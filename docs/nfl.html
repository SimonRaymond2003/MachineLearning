<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 NFL | Machine Learning Applications</title>
  <meta name="description" content="Introduction" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 NFL | Machine Learning Applications" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Introduction" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 NFL | Machine Learning Applications" />
  
  <meta name="twitter:description" content="Introduction" />
  

<meta name="author" content="Simon P. Raymond" />


<meta name="date" content="2024-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro_econ_stats.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MachineLearning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About Myself</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#notes-for-public"><i class="fa fa-check"></i><b>1.2</b> Notes for public</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#work-in-progress"><i class="fa fa-check"></i><b>1.3</b> Work in progress</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>2</b> Algorithms</a>
<ul>
<li class="chapter" data-level="2.1" data-path="algorithms.html"><a href="algorithms.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="algorithms.html"><a href="algorithms.html#parametric"><i class="fa fa-check"></i><b>2.2</b> Parametric</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="algorithms.html"><a href="algorithms.html#lm"><i class="fa fa-check"></i><b>2.2.1</b> LM</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="algorithms.html"><a href="algorithms.html#trees"><i class="fa fa-check"></i><b>2.3</b> Trees</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="algorithms.html"><a href="algorithms.html#cart"><i class="fa fa-check"></i><b>2.3.1</b> CART</a></li>
<li class="chapter" data-level="2.3.2" data-path="algorithms.html"><a href="algorithms.html#bagging"><i class="fa fa-check"></i><b>2.3.2</b> Bagging</a></li>
<li class="chapter" data-level="2.3.3" data-path="algorithms.html"><a href="algorithms.html#rf"><i class="fa fa-check"></i><b>2.3.3</b> RF</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="algorithms.html"><a href="algorithms.html#boosting"><i class="fa fa-check"></i><b>2.4</b> Boosting</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="algorithms.html"><a href="algorithms.html#adaboost"><i class="fa fa-check"></i><b>2.4.1</b> Adaboost</a></li>
<li class="chapter" data-level="2.4.2" data-path="algorithms.html"><a href="algorithms.html#gbm-boost"><i class="fa fa-check"></i><b>2.4.2</b> GBM boost</a></li>
<li class="chapter" data-level="2.4.3" data-path="algorithms.html"><a href="algorithms.html#xgboost"><i class="fa fa-check"></i><b>2.4.3</b> XGBoost</a></li>
<li class="chapter" data-level="2.4.4" data-path="algorithms.html"><a href="algorithms.html#light-gbm-boost"><i class="fa fa-check"></i><b>2.4.4</b> Light GBM boost</a></li>
<li class="chapter" data-level="2.4.5" data-path="algorithms.html"><a href="algorithms.html#catboost"><i class="fa fa-check"></i><b>2.4.5</b> Catboost</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="algorithms.html"><a href="algorithms.html#other-non-parametric"><i class="fa fa-check"></i><b>2.5</b> Other Non-parametric</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="algorithms.html"><a href="algorithms.html#knn"><i class="fa fa-check"></i><b>2.5.1</b> KNN</a></li>
<li class="chapter" data-level="2.5.2" data-path="algorithms.html"><a href="algorithms.html#nueralnet"><i class="fa fa-check"></i><b>2.5.2</b> Nueralnet</a></li>
<li class="chapter" data-level="2.5.3" data-path="algorithms.html"><a href="algorithms.html#svm"><i class="fa fa-check"></i><b>2.5.3</b> SVM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="binary-application.html"><a href="binary-application.html"><i class="fa fa-check"></i><b>3</b> Binary Application</a>
<ul>
<li class="chapter" data-level="3.1" data-path="binary-application.html"><a href="binary-application.html#data-1"><i class="fa fa-check"></i><b>3.1</b> Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="binary-application.html"><a href="binary-application.html#data-prep"><i class="fa fa-check"></i><b>3.1.1</b> Data Prep</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="binary-application.html"><a href="binary-application.html#model-selection"><i class="fa fa-check"></i><b>3.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="binary-application.html"><a href="binary-application.html#functions"><i class="fa fa-check"></i><b>3.2.1</b> Functions</a></li>
<li class="chapter" data-level="3.2.2" data-path="binary-application.html"><a href="binary-application.html#xgb"><i class="fa fa-check"></i><b>3.2.2</b> XGB</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="binary-application.html"><a href="binary-application.html#comparisions"><i class="fa fa-check"></i><b>3.3</b> Comparisions</a></li>
<li class="chapter" data-level="3.4" data-path="binary-application.html"><a href="binary-application.html#statistic-selection"><i class="fa fa-check"></i><b>3.4</b> Statistic selection</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="binary-application.html"><a href="binary-application.html#section"><i class="fa fa-check"></i><b>3.4.1</b> 0.5</a></li>
<li class="chapter" data-level="3.4.2" data-path="binary-application.html"><a href="binary-application.html#youdens-j-statistic"><i class="fa fa-check"></i><b>3.4.2</b> Youden’s J Statistic</a></li>
<li class="chapter" data-level="3.4.3" data-path="binary-application.html"><a href="binary-application.html#fscore"><i class="fa fa-check"></i><b>3.4.3</b> Fscore</a></li>
<li class="chapter" data-level="3.4.4" data-path="binary-application.html"><a href="binary-application.html#roc-curve"><i class="fa fa-check"></i><b>3.4.4</b> ROC curve</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regressional-application.html"><a href="regressional-application.html"><i class="fa fa-check"></i><b>4</b> Regressional Application</a>
<ul>
<li class="chapter" data-level="4.1" data-path="regressional-application.html"><a href="regressional-application.html#data-2"><i class="fa fa-check"></i><b>4.1</b> Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="regressional-application.html"><a href="regressional-application.html#data-prep-1"><i class="fa fa-check"></i><b>4.1.1</b> Data Prep</a></li>
<li class="chapter" data-level="4.1.2" data-path="regressional-application.html"><a href="regressional-application.html#data-explorations"><i class="fa fa-check"></i><b>4.1.2</b> Data Explorations</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="regressional-application.html"><a href="regressional-application.html#model-selection-1"><i class="fa fa-check"></i><b>4.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="regressional-application.html"><a href="regressional-application.html#rf-1"><i class="fa fa-check"></i><b>4.2.1</b> RF</a></li>
<li class="chapter" data-level="4.2.2" data-path="regressional-application.html"><a href="regressional-application.html#lm-1"><i class="fa fa-check"></i><b>4.2.2</b> LM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="imbalanced-application.html"><a href="imbalanced-application.html"><i class="fa fa-check"></i><b>5</b> Imbalanced Application</a>
<ul>
<li class="chapter" data-level="5.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#data-3"><i class="fa fa-check"></i><b>5.1</b> Data</a></li>
<li class="chapter" data-level="5.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#approaches"><i class="fa fa-check"></i><b>5.2</b> Approaches</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#no-changes"><i class="fa fa-check"></i><b>5.2.1</b> No changes</a></li>
<li class="chapter" data-level="5.2.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#undersample"><i class="fa fa-check"></i><b>5.2.2</b> Undersample</a></li>
<li class="chapter" data-level="5.2.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#oversampling"><i class="fa fa-check"></i><b>5.2.3</b> Oversampling</a></li>
<li class="chapter" data-level="5.2.4" data-path="imbalanced-application.html"><a href="imbalanced-application.html#smoteing"><i class="fa fa-check"></i><b>5.2.4</b> Smoteing</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#statistic-selection-1"><i class="fa fa-check"></i><b>5.3</b> Statistic selection</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="speeds.html"><a href="speeds.html"><i class="fa fa-check"></i><b>6</b> Speeds</a>
<ul>
<li class="chapter" data-level="6.1" data-path="speeds.html"><a href="speeds.html#functions-to-run-the-tests"><i class="fa fa-check"></i><b>6.1</b> Functions to run the tests</a></li>
<li class="chapter" data-level="6.2" data-path="speeds.html"><a href="speeds.html#data-4"><i class="fa fa-check"></i><b>6.2</b> Data</a></li>
<li class="chapter" data-level="6.3" data-path="speeds.html"><a href="speeds.html#rows"><i class="fa fa-check"></i><b>6.3</b> 10,000 rows</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix"><i class="fa fa-check"></i><b>6.3.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.3.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix"><i class="fa fa-check"></i><b>6.3.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="speeds.html"><a href="speeds.html#rows-1"><i class="fa fa-check"></i><b>6.4</b> 500,000 rows</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix-1"><i class="fa fa-check"></i><b>6.4.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix-1"><i class="fa fa-check"></i><b>6.4.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="speeds.html"><a href="speeds.html#presentations"><i class="fa fa-check"></i><b>6.5</b> Presentations</a></li>
<li class="chapter" data-level="6.6" data-path="speeds.html"><a href="speeds.html#analysis"><i class="fa fa-check"></i><b>6.6</b> Analysis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="speeds.html"><a href="speeds.html#graphs"><i class="fa fa-check"></i><b>6.6.1</b> Graphs</a></li>
<li class="chapter" data-level="6.6.2" data-path="speeds.html"><a href="speeds.html#takaways"><i class="fa fa-check"></i><b>6.6.2</b> Takaways</a></li>
<li class="chapter" data-level="6.6.3" data-path="speeds.html"><a href="speeds.html#things-to-change"><i class="fa fa-check"></i><b>6.6.3</b> Things to change</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html"><i class="fa fa-check"></i><b>7</b> Multi Variable Classification</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#data-5"><i class="fa fa-check"></i><b>7.1</b> Data</a></li>
<li class="chapter" data-level="7.2" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#aucs"><i class="fa fa-check"></i><b>7.2</b> AUCs</a></li>
<li class="chapter" data-level="7.3" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#confusion-table"><i class="fa fa-check"></i><b>7.3</b> Confusion Table</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="h20.html"><a href="h20.html"><i class="fa fa-check"></i><b>8</b> h20</a>
<ul>
<li class="chapter" data-level="8.1" data-path="h20.html"><a href="h20.html#set-up"><i class="fa fa-check"></i><b>8.1</b> Set-Up</a></li>
<li class="chapter" data-level="8.2" data-path="h20.html"><a href="h20.html#eda"><i class="fa fa-check"></i><b>8.2</b> EDA</a></li>
<li class="chapter" data-level="8.3" data-path="h20.html"><a href="h20.html#models-h20"><i class="fa fa-check"></i><b>8.3</b> Models h20</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="h20.html"><a href="h20.html#random-forest"><i class="fa fa-check"></i><b>8.3.1</b> Random Forest</a></li>
<li class="chapter" data-level="8.3.2" data-path="h20.html"><a href="h20.html#gradient-boosting-machine"><i class="fa fa-check"></i><b>8.3.2</b> Gradient Boosting Machine</a></li>
<li class="chapter" data-level="8.3.3" data-path="h20.html"><a href="h20.html#automl"><i class="fa fa-check"></i><b>8.3.3</b> AutoML</a></li>
<li class="chapter" data-level="8.3.4" data-path="h20.html"><a href="h20.html#xgboost-1"><i class="fa fa-check"></i><b>8.3.4</b> XGBoost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="econometrics.html"><a href="econometrics.html"><i class="fa fa-check"></i><b>9</b> 08_Econometrics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="econometrics.html"><a href="econometrics.html#a.-california-test-scores"><i class="fa fa-check"></i><b>9.1</b> A. California Test Scores</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="econometrics.html"><a href="econometrics.html#introduction"><i class="fa fa-check"></i><b>9.1.1</b> Introduction</a></li>
<li class="chapter" data-level="9.1.2" data-path="econometrics.html"><a href="econometrics.html#theory"><i class="fa fa-check"></i><b>9.1.2</b> Theory</a></li>
<li class="chapter" data-level="9.1.3" data-path="econometrics.html"><a href="econometrics.html#building-the-models"><i class="fa fa-check"></i><b>9.1.3</b> Building The models</a></li>
<li class="chapter" data-level="9.1.4" data-path="econometrics.html"><a href="econometrics.html#proofs"><i class="fa fa-check"></i><b>9.1.4</b> Proofs</a></li>
<li class="chapter" data-level="9.1.5" data-path="econometrics.html"><a href="econometrics.html#tests"><i class="fa fa-check"></i><b>9.1.5</b> Tests</a></li>
<li class="chapter" data-level="9.1.6" data-path="econometrics.html"><a href="econometrics.html#significances-and-tests"><i class="fa fa-check"></i><b>9.1.6</b> Significances and Tests</a></li>
<li class="chapter" data-level="9.1.7" data-path="econometrics.html"><a href="econometrics.html#conclusion"><i class="fa fa-check"></i><b>9.1.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="econometrics.html"><a href="econometrics.html#auto-correlation"><i class="fa fa-check"></i><b>9.2</b> Auto Correlation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="parrallel-processing.html"><a href="parrallel-processing.html"><i class="fa fa-check"></i><b>10</b> Parrallel Processing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="parrallel-processing.html"><a href="parrallel-processing.html#parallel-with-parlapply"><i class="fa fa-check"></i><b>10.1</b> 1. parallel with parLapply</a></li>
<li class="chapter" data-level="10.2" data-path="parrallel-processing.html"><a href="parrallel-processing.html#foreach-with-doparallel"><i class="fa fa-check"></i><b>10.2</b> 2. foreach with doParallel</a></li>
<li class="chapter" data-level="10.3" data-path="parrallel-processing.html"><a href="parrallel-processing.html#future-with-future.apply"><i class="fa fa-check"></i><b>10.3</b> 3. future with future.apply</a></li>
<li class="chapter" data-level="10.4" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-with-furrr"><i class="fa fa-check"></i><b>10.4</b> 4. purrr with furrr</a></li>
<li class="chapter" data-level="10.5" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-synchronously"><i class="fa fa-check"></i><b>10.5</b> 5. purrr Synchronously</a></li>
<li class="chapter" data-level="10.6" data-path="parrallel-processing.html"><a href="parrallel-processing.html#comparisions-1"><i class="fa fa-check"></i><b>10.6</b> comparisions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="randomforestinsight.html"><a href="randomforestinsight.html"><i class="fa fa-check"></i><b>11</b> 10_RandomForestInsight</a></li>
<li class="chapter" data-level="12" data-path="sequential-data-embedding.html"><a href="sequential-data-embedding.html"><i class="fa fa-check"></i><b>12</b> Sequential Data Embedding</a></li>
<li class="chapter" data-level="13" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html"><i class="fa fa-check"></i><b>13</b> HCC_Survey_Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#our-data-and-purpose"><i class="fa fa-check"></i><b>13.1</b> Our data and Purpose</a></li>
<li class="chapter" data-level="13.2" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>13.2</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="13.3" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#modeling-random-forest"><i class="fa fa-check"></i><b>13.3</b> Modeling Random Forest</a></li>
<li class="chapter" data-level="13.4" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#global-importance"><i class="fa fa-check"></i><b>13.4</b> Global Importance</a></li>
<li class="chapter" data-level="13.5" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#local-importance"><i class="fa fa-check"></i><b>13.5</b> Local Importance</a></li>
<li class="chapter" data-level="13.6" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#partial-dependence-plots"><i class="fa fa-check"></i><b>13.6</b> Partial Dependence Plots</a></li>
<li class="chapter" data-level="13.7" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#random-forest-explainer"><i class="fa fa-check"></i><b>13.7</b> Random Forest Explainer</a></li>
<li class="chapter" data-level="13.8" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#final-notes"><i class="fa fa-check"></i><b>13.8</b> Final Notes</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="what_is_stacked_ensambled.html"><a href="what_is_stacked_ensambled.html"><i class="fa fa-check"></i><b>14</b> 13_What_Is_Stacked_Ensambled</a></li>
<li class="chapter" data-level="15" data-path="intro_econ_stats.html"><a href="intro_econ_stats.html"><i class="fa fa-check"></i><b>15</b> 14_Intro_Econ_Stats</a></li>
<li class="chapter" data-level="16" data-path="nfl.html"><a href="nfl.html"><i class="fa fa-check"></i><b>16</b> NFL</a>
<ul>
<li class="chapter" data-level="16.1" data-path="nfl.html"><a href="nfl.html#wbs"><i class="fa fa-check"></i><b>16.1</b> WBs</a></li>
<li class="chapter" data-level="16.2" data-path="nfl.html"><a href="nfl.html#rbs"><i class="fa fa-check"></i><b>16.2</b> RBs</a></li>
<li class="chapter" data-level="16.3" data-path="nfl.html"><a href="nfl.html#qbs"><i class="fa fa-check"></i><b>16.3</b> QBs</a></li>
<li class="chapter" data-level="16.4" data-path="nfl.html"><a href="nfl.html#plots-and-analysis"><i class="fa fa-check"></i><b>16.4</b> Plots and Analysis</a></li>
<li class="chapter" data-level="16.5" data-path="nfl.html"><a href="nfl.html#lists-to-do"><i class="fa fa-check"></i><b>16.5</b> Lists to do</a></li>
<li class="chapter" data-level="16.6" data-path="nfl.html"><a href="nfl.html#team-mates"><i class="fa fa-check"></i><b>16.6</b> team mates</a></li>
<li class="chapter" data-level="16.7" data-path="nfl.html"><a href="nfl.html#testing"><i class="fa fa-check"></i><b>16.7</b> Testing</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning Applications</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="nfl" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">Chapter 16</span> NFL<a href="nfl.html#nfl" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="wbs" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> WBs<a href="nfl.html#wbs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="nfl.html#cb466-1" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb466-2"><a href="nfl.html#cb466-2" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb466-3"><a href="nfl.html#cb466-3" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb466-4"><a href="nfl.html#cb466-4" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb466-5"><a href="nfl.html#cb466-5" tabindex="-1"></a><span class="fu">library</span>(pdp)</span>
<span id="cb466-6"><a href="nfl.html#cb466-6" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="nfl.html#cb467-1" tabindex="-1"></a><span class="co"># Load the offensive yearly data</span></span>
<span id="cb467-2"><a href="nfl.html#cb467-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;offense_yearly_data.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 5453 Columns: 76
## ── Column specification ──────────
## Delimiter: &quot;,&quot;
## chr  (5): name, height_ft, position, team, season_type
## dbl (71): id, height_cm, season, completions, attempts, passing_yards, passi...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="nfl.html#cb469-1" tabindex="-1"></a><span class="co"># Sort the dataset by player name and season</span></span>
<span id="cb469-2"><a href="nfl.html#cb469-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[<span class="fu">order</span>(data<span class="sc">$</span>name, data<span class="sc">$</span>season), ]</span></code></pre></div>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="nfl.html#cb470-1" tabindex="-1"></a><span class="fu">names</span>(data)[<span class="fu">names</span>(data) <span class="sc">==</span> <span class="st">&quot;height_cm&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;height_in&quot;</span></span>
<span id="cb470-2"><a href="nfl.html#cb470-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[, <span class="sc">!</span><span class="fu">names</span>(data) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;height_ft&quot;</span>)]</span></code></pre></div>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="nfl.html#cb471-1" tabindex="-1"></a><span class="co"># Split the dataset by position</span></span>
<span id="cb471-2"><a href="nfl.html#cb471-2" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">split</span>(data, data<span class="sc">$</span>position)</span>
<span id="cb471-3"><a href="nfl.html#cb471-3" tabindex="-1"></a></span>
<span id="cb471-4"><a href="nfl.html#cb471-4" tabindex="-1"></a><span class="co"># Access the WR data</span></span>
<span id="cb471-5"><a href="nfl.html#cb471-5" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>WR</span></code></pre></div>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="nfl.html#cb472-1" tabindex="-1"></a><span class="co"># Identify zero-variance columns</span></span>
<span id="cb472-2"><a href="nfl.html#cb472-2" tabindex="-1"></a>zero_var_cols <span class="ot">&lt;-</span> <span class="fu">nearZeroVar</span>(wr_data)</span>
<span id="cb472-3"><a href="nfl.html#cb472-3" tabindex="-1"></a></span>
<span id="cb472-4"><a href="nfl.html#cb472-4" tabindex="-1"></a><span class="co"># Check and remove zero-variance columns, excluding &#39;position&#39;</span></span>
<span id="cb472-5"><a href="nfl.html#cb472-5" tabindex="-1"></a>zero_var_colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(wr_data)[zero_var_cols]</span>
<span id="cb472-6"><a href="nfl.html#cb472-6" tabindex="-1"></a>cols_to_keep <span class="ot">&lt;-</span> <span class="fu">names</span>(wr_data)[<span class="sc">!</span>(<span class="fu">names</span>(wr_data) <span class="sc">%in%</span> zero_var_colnames) <span class="sc">|</span> <span class="fu">names</span>(wr_data) <span class="sc">==</span> <span class="st">&quot;position&quot;</span>]</span>
<span id="cb472-7"><a href="nfl.html#cb472-7" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> wr_data[, cols_to_keep]</span></code></pre></div>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="nfl.html#cb473-1" tabindex="-1"></a><span class="co"># Filter the data for the 2023 season to save it before we kill it</span></span>
<span id="cb473-2"><a href="nfl.html#cb473-2" tabindex="-1"></a>wr_2023 <span class="ot">&lt;-</span> <span class="fu">subset</span>(wr_data, season <span class="sc">==</span> <span class="dv">2023</span>)</span></code></pre></div>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="nfl.html#cb474-1" tabindex="-1"></a><span class="co"># Create new columns for the next season&#39;s fantasy points</span></span>
<span id="cb474-2"><a href="nfl.html#cb474-2" tabindex="-1"></a>wr_data<span class="sc">$</span>next_fantasy_points <span class="ot">&lt;-</span> <span class="fu">ave</span>(wr_data<span class="sc">$</span>fantasy_points, wr_data<span class="sc">$</span>name, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">NA</span>))</span>
<span id="cb474-3"><a href="nfl.html#cb474-3" tabindex="-1"></a>wr_data<span class="sc">$</span>next_fantasy_points_ppr <span class="ot">&lt;-</span> <span class="fu">ave</span>(wr_data<span class="sc">$</span>fantasy_points_ppr, wr_data<span class="sc">$</span>name, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">NA</span>))</span>
<span id="cb474-4"><a href="nfl.html#cb474-4" tabindex="-1"></a></span>
<span id="cb474-5"><a href="nfl.html#cb474-5" tabindex="-1"></a><span class="co"># View the first few rows of the updated data</span></span>
<span id="cb474-6"><a href="nfl.html#cb474-6" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 75
##      id name    height_in position team  season season_type completions attempts
##   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;    &lt;dbl&gt;
## 1     1 A.J. B…        73 WR       TEN     2019 REG                   0        0
## 2     1 A.J. B…        72 WR       TEN     2020 REG                   0        0
## 3     1 A.J. B…        73 WR       TEN     2021 REG                   0        2
## 4     1 A.J. B…        73 WR       PHI     2022 REG                   0        0
## 5     1 A.J. B…        73 WR       PHI     2023 REG                   0        0
## 6     2 A.J. D…        77 TE       DEN     2016 REG                   0        0
## # ℹ 66 more variables: passing_yards &lt;dbl&gt;, passing_tds &lt;dbl&gt;,
## #   interceptions &lt;dbl&gt;, sacks &lt;dbl&gt;, sack_yards &lt;dbl&gt;, sack_fumbles &lt;dbl&gt;,
## #   sack_fumbles_lost &lt;dbl&gt;, passing_air_yards &lt;dbl&gt;,
## #   passing_yards_after_catch &lt;dbl&gt;, passing_first_downs &lt;dbl&gt;,
## #   passing_2pt_conversions &lt;dbl&gt;, carries &lt;dbl&gt;, rushing_yards &lt;dbl&gt;,
## #   rushing_tds &lt;dbl&gt;, rushing_fumbles &lt;dbl&gt;, rushing_fumbles_lost &lt;dbl&gt;,
## #   rushing_first_downs &lt;dbl&gt;, rushing_2pt_conversions &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="nfl.html#cb476-1" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> wr_data[wr_data<span class="sc">$</span>rookie_season <span class="sc">!=</span> <span class="dv">0</span>, ]</span></code></pre></div>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="nfl.html#cb477-1" tabindex="-1"></a><span class="co"># Count the number of NA values in each column</span></span>
<span id="cb477-2"><a href="nfl.html#cb477-2" tabindex="-1"></a>na_table <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(wr_data))</span>
<span id="cb477-3"><a href="nfl.html#cb477-3" tabindex="-1"></a><span class="fu">print</span>(na_table)</span></code></pre></div>
<pre><code>##                          id                        name 
##                           0                           0 
##                   height_in                    position 
##                           0                           0 
##                        team                      season 
##                           0                           0 
##                    attempts                     carries 
##                           0                           0 
##         rushing_first_downs                  receptions 
##                           0                           0 
##                     targets             receiving_yards 
##                           0                           0 
##               receiving_tds           receiving_fumbles 
##                           0                           0 
##      receiving_fumbles_lost         receiving_air_yards 
##                           0                           0 
## receiving_yards_after_catch       receiving_first_downs 
##                           0                           0 
##   receiving_2pt_conversions                target_share 
##                           0                           0 
##             air_yards_share              fantasy_points 
##                           0                           0 
##          fantasy_points_ppr                 total_yards 
##                           0                           0 
##                       games               offense_snaps 
##                           0                           0 
##         teams_offense_snaps                         ypc 
##                           0                           0 
##                         ypr                     touches 
##                           0                           0 
##           rec_td_percentage                   total_tds 
##                           0                           0 
##               td_percentage                 offense_pct 
##                           0                          77 
##                    rush_ypg                     rec_ypg 
##                           0                           0 
##                         ppg                     ppr_ppg 
##                           0                           0 
##                         yps                         ypg 
##                           4                           0 
##               rookie_season                       round 
##                           0                           0 
##                       forty                       bench 
##                           0                           0 
##                    vertical                years_played 
##                           0                           0 
##                       fp_ps                   ppr_fp_ps 
##                           2                           2 
##         next_fantasy_points     next_fantasy_points_ppr 
##                         675                         675</code></pre>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="nfl.html#cb479-1" tabindex="-1"></a><span class="co"># For now, remove all rows with NAs</span></span>
<span id="cb479-2"><a href="nfl.html#cb479-2" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(wr_data)</span>
<span id="cb479-3"><a href="nfl.html#cb479-3" tabindex="-1"></a></span>
<span id="cb479-4"><a href="nfl.html#cb479-4" tabindex="-1"></a><span class="co"># Drop the next_fantasy_points_ppr column</span></span>
<span id="cb479-5"><a href="nfl.html#cb479-5" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> wr_data[, <span class="sc">!</span><span class="fu">names</span>(wr_data) <span class="sc">%in%</span> <span class="st">&quot;next_fantasy_points_ppr&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="nfl.html#cb480-1" tabindex="-1"></a><span class="co"># Build Random Forest model</span></span>
<span id="cb480-2"><a href="nfl.html#cb480-2" tabindex="-1"></a>wrrf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(next_fantasy_points <span class="sc">~</span> ., <span class="at">data =</span> wr_data, <span class="at">ntree =</span> <span class="dv">500</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="nfl.html#cb481-1" tabindex="-1"></a><span class="co"># Create a simplified dataset for linear regression</span></span>
<span id="cb481-2"><a href="nfl.html#cb481-2" tabindex="-1"></a>lm_data <span class="ot">&lt;-</span> wr_data[, <span class="sc">!</span><span class="fu">names</span>(wr_data) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;id&quot;</span>, <span class="st">&quot;position&quot;</span>)]</span>
<span id="cb481-3"><a href="nfl.html#cb481-3" tabindex="-1"></a></span>
<span id="cb481-4"><a href="nfl.html#cb481-4" tabindex="-1"></a></span>
<span id="cb481-5"><a href="nfl.html#cb481-5" tabindex="-1"></a><span class="co"># Initialize a vector to store RMSPE values for each run</span></span>
<span id="cb481-6"><a href="nfl.html#cb481-6" tabindex="-1"></a>rmspe <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb481-7"><a href="nfl.html#cb481-7" tabindex="-1"></a></span>
<span id="cb481-8"><a href="nfl.html#cb481-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb481-9"><a href="nfl.html#cb481-9" tabindex="-1"></a>  </span>
<span id="cb481-10"><a href="nfl.html#cb481-10" tabindex="-1"></a>  <span class="co"># Resample the dataset with replacement</span></span>
<span id="cb481-11"><a href="nfl.html#cb481-11" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(lm_data), <span class="fu">nrow</span>(lm_data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb481-12"><a href="nfl.html#cb481-12" tabindex="-1"></a>  train <span class="ot">&lt;-</span> lm_data[ind, ]</span>
<span id="cb481-13"><a href="nfl.html#cb481-13" tabindex="-1"></a>  test <span class="ot">&lt;-</span> lm_data[<span class="sc">-</span>ind, ]</span>
<span id="cb481-14"><a href="nfl.html#cb481-14" tabindex="-1"></a>  </span>
<span id="cb481-15"><a href="nfl.html#cb481-15" tabindex="-1"></a>  <span class="co"># Build Linear Regression model</span></span>
<span id="cb481-16"><a href="nfl.html#cb481-16" tabindex="-1"></a>  lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(next_fantasy_points <span class="sc">~</span> ., <span class="at">data =</span> train)</span>
<span id="cb481-17"><a href="nfl.html#cb481-17" tabindex="-1"></a>  </span>
<span id="cb481-18"><a href="nfl.html#cb481-18" tabindex="-1"></a>  <span class="co"># Predict on the test data</span></span>
<span id="cb481-19"><a href="nfl.html#cb481-19" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_model, <span class="at">newdata =</span> test)</span>
<span id="cb481-20"><a href="nfl.html#cb481-20" tabindex="-1"></a>  </span>
<span id="cb481-21"><a href="nfl.html#cb481-21" tabindex="-1"></a>  <span class="co"># Calculate RMSPE</span></span>
<span id="cb481-22"><a href="nfl.html#cb481-22" tabindex="-1"></a>  rmspe[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test<span class="sc">$</span>next_fantasy_points <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb481-23"><a href="nfl.html#cb481-23" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases</code></pre>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="nfl.html#cb483-1" tabindex="-1"></a><span class="co"># Calculate the mean RMSPE over the 10 runs</span></span>
<span id="cb483-2"><a href="nfl.html#cb483-2" tabindex="-1"></a>mean_rmspe <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe)</span>
<span id="cb483-3"><a href="nfl.html#cb483-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE over 10 runs:&quot;</span>, mean_rmspe))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE over 10 runs: 40.3900949556639&quot;</code></pre>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="nfl.html#cb485-1" tabindex="-1"></a><span class="co"># Optionally, print the RMSPE for each run to see variability</span></span>
<span id="cb485-2"><a href="nfl.html#cb485-2" tabindex="-1"></a><span class="fu">print</span>(rmspe)</span></code></pre></div>
<pre><code>##  [1] 41.51607 38.92039 40.43129 40.48614 39.86521 40.58027 38.78137 41.11945
##  [9] 42.87032 39.33045</code></pre>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="nfl.html#cb487-1" tabindex="-1"></a><span class="co"># Evaluate feature importance</span></span>
<span id="cb487-2"><a href="nfl.html#cb487-2" tabindex="-1"></a>importance_values <span class="ot">&lt;-</span> <span class="fu">importance</span>(wrrf_model)</span>
<span id="cb487-3"><a href="nfl.html#cb487-3" tabindex="-1"></a></span>
<span id="cb487-4"><a href="nfl.html#cb487-4" tabindex="-1"></a><span class="co"># Sort and extract the top 10 features by %IncMSE and IncNodePurity</span></span>
<span id="cb487-5"><a href="nfl.html#cb487-5" tabindex="-1"></a>top10_mse <span class="ot">&lt;-</span> importance_values[<span class="fu">order</span>(importance_values[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb487-6"><a href="nfl.html#cb487-6" tabindex="-1"></a>top10_purity <span class="ot">&lt;-</span> importance_values[<span class="fu">order</span>(importance_values[, <span class="st">&quot;IncNodePurity&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb487-7"><a href="nfl.html#cb487-7" tabindex="-1"></a></span>
<span id="cb487-8"><a href="nfl.html#cb487-8" tabindex="-1"></a><span class="co"># Visualize top 10 features by %IncMSE</span></span>
<span id="cb487-9"><a href="nfl.html#cb487-9" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">2</span>))  <span class="co"># Increase margins for labels</span></span>
<span id="cb487-10"><a href="nfl.html#cb487-10" tabindex="-1"></a><span class="fu">barplot</span>(top10_mse[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_mse),</span>
<span id="cb487-11"><a href="nfl.html#cb487-11" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by %IncMSE (Mean Decrease in Accuracy)&quot;</span>,</span>
<span id="cb487-12"><a href="nfl.html#cb487-12" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-210-1.png" width="672" /></p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="nfl.html#cb488-1" tabindex="-1"></a><span class="co"># Visualize top 10 features by IncNodePurity</span></span>
<span id="cb488-2"><a href="nfl.html#cb488-2" tabindex="-1"></a><span class="fu">barplot</span>(top10_purity[, <span class="st">&quot;IncNodePurity&quot;</span>], <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_purity),</span>
<span id="cb488-3"><a href="nfl.html#cb488-3" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by IncNodePurity (Mean Decrease in Gini)&quot;</span>,</span>
<span id="cb488-4"><a href="nfl.html#cb488-4" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-210-2.png" width="672" /></p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="nfl.html#cb489-1" tabindex="-1"></a>oob_mse <span class="ot">&lt;-</span> wrrf_model<span class="sc">$</span>mse[wrrf_model<span class="sc">$</span>ntree]</span>
<span id="cb489-2"><a href="nfl.html#cb489-2" tabindex="-1"></a>oobrmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(oob_mse)</span>
<span id="cb489-3"><a href="nfl.html#cb489-3" tabindex="-1"></a><span class="co"># Print the OOB MSE</span></span>
<span id="cb489-4"><a href="nfl.html#cb489-4" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;OOB rMSE:&quot;</span>, oobrmse))</span></code></pre></div>
<pre><code>## [1] &quot;OOB rMSE: 40.8993809346341&quot;</code></pre>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="nfl.html#cb491-1" tabindex="-1"></a><span class="co"># Extract OOB predictions</span></span>
<span id="cb491-2"><a href="nfl.html#cb491-2" tabindex="-1"></a>oob_predictions <span class="ot">&lt;-</span> wrrf_model<span class="sc">$</span>predicted</span>
<span id="cb491-3"><a href="nfl.html#cb491-3" tabindex="-1"></a></span>
<span id="cb491-4"><a href="nfl.html#cb491-4" tabindex="-1"></a><span class="co"># Calculate the absolute errors</span></span>
<span id="cb491-5"><a href="nfl.html#cb491-5" tabindex="-1"></a>absolute_errors <span class="ot">&lt;-</span> <span class="fu">abs</span>(oob_predictions <span class="sc">-</span> wrrf_model<span class="sc">$</span>y)</span>
<span id="cb491-6"><a href="nfl.html#cb491-6" tabindex="-1"></a></span>
<span id="cb491-7"><a href="nfl.html#cb491-7" tabindex="-1"></a><span class="co"># Calculate the Mean Absolute Error (MAE)</span></span>
<span id="cb491-8"><a href="nfl.html#cb491-8" tabindex="-1"></a>oob_mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(absolute_errors)</span>
<span id="cb491-9"><a href="nfl.html#cb491-9" tabindex="-1"></a></span>
<span id="cb491-10"><a href="nfl.html#cb491-10" tabindex="-1"></a><span class="co"># Print the OOB MAE</span></span>
<span id="cb491-11"><a href="nfl.html#cb491-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;OOB MAE:&quot;</span>, oob_mae))</span></code></pre></div>
<pre><code>## [1] &quot;OOB MAE: 31.0312370753633&quot;</code></pre>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="nfl.html#cb493-1" tabindex="-1"></a><span class="co"># Predict 2024 fantasy points for 2023 WRs</span></span>
<span id="cb493-2"><a href="nfl.html#cb493-2" tabindex="-1"></a>predicted_2024_fantasy_points <span class="ot">&lt;-</span> <span class="fu">predict</span>(wrrf_model, <span class="at">newdata =</span> wr_2023)</span>
<span id="cb493-3"><a href="nfl.html#cb493-3" tabindex="-1"></a></span>
<span id="cb493-4"><a href="nfl.html#cb493-4" tabindex="-1"></a><span class="co"># Create a data frame with the names and the predicted 2024 fantasy points</span></span>
<span id="cb493-5"><a href="nfl.html#cb493-5" tabindex="-1"></a>results_wr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> wr_2023<span class="sc">$</span>name, <span class="at">predicted_2024_fantasy_points =</span> predicted_2024_fantasy_points)</span>
<span id="cb493-6"><a href="nfl.html#cb493-6" tabindex="-1"></a><span class="fu">print</span>(results_wr)</span></code></pre></div>
<pre><code>##                         name predicted_2024_fantasy_points
## 1                 A.J. Brown                     157.17480
## 2                 A.T. Perry                      46.98369
## 3               Adam Thielen                     124.63056
## 4                Alec Pierce                      67.58696
## 5              Alex Erickson                      37.06521
## 6               Allen Lazard                      49.83097
## 7             Allen Robinson                      47.93763
## 8               Amari Cooper                     135.74772
## 9              Amari Rodgers                      25.25656
## 10         Amon-Ra St. Brown                     190.62602
## 11            Andrei Iosivas                      37.23415
## 12             Antoine Green                      25.17406
## 13           Austin Trammell                      18.80340
## 14             Ben Skowronek                      19.88537
## 15                 Bo Melton                      59.66029
## 16             Brandin Cooks                     107.68374
## 17             Brandon Aiyuk                     146.37277
## 18           Brandon Johnson                      44.39556
## 19            Brandon Powell                      42.02138
## 20           Braxton Berrios                      39.60880
## 21             Britain Covey                      17.08505
## 22             Byron Pringle                      26.51074
## 23             Calvin Austin                      39.43761
## 24             Calvin Ridley                     130.29700
## 25            Cedric Tillman                      44.89559
## 26               CeeDee Lamb                     187.75591
## 27             Charlie Jones                      24.83876
## 28            Chase Claypool                      12.38027
## 29              Chris Conley                      52.30433
## 30              Chris Godwin                     115.05250
## 31               Chris Moore                      42.57187
## 32               Chris Olave                     140.80677
## 33            Christian Kirk                      97.79042
## 34          Christian Watson                      78.28672
## 35             Cody Thompson                      14.12964
## 36            Collin Johnson                      10.41027
## 37             Colton Dowell                      17.19781
## 38               Cooper Kupp                     108.32921
## 39          Courtland Sutton                     112.63547
## 40             Curtis Samuel                      73.59254
## 41          D&#39;Wayne Eskridge                      16.71575
## 42                D.J. Chark                            NA
## 43           D.J. Montgomery                      22.14999
## 44                D.J. Moore                     155.89027
## 45            Darius Slayton                      68.79059
## 46            Darnell Mooney                      55.90383
## 47             Davante Adams                     134.72572
## 48                David Bell                      35.11340
## 49               David Moore                      18.23128
## 50            DeAndre Carter                      18.77411
## 51           DeAndre Hopkins                     123.21165
## 52              Deebo Samuel                     127.33945
## 53         Demarcus Robinson                      54.56798
## 54           Demario Douglas                      73.42642
## 55              Deonte Harty                      24.25080
## 56              Derius Davis                      35.31692
## 57            DeVante Parker                      40.49505
## 58           Deven Thompkins                      28.03221
## 59            Devin Duvernay                      18.41180
## 60             DeVonta Smith                     134.73927
## 61           Diontae Johnson                     107.77734
## 62                DK Metcalf                            NA
## 63     Donovan Peoples-Jones                      13.95773
## 64          Dontayvion Wicks                      69.02956
## 65              Drake London                      94.35400
## 66               Dyami Brown                      34.43046
## 67              Elijah Cooks                      16.03892
## 68              Elijah Moore                      77.19134
## 69     Equanimeous St. Brown                      12.21726
## 70             Erik Ezukanma                      21.20262
## 71                Gabe Davis                            NA
## 72            Garrett Wilson                     118.87253
## 73            George Pickens                     119.96120
## 74               Greg Dortch                      44.71445
## 75          Gunner Olszewski                      20.97760
## 76            Hunter Renfrow                      40.33806
## 77      Ihmir Smith-Marsette                      26.83299
## 78             Irvin Charles                      17.86954
## 79            Isaiah Hodgins                      42.12548
## 80           Isaiah McKenzie                      25.54656
## 81             Ja&#39;Marr Chase                     137.89821
## 82              Jahan Dotson                      56.38782
## 83                 Jake Bobo                      37.67511
## 84             Jakobi Meyers                     113.42291
## 85              Jalen Brooks                      23.39124
## 86              Jalen Guyton                      21.51121
## 87              Jalen Nailor                      19.39478
## 88              Jalen Reagor                      25.13487
## 89             Jalen Tolbert                      42.11227
## 90               Jalin Hyatt                      61.83907
## 91               Jamal Agnew                      32.79430
## 92              James Proche                      30.55856
## 93          Jameson Williams                      49.73451
## 94           Jamison Crowder                      29.39799
## 95            Jason Brownlee                      27.34987
## 96            Jauan Jennings                      36.10466
## 97        Jaxon Smith-Njigba                      82.61150
## 98               Jayden Reed                     129.16471
## 99             Jaylen Waddle                     133.38376
## 100              Jerry Jeudy                      77.73054
## 101           Jonathan Mingo                      77.55108
## 102           Jordan Addison                     122.85956
## 103               Josh Downs                      85.10446
## 104              Josh Palmer                      77.84407
## 105            Josh Reynolds                      54.59260
## 106      JuJu Smith-Schuster                      39.12024
## 107              Julio Jones                      23.73418
## 108         Justin Jefferson                     137.10834
## 109            Justin Watson                      60.80272
## 110              Justyn Ross                      16.38659
## 111           Juwann Winfree                      14.04169
## 112              K.J. Osborn                      47.56511
## 113           Kadarius Toney                      42.00206
## 114            Kalif Raymond                      50.26786
## 115           Kayshon Boutte                      21.53693
## 116              Keelan Doss                      19.73776
## 117             Keenan Allen                     150.16159
## 118           Keith Kirkwood                      13.79941
## 119          Kendrick Bourne                      69.14235
## 120           KhaDarel Hodge                      34.60650
## 121            Khalil Shakir                      65.89405
## 122          Kwamie Lassiter                            NA
## 123             Kyle Philips                      27.48208
## 124         Laquon Treadwell                      21.12392
## 125         Laviska Shenault                            NA
## 126      Lil&#39;Jordan Humphrey                      35.20077
## 127              Lynn Bowden                            NA
## 128             Mack Hollins                      32.42796
## 129              Malik Heath                      31.37605
## 130             Malik Taylor                      11.55329
## 131 Marquez Valdes-Scantling                      48.59948
## 132           Marquise Brown                      75.42577
## 133         Marquise Goodwin                      25.62864
## 134             Marvin Jones                      14.59955
## 135              Marvin Mims                      58.28685
## 136             Mason Kinsey                      16.04117
## 137           Mecole Hardman                      28.05350
## 138           Michael Gallup                      34.03682
## 139          Michael Pittman                            NA
## 140           Michael Thomas                      49.86298
## 141           Michael Wilson                      74.66154
## 142               Mike Evans                     135.53877
## 143            Mike Strachan                      18.57186
## 144            Mike Williams                      65.83951
## 145             Miles Boykin                      11.39638
## 146           Nelson Agholor                      41.51334
## 147    Nick Westbrook-Ikhine                      42.13301
## 148             Nico Collins                     142.83580
## 149               Noah Brown                      67.31974
## 150        Olamide Zaccheaus                      31.70466
## 151        Parker Washington                      31.81540
## 152          Parris Campbell                      25.62103
## 153          Phillip Dorsett                      24.68863
## 154               Puka Nacua                     181.00701
## 155         Quentin Johnston                      58.12017
## 156             Quez Watkins                      34.27737
## 157            Rakim Jarrett                      20.59234
## 158             Randall Cobb                      25.24437
## 159              Rashee Rice                     105.47835
## 160           Rashid Shaheed                      86.25315
## 161           Rashod Bateman                      57.45422
## 162          Ray-Ray McCloud                      24.92795
## 163             Richie James                      23.33708
## 164           River Cracraft                      16.48914
## 165            Robbie Chosen                      22.14739
## 166             Robert Woods                      52.70001
## 167              Romeo Doubs                      83.70492
## 168            Rondale Moore                      55.50335
## 169              Ronnie Bell                      34.19325
## 170             Samori Toure                      22.00546
## 171             Scott Miller                      29.56553
## 172         Shedrick Jackson                      21.24781
## 173              Simi Fehoko                      19.90172
## 174               Skyy Moore                      34.87768
## 175             Stefon Diggs                     133.00342
## 176         Sterling Shepard                      27.71374
## 177              Steven Sims                      17.06804
## 178                Tank Dell                     128.01543
## 179              Tee Higgins                      88.82843
## 180         Terrace Marshall                            NA
## 181           Terry McLaurin                     108.61167
## 182                Tim Jones                      34.24164
## 183               Tre Tucker                      58.91104
## 184          Trent Sherfield                      23.04970
## 185             Trent Taylor                      19.23744
## 186            Trenton Irwin                      36.91050
## 187              Trey Palmer                      59.69736
## 188            Treylon Burks                      52.11504
## 189         Trishton Jackson                      14.46942
## 190              Tutu Atwell                      54.53558
## 191            Ty Montgomery                      15.34042
## 192            Tylan Wallace                      13.92826
## 193               Tyler Boyd                      54.53340
## 194            Tyler Johnson                      21.84475
## 195            Tyler Lockett                      86.67339
## 196              Tyler Scott                      36.00726
## 197          Tyquan Thornton                      26.71170
## 198              Tyreek Hill                     200.60328
## 199            Van Jefferson                      44.75561
## 200              Velus Jones                            NA
## 201        Wan&#39;Dale Robinson                      69.80029
## 202             Willie Snead                      14.29176
## 203            Xavier Gipson                      46.30136
## 204        Xavier Hutchinson                      41.41602
## 205              Zach Pascal                      26.24253
## 206              Zay Flowers                     109.98446
## 207                Zay Jones                      59.75285</code></pre>
<p>mse of specific seasons?
we need to factor in the qbs and teamates of the players</p>
</div>
<div id="rbs" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> RBs<a href="nfl.html#rbs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="nfl.html#cb495-1" tabindex="-1"></a><span class="co"># Access the RB data</span></span>
<span id="cb495-2"><a href="nfl.html#cb495-2" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>RB</span></code></pre></div>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="nfl.html#cb496-1" tabindex="-1"></a><span class="co"># Identify zero-variance columns</span></span>
<span id="cb496-2"><a href="nfl.html#cb496-2" tabindex="-1"></a>zero_var_cols <span class="ot">&lt;-</span> <span class="fu">nearZeroVar</span>(rb_data)</span>
<span id="cb496-3"><a href="nfl.html#cb496-3" tabindex="-1"></a></span>
<span id="cb496-4"><a href="nfl.html#cb496-4" tabindex="-1"></a><span class="co"># Check and remove zero-variance columns, excluding &#39;position&#39;</span></span>
<span id="cb496-5"><a href="nfl.html#cb496-5" tabindex="-1"></a>zero_var_colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(rb_data)[zero_var_cols]</span>
<span id="cb496-6"><a href="nfl.html#cb496-6" tabindex="-1"></a>cols_to_keep <span class="ot">&lt;-</span> <span class="fu">names</span>(rb_data)[<span class="sc">!</span>(<span class="fu">names</span>(rb_data) <span class="sc">%in%</span> zero_var_colnames) <span class="sc">|</span> <span class="fu">names</span>(rb_data) <span class="sc">==</span> <span class="st">&quot;position&quot;</span>]</span>
<span id="cb496-7"><a href="nfl.html#cb496-7" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> rb_data[, cols_to_keep]</span>
<span id="cb496-8"><a href="nfl.html#cb496-8" tabindex="-1"></a></span>
<span id="cb496-9"><a href="nfl.html#cb496-9" tabindex="-1"></a>rb_2023 <span class="ot">&lt;-</span> <span class="fu">subset</span>(rb_data, season <span class="sc">==</span> <span class="dv">2023</span>)</span></code></pre></div>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="nfl.html#cb497-1" tabindex="-1"></a><span class="co"># Create new columns for the next season&#39;s fantasy points</span></span>
<span id="cb497-2"><a href="nfl.html#cb497-2" tabindex="-1"></a>rb_data<span class="sc">$</span>next_fantasy_points <span class="ot">&lt;-</span> <span class="fu">ave</span>(rb_data<span class="sc">$</span>fantasy_points, rb_data<span class="sc">$</span>name, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">NA</span>))</span>
<span id="cb497-3"><a href="nfl.html#cb497-3" tabindex="-1"></a>rb_data<span class="sc">$</span>next_fantasy_points_ppr <span class="ot">&lt;-</span> <span class="fu">ave</span>(rb_data<span class="sc">$</span>fantasy_points_ppr, rb_data<span class="sc">$</span>name, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">NA</span>))</span>
<span id="cb497-4"><a href="nfl.html#cb497-4" tabindex="-1"></a></span>
<span id="cb497-5"><a href="nfl.html#cb497-5" tabindex="-1"></a><span class="co"># View the first few rows of the updated data</span></span>
<span id="cb497-6"><a href="nfl.html#cb497-6" tabindex="-1"></a><span class="fu">head</span>(rb_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 55
##      id name   height_in position team  season carries rushing_yards rushing_tds
##   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;
## 1     3 A.J. …        72 RB       GB      2020      46           242           2
## 2     3 A.J. …        72 RB       GB      2021     187           803           5
## 3     3 A.J. …        72 RB       GB      2022     186           770           7
## 4    10 Aaron…        69 RB       GB      2017      81           448           4
## 5    10 Aaron…        69 RB       GB      2018     133           728           8
## 6    10 Aaron…        69 RB       GB      2019     236          1084          16
## # ℹ 46 more variables: rushing_fumbles &lt;dbl&gt;, rushing_fumbles_lost &lt;dbl&gt;,
## #   rushing_first_downs &lt;dbl&gt;, rushing_2pt_conversions &lt;dbl&gt;, receptions &lt;dbl&gt;,
## #   targets &lt;dbl&gt;, receiving_yards &lt;dbl&gt;, receiving_tds &lt;dbl&gt;,
## #   receiving_fumbles &lt;dbl&gt;, receiving_fumbles_lost &lt;dbl&gt;,
## #   receiving_air_yards &lt;dbl&gt;, receiving_yards_after_catch &lt;dbl&gt;,
## #   receiving_first_downs &lt;dbl&gt;, target_share &lt;dbl&gt;, air_yards_share &lt;dbl&gt;,
## #   fantasy_points &lt;dbl&gt;, fantasy_points_ppr &lt;dbl&gt;, total_yards &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="nfl.html#cb499-1" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> rb_data[rb_data<span class="sc">$</span>rookie_season <span class="sc">!=</span> <span class="dv">0</span>, ]</span></code></pre></div>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="nfl.html#cb500-1" tabindex="-1"></a><span class="co"># Count the number of NA values in each column</span></span>
<span id="cb500-2"><a href="nfl.html#cb500-2" tabindex="-1"></a>na_table <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(rb_data))</span>
<span id="cb500-3"><a href="nfl.html#cb500-3" tabindex="-1"></a><span class="fu">print</span>(na_table)</span></code></pre></div>
<pre><code>##                          id                        name 
##                           0                           0 
##                   height_in                    position 
##                           0                           0 
##                        team                      season 
##                           0                           0 
##                     carries               rushing_yards 
##                           0                           0 
##                 rushing_tds             rushing_fumbles 
##                           0                           0 
##        rushing_fumbles_lost         rushing_first_downs 
##                           0                           0 
##     rushing_2pt_conversions                  receptions 
##                           0                           0 
##                     targets             receiving_yards 
##                           0                           0 
##               receiving_tds           receiving_fumbles 
##                           0                           0 
##      receiving_fumbles_lost         receiving_air_yards 
##                           0                           0 
## receiving_yards_after_catch       receiving_first_downs 
##                           0                           0 
##                target_share             air_yards_share 
##                           0                           0 
##              fantasy_points          fantasy_points_ppr 
##                           0                           0 
##                 total_yards                       games 
##                           0                           0 
##               offense_snaps         teams_offense_snaps 
##                           0                           0 
##                         ypc                         ypr 
##                           0                           0 
##                     touches          rush_td_percentage 
##                           0                           0 
##           rec_td_percentage                   total_tds 
##                           0                           0 
##               td_percentage                 offense_pct 
##                           0                          50 
##                    rush_ypg                     rec_ypg 
##                           0                           0 
##                         ppg                     ppr_ppg 
##                           0                           0 
##                         yps                         ypg 
##                           0                           0 
##               rookie_season                       round 
##                           0                           0 
##                     overall                       forty 
##                           0                           0 
##                       bench                    vertical 
##                           0                           0 
##                years_played                       fp_ps 
##                           0                           0 
##                   ppr_fp_ps         next_fantasy_points 
##                           0                         429 
##     next_fantasy_points_ppr 
##                         429</code></pre>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="nfl.html#cb502-1" tabindex="-1"></a><span class="co"># For now, remove all rows with NAs</span></span>
<span id="cb502-2"><a href="nfl.html#cb502-2" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(rb_data)</span>
<span id="cb502-3"><a href="nfl.html#cb502-3" tabindex="-1"></a></span>
<span id="cb502-4"><a href="nfl.html#cb502-4" tabindex="-1"></a><span class="co"># Drop the next_fantasy_points_ppr column</span></span>
<span id="cb502-5"><a href="nfl.html#cb502-5" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> rb_data[, <span class="sc">!</span><span class="fu">names</span>(rb_data) <span class="sc">%in%</span> <span class="st">&quot;next_fantasy_points_ppr&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="nfl.html#cb503-1" tabindex="-1"></a><span class="co"># Build Random Forest model</span></span>
<span id="cb503-2"><a href="nfl.html#cb503-2" tabindex="-1"></a>rbrf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(next_fantasy_points <span class="sc">~</span> ., <span class="at">data =</span> rb_data, <span class="at">ntree =</span> <span class="dv">500</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="nfl.html#cb504-1" tabindex="-1"></a><span class="co"># Create a simplified dataset for linear regression</span></span>
<span id="cb504-2"><a href="nfl.html#cb504-2" tabindex="-1"></a>lm_data <span class="ot">&lt;-</span> rb_data[, <span class="sc">!</span><span class="fu">names</span>(rb_data) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;id&quot;</span>, <span class="st">&quot;position&quot;</span>)]</span>
<span id="cb504-3"><a href="nfl.html#cb504-3" tabindex="-1"></a></span>
<span id="cb504-4"><a href="nfl.html#cb504-4" tabindex="-1"></a><span class="co"># Initialize a vector to store RMSPE values for each run</span></span>
<span id="cb504-5"><a href="nfl.html#cb504-5" tabindex="-1"></a>rmspe <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb504-6"><a href="nfl.html#cb504-6" tabindex="-1"></a></span>
<span id="cb504-7"><a href="nfl.html#cb504-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb504-8"><a href="nfl.html#cb504-8" tabindex="-1"></a>  </span>
<span id="cb504-9"><a href="nfl.html#cb504-9" tabindex="-1"></a>  <span class="co"># Resample the dataset with replacement</span></span>
<span id="cb504-10"><a href="nfl.html#cb504-10" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(lm_data), <span class="fu">nrow</span>(lm_data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb504-11"><a href="nfl.html#cb504-11" tabindex="-1"></a>  train <span class="ot">&lt;-</span> lm_data[ind, ]</span>
<span id="cb504-12"><a href="nfl.html#cb504-12" tabindex="-1"></a>  test <span class="ot">&lt;-</span> lm_data[<span class="sc">-</span>ind, ]</span>
<span id="cb504-13"><a href="nfl.html#cb504-13" tabindex="-1"></a>  </span>
<span id="cb504-14"><a href="nfl.html#cb504-14" tabindex="-1"></a>  <span class="co"># Build Linear Regression model</span></span>
<span id="cb504-15"><a href="nfl.html#cb504-15" tabindex="-1"></a>  lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(next_fantasy_points <span class="sc">~</span> ., <span class="at">data =</span> train)</span>
<span id="cb504-16"><a href="nfl.html#cb504-16" tabindex="-1"></a>  </span>
<span id="cb504-17"><a href="nfl.html#cb504-17" tabindex="-1"></a>  <span class="co"># Predict on the test data</span></span>
<span id="cb504-18"><a href="nfl.html#cb504-18" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_model, <span class="at">newdata =</span> test)</span>
<span id="cb504-19"><a href="nfl.html#cb504-19" tabindex="-1"></a>  </span>
<span id="cb504-20"><a href="nfl.html#cb504-20" tabindex="-1"></a>  <span class="co"># Calculate RMSPE</span></span>
<span id="cb504-21"><a href="nfl.html#cb504-21" tabindex="-1"></a>  rmspe[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test<span class="sc">$</span>next_fantasy_points <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb504-22"><a href="nfl.html#cb504-22" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases</code></pre>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="nfl.html#cb506-1" tabindex="-1"></a><span class="co"># Calculate the mean RMSPE over the 10 runs</span></span>
<span id="cb506-2"><a href="nfl.html#cb506-2" tabindex="-1"></a>mean_rmspe <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe)</span>
<span id="cb506-3"><a href="nfl.html#cb506-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE over 10 runs:&quot;</span>, mean_rmspe))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE over 10 runs: 59.7769931450521&quot;</code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="nfl.html#cb508-1" tabindex="-1"></a><span class="co"># Optionally, print the RMSPE for each run to see variability</span></span>
<span id="cb508-2"><a href="nfl.html#cb508-2" tabindex="-1"></a><span class="fu">print</span>(rmspe)</span></code></pre></div>
<pre><code>##  [1] 57.32384 62.04078 55.41853 61.09091 59.29520 64.96443 62.44621 58.12239
##  [9] 59.46607 57.60159</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="nfl.html#cb510-1" tabindex="-1"></a><span class="co"># Evaluate feature importance</span></span>
<span id="cb510-2"><a href="nfl.html#cb510-2" tabindex="-1"></a>importance_values <span class="ot">&lt;-</span> <span class="fu">importance</span>(rbrf_model)</span>
<span id="cb510-3"><a href="nfl.html#cb510-3" tabindex="-1"></a></span>
<span id="cb510-4"><a href="nfl.html#cb510-4" tabindex="-1"></a><span class="co"># Sort and extract the top 10 features by %IncMSE and IncNodePurity</span></span>
<span id="cb510-5"><a href="nfl.html#cb510-5" tabindex="-1"></a>top10_mse <span class="ot">&lt;-</span> importance_values[<span class="fu">order</span>(importance_values[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb510-6"><a href="nfl.html#cb510-6" tabindex="-1"></a>top10_purity <span class="ot">&lt;-</span> importance_values[<span class="fu">order</span>(importance_values[, <span class="st">&quot;IncNodePurity&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb510-7"><a href="nfl.html#cb510-7" tabindex="-1"></a></span>
<span id="cb510-8"><a href="nfl.html#cb510-8" tabindex="-1"></a><span class="co"># Visualize top 10 features by %IncMSE</span></span>
<span id="cb510-9"><a href="nfl.html#cb510-9" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">2</span>))  <span class="co"># Increase margins for labels</span></span>
<span id="cb510-10"><a href="nfl.html#cb510-10" tabindex="-1"></a><span class="fu">barplot</span>(top10_mse[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_mse),</span>
<span id="cb510-11"><a href="nfl.html#cb510-11" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by %IncMSE (Mean Decrease in Accuracy)&quot;</span>,</span>
<span id="cb510-12"><a href="nfl.html#cb510-12" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-221-1.png" width="672" /></p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="nfl.html#cb511-1" tabindex="-1"></a><span class="co"># Visualize top 10 features by IncNodePurity</span></span>
<span id="cb511-2"><a href="nfl.html#cb511-2" tabindex="-1"></a><span class="fu">barplot</span>(top10_purity[, <span class="st">&quot;IncNodePurity&quot;</span>], <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_purity),</span>
<span id="cb511-3"><a href="nfl.html#cb511-3" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by IncNodePurity (Mean Decrease in Gini)&quot;</span>,</span>
<span id="cb511-4"><a href="nfl.html#cb511-4" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-221-2.png" width="672" /></p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="nfl.html#cb512-1" tabindex="-1"></a><span class="co"># Calculate OOB MAE</span></span>
<span id="cb512-2"><a href="nfl.html#cb512-2" tabindex="-1"></a><span class="co"># Extract OOB predictions</span></span>
<span id="cb512-3"><a href="nfl.html#cb512-3" tabindex="-1"></a>oob_predictions <span class="ot">&lt;-</span> rbrf_model<span class="sc">$</span>predicted</span>
<span id="cb512-4"><a href="nfl.html#cb512-4" tabindex="-1"></a></span>
<span id="cb512-5"><a href="nfl.html#cb512-5" tabindex="-1"></a><span class="co"># Calculate the absolute errors</span></span>
<span id="cb512-6"><a href="nfl.html#cb512-6" tabindex="-1"></a>absolute_errors <span class="ot">&lt;-</span> <span class="fu">abs</span>(oob_predictions <span class="sc">-</span> rbrf_model<span class="sc">$</span>y)</span>
<span id="cb512-7"><a href="nfl.html#cb512-7" tabindex="-1"></a></span>
<span id="cb512-8"><a href="nfl.html#cb512-8" tabindex="-1"></a><span class="co"># Calculate the Mean Absolute Error (MAE)</span></span>
<span id="cb512-9"><a href="nfl.html#cb512-9" tabindex="-1"></a>oob_mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(absolute_errors)</span>
<span id="cb512-10"><a href="nfl.html#cb512-10" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;OOB MAE:&quot;</span>, oob_mae))</span></code></pre></div>
<pre><code>## [1] &quot;OOB MAE: 42.7118053512281&quot;</code></pre>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="nfl.html#cb514-1" tabindex="-1"></a><span class="co"># Predict 2024 fantasy points for 2023 RBs</span></span>
<span id="cb514-2"><a href="nfl.html#cb514-2" tabindex="-1"></a>predicted_2024_fantasy_points <span class="ot">&lt;-</span> <span class="fu">predict</span>(rbrf_model, <span class="at">newdata =</span> rb_2023)</span>
<span id="cb514-3"><a href="nfl.html#cb514-3" tabindex="-1"></a></span>
<span id="cb514-4"><a href="nfl.html#cb514-4" tabindex="-1"></a><span class="co"># Create a data frame with the names and the predicted 2024 fantasy points</span></span>
<span id="cb514-5"><a href="nfl.html#cb514-5" tabindex="-1"></a>results_rb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> rb_2023<span class="sc">$</span>name, <span class="at">predicted_2024_fantasy_points =</span> predicted_2024_fantasy_points)</span>
<span id="cb514-6"><a href="nfl.html#cb514-6" tabindex="-1"></a><span class="fu">print</span>(results_rb)</span></code></pre></div>
<pre><code>##                      name predicted_2024_fantasy_points
## 1             Aaron Jones                     121.52164
## 2              Alex Armah                      22.45872
## 3      Alexander Mattison                      88.98290
## 4            Alvin Kamara                     168.75066
## 5          Ameer Abdullah                      45.42838
## 6       Anthony McFarland                            NA
## 7          Antonio Gibson                      68.47607
## 8           Austin Ekeler                     157.71401
## 9          Bijan Robinson                     136.19888
## 10           Boston Scott                      19.84746
## 11         Brandon Bolden                      47.05817
## 12            Breece Hall                     158.69111
## 13         Brian Robinson                            NA
## 14              Cam Akers                      41.44165
## 15            Chase Brown                      78.15063
## 16          Chase Edmonds                      50.74780
## 17            Chris Evans                      45.44282
## 18        Chris Rodriguez                      64.28221
## 19    Christian McCaffrey                     224.10372
## 20          Chuba Hubbard                     117.01363
## 21  Clyde Edwards-Helaire                      46.58028
## 22  Cordarrelle Patterson                      36.71840
## 23         Craig Reynolds                      34.94989
## 24          D&#39;Andre Swift                     115.76660
## 25       D&#39;Ernest Johnson                      33.43723
## 26         D&#39;Onta Foreman                      56.90359
## 27          Dameon Pierce                      86.84517
## 28          Damien Harris                      22.04393
## 29        Damien Williams                      24.27407
## 30        Dare Ogunbowale                      42.36622
## 31      Darrell Henderson                      54.99883
## 32        Darrynton Evans                      43.62251
## 33       David Montgomery                     127.46178
## 34          DeeJay Dallas                      30.55839
## 35           Deon Jackson                      40.77308
## 36           Derrick Gore                      46.33060
## 37          Derrick Henry                     118.73975
## 38           Deuce Vaughn                      27.81279
## 39       Devin Singletary                     116.18461
## 40          Devine Ozigbo                      11.53234
## 41          Elijah Dotson                      26.37480
## 42        Elijah Mitchell                      49.92732
## 43         Emanuel Wilson                      21.89009
## 44        Emari Demercado                      68.05451
## 45              Eric Gray                      29.33684
## 46              Evan Hull                      40.49006
## 47        Ezekiel Elliott                      87.33393
## 48        Gary Brightwell                      20.36802
## 49            Gus Edwards                     102.36925
## 50          Hunter Luepke                      21.60830
## 51         Isaiah Spiller                      31.22534
## 52          Isiah Pacheco                     153.48213
## 53      Israel Abanikanda                      25.03228
## 54           J.K. Dobbins                      46.00932
## 55           Jahmyr Gibbs                     161.34515
## 56      Jaleel McLaughlin                     117.62059
## 57        Jamaal Williams                      47.76322
## 58           James Conner                     139.50478
## 59             James Cook                     125.89687
## 60         Jashaun Corbin                      36.41184
## 61       Javonte Williams                      88.43398
## 62          Jaylen Warren                     117.88615
## 63        Jerick McKinnon                      63.48359
## 64            Jerome Ford                     114.92145
## 65              Joe Mixon                     154.71751
## 66        Jonathan Taylor                     138.01398
## 67          Jonathan Ward                      23.20985
## 68      Jonathan Williams                      47.69419
## 69           Jordan Mason                      50.65410
## 70            Jordan Mims                      47.67516
## 71            Josh Jacobs                     155.74471
## 72          Joshua Kelley                      63.98855
## 73           Justice Hill                      69.29128
## 74            Kareem Hunt                      61.24182
## 75        Keaton Mitchell                      74.06378
## 76          Kendre Miller                      56.04212
## 77           Kene Nwangwu                      16.90155
## 78       Kenneth Gainwell                      63.62875
## 79         Kenneth Walker                            NA
## 80           Kenyan Drake                      45.96875
## 81           Kevin Harris                      31.43699
## 82         Khalil Herbert                      85.49128
## 83         Kyren Williams                     176.52749
## 84        La&#39;Mical Perine                      37.17253
## 85        Latavius Murray                      58.14279
## 86      Leonard Fournette                      39.26199
## 87            Matt Breida                      40.50366
## 88          Melvin Gordon                      28.27088
## 89         Michael Carter                      40.43726
## 90          Miles Sanders                      61.48906
## 91           Najee Harris                     104.31847
## 92             Nick Chubb                      67.48493
## 93         Patrick Taylor                      41.53899
## 94          Pierre Strong                      71.70650
## 95          Rachaad White                     146.56125
## 96      Raheem Blackshear                      16.50377
## 97         Raheem Mostert                     136.00833
## 98          Rashaad Penny                      27.96484
## 99    Rhamondre Stevenson                     130.06218
## 100           Rico Dowdle                      76.35671
## 101         Ronnie Rivers                      47.70888
## 102       Roschon Johnson                     102.62134
## 103         Royce Freeman                      47.10223
## 104          Salvon Ahmed                      23.81889
## 105         Samaje Perine                      76.38192
## 106        Saquon Barkley                     141.81715
## 107           Sean Tucker                      20.89360
## 108           Tank Bigsby                      74.00957
## 109            Tony Jones                      35.20343
## 110          Tony Pollard                     145.95358
## 111        Travis Etienne                     158.14376
## 112          Travis Homer                      50.87992
## 113     Trayveon Williams                      44.68174
## 114           Trey Sermon                      37.98310
## 115           Ty Chandler                      97.94345
## 116            Ty Johnson                      28.79768
## 117          Tyjae Spears                     119.92003
## 118        Tyler Allgeier                     122.23780
## 119         Tyler Goodson                      29.02777
## 120    Tyrion Davis-Price                      50.26586
## 121       Zach Charbonnet                     113.55740
## 122            Zach Evans                      43.02850
## 123             Zack Moss                     101.57533
## 124           Zamir White                      90.98568</code></pre>
</div>
<div id="qbs" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> QBs<a href="nfl.html#qbs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="nfl.html#cb516-1" tabindex="-1"></a><span class="co"># Access the QB data</span></span>
<span id="cb516-2"><a href="nfl.html#cb516-2" tabindex="-1"></a>qb_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>QB</span></code></pre></div>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="nfl.html#cb517-1" tabindex="-1"></a><span class="co"># Identify zero-variance columns</span></span>
<span id="cb517-2"><a href="nfl.html#cb517-2" tabindex="-1"></a>zero_var_cols <span class="ot">&lt;-</span> <span class="fu">nearZeroVar</span>(qb_data)</span>
<span id="cb517-3"><a href="nfl.html#cb517-3" tabindex="-1"></a></span>
<span id="cb517-4"><a href="nfl.html#cb517-4" tabindex="-1"></a><span class="co"># Check and remove zero-variance columns</span></span>
<span id="cb517-5"><a href="nfl.html#cb517-5" tabindex="-1"></a>zero_var_colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(qb_data)[zero_var_cols]</span>
<span id="cb517-6"><a href="nfl.html#cb517-6" tabindex="-1"></a>qb_data <span class="ot">&lt;-</span> qb_data[, <span class="sc">!</span><span class="fu">names</span>(qb_data) <span class="sc">%in%</span> zero_var_colnames]</span>
<span id="cb517-7"><a href="nfl.html#cb517-7" tabindex="-1"></a></span>
<span id="cb517-8"><a href="nfl.html#cb517-8" tabindex="-1"></a></span>
<span id="cb517-9"><a href="nfl.html#cb517-9" tabindex="-1"></a><span class="co"># Filter the data for the 2023 season</span></span>
<span id="cb517-10"><a href="nfl.html#cb517-10" tabindex="-1"></a>qb_2023 <span class="ot">&lt;-</span> <span class="fu">subset</span>(qb_data, season <span class="sc">==</span> <span class="dv">2023</span>)</span>
<span id="cb517-11"><a href="nfl.html#cb517-11" tabindex="-1"></a><span class="co"># Create new columns for the next season&#39;s fantasy points</span></span>
<span id="cb517-12"><a href="nfl.html#cb517-12" tabindex="-1"></a>qb_data<span class="sc">$</span>next_fantasy_points <span class="ot">&lt;-</span> <span class="fu">ave</span>(qb_data<span class="sc">$</span>fantasy_points, qb_data<span class="sc">$</span>name, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">NA</span>))</span>
<span id="cb517-13"><a href="nfl.html#cb517-13" tabindex="-1"></a></span>
<span id="cb517-14"><a href="nfl.html#cb517-14" tabindex="-1"></a><span class="co"># Remove rows where rookie_season is 0</span></span>
<span id="cb517-15"><a href="nfl.html#cb517-15" tabindex="-1"></a>qb_data <span class="ot">&lt;-</span> qb_data[qb_data<span class="sc">$</span>rookie_season <span class="sc">!=</span> <span class="dv">0</span>, ]</span>
<span id="cb517-16"><a href="nfl.html#cb517-16" tabindex="-1"></a></span>
<span id="cb517-17"><a href="nfl.html#cb517-17" tabindex="-1"></a><span class="co"># Remove rows with NAs</span></span>
<span id="cb517-18"><a href="nfl.html#cb517-18" tabindex="-1"></a>qb_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(qb_data)</span></code></pre></div>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="nfl.html#cb518-1" tabindex="-1"></a><span class="co"># Build Random Forest model</span></span>
<span id="cb518-2"><a href="nfl.html#cb518-2" tabindex="-1"></a>qbrf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(next_fantasy_points <span class="sc">~</span> ., <span class="at">data =</span> qb_data, <span class="at">ntree =</span> <span class="dv">500</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="nfl.html#cb519-1" tabindex="-1"></a><span class="co"># Evaluate feature importance</span></span>
<span id="cb519-2"><a href="nfl.html#cb519-2" tabindex="-1"></a>importance_values <span class="ot">&lt;-</span> <span class="fu">importance</span>(qbrf_model)</span>
<span id="cb519-3"><a href="nfl.html#cb519-3" tabindex="-1"></a></span>
<span id="cb519-4"><a href="nfl.html#cb519-4" tabindex="-1"></a><span class="co"># Sort and extract the top 10 features by %IncMSE and IncNodePurity</span></span>
<span id="cb519-5"><a href="nfl.html#cb519-5" tabindex="-1"></a>top10_mse <span class="ot">&lt;-</span> importance_values[<span class="fu">order</span>(importance_values[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb519-6"><a href="nfl.html#cb519-6" tabindex="-1"></a>top10_purity <span class="ot">&lt;-</span> importance_values[<span class="fu">order</span>(importance_values[, <span class="st">&quot;IncNodePurity&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb519-7"><a href="nfl.html#cb519-7" tabindex="-1"></a></span>
<span id="cb519-8"><a href="nfl.html#cb519-8" tabindex="-1"></a><span class="co"># Visualize top 10 features by %IncMSE</span></span>
<span id="cb519-9"><a href="nfl.html#cb519-9" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">2</span>))  <span class="co"># Increase margins for labels</span></span>
<span id="cb519-10"><a href="nfl.html#cb519-10" tabindex="-1"></a><span class="fu">barplot</span>(top10_mse[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_mse),</span>
<span id="cb519-11"><a href="nfl.html#cb519-11" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by %IncMSE (Mean Decrease in Accuracy)&quot;</span>,</span>
<span id="cb519-12"><a href="nfl.html#cb519-12" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-227-1.png" width="672" /></p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="nfl.html#cb520-1" tabindex="-1"></a><span class="co"># Visualize top 10 features by IncNodePurity</span></span>
<span id="cb520-2"><a href="nfl.html#cb520-2" tabindex="-1"></a><span class="fu">barplot</span>(top10_purity[, <span class="st">&quot;IncNodePurity&quot;</span>], <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_purity),</span>
<span id="cb520-3"><a href="nfl.html#cb520-3" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by IncNodePurity (Mean Decrease in Gini)&quot;</span>,</span>
<span id="cb520-4"><a href="nfl.html#cb520-4" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-227-2.png" width="672" /></p>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="nfl.html#cb521-1" tabindex="-1"></a><span class="co"># Calculate OOB rmse</span></span>
<span id="cb521-2"><a href="nfl.html#cb521-2" tabindex="-1"></a>oob_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(qbrf_model<span class="sc">$</span>mse[qbrf_model<span class="sc">$</span>ntree])</span>
<span id="cb521-3"><a href="nfl.html#cb521-3" tabindex="-1"></a><span class="co"># Extract OOB predictions</span></span>
<span id="cb521-4"><a href="nfl.html#cb521-4" tabindex="-1"></a>oob_predictions <span class="ot">&lt;-</span> qbrf_model<span class="sc">$</span>predicted</span>
<span id="cb521-5"><a href="nfl.html#cb521-5" tabindex="-1"></a></span>
<span id="cb521-6"><a href="nfl.html#cb521-6" tabindex="-1"></a><span class="co"># Calculate the absolute errors</span></span>
<span id="cb521-7"><a href="nfl.html#cb521-7" tabindex="-1"></a>absolute_errors <span class="ot">&lt;-</span> <span class="fu">abs</span>(oob_predictions <span class="sc">-</span> qbrf_model<span class="sc">$</span>y)</span>
<span id="cb521-8"><a href="nfl.html#cb521-8" tabindex="-1"></a></span>
<span id="cb521-9"><a href="nfl.html#cb521-9" tabindex="-1"></a><span class="co"># Calculate the Mean Absolute Error (MAE)</span></span>
<span id="cb521-10"><a href="nfl.html#cb521-10" tabindex="-1"></a>oob_mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(absolute_errors)</span>
<span id="cb521-11"><a href="nfl.html#cb521-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;OOB MAE:&quot;</span>, oob_mae))</span></code></pre></div>
<pre><code>## [1] &quot;OOB MAE: 62.1728672351168&quot;</code></pre>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="nfl.html#cb523-1" tabindex="-1"></a>oob_rmse</span></code></pre></div>
<pre><code>## [1] 82.75093</code></pre>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="nfl.html#cb525-1" tabindex="-1"></a><span class="co"># Predict 2024 fantasy points for 2023 QBs</span></span>
<span id="cb525-2"><a href="nfl.html#cb525-2" tabindex="-1"></a>predicted_2024_fantasy_points <span class="ot">&lt;-</span> <span class="fu">predict</span>(qbrf_model, <span class="at">newdata =</span> qb_2023)</span>
<span id="cb525-3"><a href="nfl.html#cb525-3" tabindex="-1"></a></span>
<span id="cb525-4"><a href="nfl.html#cb525-4" tabindex="-1"></a><span class="co"># Create a data frame with the names and the predicted 2024 fantasy points</span></span>
<span id="cb525-5"><a href="nfl.html#cb525-5" tabindex="-1"></a>results_qb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> qb_2023<span class="sc">$</span>name, <span class="at">predicted_2024_fantasy_points =</span> predicted_2024_fantasy_points)</span>
<span id="cb525-6"><a href="nfl.html#cb525-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(results_qb))</span></code></pre></div>
<pre><code>##                 name predicted_2024_fantasy_points
## 1      Aaron Rodgers                      76.52449
## 2    Aidan O&#39;Connell                     124.34640
## 3        AJ McCarron                            NA
## 4        Andy Dalton                      95.89981
## 5 Anthony Richardson                     153.95453
## 6       Bailey Zappe                     130.72803</code></pre>
</div>
<div id="plots-and-analysis" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> Plots and Analysis<a href="nfl.html#plots-and-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="nfl.html#cb527-1" tabindex="-1"></a><span class="co"># For QB model (qbrf_model)</span></span>
<span id="cb527-2"><a href="nfl.html#cb527-2" tabindex="-1"></a>pdp_qb_games <span class="ot">&lt;-</span> <span class="fu">partial</span>(qbrf_model, <span class="at">pred.var =</span> <span class="st">&quot;games&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb527-3"><a href="nfl.html#cb527-3" tabindex="-1"></a>                        <span class="at">main =</span> <span class="st">&quot;PDP for Games (QB Random Forest Model)&quot;</span>,</span>
<span id="cb527-4"><a href="nfl.html#cb527-4" tabindex="-1"></a>                        <span class="at">xlab =</span> <span class="st">&quot;Games&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Partial Dependence&quot;</span>)</span>
<span id="cb527-5"><a href="nfl.html#cb527-5" tabindex="-1"></a></span>
<span id="cb527-6"><a href="nfl.html#cb527-6" tabindex="-1"></a></span>
<span id="cb527-7"><a href="nfl.html#cb527-7" tabindex="-1"></a></span>
<span id="cb527-8"><a href="nfl.html#cb527-8" tabindex="-1"></a><span class="co"># For WR model (wrrf_model)</span></span>
<span id="cb527-9"><a href="nfl.html#cb527-9" tabindex="-1"></a>pdp_wr_games <span class="ot">&lt;-</span> <span class="fu">partial</span>(wrrf_model, <span class="at">pred.var =</span> <span class="st">&quot;games&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb527-10"><a href="nfl.html#cb527-10" tabindex="-1"></a>                        <span class="at">main =</span> <span class="st">&quot;PDP for Games (WR Random Forest Model)&quot;</span>,</span>
<span id="cb527-11"><a href="nfl.html#cb527-11" tabindex="-1"></a>                        <span class="at">xlab =</span> <span class="st">&quot;Games&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Partial Dependence&quot;</span>)</span>
<span id="cb527-12"><a href="nfl.html#cb527-12" tabindex="-1"></a></span>
<span id="cb527-13"><a href="nfl.html#cb527-13" tabindex="-1"></a><span class="co"># For RB model (rbrf_model)</span></span>
<span id="cb527-14"><a href="nfl.html#cb527-14" tabindex="-1"></a>pdp_rb_games <span class="ot">&lt;-</span> <span class="fu">partial</span>(rbrf_model, <span class="at">pred.var =</span> <span class="st">&quot;games&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb527-15"><a href="nfl.html#cb527-15" tabindex="-1"></a>                        <span class="at">main =</span> <span class="st">&quot;PDP for Games (RB Random Forest Model)&quot;</span>,</span>
<span id="cb527-16"><a href="nfl.html#cb527-16" tabindex="-1"></a>                        <span class="at">xlab =</span> <span class="st">&quot;Games&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Partial Dependence&quot;</span>)</span>
<span id="cb527-17"><a href="nfl.html#cb527-17" tabindex="-1"></a></span>
<span id="cb527-18"><a href="nfl.html#cb527-18" tabindex="-1"></a>pdp_qb_games</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-230-1.png" width="672" /></p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="nfl.html#cb528-1" tabindex="-1"></a>pdp_wr_games</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-230-2.png" width="672" /></p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="nfl.html#cb529-1" tabindex="-1"></a>pdp_rb_games</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-230-3.png" width="672" /></p>
<p>Games played is being tracked by other statistics… i dont give a crap about games played i only care about your stats at the end of the season…</p>
</div>
<div id="lists-to-do" class="section level2 hasAnchor" number="16.5">
<h2><span class="header-section-number">16.5</span> Lists to do<a href="nfl.html#lists-to-do" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>need to look at if multiple years back is good idea(i dont think so because then can no use 2nd yr players), and to be able to add teamates. also look if we are good for the seasons that there are 17 games. break the seasons down into quarters.</p>
</div>
<div id="team-mates" class="section level2 hasAnchor" number="16.6">
<h2><span class="header-section-number">16.6</span> team mates<a href="nfl.html#team-mates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="nfl.html#cb530-1" tabindex="-1"></a><span class="fu">library</span>(nflfastR)</span></code></pre></div>
<pre><code>## Warning: package &#39;nflfastR&#39; was built under R version 4.3.3</code></pre>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="nfl.html#cb532-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="nfl.html#cb533-1" tabindex="-1"></a><span class="co"># Fetch rosters for 2024</span></span>
<span id="cb533-2"><a href="nfl.html#cb533-2" tabindex="-1"></a>rosters <span class="ot">&lt;-</span> <span class="fu">fast_scraper_roster</span>(<span class="at">season =</span> <span class="dv">2024</span>)</span>
<span id="cb533-3"><a href="nfl.html#cb533-3" tabindex="-1"></a></span>
<span id="cb533-4"><a href="nfl.html#cb533-4" tabindex="-1"></a><span class="co"># Filter WR and RB positions</span></span>
<span id="cb533-5"><a href="nfl.html#cb533-5" tabindex="-1"></a>wr_rosters <span class="ot">&lt;-</span> rosters <span class="sc">%&gt;%</span> <span class="fu">filter</span>(position <span class="sc">==</span> <span class="st">&quot;WR&quot;</span>)</span>
<span id="cb533-6"><a href="nfl.html#cb533-6" tabindex="-1"></a>rb_rosters <span class="ot">&lt;-</span> rosters <span class="sc">%&gt;%</span> <span class="fu">filter</span>(position <span class="sc">==</span> <span class="st">&quot;RB&quot;</span>)</span>
<span id="cb533-7"><a href="nfl.html#cb533-7" tabindex="-1"></a></span>
<span id="cb533-8"><a href="nfl.html#cb533-8" tabindex="-1"></a><span class="co"># Rename columns to match merging requirements</span></span>
<span id="cb533-9"><a href="nfl.html#cb533-9" tabindex="-1"></a><span class="fu">colnames</span>(wr_2023)[<span class="fu">colnames</span>(wr_2023) <span class="sc">==</span> <span class="st">&quot;team.x&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team&quot;</span></span>
<span id="cb533-10"><a href="nfl.html#cb533-10" tabindex="-1"></a><span class="fu">colnames</span>(rb_2023)[<span class="fu">colnames</span>(rb_2023) <span class="sc">==</span> <span class="st">&quot;team.x&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team&quot;</span></span>
<span id="cb533-11"><a href="nfl.html#cb533-11" tabindex="-1"></a></span>
<span id="cb533-12"><a href="nfl.html#cb533-12" tabindex="-1"></a><span class="co"># Merge WR data with rosters</span></span>
<span id="cb533-13"><a href="nfl.html#cb533-13" tabindex="-1"></a>wr_teams <span class="ot">&lt;-</span> <span class="fu">merge</span>(wr_2023, wr_rosters, <span class="at">by.x =</span> <span class="st">&quot;name&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;full_name&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb533-14"><a href="nfl.html#cb533-14" tabindex="-1"></a><span class="fu">colnames</span>(wr_teams)[<span class="fu">colnames</span>(wr_teams) <span class="sc">==</span> <span class="st">&quot;team.x&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team&quot;</span> <span class="co"># Use team.x for original team</span></span>
<span id="cb533-15"><a href="nfl.html#cb533-15" tabindex="-1"></a><span class="fu">colnames</span>(wr_teams)[<span class="fu">colnames</span>(wr_teams) <span class="sc">==</span> <span class="st">&quot;team.y&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;new_team&quot;</span> <span class="co"># Use team.y for updated team</span></span>
<span id="cb533-16"><a href="nfl.html#cb533-16" tabindex="-1"></a>wr_teams <span class="ot">&lt;-</span> wr_teams[, <span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;team&quot;</span>)]</span>
<span id="cb533-17"><a href="nfl.html#cb533-17" tabindex="-1"></a></span>
<span id="cb533-18"><a href="nfl.html#cb533-18" tabindex="-1"></a><span class="co"># Merge RB data with rosters</span></span>
<span id="cb533-19"><a href="nfl.html#cb533-19" tabindex="-1"></a>rb_teams <span class="ot">&lt;-</span> <span class="fu">merge</span>(rb_2023, rb_rosters, <span class="at">by.x =</span> <span class="st">&quot;name&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;full_name&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb533-20"><a href="nfl.html#cb533-20" tabindex="-1"></a><span class="fu">colnames</span>(rb_teams)[<span class="fu">colnames</span>(rb_teams) <span class="sc">==</span> <span class="st">&quot;team.x&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team&quot;</span> <span class="co"># Use team.x for original team</span></span>
<span id="cb533-21"><a href="nfl.html#cb533-21" tabindex="-1"></a><span class="fu">colnames</span>(rb_teams)[<span class="fu">colnames</span>(rb_teams) <span class="sc">==</span> <span class="st">&quot;team.y&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;new_team&quot;</span> <span class="co"># Use team.y for updated team</span></span>
<span id="cb533-22"><a href="nfl.html#cb533-22" tabindex="-1"></a>rb_teams <span class="ot">&lt;-</span> rb_teams[, <span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;team&quot;</span>)]</span></code></pre></div>
<p>create wr_2023-2024 that has the 2023 stats that have the players on there correct teams. we will do the same for the rb data</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="nfl.html#cb534-1" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb534-2"><a href="nfl.html#cb534-2" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb534-3"><a href="nfl.html#cb534-3" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb534-4"><a href="nfl.html#cb534-4" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb534-5"><a href="nfl.html#cb534-5" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb534-6"><a href="nfl.html#cb534-6" tabindex="-1"></a><span class="fu">library</span>(pdp)</span>
<span id="cb534-7"><a href="nfl.html#cb534-7" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb534-8"><a href="nfl.html#cb534-8" tabindex="-1"></a><span class="fu">library</span>(nflfastR)</span>
<span id="cb534-9"><a href="nfl.html#cb534-9" tabindex="-1"></a></span>
<span id="cb534-10"><a href="nfl.html#cb534-10" tabindex="-1"></a><span class="co"># Load the offensive yearly data</span></span>
<span id="cb534-11"><a href="nfl.html#cb534-11" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;offense_yearly_data.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 5453 Columns: 76
## ── Column specification ──────────
## Delimiter: &quot;,&quot;
## chr  (5): name, height_ft, position, team, season_type
## dbl (71): id, height_cm, season, completions, attempts, passing_yards, passi...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="nfl.html#cb536-1" tabindex="-1"></a><span class="co"># Sort the dataset by player name and season</span></span>
<span id="cb536-2"><a href="nfl.html#cb536-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[<span class="fu">order</span>(data<span class="sc">$</span>name, data<span class="sc">$</span>season), ]</span>
<span id="cb536-3"><a href="nfl.html#cb536-3" tabindex="-1"></a></span>
<span id="cb536-4"><a href="nfl.html#cb536-4" tabindex="-1"></a><span class="co"># Adjust columns</span></span>
<span id="cb536-5"><a href="nfl.html#cb536-5" tabindex="-1"></a><span class="fu">names</span>(data)[<span class="fu">names</span>(data) <span class="sc">==</span> <span class="st">&quot;height_cm&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;height_in&quot;</span></span>
<span id="cb536-6"><a href="nfl.html#cb536-6" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[, <span class="sc">!</span><span class="fu">names</span>(data) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;height_ft&quot;</span>)]</span>
<span id="cb536-7"><a href="nfl.html#cb536-7" tabindex="-1"></a></span>
<span id="cb536-8"><a href="nfl.html#cb536-8" tabindex="-1"></a><span class="co"># Split the dataset by position</span></span>
<span id="cb536-9"><a href="nfl.html#cb536-9" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">split</span>(data, data<span class="sc">$</span>position)</span>
<span id="cb536-10"><a href="nfl.html#cb536-10" tabindex="-1"></a></span>
<span id="cb536-11"><a href="nfl.html#cb536-11" tabindex="-1"></a><span class="co"># Access the WR and RB data</span></span>
<span id="cb536-12"><a href="nfl.html#cb536-12" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>WR</span>
<span id="cb536-13"><a href="nfl.html#cb536-13" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>RB</span>
<span id="cb536-14"><a href="nfl.html#cb536-14" tabindex="-1"></a></span>
<span id="cb536-15"><a href="nfl.html#cb536-15" tabindex="-1"></a><span class="co"># Identify zero-variance columns and remove them, excluding &#39;position&#39;</span></span>
<span id="cb536-16"><a href="nfl.html#cb536-16" tabindex="-1"></a><span class="co"># For WR data</span></span>
<span id="cb536-17"><a href="nfl.html#cb536-17" tabindex="-1"></a>zero_var_cols_wr <span class="ot">&lt;-</span> <span class="fu">nearZeroVar</span>(wr_data)</span>
<span id="cb536-18"><a href="nfl.html#cb536-18" tabindex="-1"></a>zero_var_colnames_wr <span class="ot">&lt;-</span> <span class="fu">colnames</span>(wr_data)[zero_var_cols_wr]</span>
<span id="cb536-19"><a href="nfl.html#cb536-19" tabindex="-1"></a>cols_to_remove_wr <span class="ot">&lt;-</span> zero_var_colnames_wr[zero_var_colnames_wr <span class="sc">!=</span> <span class="st">&quot;position&quot;</span>]</span>
<span id="cb536-20"><a href="nfl.html#cb536-20" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> wr_data[, <span class="sc">!</span><span class="fu">names</span>(wr_data) <span class="sc">%in%</span> cols_to_remove_wr]</span>
<span id="cb536-21"><a href="nfl.html#cb536-21" tabindex="-1"></a></span>
<span id="cb536-22"><a href="nfl.html#cb536-22" tabindex="-1"></a><span class="co"># For RB data</span></span>
<span id="cb536-23"><a href="nfl.html#cb536-23" tabindex="-1"></a>zero_var_cols_rb <span class="ot">&lt;-</span> <span class="fu">nearZeroVar</span>(rb_data)</span>
<span id="cb536-24"><a href="nfl.html#cb536-24" tabindex="-1"></a>zero_var_colnames_rb <span class="ot">&lt;-</span> <span class="fu">colnames</span>(rb_data)[zero_var_cols_rb]</span>
<span id="cb536-25"><a href="nfl.html#cb536-25" tabindex="-1"></a>cols_to_remove_rb <span class="ot">&lt;-</span> zero_var_colnames_rb[zero_var_colnames_rb <span class="sc">!=</span> <span class="st">&quot;position&quot;</span>]</span>
<span id="cb536-26"><a href="nfl.html#cb536-26" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> rb_data[, <span class="sc">!</span><span class="fu">names</span>(rb_data) <span class="sc">%in%</span> cols_to_remove_rb]</span>
<span id="cb536-27"><a href="nfl.html#cb536-27" tabindex="-1"></a></span>
<span id="cb536-28"><a href="nfl.html#cb536-28" tabindex="-1"></a><span class="co"># Assuming the previous steps up to filtering the 2023 data are done</span></span>
<span id="cb536-29"><a href="nfl.html#cb536-29" tabindex="-1"></a><span class="co"># Filter the data for the 2023 season</span></span>
<span id="cb536-30"><a href="nfl.html#cb536-30" tabindex="-1"></a>wr_2023 <span class="ot">&lt;-</span> <span class="fu">subset</span>(wr_data, season <span class="sc">==</span> <span class="dv">2023</span>)</span>
<span id="cb536-31"><a href="nfl.html#cb536-31" tabindex="-1"></a>rb_2023 <span class="ot">&lt;-</span> <span class="fu">subset</span>(rb_data, season <span class="sc">==</span> <span class="dv">2023</span>)</span>
<span id="cb536-32"><a href="nfl.html#cb536-32" tabindex="-1"></a></span>
<span id="cb536-33"><a href="nfl.html#cb536-33" tabindex="-1"></a><span class="co"># Fetch current rosters for 2024</span></span>
<span id="cb536-34"><a href="nfl.html#cb536-34" tabindex="-1"></a>rosters <span class="ot">&lt;-</span> <span class="fu">fast_scraper_roster</span>(<span class="at">season =</span> <span class="dv">2024</span>)</span>
<span id="cb536-35"><a href="nfl.html#cb536-35" tabindex="-1"></a>wr_rosters <span class="ot">&lt;-</span> rosters <span class="sc">%&gt;%</span> <span class="fu">filter</span>(position <span class="sc">==</span> <span class="st">&quot;WR&quot;</span>)</span>
<span id="cb536-36"><a href="nfl.html#cb536-36" tabindex="-1"></a>rb_rosters <span class="ot">&lt;-</span> rosters <span class="sc">%&gt;%</span> <span class="fu">filter</span>(position <span class="sc">==</span> <span class="st">&quot;RB&quot;</span>)</span>
<span id="cb536-37"><a href="nfl.html#cb536-37" tabindex="-1"></a></span>
<span id="cb536-38"><a href="nfl.html#cb536-38" tabindex="-1"></a><span class="co"># For WR data</span></span>
<span id="cb536-39"><a href="nfl.html#cb536-39" tabindex="-1"></a>wr_rosters_temp <span class="ot">&lt;-</span> wr_rosters[, <span class="fu">c</span>(<span class="st">&quot;full_name&quot;</span>, <span class="st">&quot;team&quot;</span>)]</span>
<span id="cb536-40"><a href="nfl.html#cb536-40" tabindex="-1"></a><span class="fu">names</span>(wr_rosters_temp)[<span class="fu">names</span>(wr_rosters_temp) <span class="sc">==</span> <span class="st">&quot;team&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team_roster&quot;</span></span>
<span id="cb536-41"><a href="nfl.html#cb536-41" tabindex="-1"></a>wr_2023_2024 <span class="ot">&lt;-</span> <span class="fu">merge</span>(wr_2023, wr_rosters_temp, <span class="at">by.x =</span> <span class="st">&quot;name&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;full_name&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb536-42"><a href="nfl.html#cb536-42" tabindex="-1"></a><span class="co"># Replace NA in team with team_roster if available</span></span>
<span id="cb536-43"><a href="nfl.html#cb536-43" tabindex="-1"></a>wr_2023_2024<span class="sc">$</span>team <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(wr_2023_2024<span class="sc">$</span>team_roster), </span>
<span id="cb536-44"><a href="nfl.html#cb536-44" tabindex="-1"></a>                           wr_2023_2024<span class="sc">$</span>team, </span>
<span id="cb536-45"><a href="nfl.html#cb536-45" tabindex="-1"></a>                           wr_2023_2024<span class="sc">$</span>team_roster)</span>
<span id="cb536-46"><a href="nfl.html#cb536-46" tabindex="-1"></a>wr_2023_2024 <span class="ot">&lt;-</span> wr_2023_2024[, <span class="sc">!</span><span class="fu">names</span>(wr_2023_2024) <span class="sc">%in%</span> <span class="st">&quot;team_roster&quot;</span>]</span>
<span id="cb536-47"><a href="nfl.html#cb536-47" tabindex="-1"></a></span>
<span id="cb536-48"><a href="nfl.html#cb536-48" tabindex="-1"></a><span class="co"># For RB data</span></span>
<span id="cb536-49"><a href="nfl.html#cb536-49" tabindex="-1"></a>rb_rosters_temp <span class="ot">&lt;-</span> rb_rosters[, <span class="fu">c</span>(<span class="st">&quot;full_name&quot;</span>, <span class="st">&quot;team&quot;</span>)]</span>
<span id="cb536-50"><a href="nfl.html#cb536-50" tabindex="-1"></a><span class="fu">names</span>(rb_rosters_temp)[<span class="fu">names</span>(rb_rosters_temp) <span class="sc">==</span> <span class="st">&quot;team&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team_roster&quot;</span></span>
<span id="cb536-51"><a href="nfl.html#cb536-51" tabindex="-1"></a>rb_2023_2024 <span class="ot">&lt;-</span> <span class="fu">merge</span>(rb_2023, rb_rosters_temp, <span class="at">by.x =</span> <span class="st">&quot;name&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;full_name&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb536-52"><a href="nfl.html#cb536-52" tabindex="-1"></a><span class="co"># Replace NA in team with team_roster if available</span></span>
<span id="cb536-53"><a href="nfl.html#cb536-53" tabindex="-1"></a>rb_2023_2024<span class="sc">$</span>team <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(rb_2023_2024<span class="sc">$</span>team_roster), </span>
<span id="cb536-54"><a href="nfl.html#cb536-54" tabindex="-1"></a>                           rb_2023_2024<span class="sc">$</span>team, </span>
<span id="cb536-55"><a href="nfl.html#cb536-55" tabindex="-1"></a>                           rb_2023_2024<span class="sc">$</span>team_roster)</span>
<span id="cb536-56"><a href="nfl.html#cb536-56" tabindex="-1"></a>rb_2023_2024 <span class="ot">&lt;-</span> rb_2023_2024[, <span class="sc">!</span><span class="fu">names</span>(rb_2023_2024) <span class="sc">%in%</span> <span class="st">&quot;team_roster&quot;</span>]</span>
<span id="cb536-57"><a href="nfl.html#cb536-57" tabindex="-1"></a></span>
<span id="cb536-58"><a href="nfl.html#cb536-58" tabindex="-1"></a><span class="co"># Now, wr_2023_2024 and rb_2023_2024 should have the correct teams for the players in 2023, with fallback to original team if NA.</span></span></code></pre></div>
<p>now in wr_data and rb we need to look to include teamate stats. (we will group them for the 2023/2024 one later) we will create collums that have a the teamates states. to determine a teamate use the team and the season… now we obviously cant use every teamate. so for now we wil use the best qb on that team the 2 best wrs(that isnt themselves) and the best rb… now we have to determine what best is. best for qb will be pass yards. best for rbs will be rush yards. and best for wrs will be receving yards we may need to restructure it from the begining a bit because some colloms where dropped but u figure that out</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="nfl.html#cb537-1" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb537-2"><a href="nfl.html#cb537-2" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb537-3"><a href="nfl.html#cb537-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb537-4"><a href="nfl.html#cb537-4" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb537-5"><a href="nfl.html#cb537-5" tabindex="-1"></a></span>
<span id="cb537-6"><a href="nfl.html#cb537-6" tabindex="-1"></a><span class="co"># Load the offensive yearly data</span></span>
<span id="cb537-7"><a href="nfl.html#cb537-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;offense_yearly_data.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 5453 Columns: 76
## ── Column specification ──────────
## Delimiter: &quot;,&quot;
## chr  (5): name, height_ft, position, team, season_type
## dbl (71): id, height_cm, season, completions, attempts, passing_yards, passi...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="nfl.html#cb539-1" tabindex="-1"></a><span class="co"># Sort the dataset by player name and season</span></span>
<span id="cb539-2"><a href="nfl.html#cb539-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[<span class="fu">order</span>(data<span class="sc">$</span>name, data<span class="sc">$</span>season), ]</span>
<span id="cb539-3"><a href="nfl.html#cb539-3" tabindex="-1"></a></span>
<span id="cb539-4"><a href="nfl.html#cb539-4" tabindex="-1"></a><span class="co"># Adjust columns</span></span>
<span id="cb539-5"><a href="nfl.html#cb539-5" tabindex="-1"></a><span class="fu">names</span>(data)[<span class="fu">names</span>(data) <span class="sc">==</span> <span class="st">&quot;height_cm&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;height_in&quot;</span>  <span class="co"># Rename column</span></span>
<span id="cb539-6"><a href="nfl.html#cb539-6" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[, <span class="sc">!</span><span class="fu">names</span>(data) <span class="sc">%in%</span> <span class="st">&quot;height_ft&quot;</span>]          <span class="co"># Remove height_ft column</span></span>
<span id="cb539-7"><a href="nfl.html#cb539-7" tabindex="-1"></a></span>
<span id="cb539-8"><a href="nfl.html#cb539-8" tabindex="-1"></a><span class="co"># Split the dataset by position</span></span>
<span id="cb539-9"><a href="nfl.html#cb539-9" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">split</span>(data, data<span class="sc">$</span>position)</span>
<span id="cb539-10"><a href="nfl.html#cb539-10" tabindex="-1"></a></span>
<span id="cb539-11"><a href="nfl.html#cb539-11" tabindex="-1"></a><span class="co"># Access the WR, RB, and QB data</span></span>
<span id="cb539-12"><a href="nfl.html#cb539-12" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>WR</span>
<span id="cb539-13"><a href="nfl.html#cb539-13" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>RB</span>
<span id="cb539-14"><a href="nfl.html#cb539-14" tabindex="-1"></a>qb_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>QB</span>
<span id="cb539-15"><a href="nfl.html#cb539-15" tabindex="-1"></a></span>
<span id="cb539-16"><a href="nfl.html#cb539-16" tabindex="-1"></a></span>
<span id="cb539-17"><a href="nfl.html#cb539-17" tabindex="-1"></a></span>
<span id="cb539-18"><a href="nfl.html#cb539-18" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb539-19"><a href="nfl.html#cb539-19" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb539-20"><a href="nfl.html#cb539-20" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb539-21"><a href="nfl.html#cb539-21" tabindex="-1"></a></span>
<span id="cb539-22"><a href="nfl.html#cb539-22" tabindex="-1"></a><span class="co"># Load the offensive yearly data</span></span>
<span id="cb539-23"><a href="nfl.html#cb539-23" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;offense_yearly_data.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 5453 Columns: 76
## ── Column specification ──────────
## Delimiter: &quot;,&quot;
## chr  (5): name, height_ft, position, team, season_type
## dbl (71): id, height_cm, season, completions, attempts, passing_yards, passi...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="nfl.html#cb541-1" tabindex="-1"></a><span class="co"># Group by season and team to get a column with the names of all team members</span></span>
<span id="cb541-2"><a href="nfl.html#cb541-2" tabindex="-1"></a>get_team_members <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb541-3"><a href="nfl.html#cb541-3" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb541-4"><a href="nfl.html#cb541-4" tabindex="-1"></a>    <span class="fu">group_by</span>(season, team) <span class="sc">%&gt;%</span></span>
<span id="cb541-5"><a href="nfl.html#cb541-5" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">team_members =</span> <span class="fu">paste</span>(name, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb541-6"><a href="nfl.html#cb541-6" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb541-7"><a href="nfl.html#cb541-7" tabindex="-1"></a>}</span>
<span id="cb541-8"><a href="nfl.html#cb541-8" tabindex="-1"></a></span>
<span id="cb541-9"><a href="nfl.html#cb541-9" tabindex="-1"></a><span class="co"># Apply the function to WR, RB, and QB data</span></span>
<span id="cb541-10"><a href="nfl.html#cb541-10" tabindex="-1"></a>wr_team_members <span class="ot">&lt;-</span> <span class="fu">get_team_members</span>(data_split<span class="sc">$</span>WR)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output
## by &#39;season&#39;. You can override
## using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="nfl.html#cb543-1" tabindex="-1"></a>rb_team_members <span class="ot">&lt;-</span> <span class="fu">get_team_members</span>(data_split<span class="sc">$</span>RB)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output
## by &#39;season&#39;. You can override
## using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="nfl.html#cb545-1" tabindex="-1"></a>qb_team_members <span class="ot">&lt;-</span> <span class="fu">get_team_members</span>(data_split<span class="sc">$</span>QB)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output
## by &#39;season&#39;. You can override
## using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="nfl.html#cb547-1" tabindex="-1"></a><span class="co"># Function to get team members</span></span>
<span id="cb547-2"><a href="nfl.html#cb547-2" tabindex="-1"></a>get_team_members <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb547-3"><a href="nfl.html#cb547-3" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb547-4"><a href="nfl.html#cb547-4" tabindex="-1"></a>    <span class="fu">group_by</span>(season, team) <span class="sc">%&gt;%</span></span>
<span id="cb547-5"><a href="nfl.html#cb547-5" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">team_members =</span> <span class="fu">paste</span>(name, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb547-6"><a href="nfl.html#cb547-6" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb547-7"><a href="nfl.html#cb547-7" tabindex="-1"></a>}</span>
<span id="cb547-8"><a href="nfl.html#cb547-8" tabindex="-1"></a></span>
<span id="cb547-9"><a href="nfl.html#cb547-9" tabindex="-1"></a><span class="co"># Apply the function to existing data</span></span>
<span id="cb547-10"><a href="nfl.html#cb547-10" tabindex="-1"></a>wr_team_members <span class="ot">&lt;-</span> <span class="fu">get_team_members</span>(data_split<span class="sc">$</span>WR)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output
## by &#39;season&#39;. You can override
## using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="nfl.html#cb549-1" tabindex="-1"></a>rb_team_members <span class="ot">&lt;-</span> <span class="fu">get_team_members</span>(data_split<span class="sc">$</span>RB)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output
## by &#39;season&#39;. You can override
## using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="nfl.html#cb551-1" tabindex="-1"></a>qb_team_members <span class="ot">&lt;-</span> <span class="fu">get_team_members</span>(data_split<span class="sc">$</span>QB)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output
## by &#39;season&#39;. You can override
## using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="nfl.html#cb553-1" tabindex="-1"></a><span class="co"># Function to get top WRs by team</span></span>
<span id="cb553-2"><a href="nfl.html#cb553-2" tabindex="-1"></a>get_top_wr_team_members <span class="ot">&lt;-</span> <span class="cf">function</span>(ranked_wr_data) {</span>
<span id="cb553-3"><a href="nfl.html#cb553-3" tabindex="-1"></a>  <span class="co"># Sort data</span></span>
<span id="cb553-4"><a href="nfl.html#cb553-4" tabindex="-1"></a>  ranked_wr_data <span class="ot">&lt;-</span> ranked_wr_data[<span class="fu">order</span>(ranked_wr_data<span class="sc">$</span>season, </span>
<span id="cb553-5"><a href="nfl.html#cb553-5" tabindex="-1"></a>                                         ranked_wr_data<span class="sc">$</span>team, </span>
<span id="cb553-6"><a href="nfl.html#cb553-6" tabindex="-1"></a>                                         ranked_wr_data<span class="sc">$</span>rank), ]</span>
<span id="cb553-7"><a href="nfl.html#cb553-7" tabindex="-1"></a>  </span>
<span id="cb553-8"><a href="nfl.html#cb553-8" tabindex="-1"></a>  <span class="co"># Function to get nth value safely</span></span>
<span id="cb553-9"><a href="nfl.html#cb553-9" tabindex="-1"></a>  get_nth <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n) {</span>
<span id="cb553-10"><a href="nfl.html#cb553-10" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(x) <span class="sc">&gt;=</span> n) <span class="fu">return</span>(x[n])</span>
<span id="cb553-11"><a href="nfl.html#cb553-11" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb553-12"><a href="nfl.html#cb553-12" tabindex="-1"></a>  }</span>
<span id="cb553-13"><a href="nfl.html#cb553-13" tabindex="-1"></a>  </span>
<span id="cb553-14"><a href="nfl.html#cb553-14" tabindex="-1"></a>  <span class="co"># Split data by season and team</span></span>
<span id="cb553-15"><a href="nfl.html#cb553-15" tabindex="-1"></a>  split_data <span class="ot">&lt;-</span> <span class="fu">split</span>(ranked_wr_data, </span>
<span id="cb553-16"><a href="nfl.html#cb553-16" tabindex="-1"></a>                      <span class="fu">list</span>(ranked_wr_data<span class="sc">$</span>season, ranked_wr_data<span class="sc">$</span>team))</span>
<span id="cb553-17"><a href="nfl.html#cb553-17" tabindex="-1"></a>  </span>
<span id="cb553-18"><a href="nfl.html#cb553-18" tabindex="-1"></a>  <span class="co"># Create result data frame</span></span>
<span id="cb553-19"><a href="nfl.html#cb553-19" tabindex="-1"></a>  result_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_data, <span class="cf">function</span>(group) {</span>
<span id="cb553-20"><a href="nfl.html#cb553-20" tabindex="-1"></a>    <span class="co"># If the group is empty, return NULL</span></span>
<span id="cb553-21"><a href="nfl.html#cb553-21" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(group) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb553-22"><a href="nfl.html#cb553-22" tabindex="-1"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>) </span>
<span id="cb553-23"><a href="nfl.html#cb553-23" tabindex="-1"></a>    }</span>
<span id="cb553-24"><a href="nfl.html#cb553-24" tabindex="-1"></a>    </span>
<span id="cb553-25"><a href="nfl.html#cb553-25" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb553-26"><a href="nfl.html#cb553-26" tabindex="-1"></a>      <span class="at">season =</span> <span class="fu">unique</span>(group<span class="sc">$</span>season),</span>
<span id="cb553-27"><a href="nfl.html#cb553-27" tabindex="-1"></a>      <span class="at">team =</span> <span class="fu">unique</span>(group<span class="sc">$</span>team),</span>
<span id="cb553-28"><a href="nfl.html#cb553-28" tabindex="-1"></a>      <span class="at">WR1_name =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>name, <span class="dv">1</span>),</span>
<span id="cb553-29"><a href="nfl.html#cb553-29" tabindex="-1"></a>      <span class="at">WR1_yards =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>receiving_yards, <span class="dv">1</span>),</span>
<span id="cb553-30"><a href="nfl.html#cb553-30" tabindex="-1"></a>      <span class="at">WR2_name =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>name, <span class="dv">2</span>),</span>
<span id="cb553-31"><a href="nfl.html#cb553-31" tabindex="-1"></a>      <span class="at">WR2_yards =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>receiving_yards, <span class="dv">2</span>),</span>
<span id="cb553-32"><a href="nfl.html#cb553-32" tabindex="-1"></a>      <span class="at">WR3_name =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>name, <span class="dv">3</span>),</span>
<span id="cb553-33"><a href="nfl.html#cb553-33" tabindex="-1"></a>      <span class="at">WR3_yards =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>receiving_yards, <span class="dv">3</span>),</span>
<span id="cb553-34"><a href="nfl.html#cb553-34" tabindex="-1"></a>      <span class="at">WR4_name =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>name, <span class="dv">4</span>),</span>
<span id="cb553-35"><a href="nfl.html#cb553-35" tabindex="-1"></a>      <span class="at">WR4_yards =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>receiving_yards, <span class="dv">4</span>),</span>
<span id="cb553-36"><a href="nfl.html#cb553-36" tabindex="-1"></a>      <span class="at">WR5_name =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>name, <span class="dv">5</span>),</span>
<span id="cb553-37"><a href="nfl.html#cb553-37" tabindex="-1"></a>      <span class="at">WR5_yards =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>receiving_yards, <span class="dv">5</span>),</span>
<span id="cb553-38"><a href="nfl.html#cb553-38" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb553-39"><a href="nfl.html#cb553-39" tabindex="-1"></a>    )</span>
<span id="cb553-40"><a href="nfl.html#cb553-40" tabindex="-1"></a>  })</span>
<span id="cb553-41"><a href="nfl.html#cb553-41" tabindex="-1"></a>  </span>
<span id="cb553-42"><a href="nfl.html#cb553-42" tabindex="-1"></a>  <span class="co"># Filter out NULL entries</span></span>
<span id="cb553-43"><a href="nfl.html#cb553-43" tabindex="-1"></a>  result_list <span class="ot">&lt;-</span> <span class="fu">Filter</span>(<span class="fu">Negate</span>(is.null), result_list)</span>
<span id="cb553-44"><a href="nfl.html#cb553-44" tabindex="-1"></a>  </span>
<span id="cb553-45"><a href="nfl.html#cb553-45" tabindex="-1"></a>  <span class="co"># Combine all data frames into one</span></span>
<span id="cb553-46"><a href="nfl.html#cb553-46" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, result_list)</span>
<span id="cb553-47"><a href="nfl.html#cb553-47" tabindex="-1"></a>  </span>
<span id="cb553-48"><a href="nfl.html#cb553-48" tabindex="-1"></a>  <span class="co"># Create team_key</span></span>
<span id="cb553-49"><a href="nfl.html#cb553-49" tabindex="-1"></a>  result<span class="sc">$</span>team_key <span class="ot">&lt;-</span> <span class="fu">paste</span>(result<span class="sc">$</span>team, result<span class="sc">$</span>season, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb553-50"><a href="nfl.html#cb553-50" tabindex="-1"></a>  </span>
<span id="cb553-51"><a href="nfl.html#cb553-51" tabindex="-1"></a>  <span class="co"># Reorder columns</span></span>
<span id="cb553-52"><a href="nfl.html#cb553-52" tabindex="-1"></a>  col_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;team_key&quot;</span>, <span class="st">&quot;season&quot;</span>, <span class="st">&quot;team&quot;</span>, </span>
<span id="cb553-53"><a href="nfl.html#cb553-53" tabindex="-1"></a>                 <span class="fu">names</span>(result)[<span class="sc">!</span><span class="fu">names</span>(result) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;team_key&quot;</span>, <span class="st">&quot;season&quot;</span>, <span class="st">&quot;team&quot;</span>)])</span>
<span id="cb553-54"><a href="nfl.html#cb553-54" tabindex="-1"></a>  result <span class="ot">&lt;-</span> result[, col_order]</span>
<span id="cb553-55"><a href="nfl.html#cb553-55" tabindex="-1"></a>  </span>
<span id="cb553-56"><a href="nfl.html#cb553-56" tabindex="-1"></a>  <span class="fu">rownames</span>(result) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb553-57"><a href="nfl.html#cb553-57" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb553-58"><a href="nfl.html#cb553-58" tabindex="-1"></a>}</span>
<span id="cb553-59"><a href="nfl.html#cb553-59" tabindex="-1"></a></span>
<span id="cb553-60"><a href="nfl.html#cb553-60" tabindex="-1"></a><span class="co"># Create a function to calculate dense rank</span></span>
<span id="cb553-61"><a href="nfl.html#cb553-61" tabindex="-1"></a>dense_rank_desc <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb553-62"><a href="nfl.html#cb553-62" tabindex="-1"></a>  <span class="co"># Sort unique values in descending order</span></span>
<span id="cb553-63"><a href="nfl.html#cb553-63" tabindex="-1"></a>  sorted_unique <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(x), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb553-64"><a href="nfl.html#cb553-64" tabindex="-1"></a>  <span class="co"># Create rank mapping</span></span>
<span id="cb553-65"><a href="nfl.html#cb553-65" tabindex="-1"></a>  rank_map <span class="ot">&lt;-</span> <span class="fu">seq_along</span>(sorted_unique)</span>
<span id="cb553-66"><a href="nfl.html#cb553-66" tabindex="-1"></a>  <span class="fu">names</span>(rank_map) <span class="ot">&lt;-</span> sorted_unique</span>
<span id="cb553-67"><a href="nfl.html#cb553-67" tabindex="-1"></a>  <span class="co"># Return ranks</span></span>
<span id="cb553-68"><a href="nfl.html#cb553-68" tabindex="-1"></a>  rank_map[<span class="fu">as.character</span>(x)]</span>
<span id="cb553-69"><a href="nfl.html#cb553-69" tabindex="-1"></a>}</span>
<span id="cb553-70"><a href="nfl.html#cb553-70" tabindex="-1"></a></span>
<span id="cb553-71"><a href="nfl.html#cb553-71" tabindex="-1"></a><span class="co"># Split data by season and team</span></span>
<span id="cb553-72"><a href="nfl.html#cb553-72" tabindex="-1"></a>splits <span class="ot">&lt;-</span> <span class="fu">split</span>(wr_data, <span class="fu">list</span>(wr_data<span class="sc">$</span>season, wr_data<span class="sc">$</span>team))</span>
<span id="cb553-73"><a href="nfl.html#cb553-73" tabindex="-1"></a></span>
<span id="cb553-74"><a href="nfl.html#cb553-74" tabindex="-1"></a><span class="co"># Function to process each group</span></span>
<span id="cb553-75"><a href="nfl.html#cb553-75" tabindex="-1"></a>process_group <span class="ot">&lt;-</span> <span class="cf">function</span>(group) {</span>
<span id="cb553-76"><a href="nfl.html#cb553-76" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(group) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb553-77"><a href="nfl.html#cb553-77" tabindex="-1"></a>  </span>
<span id="cb553-78"><a href="nfl.html#cb553-78" tabindex="-1"></a>  <span class="co"># Calculate rank within group</span></span>
<span id="cb553-79"><a href="nfl.html#cb553-79" tabindex="-1"></a>  group<span class="sc">$</span>rank <span class="ot">&lt;-</span> <span class="fu">dense_rank_desc</span>(group<span class="sc">$</span>receiving_yards)</span>
<span id="cb553-80"><a href="nfl.html#cb553-80" tabindex="-1"></a>  </span>
<span id="cb553-81"><a href="nfl.html#cb553-81" tabindex="-1"></a>  <span class="co"># Select only needed columns</span></span>
<span id="cb553-82"><a href="nfl.html#cb553-82" tabindex="-1"></a>  cols_to_keep <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;season&quot;</span>, <span class="st">&quot;team&quot;</span>, <span class="st">&quot;name&quot;</span>, <span class="st">&quot;receiving_yards&quot;</span>, <span class="st">&quot;rank&quot;</span>)</span>
<span id="cb553-83"><a href="nfl.html#cb553-83" tabindex="-1"></a>  group <span class="ot">&lt;-</span> group[, cols_to_keep[cols_to_keep <span class="sc">%in%</span> <span class="fu">names</span>(group)]]</span>
<span id="cb553-84"><a href="nfl.html#cb553-84" tabindex="-1"></a>  </span>
<span id="cb553-85"><a href="nfl.html#cb553-85" tabindex="-1"></a>  <span class="fu">return</span>(group)</span>
<span id="cb553-86"><a href="nfl.html#cb553-86" tabindex="-1"></a>}</span>
<span id="cb553-87"><a href="nfl.html#cb553-87" tabindex="-1"></a></span>
<span id="cb553-88"><a href="nfl.html#cb553-88" tabindex="-1"></a><span class="co"># Apply processing to each group and combine results</span></span>
<span id="cb553-89"><a href="nfl.html#cb553-89" tabindex="-1"></a>ranked_wr_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(splits, process_group))</span>
<span id="cb553-90"><a href="nfl.html#cb553-90" tabindex="-1"></a></span>
<span id="cb553-91"><a href="nfl.html#cb553-91" tabindex="-1"></a><span class="co"># Reset row names</span></span>
<span id="cb553-92"><a href="nfl.html#cb553-92" tabindex="-1"></a><span class="fu">rownames</span>(ranked_wr_data) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb553-93"><a href="nfl.html#cb553-93" tabindex="-1"></a></span>
<span id="cb553-94"><a href="nfl.html#cb553-94" tabindex="-1"></a><span class="co"># Create WR summary</span></span>
<span id="cb553-95"><a href="nfl.html#cb553-95" tabindex="-1"></a>wr_summary <span class="ot">&lt;-</span> <span class="fu">get_top_wr_team_members</span>(ranked_wr_data)</span>
<span id="cb553-96"><a href="nfl.html#cb553-96" tabindex="-1"></a></span>
<span id="cb553-97"><a href="nfl.html#cb553-97" tabindex="-1"></a><span class="co"># Check structure</span></span>
<span id="cb553-98"><a href="nfl.html#cb553-98" tabindex="-1"></a><span class="fu">str</span>(wr_summary)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    326 obs. of  13 variables:
##  $ team_key : chr  &quot;ARI_2016&quot; &quot;ARI_2017&quot; &quot;ARI_2018&quot; &quot;ARI_2019&quot; ...
##  $ season   : num  2016 2017 2018 2019 2020 ...
##  $ team     : chr  &quot;ARI&quot; &quot;ARI&quot; &quot;ARI&quot; &quot;ARI&quot; ...
##  $ WR1_name : chr  &quot;Larry Fitzgerald&quot; &quot;Larry Fitzgerald&quot; &quot;Larry Fitzgerald&quot; &quot;Larry Fitzgerald&quot; ...
##  $ WR1_yards: num  1023 1156 734 804 1407 ...
##  $ WR2_name : chr  &quot;J.J. Nelson&quot; &quot;J.J. Nelson&quot; &quot;Christian Kirk&quot; &quot;Christian Kirk&quot; ...
##  $ WR2_yards: num  568 508 590 709 621 848 709 565 711 921 ...
##  $ WR3_name : chr  &quot;John Brown&quot; &quot;Jaron Brown&quot; &quot;Trent Sherfield&quot; &quot;Damiere Byrd&quot; ...
##  $ WR3_yards: num  517 477 210 359 409 572 467 352 580 556 ...
##  $ WR4_name : chr  &quot;Jaron Brown&quot; &quot;John Brown&quot; &quot;Chad Williams&quot; &quot;Pharoh Cooper&quot; ...
##  $ WR4_yards: num  187 299 171 243 224 435 414 280 210 504 ...
##  $ WR5_name : chr  &quot;Brittan Golden&quot; &quot;Brittan Golden&quot; &quot;J.J. Nelson&quot; &quot;Andy Isabella&quot; ...
##  $ WR5_yards: num  82 70 64 189 173 208 236 19 12 102 ...</code></pre>
</div>
<div id="testing" class="section level2 hasAnchor" number="16.7">
<h2><span class="header-section-number">16.7</span> Testing<a href="nfl.html#testing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="nfl.html#cb555-1" tabindex="-1"></a><span class="co"># Create team_key and merge with wr_summary</span></span>
<span id="cb555-2"><a href="nfl.html#cb555-2" tabindex="-1"></a>wr_data_final <span class="ot">&lt;-</span> wr_data</span>
<span id="cb555-3"><a href="nfl.html#cb555-3" tabindex="-1"></a>wr_data_final<span class="sc">$</span>team_key <span class="ot">&lt;-</span> <span class="fu">paste</span>(wr_data_final<span class="sc">$</span>team, wr_data_final<span class="sc">$</span>season, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb555-4"><a href="nfl.html#cb555-4" tabindex="-1"></a>wr_data_final <span class="ot">&lt;-</span> <span class="fu">merge</span>(wr_data_final, wr_summary, <span class="at">by =</span> <span class="st">&quot;team_key&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb555-5"><a href="nfl.html#cb555-5" tabindex="-1"></a></span>
<span id="cb555-6"><a href="nfl.html#cb555-6" tabindex="-1"></a><span class="co"># Rename columns and create initial wr_dataf</span></span>
<span id="cb555-7"><a href="nfl.html#cb555-7" tabindex="-1"></a>wr_dataf <span class="ot">&lt;-</span> wr_data_final</span>
<span id="cb555-8"><a href="nfl.html#cb555-8" tabindex="-1"></a><span class="fu">names</span>(wr_dataf)[<span class="fu">names</span>(wr_dataf) <span class="sc">==</span> <span class="st">&quot;season.x&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;season&quot;</span></span>
<span id="cb555-9"><a href="nfl.html#cb555-9" tabindex="-1"></a><span class="fu">names</span>(wr_dataf)[<span class="fu">names</span>(wr_dataf) <span class="sc">==</span> <span class="st">&quot;team.x&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team&quot;</span></span>
<span id="cb555-10"><a href="nfl.html#cb555-10" tabindex="-1"></a><span class="fu">names</span>(wr_dataf)[<span class="fu">names</span>(wr_dataf) <span class="sc">==</span> <span class="st">&quot;name&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;player_name&quot;</span></span>
<span id="cb555-11"><a href="nfl.html#cb555-11" tabindex="-1"></a></span>
<span id="cb555-12"><a href="nfl.html#cb555-12" tabindex="-1"></a><span class="co"># Remove ID column if it exists</span></span>
<span id="cb555-13"><a href="nfl.html#cb555-13" tabindex="-1"></a><span class="cf">if</span>(<span class="st">&quot;id&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(wr_dataf)) {</span>
<span id="cb555-14"><a href="nfl.html#cb555-14" tabindex="-1"></a>    wr_dataf <span class="ot">&lt;-</span> wr_dataf[, <span class="sc">!</span><span class="fu">names</span>(wr_dataf) <span class="sc">==</span> <span class="st">&quot;id&quot;</span>]</span>
<span id="cb555-15"><a href="nfl.html#cb555-15" tabindex="-1"></a>}</span>
<span id="cb555-16"><a href="nfl.html#cb555-16" tabindex="-1"></a></span>
<span id="cb555-17"><a href="nfl.html#cb555-17" tabindex="-1"></a><span class="co"># Subset 2023 data</span></span>
<span id="cb555-18"><a href="nfl.html#cb555-18" tabindex="-1"></a>wr_2023 <span class="ot">&lt;-</span> wr_dataf[wr_dataf<span class="sc">$</span>season <span class="sc">==</span> <span class="dv">2023</span>, ]</span>
<span id="cb555-19"><a href="nfl.html#cb555-19" tabindex="-1"></a></span>
<span id="cb555-20"><a href="nfl.html#cb555-20" tabindex="-1"></a><span class="co"># Create next season&#39;s fantasy points</span></span>
<span id="cb555-21"><a href="nfl.html#cb555-21" tabindex="-1"></a>create_next_points <span class="ot">&lt;-</span> <span class="cf">function</span>(points, player) {</span>
<span id="cb555-22"><a href="nfl.html#cb555-22" tabindex="-1"></a>    <span class="fu">ave</span>(points, player, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">NA</span>))</span>
<span id="cb555-23"><a href="nfl.html#cb555-23" tabindex="-1"></a>}</span>
<span id="cb555-24"><a href="nfl.html#cb555-24" tabindex="-1"></a>wr_dataf<span class="sc">$</span>next_fantasy_points <span class="ot">&lt;-</span> <span class="fu">create_next_points</span>(wr_dataf<span class="sc">$</span>fantasy_points, wr_dataf<span class="sc">$</span>player_name)</span>
<span id="cb555-25"><a href="nfl.html#cb555-25" tabindex="-1"></a>wr_dataf<span class="sc">$</span>next_fantasy_points_ppr <span class="ot">&lt;-</span> <span class="fu">create_next_points</span>(wr_dataf<span class="sc">$</span>fantasy_points_ppr, wr_dataf<span class="sc">$</span>player_name)</span>
<span id="cb555-26"><a href="nfl.html#cb555-26" tabindex="-1"></a></span>
<span id="cb555-27"><a href="nfl.html#cb555-27" tabindex="-1"></a><span class="co"># Filter rookie seasons</span></span>
<span id="cb555-28"><a href="nfl.html#cb555-28" tabindex="-1"></a>wr_dataf <span class="ot">&lt;-</span> wr_dataf[wr_dataf<span class="sc">$</span>rookie_season <span class="sc">!=</span> <span class="dv">0</span>, ]</span>
<span id="cb555-29"><a href="nfl.html#cb555-29" tabindex="-1"></a>wr_dataf <span class="ot">&lt;-</span> wr_dataf[wr_dataf<span class="sc">$</span>rookie_season <span class="sc">!=</span> wr_dataf<span class="sc">$</span>season, ]</span>
<span id="cb555-30"><a href="nfl.html#cb555-30" tabindex="-1"></a></span>
<span id="cb555-31"><a href="nfl.html#cb555-31" tabindex="-1"></a><span class="co"># Remove next_fantasy_points_ppr</span></span>
<span id="cb555-32"><a href="nfl.html#cb555-32" tabindex="-1"></a>wr_dataf<span class="sc">$</span>next_fantasy_points_ppr <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb555-33"><a href="nfl.html#cb555-33" tabindex="-1"></a></span>
<span id="cb555-34"><a href="nfl.html#cb555-34" tabindex="-1"></a><span class="co"># Remove zero-variance columns</span></span>
<span id="cb555-35"><a href="nfl.html#cb555-35" tabindex="-1"></a>n_distinct <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x))</span>
<span id="cb555-36"><a href="nfl.html#cb555-36" tabindex="-1"></a>zero_var_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(wr_dataf)[<span class="fu">sapply</span>(wr_dataf, n_distinct) <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb555-37"><a href="nfl.html#cb555-37" tabindex="-1"></a>wr_dataf <span class="ot">&lt;-</span> wr_dataf[, <span class="sc">!</span><span class="fu">names</span>(wr_dataf) <span class="sc">%in%</span> zero_var_cols]</span>
<span id="cb555-38"><a href="nfl.html#cb555-38" tabindex="-1"></a></span>
<span id="cb555-39"><a href="nfl.html#cb555-39" tabindex="-1"></a><span class="co"># Remove non-predictive columns</span></span>
<span id="cb555-40"><a href="nfl.html#cb555-40" tabindex="-1"></a>columns_to_remove <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;player_name&quot;</span>, <span class="st">&quot;team_key&quot;</span>, <span class="st">&quot;WR2_name&quot;</span>, <span class="st">&quot;WR1_name&quot;</span>, </span>
<span id="cb555-41"><a href="nfl.html#cb555-41" tabindex="-1"></a>                      <span class="st">&quot;RB3_name&quot;</span>, <span class="st">&quot;RB2_name&quot;</span>, <span class="st">&quot;RB1_name&quot;</span>, <span class="st">&quot;QB_name&quot;</span>, </span>
<span id="cb555-42"><a href="nfl.html#cb555-42" tabindex="-1"></a>                      <span class="st">&quot;season&quot;</span>, <span class="st">&quot;team&quot;</span>, <span class="st">&quot;season.y&quot;</span>, <span class="st">&quot;team.y&quot;</span>)</span>
<span id="cb555-43"><a href="nfl.html#cb555-43" tabindex="-1"></a>wr_dataf <span class="ot">&lt;-</span> wr_dataf[, <span class="sc">!</span><span class="fu">names</span>(wr_dataf) <span class="sc">%in%</span> columns_to_remove]</span>
<span id="cb555-44"><a href="nfl.html#cb555-44" tabindex="-1"></a></span>
<span id="cb555-45"><a href="nfl.html#cb555-45" tabindex="-1"></a><span class="co"># Train Random Forest model</span></span>
<span id="cb555-46"><a href="nfl.html#cb555-46" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(next_fantasy_points <span class="sc">~</span> ., </span>
<span id="cb555-47"><a href="nfl.html#cb555-47" tabindex="-1"></a>                        <span class="at">ntree =</span> <span class="dv">1200</span>, </span>
<span id="cb555-48"><a href="nfl.html#cb555-48" tabindex="-1"></a>                        <span class="at">data =</span> wr_dataf, </span>
<span id="cb555-49"><a href="nfl.html#cb555-49" tabindex="-1"></a>                        <span class="at">importance =</span> <span class="cn">TRUE</span>, </span>
<span id="cb555-50"><a href="nfl.html#cb555-50" tabindex="-1"></a>                        <span class="at">na.action =</span> na.omit)</span>
<span id="cb555-51"><a href="nfl.html#cb555-51" tabindex="-1"></a></span>
<span id="cb555-52"><a href="nfl.html#cb555-52" tabindex="-1"></a><span class="co"># Calculate performance metrics</span></span>
<span id="cb555-53"><a href="nfl.html#cb555-53" tabindex="-1"></a>oob_predictions <span class="ot">&lt;-</span> rf_model<span class="sc">$</span>predicted</span>
<span id="cb555-54"><a href="nfl.html#cb555-54" tabindex="-1"></a>absolute_errors <span class="ot">&lt;-</span> <span class="fu">abs</span>(oob_predictions <span class="sc">-</span> rf_model<span class="sc">$</span>y)</span>
<span id="cb555-55"><a href="nfl.html#cb555-55" tabindex="-1"></a>oob_mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(absolute_errors)</span>
<span id="cb555-56"><a href="nfl.html#cb555-56" tabindex="-1"></a>oob_mse <span class="ot">&lt;-</span> rf_model<span class="sc">$</span>mse[<span class="dv">1200</span>]</span>
<span id="cb555-57"><a href="nfl.html#cb555-57" tabindex="-1"></a>oobrmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(oob_mse)</span>
<span id="cb555-58"><a href="nfl.html#cb555-58" tabindex="-1"></a></span>
<span id="cb555-59"><a href="nfl.html#cb555-59" tabindex="-1"></a><span class="co"># Print metrics</span></span>
<span id="cb555-60"><a href="nfl.html#cb555-60" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;OOB MAE:&quot;</span>, oob_mae))</span></code></pre></div>
<pre><code>## [1] &quot;OOB MAE: 33.312207333587&quot;</code></pre>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="nfl.html#cb557-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;OOB rMSE:&quot;</span>, oobrmse))</span></code></pre></div>
<pre><code>## [1] &quot;OOB rMSE: 43.6783743687123&quot;</code></pre>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="nfl.html#cb559-1" tabindex="-1"></a><span class="co"># Feature importance</span></span>
<span id="cb559-2"><a href="nfl.html#cb559-2" tabindex="-1"></a>importance_values <span class="ot">&lt;-</span> <span class="fu">importance</span>(rf_model)</span>
<span id="cb559-3"><a href="nfl.html#cb559-3" tabindex="-1"></a>ordered_importance <span class="ot">&lt;-</span> <span class="fu">order</span>(importance_values[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb559-4"><a href="nfl.html#cb559-4" tabindex="-1"></a>top10_mse <span class="ot">&lt;-</span> importance_values[ordered_importance[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], ]</span>
<span id="cb559-5"><a href="nfl.html#cb559-5" tabindex="-1"></a></span>
<span id="cb559-6"><a href="nfl.html#cb559-6" tabindex="-1"></a><span class="co"># Plot importance</span></span>
<span id="cb559-7"><a href="nfl.html#cb559-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb559-8"><a href="nfl.html#cb559-8" tabindex="-1"></a><span class="fu">barplot</span>(top10_mse[, <span class="st">&quot;%IncMSE&quot;</span>], </span>
<span id="cb559-9"><a href="nfl.html#cb559-9" tabindex="-1"></a>        <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_mse),</span>
<span id="cb559-10"><a href="nfl.html#cb559-10" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by %IncMSE (Enhanced Model)&quot;</span>,</span>
<span id="cb559-11"><a href="nfl.html#cb559-11" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, </span>
<span id="cb559-12"><a href="nfl.html#cb559-12" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb559-13"><a href="nfl.html#cb559-13" tabindex="-1"></a>        <span class="at">horiz =</span> <span class="cn">TRUE</span>, </span>
<span id="cb559-14"><a href="nfl.html#cb559-14" tabindex="-1"></a>        <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-236-1.png" width="672" /></p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="nfl.html#cb560-1" tabindex="-1"></a><span class="co"># Save player names and clean 2023 data</span></span>
<span id="cb560-2"><a href="nfl.html#cb560-2" tabindex="-1"></a>nms <span class="ot">&lt;-</span> wr_2023<span class="sc">$</span>player_name</span>
<span id="cb560-3"><a href="nfl.html#cb560-3" tabindex="-1"></a>wr_2023 <span class="ot">&lt;-</span> wr_2023[, <span class="sc">!</span><span class="fu">names</span>(wr_2023) <span class="sc">%in%</span> <span class="fu">c</span>(zero_var_cols, columns_to_remove)]</span>
<span id="cb560-4"><a href="nfl.html#cb560-4" tabindex="-1"></a></span>
<span id="cb560-5"><a href="nfl.html#cb560-5" tabindex="-1"></a><span class="co"># Generate predictions</span></span>
<span id="cb560-6"><a href="nfl.html#cb560-6" tabindex="-1"></a>predicted_2024_fantasy_points <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata =</span> wr_2023)</span>
<span id="cb560-7"><a href="nfl.html#cb560-7" tabindex="-1"></a></span>
<span id="cb560-8"><a href="nfl.html#cb560-8" tabindex="-1"></a><span class="co"># Create and sort results</span></span>
<span id="cb560-9"><a href="nfl.html#cb560-9" tabindex="-1"></a>results_wr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb560-10"><a href="nfl.html#cb560-10" tabindex="-1"></a>    <span class="at">name =</span> nms,</span>
<span id="cb560-11"><a href="nfl.html#cb560-11" tabindex="-1"></a>    <span class="at">predicted_2024_fantasy_points =</span> predicted_2024_fantasy_points</span>
<span id="cb560-12"><a href="nfl.html#cb560-12" tabindex="-1"></a>)</span>
<span id="cb560-13"><a href="nfl.html#cb560-13" tabindex="-1"></a>results_wr <span class="ot">&lt;-</span> results_wr[<span class="fu">order</span>(results_wr<span class="sc">$</span>predicted_2024_fantasy_points, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb560-14"><a href="nfl.html#cb560-14" tabindex="-1"></a></span>
<span id="cb560-15"><a href="nfl.html#cb560-15" tabindex="-1"></a><span class="co"># Print predictions</span></span>
<span id="cb560-16"><a href="nfl.html#cb560-16" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;2024 WR Predictions (Enhanced Model):&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2024 WR Predictions (Enhanced Model):&quot;</code></pre>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="nfl.html#cb562-1" tabindex="-1"></a><span class="fu">print</span>(results_wr)</span></code></pre></div>
<pre><code>##                          name predicted_2024_fantasy_points
## 709         Amon-Ra St. Brown                     181.59983
## 1243              Tyreek Hill                     181.14827
## 571               CeeDee Lamb                     179.95472
## 1104               Puka Nacua                     172.72173
## 1667               A.J. Brown                     153.04361
## 836              Nico Collins                     148.01333
## 1149             Keenan Allen                     147.45274
## 1869            Brandon Aiyuk                     139.97278
## 1298         Justin Jefferson                     139.15777
## 381                D.J. Moore                     137.90136
## 1437              Chris Olave                     136.98476
## 449             Ja&#39;Marr Chase                     136.44189
## 835                 Tank Dell                     135.39274
## 1173            Davante Adams                     130.17761
## 1950               Mike Evans                     128.77732
## 1874             Deebo Samuel                     125.98903
## 569             Brandin Cooks                     124.51287
## 1244            Jaylen Waddle                     124.43821
## 503              Amari Cooper                     120.31856
## 1732           George Pickens                     119.33197
## 244              Stefon Diggs                     118.97043
## 1664            DeVonta Smith                     115.60759
## 2023          DeAndre Hopkins                     111.29464
## 984             Calvin Ridley                     108.50681
## 1602           Garrett Wilson                     107.87159
## 1949             Chris Godwin                     106.12752
## 780               Jayden Reed                     102.80696
## 1734          Diontae Johnson                     100.35731
## 2101           Terry McLaurin                     100.24320
## 1370      JuJu Smith-Schuster                      98.87110
## 49             Marquise Brown                      98.12850
## 1296           Jordan Addison                      97.20340
## 1109              Cooper Kupp                      95.61552
## 170            Nelson Agholor                      93.99087
## 986            Christian Kirk                      93.93921
## 169               Zay Flowers                      93.74678
## 640          Courtland Sutton                      91.88144
## 1441           Rashid Shaheed                      91.87780
## 505              Elijah Moore                      90.28396
## 1801            Tyler Lockett                      90.13423
## 456               Tee Higgins                      88.55195
## 786          Christian Watson                      87.54887
## 711              Marvin Jones                      87.20233
## 119              Drake London                      87.16003
## 784               Romeo Doubs                      85.63936
## 1055              Rashee Rice                      80.82038
## 639               Jerry Jeudy                      80.71338
## 834              Robert Woods                      77.99893
## 1150              Josh Palmer                      77.78315
## 907                Josh Downs                      76.72685
## 1371          Demario Douglas                      76.49230
## 1105              Tutu Atwell                      76.42632
## 1247           Chase Claypool                      74.70828
## 2096            Curtis Samuel                      74.56587
## 300            Jonathan Mingo                      73.62137
## 1153         Quentin Johnston                      72.85825
## 785                 Bo Melton                      71.98097
## 453                Tyler Boyd                      71.59650
## 1525           Darius Slayton                      70.72639
## 1800       Jaxon Smith-Njigba                      70.46430
## 1524        Wan&#39;Dale Robinson                      70.30337
## 1733           Allen Robinson                      70.19659
## 47             Michael Wilson                      70.16334
## 2100             Jahan Dotson                      69.63122
## 1107        Demarcus Robinson                      67.88962
## 306              Adam Thielen                      67.45377
## 120              Mack Hollins                      67.15398
## 455             Trenton Irwin                      67.14472
## 782          Dontayvion Wicks                      65.74947
## 1175            Jakobi Meyers                      64.27733
## 1603             Randall Cobb                      63.51867
## 905               Alec Pierce                      63.02156
## 1440           Michael Thomas                      62.31477
## 168            Rashod Bateman                      61.13400
## 1665              Julio Jones                      60.97879
## 242             Khalil Shakir                      59.78990
## 1365           DeVante Parker                      59.72767
## 1522              Jalin Hyatt                      59.44663
## 1151            Mike Williams                      59.19338
## 1605             Allen Lazard                      57.01559
## 51              Rondale Moore                      56.41350
## 506            Cedric Tillman                      56.39963
## 507          Marquise Goodwin                      55.94416
## 643               Marvin Mims                      54.71009
## 1052             Richie James                      53.44949
## 1871             Willie Snead                      52.39397
## 1369          Kendrick Bourne                      52.14344
## 1154            Alex Erickson                      52.05016
## 832                Noah Brown                      51.82046
## 378            Darnell Mooney                      50.98198
## 708          Jameson Williams                      50.74657
## 2024              Chris Moore                      50.37908
## 1172               Tre Tucker                      49.44492
## 1299              K.J. Osborn                      49.25193
## 2028            Treylon Burks                      48.68337
## 173          Laquon Treadwell                      48.34939
## 988                 Zay Jones                      47.78962
## 1057 Marquez Valdes-Scantling                      47.32033
## 1951              Trey Palmer                      47.11448
## 568             Jalen Tolbert                      45.54541
## 1054           Kadarius Toney                      45.41977
## 1174           Hunter Renfrow                      45.05365
## 1176           DeAndre Carter                      44.74819
## 1301           Brandon Powell                      44.67244
## 1152             Derius Davis                      44.59105
## 1438               A.T. Perry                      43.70399
## 50                Greg Dortch                      43.07924
## 1526           Isaiah Hodgins                      42.80481
## 1248            Erik Ezukanma                      42.78455
## 1873           Jauan Jennings                      42.49477
## 1870             Chris Conley                      42.23952
## 1056               Skyy Moore                      42.07177
## 1368             Jalen Reagor                      41.99928
## 1872              Ronnie Bell                      41.87035
## 379               Tyler Scott                      41.03749
## 1604            Xavier Gipson                      40.97803
## 2026    Nick Westbrook-Ikhine                      40.78182
## 2097          Jamison Crowder                      40.30683
## 638           Brandon Johnson                      39.49787
## 1523          Parris Campbell                      38.41738
## 1663             Quez Watkins                      38.36607
## 710             Josh Reynolds                      38.03500
## 572              Jalen Brooks                      37.98076
## 1730            Calvin Austin                      37.35225
## 48                Zach Pascal                      37.24599
## 171            Devin Duvernay                      37.23263
## 454            Andrei Iosivas                      36.84082
## 1108            Tyler Johnson                      36.01099
## 570            Michael Gallup                      35.69286
## 502                David Bell                      34.92553
## 383              Trent Taylor                      34.26550
## 1607           Jason Brownlee                      34.10946
## 837         Xavier Hutchinson                      32.98186
## 1527         Sterling Shepard                      32.97947
## 1155              Keelan Doss                      32.92457
## 504              James Proche                      32.48198
## 906           Isaiah McKenzie                      32.41660
## 985         Parker Washington                      31.84616
## 1246          Braxton Berrios                      31.57056
## 1053            Justin Watson                      31.25025
## 989               Jamal Agnew                      31.09253
## 240           Trent Sherfield                      30.84335
## 1364          Tyquan Thornton                      30.41349
## 1051           Mecole Hardman                      29.89886
## 305      Ihmir Smith-Marsette                      29.49421
## 1802                Jake Bobo                      29.41785
## 1948          Deven Thompkins                      29.08725
## 117             Van Jefferson                      28.10888
## 783               Malik Heath                      28.05905
## 641           Phillip Dorsett                      27.90272
## 1147              Simi Fehoko                      27.61063
## 2099              Dyami Brown                      27.26799
## 1666        Olamide Zaccheaus                      26.88340
## 2025             Kyle Philips                      26.43851
## 707             Kalif Raymond                      25.08213
## 1300         Trishton Jackson                      24.98231
## 382            Collin Johnson                      24.96856
## 1367            Ty Montgomery                      24.81606
## 1297             Jalen Nailor                      24.56069
## 1731             Miles Boykin                      24.49687
## 712             Antoine Green                      24.22513
## 983                 Tim Jones                      24.10134
## 1245            Robbie Chosen                      23.58473
## 1366           Kayshon Boutte                      23.07949
## 1436           Keith Kirkwood                      23.00427
## 380     Equanimeous St. Brown                      22.95371
## 706     Donovan Peoples-Jones                      22.72767
## 1875          Ray-Ray McCloud                      22.45901
## 909             Amari Rodgers                      22.31813
## 172             Tylan Wallace                      22.23181
## 116            KhaDarel Hodge                      22.00749
## 1148             Jalen Guyton                      21.98612
## 642       Lil&#39;Jordan Humphrey                      21.72226
## 1799            Cody Thompson                      21.67658
## 1103          Austin Trammell                      21.28101
## 1803         D&#39;Wayne Eskridge                      20.43136
## 451             Charlie Jones                      19.92151
## 118              Scott Miller                      19.70586
## 904           D.J. Montgomery                      18.89337
## 1606            Irvin Charles                      18.56292
## 1952            Rakim Jarrett                      17.96633
## 1528         Gunner Olszewski                      17.76953
## 1106            Ben Skowronek                      17.54110
## 903            Juwann Winfree                      17.24597
## 450          Shedrick Jackson                      16.91313
## 1242           River Cracraft                      16.65992
## 2098            Byron Pringle                      16.63615
## 1953              David Moore                      16.34555
## 1668            Britain Covey                      15.82698
## 781              Samori Toure                      15.61907
## 1608             Malik Taylor                      14.52379
## 2022            Colton Dowell                      13.90308
## 241              Deonte Harty                      13.66192
## 1058              Justyn Ross                      13.10295
## 303             Mike Strachan                      12.17968
## 2027             Mason Kinsey                      12.09344
## 833               Steven Sims                      11.79314
## 987              Elijah Cooks                      10.88795
## 243                Gabe Davis                            NA
## 301          Laviska Shenault                            NA
## 302                D.J. Chark                            NA
## 304          Terrace Marshall                            NA
## 377               Velus Jones                            NA
## 452           Kwamie Lassiter                            NA
## 908           Michael Pittman                            NA
## 1439              Lynn Bowden                            NA
## 1804               DK Metcalf                            NA</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro_econ_stats.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/15_NFL.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
