<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 NFL | Machine Learning Applications</title>
  <meta name="description" content="Introduction" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 NFL | Machine Learning Applications" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Introduction" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 NFL | Machine Learning Applications" />
  
  <meta name="twitter:description" content="Introduction" />
  

<meta name="author" content="Simon P. Raymond" />


<meta name="date" content="2024-12-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro-econ-stats.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MachineLearning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About Myself</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#notes-for-public"><i class="fa fa-check"></i><b>1.2</b> Notes for public</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#work-in-progress"><i class="fa fa-check"></i><b>1.3</b> Work in progress</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>2</b> Algorithms</a>
<ul>
<li class="chapter" data-level="2.1" data-path="algorithms.html"><a href="algorithms.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="algorithms.html"><a href="algorithms.html#parametric"><i class="fa fa-check"></i><b>2.2</b> Parametric</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="algorithms.html"><a href="algorithms.html#lm"><i class="fa fa-check"></i><b>2.2.1</b> LM</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="algorithms.html"><a href="algorithms.html#trees"><i class="fa fa-check"></i><b>2.3</b> Trees</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="algorithms.html"><a href="algorithms.html#cart"><i class="fa fa-check"></i><b>2.3.1</b> CART</a></li>
<li class="chapter" data-level="2.3.2" data-path="algorithms.html"><a href="algorithms.html#bagging"><i class="fa fa-check"></i><b>2.3.2</b> Bagging</a></li>
<li class="chapter" data-level="2.3.3" data-path="algorithms.html"><a href="algorithms.html#rf"><i class="fa fa-check"></i><b>2.3.3</b> RF</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="algorithms.html"><a href="algorithms.html#boosting"><i class="fa fa-check"></i><b>2.4</b> Boosting</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="algorithms.html"><a href="algorithms.html#adaboost"><i class="fa fa-check"></i><b>2.4.1</b> Adaboost</a></li>
<li class="chapter" data-level="2.4.2" data-path="algorithms.html"><a href="algorithms.html#gbm-boost"><i class="fa fa-check"></i><b>2.4.2</b> GBM boost</a></li>
<li class="chapter" data-level="2.4.3" data-path="algorithms.html"><a href="algorithms.html#xgboost"><i class="fa fa-check"></i><b>2.4.3</b> XGBoost</a></li>
<li class="chapter" data-level="2.4.4" data-path="algorithms.html"><a href="algorithms.html#light-gbm-boost"><i class="fa fa-check"></i><b>2.4.4</b> Light GBM boost</a></li>
<li class="chapter" data-level="2.4.5" data-path="algorithms.html"><a href="algorithms.html#catboost"><i class="fa fa-check"></i><b>2.4.5</b> Catboost</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="algorithms.html"><a href="algorithms.html#other-non-parametric"><i class="fa fa-check"></i><b>2.5</b> Other Non-parametric</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="algorithms.html"><a href="algorithms.html#knn"><i class="fa fa-check"></i><b>2.5.1</b> KNN</a></li>
<li class="chapter" data-level="2.5.2" data-path="algorithms.html"><a href="algorithms.html#nueralnet"><i class="fa fa-check"></i><b>2.5.2</b> Nueralnet</a></li>
<li class="chapter" data-level="2.5.3" data-path="algorithms.html"><a href="algorithms.html#svm"><i class="fa fa-check"></i><b>2.5.3</b> SVM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="binary-application.html"><a href="binary-application.html"><i class="fa fa-check"></i><b>3</b> Binary Application</a>
<ul>
<li class="chapter" data-level="3.1" data-path="binary-application.html"><a href="binary-application.html#data-1"><i class="fa fa-check"></i><b>3.1</b> Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="binary-application.html"><a href="binary-application.html#data-prep"><i class="fa fa-check"></i><b>3.1.1</b> Data Prep</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="binary-application.html"><a href="binary-application.html#model-selection"><i class="fa fa-check"></i><b>3.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="binary-application.html"><a href="binary-application.html#functions"><i class="fa fa-check"></i><b>3.2.1</b> Functions</a></li>
<li class="chapter" data-level="3.2.2" data-path="binary-application.html"><a href="binary-application.html#xgb"><i class="fa fa-check"></i><b>3.2.2</b> XGB</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="binary-application.html"><a href="binary-application.html#comparisions"><i class="fa fa-check"></i><b>3.3</b> Comparisions</a></li>
<li class="chapter" data-level="3.4" data-path="binary-application.html"><a href="binary-application.html#statistic-selection"><i class="fa fa-check"></i><b>3.4</b> Statistic selection</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="binary-application.html"><a href="binary-application.html#section"><i class="fa fa-check"></i><b>3.4.1</b> 0.5</a></li>
<li class="chapter" data-level="3.4.2" data-path="binary-application.html"><a href="binary-application.html#youdens-j-statistic"><i class="fa fa-check"></i><b>3.4.2</b> Youden’s J Statistic</a></li>
<li class="chapter" data-level="3.4.3" data-path="binary-application.html"><a href="binary-application.html#fscore"><i class="fa fa-check"></i><b>3.4.3</b> Fscore</a></li>
<li class="chapter" data-level="3.4.4" data-path="binary-application.html"><a href="binary-application.html#roc-curve"><i class="fa fa-check"></i><b>3.4.4</b> ROC curve</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regressional-application.html"><a href="regressional-application.html"><i class="fa fa-check"></i><b>4</b> Regressional Application</a>
<ul>
<li class="chapter" data-level="4.1" data-path="regressional-application.html"><a href="regressional-application.html#data-2"><i class="fa fa-check"></i><b>4.1</b> Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="regressional-application.html"><a href="regressional-application.html#data-prep-1"><i class="fa fa-check"></i><b>4.1.1</b> Data Prep</a></li>
<li class="chapter" data-level="4.1.2" data-path="regressional-application.html"><a href="regressional-application.html#data-explorations"><i class="fa fa-check"></i><b>4.1.2</b> Data Explorations</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="regressional-application.html"><a href="regressional-application.html#model-selection-1"><i class="fa fa-check"></i><b>4.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="regressional-application.html"><a href="regressional-application.html#rf-1"><i class="fa fa-check"></i><b>4.2.1</b> RF</a></li>
<li class="chapter" data-level="4.2.2" data-path="regressional-application.html"><a href="regressional-application.html#lm-1"><i class="fa fa-check"></i><b>4.2.2</b> LM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="imbalanced-application.html"><a href="imbalanced-application.html"><i class="fa fa-check"></i><b>5</b> Imbalanced Application</a>
<ul>
<li class="chapter" data-level="5.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#data-3"><i class="fa fa-check"></i><b>5.1</b> Data</a></li>
<li class="chapter" data-level="5.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#approaches"><i class="fa fa-check"></i><b>5.2</b> Approaches</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#no-changes"><i class="fa fa-check"></i><b>5.2.1</b> No changes</a></li>
<li class="chapter" data-level="5.2.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#undersample"><i class="fa fa-check"></i><b>5.2.2</b> Undersample</a></li>
<li class="chapter" data-level="5.2.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#oversampling"><i class="fa fa-check"></i><b>5.2.3</b> Oversampling</a></li>
<li class="chapter" data-level="5.2.4" data-path="imbalanced-application.html"><a href="imbalanced-application.html#smoteing"><i class="fa fa-check"></i><b>5.2.4</b> Smoteing</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#statistic-selection-1"><i class="fa fa-check"></i><b>5.3</b> Statistic selection</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="speeds.html"><a href="speeds.html"><i class="fa fa-check"></i><b>6</b> Speeds</a>
<ul>
<li class="chapter" data-level="6.1" data-path="speeds.html"><a href="speeds.html#functions-to-run-the-tests"><i class="fa fa-check"></i><b>6.1</b> Functions to run the tests</a></li>
<li class="chapter" data-level="6.2" data-path="speeds.html"><a href="speeds.html#data-4"><i class="fa fa-check"></i><b>6.2</b> Data</a></li>
<li class="chapter" data-level="6.3" data-path="speeds.html"><a href="speeds.html#rows"><i class="fa fa-check"></i><b>6.3</b> 10,000 rows</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix"><i class="fa fa-check"></i><b>6.3.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.3.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix"><i class="fa fa-check"></i><b>6.3.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="speeds.html"><a href="speeds.html#rows-1"><i class="fa fa-check"></i><b>6.4</b> 500,000 rows</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix-1"><i class="fa fa-check"></i><b>6.4.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix-1"><i class="fa fa-check"></i><b>6.4.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="speeds.html"><a href="speeds.html#presentations"><i class="fa fa-check"></i><b>6.5</b> Presentations</a></li>
<li class="chapter" data-level="6.6" data-path="speeds.html"><a href="speeds.html#analysis"><i class="fa fa-check"></i><b>6.6</b> Analysis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="speeds.html"><a href="speeds.html#graphs"><i class="fa fa-check"></i><b>6.6.1</b> Graphs</a></li>
<li class="chapter" data-level="6.6.2" data-path="speeds.html"><a href="speeds.html#takaways"><i class="fa fa-check"></i><b>6.6.2</b> Takaways</a></li>
<li class="chapter" data-level="6.6.3" data-path="speeds.html"><a href="speeds.html#things-to-change"><i class="fa fa-check"></i><b>6.6.3</b> Things to change</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html"><i class="fa fa-check"></i><b>7</b> Multi Variable Classification</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#data-5"><i class="fa fa-check"></i><b>7.1</b> Data</a></li>
<li class="chapter" data-level="7.2" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#aucs"><i class="fa fa-check"></i><b>7.2</b> AUCs</a></li>
<li class="chapter" data-level="7.3" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#confusion-table"><i class="fa fa-check"></i><b>7.3</b> Confusion Table</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="h20.html"><a href="h20.html"><i class="fa fa-check"></i><b>8</b> h20</a>
<ul>
<li class="chapter" data-level="8.1" data-path="h20.html"><a href="h20.html#set-up"><i class="fa fa-check"></i><b>8.1</b> Set-Up</a></li>
<li class="chapter" data-level="8.2" data-path="h20.html"><a href="h20.html#eda"><i class="fa fa-check"></i><b>8.2</b> EDA</a></li>
<li class="chapter" data-level="8.3" data-path="h20.html"><a href="h20.html#models-h20"><i class="fa fa-check"></i><b>8.3</b> Models h20</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="h20.html"><a href="h20.html#random-forest"><i class="fa fa-check"></i><b>8.3.1</b> Random Forest</a></li>
<li class="chapter" data-level="8.3.2" data-path="h20.html"><a href="h20.html#gradient-boosting-machine"><i class="fa fa-check"></i><b>8.3.2</b> Gradient Boosting Machine</a></li>
<li class="chapter" data-level="8.3.3" data-path="h20.html"><a href="h20.html#automl"><i class="fa fa-check"></i><b>8.3.3</b> AutoML</a></li>
<li class="chapter" data-level="8.3.4" data-path="h20.html"><a href="h20.html#xgboost-1"><i class="fa fa-check"></i><b>8.3.4</b> XGBoost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="econometrics.html"><a href="econometrics.html"><i class="fa fa-check"></i><b>9</b> Econometrics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="econometrics.html"><a href="econometrics.html#a.-california-test-scores"><i class="fa fa-check"></i><b>9.1</b> A. California Test Scores</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="econometrics.html"><a href="econometrics.html#introduction"><i class="fa fa-check"></i><b>9.1.1</b> Introduction</a></li>
<li class="chapter" data-level="9.1.2" data-path="econometrics.html"><a href="econometrics.html#theory"><i class="fa fa-check"></i><b>9.1.2</b> Theory</a></li>
<li class="chapter" data-level="9.1.3" data-path="econometrics.html"><a href="econometrics.html#building-the-models"><i class="fa fa-check"></i><b>9.1.3</b> Building The models</a></li>
<li class="chapter" data-level="9.1.4" data-path="econometrics.html"><a href="econometrics.html#proofs"><i class="fa fa-check"></i><b>9.1.4</b> Proofs</a></li>
<li class="chapter" data-level="9.1.5" data-path="econometrics.html"><a href="econometrics.html#tests"><i class="fa fa-check"></i><b>9.1.5</b> Tests</a></li>
<li class="chapter" data-level="9.1.6" data-path="econometrics.html"><a href="econometrics.html#significances-and-tests"><i class="fa fa-check"></i><b>9.1.6</b> Significances and Tests</a></li>
<li class="chapter" data-level="9.1.7" data-path="econometrics.html"><a href="econometrics.html#conclusion"><i class="fa fa-check"></i><b>9.1.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="econometrics.html"><a href="econometrics.html#auto-correlation"><i class="fa fa-check"></i><b>9.2</b> Auto Correlation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="parrallel-processing.html"><a href="parrallel-processing.html"><i class="fa fa-check"></i><b>10</b> Parrallel Processing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="parrallel-processing.html"><a href="parrallel-processing.html#parallel-with-parlapply"><i class="fa fa-check"></i><b>10.1</b> 1. parallel with parLapply</a></li>
<li class="chapter" data-level="10.2" data-path="parrallel-processing.html"><a href="parrallel-processing.html#foreach-with-doparallel"><i class="fa fa-check"></i><b>10.2</b> 2. foreach with doParallel</a></li>
<li class="chapter" data-level="10.3" data-path="parrallel-processing.html"><a href="parrallel-processing.html#future-with-future.apply"><i class="fa fa-check"></i><b>10.3</b> 3. future with future.apply</a></li>
<li class="chapter" data-level="10.4" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-with-furrr"><i class="fa fa-check"></i><b>10.4</b> 4. purrr with furrr</a></li>
<li class="chapter" data-level="10.5" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-synchronously"><i class="fa fa-check"></i><b>10.5</b> 5. purrr Synchronously</a></li>
<li class="chapter" data-level="10.6" data-path="parrallel-processing.html"><a href="parrallel-processing.html#comparisions-1"><i class="fa fa-check"></i><b>10.6</b> comparisions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="randomforestinsight.html"><a href="randomforestinsight.html"><i class="fa fa-check"></i><b>11</b> RandomForestInsight</a></li>
<li class="chapter" data-level="12" data-path="sequential-data-embedding.html"><a href="sequential-data-embedding.html"><i class="fa fa-check"></i><b>12</b> Sequential Data Embedding</a></li>
<li class="chapter" data-level="13" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html"><i class="fa fa-check"></i><b>13</b> HCC_Survey_Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#our-data-and-purpose"><i class="fa fa-check"></i><b>13.1</b> Our data and Purpose</a></li>
<li class="chapter" data-level="13.2" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>13.2</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="13.3" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#modeling-random-forest"><i class="fa fa-check"></i><b>13.3</b> Modeling Random Forest</a></li>
<li class="chapter" data-level="13.4" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#global-importance"><i class="fa fa-check"></i><b>13.4</b> Global Importance</a></li>
<li class="chapter" data-level="13.5" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#local-importance"><i class="fa fa-check"></i><b>13.5</b> Local Importance</a></li>
<li class="chapter" data-level="13.6" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#partial-dependence-plots"><i class="fa fa-check"></i><b>13.6</b> Partial Dependence Plots</a></li>
<li class="chapter" data-level="13.7" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#random-forest-explainer"><i class="fa fa-check"></i><b>13.7</b> Random Forest Explainer</a></li>
<li class="chapter" data-level="13.8" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#final-notes"><i class="fa fa-check"></i><b>13.8</b> Final Notes</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="what-is-stacked-ensambled.html"><a href="what-is-stacked-ensambled.html"><i class="fa fa-check"></i><b>14</b> What Is Stacked Ensambled</a></li>
<li class="chapter" data-level="15" data-path="intro-econ-stats.html"><a href="intro-econ-stats.html"><i class="fa fa-check"></i><b>15</b> Intro Econ Stats</a></li>
<li class="chapter" data-level="16" data-path="nfl.html"><a href="nfl.html"><i class="fa fa-check"></i><b>16</b> NFL</a>
<ul>
<li class="chapter" data-level="16.1" data-path="nfl.html"><a href="nfl.html#wbs"><i class="fa fa-check"></i><b>16.1</b> WBs</a></li>
<li class="chapter" data-level="16.2" data-path="nfl.html"><a href="nfl.html#rbs"><i class="fa fa-check"></i><b>16.2</b> RBs</a></li>
<li class="chapter" data-level="16.3" data-path="nfl.html"><a href="nfl.html#qbs"><i class="fa fa-check"></i><b>16.3</b> QBs</a></li>
<li class="chapter" data-level="16.4" data-path="nfl.html"><a href="nfl.html#plots-and-analysis"><i class="fa fa-check"></i><b>16.4</b> Plots and Analysis</a></li>
<li class="chapter" data-level="16.5" data-path="nfl.html"><a href="nfl.html#lists-to-do"><i class="fa fa-check"></i><b>16.5</b> Lists to do</a></li>
<li class="chapter" data-level="16.6" data-path="nfl.html"><a href="nfl.html#team-mates"><i class="fa fa-check"></i><b>16.6</b> team mates</a></li>
<li class="chapter" data-level="16.7" data-path="nfl.html"><a href="nfl.html#testing"><i class="fa fa-check"></i><b>16.7</b> Testing</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning Applications</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="nfl" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">Chapter 16</span> NFL<a href="nfl.html#nfl" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="wbs" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> WBs<a href="nfl.html#wbs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="nfl.html#cb470-1" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb470-2"><a href="nfl.html#cb470-2" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb470-3"><a href="nfl.html#cb470-3" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb470-4"><a href="nfl.html#cb470-4" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb470-5"><a href="nfl.html#cb470-5" tabindex="-1"></a><span class="fu">library</span>(pdp)</span>
<span id="cb470-6"><a href="nfl.html#cb470-6" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="nfl.html#cb471-1" tabindex="-1"></a><span class="co"># Load the offensive yearly data</span></span>
<span id="cb471-2"><a href="nfl.html#cb471-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;offense_yearly_data.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 5453 Columns: 76
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (5): name, height_ft, position, team, season_type
## dbl (71): id, height_cm, season, completions, attempts, passing_yards, passi...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="nfl.html#cb473-1" tabindex="-1"></a><span class="co"># Sort the dataset by player name and season</span></span>
<span id="cb473-2"><a href="nfl.html#cb473-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[<span class="fu">order</span>(data<span class="sc">$</span>name, data<span class="sc">$</span>season), ]</span></code></pre></div>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="nfl.html#cb474-1" tabindex="-1"></a><span class="fu">names</span>(data)[<span class="fu">names</span>(data) <span class="sc">==</span> <span class="st">&quot;height_cm&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;height_in&quot;</span></span>
<span id="cb474-2"><a href="nfl.html#cb474-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[, <span class="sc">!</span><span class="fu">names</span>(data) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;height_ft&quot;</span>)]</span></code></pre></div>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="nfl.html#cb475-1" tabindex="-1"></a><span class="co"># Split the dataset by position</span></span>
<span id="cb475-2"><a href="nfl.html#cb475-2" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">split</span>(data, data<span class="sc">$</span>position)</span>
<span id="cb475-3"><a href="nfl.html#cb475-3" tabindex="-1"></a></span>
<span id="cb475-4"><a href="nfl.html#cb475-4" tabindex="-1"></a><span class="co"># Access the WR data</span></span>
<span id="cb475-5"><a href="nfl.html#cb475-5" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>WR</span></code></pre></div>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="nfl.html#cb476-1" tabindex="-1"></a><span class="co"># Identify zero-variance columns</span></span>
<span id="cb476-2"><a href="nfl.html#cb476-2" tabindex="-1"></a>zero_var_cols <span class="ot">&lt;-</span> <span class="fu">nearZeroVar</span>(wr_data)</span>
<span id="cb476-3"><a href="nfl.html#cb476-3" tabindex="-1"></a></span>
<span id="cb476-4"><a href="nfl.html#cb476-4" tabindex="-1"></a><span class="co"># Check and remove zero-variance columns, excluding &#39;position&#39;</span></span>
<span id="cb476-5"><a href="nfl.html#cb476-5" tabindex="-1"></a>zero_var_colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(wr_data)[zero_var_cols]</span>
<span id="cb476-6"><a href="nfl.html#cb476-6" tabindex="-1"></a>cols_to_keep <span class="ot">&lt;-</span> <span class="fu">names</span>(wr_data)[<span class="sc">!</span>(<span class="fu">names</span>(wr_data) <span class="sc">%in%</span> zero_var_colnames) <span class="sc">|</span> <span class="fu">names</span>(wr_data) <span class="sc">==</span> <span class="st">&quot;position&quot;</span>]</span>
<span id="cb476-7"><a href="nfl.html#cb476-7" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> wr_data[, cols_to_keep]</span></code></pre></div>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="nfl.html#cb477-1" tabindex="-1"></a><span class="co"># Filter the data for the 2023 season to save it before we kill it</span></span>
<span id="cb477-2"><a href="nfl.html#cb477-2" tabindex="-1"></a>wr_2023 <span class="ot">&lt;-</span> <span class="fu">subset</span>(wr_data, season <span class="sc">==</span> <span class="dv">2023</span>)</span></code></pre></div>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="nfl.html#cb478-1" tabindex="-1"></a><span class="co"># Create new columns for the next season&#39;s fantasy points</span></span>
<span id="cb478-2"><a href="nfl.html#cb478-2" tabindex="-1"></a>wr_data<span class="sc">$</span>next_fantasy_points <span class="ot">&lt;-</span> <span class="fu">ave</span>(wr_data<span class="sc">$</span>fantasy_points, wr_data<span class="sc">$</span>name, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">NA</span>))</span>
<span id="cb478-3"><a href="nfl.html#cb478-3" tabindex="-1"></a>wr_data<span class="sc">$</span>next_fantasy_points_ppr <span class="ot">&lt;-</span> <span class="fu">ave</span>(wr_data<span class="sc">$</span>fantasy_points_ppr, wr_data<span class="sc">$</span>name, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">NA</span>))</span>
<span id="cb478-4"><a href="nfl.html#cb478-4" tabindex="-1"></a></span>
<span id="cb478-5"><a href="nfl.html#cb478-5" tabindex="-1"></a><span class="co"># View the first few rows of the updated data</span></span>
<span id="cb478-6"><a href="nfl.html#cb478-6" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 75
##      id name    height_in position team  season season_type completions attempts
##   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;    &lt;dbl&gt;
## 1     1 A.J. B…        73 WR       TEN     2019 REG                   0        0
## 2     1 A.J. B…        72 WR       TEN     2020 REG                   0        0
## 3     1 A.J. B…        73 WR       TEN     2021 REG                   0        2
## 4     1 A.J. B…        73 WR       PHI     2022 REG                   0        0
## 5     1 A.J. B…        73 WR       PHI     2023 REG                   0        0
## 6     2 A.J. D…        77 TE       DEN     2016 REG                   0        0
## # ℹ 66 more variables: passing_yards &lt;dbl&gt;, passing_tds &lt;dbl&gt;,
## #   interceptions &lt;dbl&gt;, sacks &lt;dbl&gt;, sack_yards &lt;dbl&gt;, sack_fumbles &lt;dbl&gt;,
## #   sack_fumbles_lost &lt;dbl&gt;, passing_air_yards &lt;dbl&gt;,
## #   passing_yards_after_catch &lt;dbl&gt;, passing_first_downs &lt;dbl&gt;,
## #   passing_2pt_conversions &lt;dbl&gt;, carries &lt;dbl&gt;, rushing_yards &lt;dbl&gt;,
## #   rushing_tds &lt;dbl&gt;, rushing_fumbles &lt;dbl&gt;, rushing_fumbles_lost &lt;dbl&gt;,
## #   rushing_first_downs &lt;dbl&gt;, rushing_2pt_conversions &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="nfl.html#cb480-1" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> wr_data[wr_data<span class="sc">$</span>rookie_season <span class="sc">!=</span> <span class="dv">0</span>, ]</span></code></pre></div>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="nfl.html#cb481-1" tabindex="-1"></a><span class="co"># Count the number of NA values in each column</span></span>
<span id="cb481-2"><a href="nfl.html#cb481-2" tabindex="-1"></a>na_table <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(wr_data))</span>
<span id="cb481-3"><a href="nfl.html#cb481-3" tabindex="-1"></a><span class="fu">print</span>(na_table)</span></code></pre></div>
<pre><code>##                          id                        name 
##                           0                           0 
##                   height_in                    position 
##                           0                           0 
##                        team                      season 
##                           0                           0 
##                    attempts                     carries 
##                           0                           0 
##         rushing_first_downs                  receptions 
##                           0                           0 
##                     targets             receiving_yards 
##                           0                           0 
##               receiving_tds           receiving_fumbles 
##                           0                           0 
##      receiving_fumbles_lost         receiving_air_yards 
##                           0                           0 
## receiving_yards_after_catch       receiving_first_downs 
##                           0                           0 
##   receiving_2pt_conversions                target_share 
##                           0                           0 
##             air_yards_share              fantasy_points 
##                           0                           0 
##          fantasy_points_ppr                 total_yards 
##                           0                           0 
##                       games               offense_snaps 
##                           0                           0 
##         teams_offense_snaps                         ypc 
##                           0                           0 
##                         ypr                     touches 
##                           0                           0 
##           rec_td_percentage                   total_tds 
##                           0                           0 
##               td_percentage                 offense_pct 
##                           0                          77 
##                    rush_ypg                     rec_ypg 
##                           0                           0 
##                         ppg                     ppr_ppg 
##                           0                           0 
##                         yps                         ypg 
##                           4                           0 
##               rookie_season                       round 
##                           0                           0 
##                       forty                       bench 
##                           0                           0 
##                    vertical                years_played 
##                           0                           0 
##                       fp_ps                   ppr_fp_ps 
##                           2                           2 
##         next_fantasy_points     next_fantasy_points_ppr 
##                         675                         675</code></pre>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="nfl.html#cb483-1" tabindex="-1"></a><span class="co"># For now, remove all rows with NAs</span></span>
<span id="cb483-2"><a href="nfl.html#cb483-2" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(wr_data)</span>
<span id="cb483-3"><a href="nfl.html#cb483-3" tabindex="-1"></a></span>
<span id="cb483-4"><a href="nfl.html#cb483-4" tabindex="-1"></a><span class="co"># Drop the next_fantasy_points_ppr column</span></span>
<span id="cb483-5"><a href="nfl.html#cb483-5" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> wr_data[, <span class="sc">!</span><span class="fu">names</span>(wr_data) <span class="sc">%in%</span> <span class="st">&quot;next_fantasy_points_ppr&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="nfl.html#cb484-1" tabindex="-1"></a><span class="co"># Build Random Forest model</span></span>
<span id="cb484-2"><a href="nfl.html#cb484-2" tabindex="-1"></a>wrrf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(next_fantasy_points <span class="sc">~</span> ., <span class="at">data =</span> wr_data, <span class="at">ntree =</span> <span class="dv">500</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="nfl.html#cb485-1" tabindex="-1"></a><span class="co"># Create a simplified dataset for linear regression</span></span>
<span id="cb485-2"><a href="nfl.html#cb485-2" tabindex="-1"></a>lm_data <span class="ot">&lt;-</span> wr_data[, <span class="sc">!</span><span class="fu">names</span>(wr_data) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;id&quot;</span>, <span class="st">&quot;position&quot;</span>)]</span>
<span id="cb485-3"><a href="nfl.html#cb485-3" tabindex="-1"></a></span>
<span id="cb485-4"><a href="nfl.html#cb485-4" tabindex="-1"></a></span>
<span id="cb485-5"><a href="nfl.html#cb485-5" tabindex="-1"></a><span class="co"># Initialize a vector to store RMSPE values for each run</span></span>
<span id="cb485-6"><a href="nfl.html#cb485-6" tabindex="-1"></a>rmspe <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb485-7"><a href="nfl.html#cb485-7" tabindex="-1"></a></span>
<span id="cb485-8"><a href="nfl.html#cb485-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb485-9"><a href="nfl.html#cb485-9" tabindex="-1"></a>  </span>
<span id="cb485-10"><a href="nfl.html#cb485-10" tabindex="-1"></a>  <span class="co"># Resample the dataset with replacement</span></span>
<span id="cb485-11"><a href="nfl.html#cb485-11" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(lm_data), <span class="fu">nrow</span>(lm_data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb485-12"><a href="nfl.html#cb485-12" tabindex="-1"></a>  train <span class="ot">&lt;-</span> lm_data[ind, ]</span>
<span id="cb485-13"><a href="nfl.html#cb485-13" tabindex="-1"></a>  test <span class="ot">&lt;-</span> lm_data[<span class="sc">-</span>ind, ]</span>
<span id="cb485-14"><a href="nfl.html#cb485-14" tabindex="-1"></a>  </span>
<span id="cb485-15"><a href="nfl.html#cb485-15" tabindex="-1"></a>  <span class="co"># Build Linear Regression model</span></span>
<span id="cb485-16"><a href="nfl.html#cb485-16" tabindex="-1"></a>  lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(next_fantasy_points <span class="sc">~</span> ., <span class="at">data =</span> train)</span>
<span id="cb485-17"><a href="nfl.html#cb485-17" tabindex="-1"></a>  </span>
<span id="cb485-18"><a href="nfl.html#cb485-18" tabindex="-1"></a>  <span class="co"># Predict on the test data</span></span>
<span id="cb485-19"><a href="nfl.html#cb485-19" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_model, <span class="at">newdata =</span> test)</span>
<span id="cb485-20"><a href="nfl.html#cb485-20" tabindex="-1"></a>  </span>
<span id="cb485-21"><a href="nfl.html#cb485-21" tabindex="-1"></a>  <span class="co"># Calculate RMSPE</span></span>
<span id="cb485-22"><a href="nfl.html#cb485-22" tabindex="-1"></a>  rmspe[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test<span class="sc">$</span>next_fantasy_points <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb485-23"><a href="nfl.html#cb485-23" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases</code></pre>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="nfl.html#cb487-1" tabindex="-1"></a><span class="co"># Calculate the mean RMSPE over the 10 runs</span></span>
<span id="cb487-2"><a href="nfl.html#cb487-2" tabindex="-1"></a>mean_rmspe <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe)</span>
<span id="cb487-3"><a href="nfl.html#cb487-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE over 10 runs:&quot;</span>, mean_rmspe))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE over 10 runs: 41.3810107307706&quot;</code></pre>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="nfl.html#cb489-1" tabindex="-1"></a><span class="co"># Optionally, print the RMSPE for each run to see variability</span></span>
<span id="cb489-2"><a href="nfl.html#cb489-2" tabindex="-1"></a><span class="fu">print</span>(rmspe)</span></code></pre></div>
<pre><code>##  [1] 42.86088 40.23122 39.88330 41.61438 39.93325 39.26592 39.48694 46.47567
##  [9] 41.58921 42.46933</code></pre>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="nfl.html#cb491-1" tabindex="-1"></a><span class="co"># Evaluate feature importance</span></span>
<span id="cb491-2"><a href="nfl.html#cb491-2" tabindex="-1"></a>importance_values <span class="ot">&lt;-</span> <span class="fu">importance</span>(wrrf_model)</span>
<span id="cb491-3"><a href="nfl.html#cb491-3" tabindex="-1"></a></span>
<span id="cb491-4"><a href="nfl.html#cb491-4" tabindex="-1"></a><span class="co"># Sort and extract the top 10 features by %IncMSE and IncNodePurity</span></span>
<span id="cb491-5"><a href="nfl.html#cb491-5" tabindex="-1"></a>top10_mse <span class="ot">&lt;-</span> importance_values[<span class="fu">order</span>(importance_values[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb491-6"><a href="nfl.html#cb491-6" tabindex="-1"></a>top10_purity <span class="ot">&lt;-</span> importance_values[<span class="fu">order</span>(importance_values[, <span class="st">&quot;IncNodePurity&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb491-7"><a href="nfl.html#cb491-7" tabindex="-1"></a></span>
<span id="cb491-8"><a href="nfl.html#cb491-8" tabindex="-1"></a><span class="co"># Visualize top 10 features by %IncMSE</span></span>
<span id="cb491-9"><a href="nfl.html#cb491-9" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">2</span>))  <span class="co"># Increase margins for labels</span></span>
<span id="cb491-10"><a href="nfl.html#cb491-10" tabindex="-1"></a><span class="fu">barplot</span>(top10_mse[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_mse),</span>
<span id="cb491-11"><a href="nfl.html#cb491-11" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by %IncMSE (Mean Decrease in Accuracy)&quot;</span>,</span>
<span id="cb491-12"><a href="nfl.html#cb491-12" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-210-1.png" width="672" /></p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="nfl.html#cb492-1" tabindex="-1"></a><span class="co"># Visualize top 10 features by IncNodePurity</span></span>
<span id="cb492-2"><a href="nfl.html#cb492-2" tabindex="-1"></a><span class="fu">barplot</span>(top10_purity[, <span class="st">&quot;IncNodePurity&quot;</span>], <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_purity),</span>
<span id="cb492-3"><a href="nfl.html#cb492-3" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by IncNodePurity (Mean Decrease in Gini)&quot;</span>,</span>
<span id="cb492-4"><a href="nfl.html#cb492-4" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-210-2.png" width="672" /></p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="nfl.html#cb493-1" tabindex="-1"></a>oob_mse <span class="ot">&lt;-</span> wrrf_model<span class="sc">$</span>mse[wrrf_model<span class="sc">$</span>ntree]</span>
<span id="cb493-2"><a href="nfl.html#cb493-2" tabindex="-1"></a>oobrmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(oob_mse)</span>
<span id="cb493-3"><a href="nfl.html#cb493-3" tabindex="-1"></a><span class="co"># Print the OOB MSE</span></span>
<span id="cb493-4"><a href="nfl.html#cb493-4" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;OOB rMSE:&quot;</span>, oobrmse))</span></code></pre></div>
<pre><code>## [1] &quot;OOB rMSE: 41.0136385880389&quot;</code></pre>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="nfl.html#cb495-1" tabindex="-1"></a><span class="co"># Extract OOB predictions</span></span>
<span id="cb495-2"><a href="nfl.html#cb495-2" tabindex="-1"></a>oob_predictions <span class="ot">&lt;-</span> wrrf_model<span class="sc">$</span>predicted</span>
<span id="cb495-3"><a href="nfl.html#cb495-3" tabindex="-1"></a></span>
<span id="cb495-4"><a href="nfl.html#cb495-4" tabindex="-1"></a><span class="co"># Calculate the absolute errors</span></span>
<span id="cb495-5"><a href="nfl.html#cb495-5" tabindex="-1"></a>absolute_errors <span class="ot">&lt;-</span> <span class="fu">abs</span>(oob_predictions <span class="sc">-</span> wrrf_model<span class="sc">$</span>y)</span>
<span id="cb495-6"><a href="nfl.html#cb495-6" tabindex="-1"></a></span>
<span id="cb495-7"><a href="nfl.html#cb495-7" tabindex="-1"></a><span class="co"># Calculate the Mean Absolute Error (MAE)</span></span>
<span id="cb495-8"><a href="nfl.html#cb495-8" tabindex="-1"></a>oob_mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(absolute_errors)</span>
<span id="cb495-9"><a href="nfl.html#cb495-9" tabindex="-1"></a></span>
<span id="cb495-10"><a href="nfl.html#cb495-10" tabindex="-1"></a><span class="co"># Print the OOB MAE</span></span>
<span id="cb495-11"><a href="nfl.html#cb495-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;OOB MAE:&quot;</span>, oob_mae))</span></code></pre></div>
<pre><code>## [1] &quot;OOB MAE: 31.1016458934681&quot;</code></pre>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="nfl.html#cb497-1" tabindex="-1"></a><span class="co"># Predict 2024 fantasy points for 2023 WRs</span></span>
<span id="cb497-2"><a href="nfl.html#cb497-2" tabindex="-1"></a>predicted_2024_fantasy_points <span class="ot">&lt;-</span> <span class="fu">predict</span>(wrrf_model, <span class="at">newdata =</span> wr_2023)</span>
<span id="cb497-3"><a href="nfl.html#cb497-3" tabindex="-1"></a></span>
<span id="cb497-4"><a href="nfl.html#cb497-4" tabindex="-1"></a><span class="co"># Create a data frame with the names and the predicted 2024 fantasy points</span></span>
<span id="cb497-5"><a href="nfl.html#cb497-5" tabindex="-1"></a>results_wr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> wr_2023<span class="sc">$</span>name, <span class="at">predicted_2024_fantasy_points =</span> predicted_2024_fantasy_points)</span>
<span id="cb497-6"><a href="nfl.html#cb497-6" tabindex="-1"></a><span class="fu">print</span>(results_wr)</span></code></pre></div>
<pre><code>##                         name predicted_2024_fantasy_points
## 1                 A.J. Brown                     158.45374
## 2                 A.T. Perry                      46.98033
## 3               Adam Thielen                     124.95694
## 4                Alec Pierce                      68.77777
## 5              Alex Erickson                      36.21638
## 6               Allen Lazard                      46.50182
## 7             Allen Robinson                      47.73667
## 8               Amari Cooper                     131.86314
## 9              Amari Rodgers                      26.28798
## 10         Amon-Ra St. Brown                     191.46057
## 11            Andrei Iosivas                      39.76441
## 12             Antoine Green                      23.44094
## 13           Austin Trammell                      18.70520
## 14             Ben Skowronek                      19.05888
## 15                 Bo Melton                      66.26192
## 16             Brandin Cooks                     107.72528
## 17             Brandon Aiyuk                     146.09899
## 18           Brandon Johnson                      44.25428
## 19            Brandon Powell                      42.75481
## 20           Braxton Berrios                      39.57019
## 21             Britain Covey                      16.38348
## 22             Byron Pringle                      29.09906
## 23             Calvin Austin                      37.07823
## 24             Calvin Ridley                     129.37458
## 25            Cedric Tillman                      44.77454
## 26               CeeDee Lamb                     178.42080
## 27             Charlie Jones                      24.52458
## 28            Chase Claypool                      13.44951
## 29              Chris Conley                      54.77228
## 30              Chris Godwin                     116.59863
## 31               Chris Moore                      40.81207
## 32               Chris Olave                     140.68480
## 33            Christian Kirk                      94.48912
## 34          Christian Watson                      79.16359
## 35             Cody Thompson                      13.46552
## 36            Collin Johnson                      11.60196
## 37             Colton Dowell                      17.63330
## 38               Cooper Kupp                     108.18179
## 39          Courtland Sutton                     106.16625
## 40             Curtis Samuel                      70.29533
## 41          D&#39;Wayne Eskridge                      16.81773
## 42                D.J. Chark                            NA
## 43           D.J. Montgomery                      21.68741
## 44                D.J. Moore                     147.79211
## 45            Darius Slayton                      71.65614
## 46            Darnell Mooney                      54.48127
## 47             Davante Adams                     137.07375
## 48                David Bell                      34.92270
## 49               David Moore                      15.66785
## 50            DeAndre Carter                      18.94561
## 51           DeAndre Hopkins                     118.90245
## 52              Deebo Samuel                     128.11221
## 53         Demarcus Robinson                      55.84088
## 54           Demario Douglas                      69.68733
## 55              Deonte Harty                      22.67475
## 56              Derius Davis                      33.21416
## 57            DeVante Parker                      39.42930
## 58           Deven Thompkins                      24.45811
## 59            Devin Duvernay                      17.36587
## 60             DeVonta Smith                     132.16115
## 61           Diontae Johnson                     102.36024
## 62                DK Metcalf                            NA
## 63     Donovan Peoples-Jones                      14.79269
## 64          Dontayvion Wicks                      61.94750
## 65              Drake London                      99.63021
## 66               Dyami Brown                      33.08390
## 67              Elijah Cooks                      15.59058
## 68              Elijah Moore                      79.96089
## 69     Equanimeous St. Brown                      13.00758
## 70             Erik Ezukanma                      19.90174
## 71                Gabe Davis                            NA
## 72            Garrett Wilson                     126.36224
## 73            George Pickens                     119.40340
## 74               Greg Dortch                      43.35514
## 75          Gunner Olszewski                      22.09867
## 76            Hunter Renfrow                      40.32242
## 77      Ihmir Smith-Marsette                      26.83223
## 78             Irvin Charles                      17.05696
## 79            Isaiah Hodgins                      38.72475
## 80           Isaiah McKenzie                      26.47391
## 81             Ja&#39;Marr Chase                     136.88921
## 82              Jahan Dotson                      55.74635
## 83                 Jake Bobo                      36.70905
## 84             Jakobi Meyers                     117.90660
## 85              Jalen Brooks                      24.20460
## 86              Jalen Guyton                      19.92515
## 87              Jalen Nailor                      16.68614
## 88              Jalen Reagor                      26.19103
## 89             Jalen Tolbert                      43.54475
## 90               Jalin Hyatt                      59.36283
## 91               Jamal Agnew                      33.10912
## 92              James Proche                      30.56557
## 93          Jameson Williams                      50.67995
## 94           Jamison Crowder                      32.64889
## 95            Jason Brownlee                      26.17210
## 96            Jauan Jennings                      35.18360
## 97        Jaxon Smith-Njigba                      73.66326
## 98               Jayden Reed                     130.41729
## 99             Jaylen Waddle                     131.01759
## 100              Jerry Jeudy                      75.48801
## 101           Jonathan Mingo                      81.77836
## 102           Jordan Addison                     122.30508
## 103               Josh Downs                      86.53400
## 104              Josh Palmer                      80.52307
## 105            Josh Reynolds                      51.50464
## 106      JuJu Smith-Schuster                      41.62285
## 107              Julio Jones                      22.27734
## 108         Justin Jefferson                     140.28859
## 109            Justin Watson                      59.12881
## 110              Justyn Ross                      16.03790
## 111           Juwann Winfree                      15.22209
## 112              K.J. Osborn                      46.32797
## 113           Kadarius Toney                      44.20388
## 114            Kalif Raymond                      52.16240
## 115           Kayshon Boutte                      21.17600
## 116              Keelan Doss                      19.44566
## 117             Keenan Allen                     151.40707
## 118           Keith Kirkwood                      13.54516
## 119          Kendrick Bourne                      65.40660
## 120           KhaDarel Hodge                      32.66039
## 121            Khalil Shakir                      64.91994
## 122          Kwamie Lassiter                            NA
## 123             Kyle Philips                      27.24527
## 124         Laquon Treadwell                      20.44431
## 125         Laviska Shenault                            NA
## 126      Lil&#39;Jordan Humphrey                      34.63423
## 127              Lynn Bowden                            NA
## 128             Mack Hollins                      33.64196
## 129              Malik Heath                      31.86248
## 130             Malik Taylor                      11.45799
## 131 Marquez Valdes-Scantling                      48.29091
## 132           Marquise Brown                      76.59450
## 133         Marquise Goodwin                      25.12094
## 134             Marvin Jones                      15.00472
## 135              Marvin Mims                      58.58277
## 136             Mason Kinsey                      16.65310
## 137           Mecole Hardman                      28.69464
## 138           Michael Gallup                      39.49602
## 139          Michael Pittman                            NA
## 140           Michael Thomas                      47.17063
## 141           Michael Wilson                      75.01664
## 142               Mike Evans                     137.53211
## 143            Mike Strachan                      19.72002
## 144            Mike Williams                      70.02213
## 145             Miles Boykin                      11.50276
## 146           Nelson Agholor                      44.03776
## 147    Nick Westbrook-Ikhine                      41.92132
## 148             Nico Collins                     144.81428
## 149               Noah Brown                      65.33498
## 150        Olamide Zaccheaus                      30.22371
## 151        Parker Washington                      29.45832
## 152          Parris Campbell                      25.03521
## 153          Phillip Dorsett                      25.38451
## 154               Puka Nacua                     177.88186
## 155         Quentin Johnston                      59.37848
## 156             Quez Watkins                      33.41007
## 157            Rakim Jarrett                      19.98260
## 158             Randall Cobb                      24.41586
## 159              Rashee Rice                     100.68511
## 160           Rashid Shaheed                      87.59368
## 161           Rashod Bateman                      58.97460
## 162          Ray-Ray McCloud                      23.30915
## 163             Richie James                      23.15227
## 164           River Cracraft                      15.36569
## 165            Robbie Chosen                      19.97650
## 166             Robert Woods                      51.73724
## 167              Romeo Doubs                      80.02505
## 168            Rondale Moore                      56.61910
## 169              Ronnie Bell                      31.29796
## 170             Samori Toure                      21.76577
## 171             Scott Miller                      30.93037
## 172         Shedrick Jackson                      18.44799
## 173              Simi Fehoko                      18.43777
## 174               Skyy Moore                      34.11112
## 175             Stefon Diggs                     136.06008
## 176         Sterling Shepard                      25.60539
## 177              Steven Sims                      17.01397
## 178                Tank Dell                     131.24927
## 179              Tee Higgins                      87.99714
## 180         Terrace Marshall                            NA
## 181           Terry McLaurin                     108.34191
## 182                Tim Jones                      31.20877
## 183               Tre Tucker                      59.63487
## 184          Trent Sherfield                      20.57037
## 185             Trent Taylor                      19.45240
## 186            Trenton Irwin                      34.80355
## 187              Trey Palmer                      62.84441
## 188            Treylon Burks                      52.32640
## 189         Trishton Jackson                      15.53072
## 190              Tutu Atwell                      56.67214
## 191            Ty Montgomery                      15.31157
## 192            Tylan Wallace                      14.89528
## 193               Tyler Boyd                      58.06943
## 194            Tyler Johnson                      19.57512
## 195            Tyler Lockett                      92.65408
## 196              Tyler Scott                      35.43359
## 197          Tyquan Thornton                      25.36256
## 198              Tyreek Hill                     194.43879
## 199            Van Jefferson                      41.56438
## 200              Velus Jones                            NA
## 201        Wan&#39;Dale Robinson                      67.81444
## 202             Willie Snead                      12.65379
## 203            Xavier Gipson                      44.94178
## 204        Xavier Hutchinson                      35.47533
## 205              Zach Pascal                      24.39360
## 206              Zay Flowers                     113.21412
## 207                Zay Jones                      60.16770</code></pre>
<p>mse of specific seasons?
we need to factor in the qbs and teamates of the players</p>
</div>
<div id="rbs" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> RBs<a href="nfl.html#rbs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="nfl.html#cb499-1" tabindex="-1"></a><span class="co"># Access the RB data</span></span>
<span id="cb499-2"><a href="nfl.html#cb499-2" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>RB</span></code></pre></div>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="nfl.html#cb500-1" tabindex="-1"></a><span class="co"># Identify zero-variance columns</span></span>
<span id="cb500-2"><a href="nfl.html#cb500-2" tabindex="-1"></a>zero_var_cols <span class="ot">&lt;-</span> <span class="fu">nearZeroVar</span>(rb_data)</span>
<span id="cb500-3"><a href="nfl.html#cb500-3" tabindex="-1"></a></span>
<span id="cb500-4"><a href="nfl.html#cb500-4" tabindex="-1"></a><span class="co"># Check and remove zero-variance columns, excluding &#39;position&#39;</span></span>
<span id="cb500-5"><a href="nfl.html#cb500-5" tabindex="-1"></a>zero_var_colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(rb_data)[zero_var_cols]</span>
<span id="cb500-6"><a href="nfl.html#cb500-6" tabindex="-1"></a>cols_to_keep <span class="ot">&lt;-</span> <span class="fu">names</span>(rb_data)[<span class="sc">!</span>(<span class="fu">names</span>(rb_data) <span class="sc">%in%</span> zero_var_colnames) <span class="sc">|</span> <span class="fu">names</span>(rb_data) <span class="sc">==</span> <span class="st">&quot;position&quot;</span>]</span>
<span id="cb500-7"><a href="nfl.html#cb500-7" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> rb_data[, cols_to_keep]</span>
<span id="cb500-8"><a href="nfl.html#cb500-8" tabindex="-1"></a></span>
<span id="cb500-9"><a href="nfl.html#cb500-9" tabindex="-1"></a>rb_2023 <span class="ot">&lt;-</span> <span class="fu">subset</span>(rb_data, season <span class="sc">==</span> <span class="dv">2023</span>)</span></code></pre></div>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="nfl.html#cb501-1" tabindex="-1"></a><span class="co"># Create new columns for the next season&#39;s fantasy points</span></span>
<span id="cb501-2"><a href="nfl.html#cb501-2" tabindex="-1"></a>rb_data<span class="sc">$</span>next_fantasy_points <span class="ot">&lt;-</span> <span class="fu">ave</span>(rb_data<span class="sc">$</span>fantasy_points, rb_data<span class="sc">$</span>name, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">NA</span>))</span>
<span id="cb501-3"><a href="nfl.html#cb501-3" tabindex="-1"></a>rb_data<span class="sc">$</span>next_fantasy_points_ppr <span class="ot">&lt;-</span> <span class="fu">ave</span>(rb_data<span class="sc">$</span>fantasy_points_ppr, rb_data<span class="sc">$</span>name, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">NA</span>))</span>
<span id="cb501-4"><a href="nfl.html#cb501-4" tabindex="-1"></a></span>
<span id="cb501-5"><a href="nfl.html#cb501-5" tabindex="-1"></a><span class="co"># View the first few rows of the updated data</span></span>
<span id="cb501-6"><a href="nfl.html#cb501-6" tabindex="-1"></a><span class="fu">head</span>(rb_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 55
##      id name   height_in position team  season carries rushing_yards rushing_tds
##   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;
## 1     3 A.J. …        72 RB       GB      2020      46           242           2
## 2     3 A.J. …        72 RB       GB      2021     187           803           5
## 3     3 A.J. …        72 RB       GB      2022     186           770           7
## 4    10 Aaron…        69 RB       GB      2017      81           448           4
## 5    10 Aaron…        69 RB       GB      2018     133           728           8
## 6    10 Aaron…        69 RB       GB      2019     236          1084          16
## # ℹ 46 more variables: rushing_fumbles &lt;dbl&gt;, rushing_fumbles_lost &lt;dbl&gt;,
## #   rushing_first_downs &lt;dbl&gt;, rushing_2pt_conversions &lt;dbl&gt;, receptions &lt;dbl&gt;,
## #   targets &lt;dbl&gt;, receiving_yards &lt;dbl&gt;, receiving_tds &lt;dbl&gt;,
## #   receiving_fumbles &lt;dbl&gt;, receiving_fumbles_lost &lt;dbl&gt;,
## #   receiving_air_yards &lt;dbl&gt;, receiving_yards_after_catch &lt;dbl&gt;,
## #   receiving_first_downs &lt;dbl&gt;, target_share &lt;dbl&gt;, air_yards_share &lt;dbl&gt;,
## #   fantasy_points &lt;dbl&gt;, fantasy_points_ppr &lt;dbl&gt;, total_yards &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="nfl.html#cb503-1" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> rb_data[rb_data<span class="sc">$</span>rookie_season <span class="sc">!=</span> <span class="dv">0</span>, ]</span></code></pre></div>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="nfl.html#cb504-1" tabindex="-1"></a><span class="co"># Count the number of NA values in each column</span></span>
<span id="cb504-2"><a href="nfl.html#cb504-2" tabindex="-1"></a>na_table <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">is.na</span>(rb_data))</span>
<span id="cb504-3"><a href="nfl.html#cb504-3" tabindex="-1"></a><span class="fu">print</span>(na_table)</span></code></pre></div>
<pre><code>##                          id                        name 
##                           0                           0 
##                   height_in                    position 
##                           0                           0 
##                        team                      season 
##                           0                           0 
##                     carries               rushing_yards 
##                           0                           0 
##                 rushing_tds             rushing_fumbles 
##                           0                           0 
##        rushing_fumbles_lost         rushing_first_downs 
##                           0                           0 
##     rushing_2pt_conversions                  receptions 
##                           0                           0 
##                     targets             receiving_yards 
##                           0                           0 
##               receiving_tds           receiving_fumbles 
##                           0                           0 
##      receiving_fumbles_lost         receiving_air_yards 
##                           0                           0 
## receiving_yards_after_catch       receiving_first_downs 
##                           0                           0 
##                target_share             air_yards_share 
##                           0                           0 
##              fantasy_points          fantasy_points_ppr 
##                           0                           0 
##                 total_yards                       games 
##                           0                           0 
##               offense_snaps         teams_offense_snaps 
##                           0                           0 
##                         ypc                         ypr 
##                           0                           0 
##                     touches          rush_td_percentage 
##                           0                           0 
##           rec_td_percentage                   total_tds 
##                           0                           0 
##               td_percentage                 offense_pct 
##                           0                          50 
##                    rush_ypg                     rec_ypg 
##                           0                           0 
##                         ppg                     ppr_ppg 
##                           0                           0 
##                         yps                         ypg 
##                           0                           0 
##               rookie_season                       round 
##                           0                           0 
##                     overall                       forty 
##                           0                           0 
##                       bench                    vertical 
##                           0                           0 
##                years_played                       fp_ps 
##                           0                           0 
##                   ppr_fp_ps         next_fantasy_points 
##                           0                         429 
##     next_fantasy_points_ppr 
##                         429</code></pre>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="nfl.html#cb506-1" tabindex="-1"></a><span class="co"># For now, remove all rows with NAs</span></span>
<span id="cb506-2"><a href="nfl.html#cb506-2" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(rb_data)</span>
<span id="cb506-3"><a href="nfl.html#cb506-3" tabindex="-1"></a></span>
<span id="cb506-4"><a href="nfl.html#cb506-4" tabindex="-1"></a><span class="co"># Drop the next_fantasy_points_ppr column</span></span>
<span id="cb506-5"><a href="nfl.html#cb506-5" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> rb_data[, <span class="sc">!</span><span class="fu">names</span>(rb_data) <span class="sc">%in%</span> <span class="st">&quot;next_fantasy_points_ppr&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="nfl.html#cb507-1" tabindex="-1"></a><span class="co"># Build Random Forest model</span></span>
<span id="cb507-2"><a href="nfl.html#cb507-2" tabindex="-1"></a>rbrf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(next_fantasy_points <span class="sc">~</span> ., <span class="at">data =</span> rb_data, <span class="at">ntree =</span> <span class="dv">500</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="nfl.html#cb508-1" tabindex="-1"></a><span class="co"># Create a simplified dataset for linear regression</span></span>
<span id="cb508-2"><a href="nfl.html#cb508-2" tabindex="-1"></a>lm_data <span class="ot">&lt;-</span> rb_data[, <span class="sc">!</span><span class="fu">names</span>(rb_data) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;id&quot;</span>, <span class="st">&quot;position&quot;</span>)]</span>
<span id="cb508-3"><a href="nfl.html#cb508-3" tabindex="-1"></a></span>
<span id="cb508-4"><a href="nfl.html#cb508-4" tabindex="-1"></a><span class="co"># Initialize a vector to store RMSPE values for each run</span></span>
<span id="cb508-5"><a href="nfl.html#cb508-5" tabindex="-1"></a>rmspe <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb508-6"><a href="nfl.html#cb508-6" tabindex="-1"></a></span>
<span id="cb508-7"><a href="nfl.html#cb508-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb508-8"><a href="nfl.html#cb508-8" tabindex="-1"></a>  </span>
<span id="cb508-9"><a href="nfl.html#cb508-9" tabindex="-1"></a>  <span class="co"># Resample the dataset with replacement</span></span>
<span id="cb508-10"><a href="nfl.html#cb508-10" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(lm_data), <span class="fu">nrow</span>(lm_data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb508-11"><a href="nfl.html#cb508-11" tabindex="-1"></a>  train <span class="ot">&lt;-</span> lm_data[ind, ]</span>
<span id="cb508-12"><a href="nfl.html#cb508-12" tabindex="-1"></a>  test <span class="ot">&lt;-</span> lm_data[<span class="sc">-</span>ind, ]</span>
<span id="cb508-13"><a href="nfl.html#cb508-13" tabindex="-1"></a>  </span>
<span id="cb508-14"><a href="nfl.html#cb508-14" tabindex="-1"></a>  <span class="co"># Build Linear Regression model</span></span>
<span id="cb508-15"><a href="nfl.html#cb508-15" tabindex="-1"></a>  lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(next_fantasy_points <span class="sc">~</span> ., <span class="at">data =</span> train)</span>
<span id="cb508-16"><a href="nfl.html#cb508-16" tabindex="-1"></a>  </span>
<span id="cb508-17"><a href="nfl.html#cb508-17" tabindex="-1"></a>  <span class="co"># Predict on the test data</span></span>
<span id="cb508-18"><a href="nfl.html#cb508-18" tabindex="-1"></a>  yhat <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_model, <span class="at">newdata =</span> test)</span>
<span id="cb508-19"><a href="nfl.html#cb508-19" tabindex="-1"></a>  </span>
<span id="cb508-20"><a href="nfl.html#cb508-20" tabindex="-1"></a>  <span class="co"># Calculate RMSPE</span></span>
<span id="cb508-21"><a href="nfl.html#cb508-21" tabindex="-1"></a>  rmspe[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test<span class="sc">$</span>next_fantasy_points <span class="sc">-</span> yhat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb508-22"><a href="nfl.html#cb508-22" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases

## Warning in predict.lm(lm_model, newdata = test): prediction from rank-deficient
## fit; attr(*, &quot;non-estim&quot;) has doubtful cases</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="nfl.html#cb510-1" tabindex="-1"></a><span class="co"># Calculate the mean RMSPE over the 10 runs</span></span>
<span id="cb510-2"><a href="nfl.html#cb510-2" tabindex="-1"></a>mean_rmspe <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe)</span>
<span id="cb510-3"><a href="nfl.html#cb510-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE over 10 runs:&quot;</span>, mean_rmspe))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE over 10 runs: 60.7854844772501&quot;</code></pre>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="nfl.html#cb512-1" tabindex="-1"></a><span class="co"># Optionally, print the RMSPE for each run to see variability</span></span>
<span id="cb512-2"><a href="nfl.html#cb512-2" tabindex="-1"></a><span class="fu">print</span>(rmspe)</span></code></pre></div>
<pre><code>##  [1] 63.79008 60.63969 62.23519 60.39532 61.30245 62.32508 57.03457 56.46881
##  [9] 60.45813 63.20552</code></pre>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="nfl.html#cb514-1" tabindex="-1"></a><span class="co"># Evaluate feature importance</span></span>
<span id="cb514-2"><a href="nfl.html#cb514-2" tabindex="-1"></a>importance_values <span class="ot">&lt;-</span> <span class="fu">importance</span>(rbrf_model)</span>
<span id="cb514-3"><a href="nfl.html#cb514-3" tabindex="-1"></a></span>
<span id="cb514-4"><a href="nfl.html#cb514-4" tabindex="-1"></a><span class="co"># Sort and extract the top 10 features by %IncMSE and IncNodePurity</span></span>
<span id="cb514-5"><a href="nfl.html#cb514-5" tabindex="-1"></a>top10_mse <span class="ot">&lt;-</span> importance_values[<span class="fu">order</span>(importance_values[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb514-6"><a href="nfl.html#cb514-6" tabindex="-1"></a>top10_purity <span class="ot">&lt;-</span> importance_values[<span class="fu">order</span>(importance_values[, <span class="st">&quot;IncNodePurity&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb514-7"><a href="nfl.html#cb514-7" tabindex="-1"></a></span>
<span id="cb514-8"><a href="nfl.html#cb514-8" tabindex="-1"></a><span class="co"># Visualize top 10 features by %IncMSE</span></span>
<span id="cb514-9"><a href="nfl.html#cb514-9" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">2</span>))  <span class="co"># Increase margins for labels</span></span>
<span id="cb514-10"><a href="nfl.html#cb514-10" tabindex="-1"></a><span class="fu">barplot</span>(top10_mse[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_mse),</span>
<span id="cb514-11"><a href="nfl.html#cb514-11" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by %IncMSE (Mean Decrease in Accuracy)&quot;</span>,</span>
<span id="cb514-12"><a href="nfl.html#cb514-12" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-221-1.png" width="672" /></p>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="nfl.html#cb515-1" tabindex="-1"></a><span class="co"># Visualize top 10 features by IncNodePurity</span></span>
<span id="cb515-2"><a href="nfl.html#cb515-2" tabindex="-1"></a><span class="fu">barplot</span>(top10_purity[, <span class="st">&quot;IncNodePurity&quot;</span>], <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_purity),</span>
<span id="cb515-3"><a href="nfl.html#cb515-3" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by IncNodePurity (Mean Decrease in Gini)&quot;</span>,</span>
<span id="cb515-4"><a href="nfl.html#cb515-4" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-221-2.png" width="672" /></p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="nfl.html#cb516-1" tabindex="-1"></a><span class="co"># Calculate OOB MAE</span></span>
<span id="cb516-2"><a href="nfl.html#cb516-2" tabindex="-1"></a><span class="co"># Extract OOB predictions</span></span>
<span id="cb516-3"><a href="nfl.html#cb516-3" tabindex="-1"></a>oob_predictions <span class="ot">&lt;-</span> rbrf_model<span class="sc">$</span>predicted</span>
<span id="cb516-4"><a href="nfl.html#cb516-4" tabindex="-1"></a></span>
<span id="cb516-5"><a href="nfl.html#cb516-5" tabindex="-1"></a><span class="co"># Calculate the absolute errors</span></span>
<span id="cb516-6"><a href="nfl.html#cb516-6" tabindex="-1"></a>absolute_errors <span class="ot">&lt;-</span> <span class="fu">abs</span>(oob_predictions <span class="sc">-</span> rbrf_model<span class="sc">$</span>y)</span>
<span id="cb516-7"><a href="nfl.html#cb516-7" tabindex="-1"></a></span>
<span id="cb516-8"><a href="nfl.html#cb516-8" tabindex="-1"></a><span class="co"># Calculate the Mean Absolute Error (MAE)</span></span>
<span id="cb516-9"><a href="nfl.html#cb516-9" tabindex="-1"></a>oob_mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(absolute_errors)</span>
<span id="cb516-10"><a href="nfl.html#cb516-10" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;OOB MAE:&quot;</span>, oob_mae))</span></code></pre></div>
<pre><code>## [1] &quot;OOB MAE: 42.8327659290246&quot;</code></pre>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="nfl.html#cb518-1" tabindex="-1"></a><span class="co"># Predict 2024 fantasy points for 2023 RBs</span></span>
<span id="cb518-2"><a href="nfl.html#cb518-2" tabindex="-1"></a>predicted_2024_fantasy_points <span class="ot">&lt;-</span> <span class="fu">predict</span>(rbrf_model, <span class="at">newdata =</span> rb_2023)</span>
<span id="cb518-3"><a href="nfl.html#cb518-3" tabindex="-1"></a></span>
<span id="cb518-4"><a href="nfl.html#cb518-4" tabindex="-1"></a><span class="co"># Create a data frame with the names and the predicted 2024 fantasy points</span></span>
<span id="cb518-5"><a href="nfl.html#cb518-5" tabindex="-1"></a>results_rb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> rb_2023<span class="sc">$</span>name, <span class="at">predicted_2024_fantasy_points =</span> predicted_2024_fantasy_points)</span>
<span id="cb518-6"><a href="nfl.html#cb518-6" tabindex="-1"></a><span class="fu">print</span>(results_rb)</span></code></pre></div>
<pre><code>##                      name predicted_2024_fantasy_points
## 1             Aaron Jones                     118.04262
## 2              Alex Armah                      25.09065
## 3      Alexander Mattison                      84.97637
## 4            Alvin Kamara                     166.35528
## 5          Ameer Abdullah                      48.34743
## 6       Anthony McFarland                            NA
## 7          Antonio Gibson                      68.02155
## 8           Austin Ekeler                     152.20587
## 9          Bijan Robinson                     136.79453
## 10           Boston Scott                      17.78374
## 11         Brandon Bolden                      50.07336
## 12            Breece Hall                     155.01342
## 13         Brian Robinson                            NA
## 14              Cam Akers                      39.38520
## 15            Chase Brown                      80.88865
## 16          Chase Edmonds                      53.12924
## 17            Chris Evans                      50.61122
## 18        Chris Rodriguez                      59.85606
## 19    Christian McCaffrey                     212.77041
## 20          Chuba Hubbard                     110.80196
## 21  Clyde Edwards-Helaire                      52.44498
## 22  Cordarrelle Patterson                      36.70601
## 23         Craig Reynolds                      36.41821
## 24          D&#39;Andre Swift                     118.47322
## 25       D&#39;Ernest Johnson                      32.30104
## 26         D&#39;Onta Foreman                      58.50286
## 27          Dameon Pierce                      82.89876
## 28          Damien Harris                      23.31411
## 29        Damien Williams                      21.62917
## 30        Dare Ogunbowale                      42.97832
## 31      Darrell Henderson                      54.02835
## 32        Darrynton Evans                      39.19007
## 33       David Montgomery                     129.91948
## 34          DeeJay Dallas                      33.84922
## 35           Deon Jackson                      40.77150
## 36           Derrick Gore                      44.56223
## 37          Derrick Henry                     129.12637
## 38           Deuce Vaughn                      27.40912
## 39       Devin Singletary                     111.36104
## 40          Devine Ozigbo                      12.63288
## 41          Elijah Dotson                      26.75654
## 42        Elijah Mitchell                      50.35636
## 43         Emanuel Wilson                      22.55430
## 44        Emari Demercado                      70.48332
## 45              Eric Gray                      27.81213
## 46              Evan Hull                      37.88231
## 47        Ezekiel Elliott                      88.84338
## 48        Gary Brightwell                      22.48163
## 49            Gus Edwards                     102.98812
## 50          Hunter Luepke                      23.78956
## 51         Isaiah Spiller                      32.32182
## 52          Isiah Pacheco                     155.74796
## 53      Israel Abanikanda                      23.44183
## 54           J.K. Dobbins                      47.20577
## 55           Jahmyr Gibbs                     169.47437
## 56      Jaleel McLaughlin                     113.92307
## 57        Jamaal Williams                      43.21933
## 58           James Conner                     141.83972
## 59             James Cook                     123.57604
## 60         Jashaun Corbin                      37.93056
## 61       Javonte Williams                      93.81538
## 62          Jaylen Warren                     120.62452
## 63        Jerick McKinnon                      63.07916
## 64            Jerome Ford                     114.49215
## 65              Joe Mixon                     152.96433
## 66        Jonathan Taylor                     139.61376
## 67          Jonathan Ward                      22.94492
## 68      Jonathan Williams                      54.93015
## 69           Jordan Mason                      51.34162
## 70            Jordan Mims                      49.01447
## 71            Josh Jacobs                     159.46634
## 72          Joshua Kelley                      65.14497
## 73           Justice Hill                      65.55675
## 74            Kareem Hunt                      64.13019
## 75        Keaton Mitchell                      87.22186
## 76          Kendre Miller                      57.41223
## 77           Kene Nwangwu                      15.80442
## 78       Kenneth Gainwell                      67.31551
## 79         Kenneth Walker                            NA
## 80           Kenyan Drake                      42.61243
## 81           Kevin Harris                      31.02931
## 82         Khalil Herbert                      77.41246
## 83         Kyren Williams                     173.44194
## 84        La&#39;Mical Perine                      41.98330
## 85        Latavius Murray                      58.62617
## 86      Leonard Fournette                      44.06344
## 87            Matt Breida                      39.62983
## 88          Melvin Gordon                      29.20249
## 89         Michael Carter                      45.15985
## 90          Miles Sanders                      67.67319
## 91           Najee Harris                     103.52405
## 92             Nick Chubb                      65.56131
## 93         Patrick Taylor                      43.48695
## 94          Pierre Strong                      69.88942
## 95          Rachaad White                     153.88568
## 96      Raheem Blackshear                      15.10576
## 97         Raheem Mostert                     144.29180
## 98          Rashaad Penny                      26.38452
## 99    Rhamondre Stevenson                     133.91477
## 100           Rico Dowdle                      81.54722
## 101         Ronnie Rivers                      47.11891
## 102       Roschon Johnson                     101.38723
## 103         Royce Freeman                      48.34645
## 104          Salvon Ahmed                      26.08709
## 105         Samaje Perine                      72.79172
## 106        Saquon Barkley                     137.55416
## 107           Sean Tucker                      21.35669
## 108           Tank Bigsby                      74.38335
## 109            Tony Jones                      29.54301
## 110          Tony Pollard                     143.83668
## 111        Travis Etienne                     159.74291
## 112          Travis Homer                      44.79461
## 113     Trayveon Williams                      47.70385
## 114           Trey Sermon                      42.27016
## 115           Ty Chandler                      87.44841
## 116            Ty Johnson                      31.38996
## 117          Tyjae Spears                     114.03370
## 118        Tyler Allgeier                     111.67694
## 119         Tyler Goodson                      30.34336
## 120    Tyrion Davis-Price                      49.65526
## 121       Zach Charbonnet                     113.75264
## 122            Zach Evans                      39.63292
## 123             Zack Moss                      91.01460
## 124           Zamir White                      88.61307</code></pre>
</div>
<div id="qbs" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> QBs<a href="nfl.html#qbs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="nfl.html#cb520-1" tabindex="-1"></a><span class="co"># Access the QB data</span></span>
<span id="cb520-2"><a href="nfl.html#cb520-2" tabindex="-1"></a>qb_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>QB</span></code></pre></div>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="nfl.html#cb521-1" tabindex="-1"></a><span class="co"># Identify zero-variance columns</span></span>
<span id="cb521-2"><a href="nfl.html#cb521-2" tabindex="-1"></a>zero_var_cols <span class="ot">&lt;-</span> <span class="fu">nearZeroVar</span>(qb_data)</span>
<span id="cb521-3"><a href="nfl.html#cb521-3" tabindex="-1"></a></span>
<span id="cb521-4"><a href="nfl.html#cb521-4" tabindex="-1"></a><span class="co"># Check and remove zero-variance columns</span></span>
<span id="cb521-5"><a href="nfl.html#cb521-5" tabindex="-1"></a>zero_var_colnames <span class="ot">&lt;-</span> <span class="fu">colnames</span>(qb_data)[zero_var_cols]</span>
<span id="cb521-6"><a href="nfl.html#cb521-6" tabindex="-1"></a>qb_data <span class="ot">&lt;-</span> qb_data[, <span class="sc">!</span><span class="fu">names</span>(qb_data) <span class="sc">%in%</span> zero_var_colnames]</span>
<span id="cb521-7"><a href="nfl.html#cb521-7" tabindex="-1"></a></span>
<span id="cb521-8"><a href="nfl.html#cb521-8" tabindex="-1"></a></span>
<span id="cb521-9"><a href="nfl.html#cb521-9" tabindex="-1"></a><span class="co"># Filter the data for the 2023 season</span></span>
<span id="cb521-10"><a href="nfl.html#cb521-10" tabindex="-1"></a>qb_2023 <span class="ot">&lt;-</span> <span class="fu">subset</span>(qb_data, season <span class="sc">==</span> <span class="dv">2023</span>)</span>
<span id="cb521-11"><a href="nfl.html#cb521-11" tabindex="-1"></a><span class="co"># Create new columns for the next season&#39;s fantasy points</span></span>
<span id="cb521-12"><a href="nfl.html#cb521-12" tabindex="-1"></a>qb_data<span class="sc">$</span>next_fantasy_points <span class="ot">&lt;-</span> <span class="fu">ave</span>(qb_data<span class="sc">$</span>fantasy_points, qb_data<span class="sc">$</span>name, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">NA</span>))</span>
<span id="cb521-13"><a href="nfl.html#cb521-13" tabindex="-1"></a></span>
<span id="cb521-14"><a href="nfl.html#cb521-14" tabindex="-1"></a><span class="co"># Remove rows where rookie_season is 0</span></span>
<span id="cb521-15"><a href="nfl.html#cb521-15" tabindex="-1"></a>qb_data <span class="ot">&lt;-</span> qb_data[qb_data<span class="sc">$</span>rookie_season <span class="sc">!=</span> <span class="dv">0</span>, ]</span>
<span id="cb521-16"><a href="nfl.html#cb521-16" tabindex="-1"></a></span>
<span id="cb521-17"><a href="nfl.html#cb521-17" tabindex="-1"></a><span class="co"># Remove rows with NAs</span></span>
<span id="cb521-18"><a href="nfl.html#cb521-18" tabindex="-1"></a>qb_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(qb_data)</span></code></pre></div>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="nfl.html#cb522-1" tabindex="-1"></a><span class="co"># Build Random Forest model</span></span>
<span id="cb522-2"><a href="nfl.html#cb522-2" tabindex="-1"></a>qbrf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(next_fantasy_points <span class="sc">~</span> ., <span class="at">data =</span> qb_data, <span class="at">ntree =</span> <span class="dv">500</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="nfl.html#cb523-1" tabindex="-1"></a><span class="co"># Evaluate feature importance</span></span>
<span id="cb523-2"><a href="nfl.html#cb523-2" tabindex="-1"></a>importance_values <span class="ot">&lt;-</span> <span class="fu">importance</span>(qbrf_model)</span>
<span id="cb523-3"><a href="nfl.html#cb523-3" tabindex="-1"></a></span>
<span id="cb523-4"><a href="nfl.html#cb523-4" tabindex="-1"></a><span class="co"># Sort and extract the top 10 features by %IncMSE and IncNodePurity</span></span>
<span id="cb523-5"><a href="nfl.html#cb523-5" tabindex="-1"></a>top10_mse <span class="ot">&lt;-</span> importance_values[<span class="fu">order</span>(importance_values[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb523-6"><a href="nfl.html#cb523-6" tabindex="-1"></a>top10_purity <span class="ot">&lt;-</span> importance_values[<span class="fu">order</span>(importance_values[, <span class="st">&quot;IncNodePurity&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb523-7"><a href="nfl.html#cb523-7" tabindex="-1"></a></span>
<span id="cb523-8"><a href="nfl.html#cb523-8" tabindex="-1"></a><span class="co"># Visualize top 10 features by %IncMSE</span></span>
<span id="cb523-9"><a href="nfl.html#cb523-9" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">2</span>))  <span class="co"># Increase margins for labels</span></span>
<span id="cb523-10"><a href="nfl.html#cb523-10" tabindex="-1"></a><span class="fu">barplot</span>(top10_mse[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_mse),</span>
<span id="cb523-11"><a href="nfl.html#cb523-11" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by %IncMSE (Mean Decrease in Accuracy)&quot;</span>,</span>
<span id="cb523-12"><a href="nfl.html#cb523-12" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-227-1.png" width="672" /></p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="nfl.html#cb524-1" tabindex="-1"></a><span class="co"># Visualize top 10 features by IncNodePurity</span></span>
<span id="cb524-2"><a href="nfl.html#cb524-2" tabindex="-1"></a><span class="fu">barplot</span>(top10_purity[, <span class="st">&quot;IncNodePurity&quot;</span>], <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_purity),</span>
<span id="cb524-3"><a href="nfl.html#cb524-3" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by IncNodePurity (Mean Decrease in Gini)&quot;</span>,</span>
<span id="cb524-4"><a href="nfl.html#cb524-4" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">horiz =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-227-2.png" width="672" /></p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="nfl.html#cb525-1" tabindex="-1"></a><span class="co"># Calculate OOB rmse</span></span>
<span id="cb525-2"><a href="nfl.html#cb525-2" tabindex="-1"></a>oob_rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(qbrf_model<span class="sc">$</span>mse[qbrf_model<span class="sc">$</span>ntree])</span>
<span id="cb525-3"><a href="nfl.html#cb525-3" tabindex="-1"></a><span class="co"># Extract OOB predictions</span></span>
<span id="cb525-4"><a href="nfl.html#cb525-4" tabindex="-1"></a>oob_predictions <span class="ot">&lt;-</span> qbrf_model<span class="sc">$</span>predicted</span>
<span id="cb525-5"><a href="nfl.html#cb525-5" tabindex="-1"></a></span>
<span id="cb525-6"><a href="nfl.html#cb525-6" tabindex="-1"></a><span class="co"># Calculate the absolute errors</span></span>
<span id="cb525-7"><a href="nfl.html#cb525-7" tabindex="-1"></a>absolute_errors <span class="ot">&lt;-</span> <span class="fu">abs</span>(oob_predictions <span class="sc">-</span> qbrf_model<span class="sc">$</span>y)</span>
<span id="cb525-8"><a href="nfl.html#cb525-8" tabindex="-1"></a></span>
<span id="cb525-9"><a href="nfl.html#cb525-9" tabindex="-1"></a><span class="co"># Calculate the Mean Absolute Error (MAE)</span></span>
<span id="cb525-10"><a href="nfl.html#cb525-10" tabindex="-1"></a>oob_mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(absolute_errors)</span>
<span id="cb525-11"><a href="nfl.html#cb525-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;OOB MAE:&quot;</span>, oob_mae))</span></code></pre></div>
<pre><code>## [1] &quot;OOB MAE: 61.9047808581408&quot;</code></pre>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="nfl.html#cb527-1" tabindex="-1"></a>oob_rmse</span></code></pre></div>
<pre><code>## [1] 82.62143</code></pre>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="nfl.html#cb529-1" tabindex="-1"></a><span class="co"># Predict 2024 fantasy points for 2023 QBs</span></span>
<span id="cb529-2"><a href="nfl.html#cb529-2" tabindex="-1"></a>predicted_2024_fantasy_points <span class="ot">&lt;-</span> <span class="fu">predict</span>(qbrf_model, <span class="at">newdata =</span> qb_2023)</span>
<span id="cb529-3"><a href="nfl.html#cb529-3" tabindex="-1"></a></span>
<span id="cb529-4"><a href="nfl.html#cb529-4" tabindex="-1"></a><span class="co"># Create a data frame with the names and the predicted 2024 fantasy points</span></span>
<span id="cb529-5"><a href="nfl.html#cb529-5" tabindex="-1"></a>results_qb <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">name =</span> qb_2023<span class="sc">$</span>name, <span class="at">predicted_2024_fantasy_points =</span> predicted_2024_fantasy_points)</span>
<span id="cb529-6"><a href="nfl.html#cb529-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(results_qb))</span></code></pre></div>
<pre><code>##                 name predicted_2024_fantasy_points
## 1      Aaron Rodgers                      82.75772
## 2    Aidan O&#39;Connell                     131.55928
## 3        AJ McCarron                            NA
## 4        Andy Dalton                      89.99066
## 5 Anthony Richardson                     148.35138
## 6       Bailey Zappe                     129.82826</code></pre>
</div>
<div id="plots-and-analysis" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> Plots and Analysis<a href="nfl.html#plots-and-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="nfl.html#cb531-1" tabindex="-1"></a><span class="co"># For QB model (qbrf_model)</span></span>
<span id="cb531-2"><a href="nfl.html#cb531-2" tabindex="-1"></a>pdp_qb_games <span class="ot">&lt;-</span> <span class="fu">partial</span>(qbrf_model, <span class="at">pred.var =</span> <span class="st">&quot;games&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb531-3"><a href="nfl.html#cb531-3" tabindex="-1"></a>                        <span class="at">main =</span> <span class="st">&quot;PDP for Games (QB Random Forest Model)&quot;</span>,</span>
<span id="cb531-4"><a href="nfl.html#cb531-4" tabindex="-1"></a>                        <span class="at">xlab =</span> <span class="st">&quot;Games&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Partial Dependence&quot;</span>)</span>
<span id="cb531-5"><a href="nfl.html#cb531-5" tabindex="-1"></a></span>
<span id="cb531-6"><a href="nfl.html#cb531-6" tabindex="-1"></a></span>
<span id="cb531-7"><a href="nfl.html#cb531-7" tabindex="-1"></a></span>
<span id="cb531-8"><a href="nfl.html#cb531-8" tabindex="-1"></a><span class="co"># For WR model (wrrf_model)</span></span>
<span id="cb531-9"><a href="nfl.html#cb531-9" tabindex="-1"></a>pdp_wr_games <span class="ot">&lt;-</span> <span class="fu">partial</span>(wrrf_model, <span class="at">pred.var =</span> <span class="st">&quot;games&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb531-10"><a href="nfl.html#cb531-10" tabindex="-1"></a>                        <span class="at">main =</span> <span class="st">&quot;PDP for Games (WR Random Forest Model)&quot;</span>,</span>
<span id="cb531-11"><a href="nfl.html#cb531-11" tabindex="-1"></a>                        <span class="at">xlab =</span> <span class="st">&quot;Games&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Partial Dependence&quot;</span>)</span>
<span id="cb531-12"><a href="nfl.html#cb531-12" tabindex="-1"></a></span>
<span id="cb531-13"><a href="nfl.html#cb531-13" tabindex="-1"></a><span class="co"># For RB model (rbrf_model)</span></span>
<span id="cb531-14"><a href="nfl.html#cb531-14" tabindex="-1"></a>pdp_rb_games <span class="ot">&lt;-</span> <span class="fu">partial</span>(rbrf_model, <span class="at">pred.var =</span> <span class="st">&quot;games&quot;</span>, <span class="at">plot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb531-15"><a href="nfl.html#cb531-15" tabindex="-1"></a>                        <span class="at">main =</span> <span class="st">&quot;PDP for Games (RB Random Forest Model)&quot;</span>,</span>
<span id="cb531-16"><a href="nfl.html#cb531-16" tabindex="-1"></a>                        <span class="at">xlab =</span> <span class="st">&quot;Games&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Partial Dependence&quot;</span>)</span>
<span id="cb531-17"><a href="nfl.html#cb531-17" tabindex="-1"></a></span>
<span id="cb531-18"><a href="nfl.html#cb531-18" tabindex="-1"></a>pdp_qb_games</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-230-1.png" width="672" /></p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="nfl.html#cb532-1" tabindex="-1"></a>pdp_wr_games</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-230-2.png" width="672" /></p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="nfl.html#cb533-1" tabindex="-1"></a>pdp_rb_games</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-230-3.png" width="672" /></p>
<p>Games played is being tracked by other statistics… i dont give a crap about games played i only care about your stats at the end of the season…</p>
</div>
<div id="lists-to-do" class="section level2 hasAnchor" number="16.5">
<h2><span class="header-section-number">16.5</span> Lists to do<a href="nfl.html#lists-to-do" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>need to look at if multiple years back is good idea(i dont think so because then can no use 2nd yr players), and to be able to add teamates. also look if we are good for the seasons that there are 17 games. break the seasons down into quarters.</p>
</div>
<div id="team-mates" class="section level2 hasAnchor" number="16.6">
<h2><span class="header-section-number">16.6</span> team mates<a href="nfl.html#team-mates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="nfl.html#cb534-1" tabindex="-1"></a><span class="fu">library</span>(nflfastR)</span></code></pre></div>
<pre><code>## Warning: package &#39;nflfastR&#39; was built under R version 4.3.3</code></pre>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="nfl.html#cb536-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="nfl.html#cb537-1" tabindex="-1"></a><span class="co"># Fetch rosters for 2024</span></span>
<span id="cb537-2"><a href="nfl.html#cb537-2" tabindex="-1"></a>rosters <span class="ot">&lt;-</span> <span class="fu">fast_scraper_roster</span>(<span class="at">season =</span> <span class="dv">2024</span>)</span>
<span id="cb537-3"><a href="nfl.html#cb537-3" tabindex="-1"></a></span>
<span id="cb537-4"><a href="nfl.html#cb537-4" tabindex="-1"></a><span class="co"># Filter WR and RB positions</span></span>
<span id="cb537-5"><a href="nfl.html#cb537-5" tabindex="-1"></a>wr_rosters <span class="ot">&lt;-</span> rosters <span class="sc">%&gt;%</span> <span class="fu">filter</span>(position <span class="sc">==</span> <span class="st">&quot;WR&quot;</span>)</span>
<span id="cb537-6"><a href="nfl.html#cb537-6" tabindex="-1"></a>rb_rosters <span class="ot">&lt;-</span> rosters <span class="sc">%&gt;%</span> <span class="fu">filter</span>(position <span class="sc">==</span> <span class="st">&quot;RB&quot;</span>)</span>
<span id="cb537-7"><a href="nfl.html#cb537-7" tabindex="-1"></a></span>
<span id="cb537-8"><a href="nfl.html#cb537-8" tabindex="-1"></a><span class="co"># Rename columns to match merging requirements</span></span>
<span id="cb537-9"><a href="nfl.html#cb537-9" tabindex="-1"></a><span class="fu">colnames</span>(wr_2023)[<span class="fu">colnames</span>(wr_2023) <span class="sc">==</span> <span class="st">&quot;team.x&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team&quot;</span></span>
<span id="cb537-10"><a href="nfl.html#cb537-10" tabindex="-1"></a><span class="fu">colnames</span>(rb_2023)[<span class="fu">colnames</span>(rb_2023) <span class="sc">==</span> <span class="st">&quot;team.x&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team&quot;</span></span>
<span id="cb537-11"><a href="nfl.html#cb537-11" tabindex="-1"></a></span>
<span id="cb537-12"><a href="nfl.html#cb537-12" tabindex="-1"></a><span class="co"># Merge WR data with rosters</span></span>
<span id="cb537-13"><a href="nfl.html#cb537-13" tabindex="-1"></a>wr_teams <span class="ot">&lt;-</span> <span class="fu">merge</span>(wr_2023, wr_rosters, <span class="at">by.x =</span> <span class="st">&quot;name&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;full_name&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb537-14"><a href="nfl.html#cb537-14" tabindex="-1"></a><span class="fu">colnames</span>(wr_teams)[<span class="fu">colnames</span>(wr_teams) <span class="sc">==</span> <span class="st">&quot;team.x&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team&quot;</span> <span class="co"># Use team.x for original team</span></span>
<span id="cb537-15"><a href="nfl.html#cb537-15" tabindex="-1"></a><span class="fu">colnames</span>(wr_teams)[<span class="fu">colnames</span>(wr_teams) <span class="sc">==</span> <span class="st">&quot;team.y&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;new_team&quot;</span> <span class="co"># Use team.y for updated team</span></span>
<span id="cb537-16"><a href="nfl.html#cb537-16" tabindex="-1"></a>wr_teams <span class="ot">&lt;-</span> wr_teams[, <span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;team&quot;</span>)]</span>
<span id="cb537-17"><a href="nfl.html#cb537-17" tabindex="-1"></a></span>
<span id="cb537-18"><a href="nfl.html#cb537-18" tabindex="-1"></a><span class="co"># Merge RB data with rosters</span></span>
<span id="cb537-19"><a href="nfl.html#cb537-19" tabindex="-1"></a>rb_teams <span class="ot">&lt;-</span> <span class="fu">merge</span>(rb_2023, rb_rosters, <span class="at">by.x =</span> <span class="st">&quot;name&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;full_name&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb537-20"><a href="nfl.html#cb537-20" tabindex="-1"></a><span class="fu">colnames</span>(rb_teams)[<span class="fu">colnames</span>(rb_teams) <span class="sc">==</span> <span class="st">&quot;team.x&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team&quot;</span> <span class="co"># Use team.x for original team</span></span>
<span id="cb537-21"><a href="nfl.html#cb537-21" tabindex="-1"></a><span class="fu">colnames</span>(rb_teams)[<span class="fu">colnames</span>(rb_teams) <span class="sc">==</span> <span class="st">&quot;team.y&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;new_team&quot;</span> <span class="co"># Use team.y for updated team</span></span>
<span id="cb537-22"><a href="nfl.html#cb537-22" tabindex="-1"></a>rb_teams <span class="ot">&lt;-</span> rb_teams[, <span class="fu">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;team&quot;</span>)]</span></code></pre></div>
<p>create wr_2023-2024 that has the 2023 stats that have the players on there correct teams. we will do the same for the rb data</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="nfl.html#cb538-1" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb538-2"><a href="nfl.html#cb538-2" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb538-3"><a href="nfl.html#cb538-3" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb538-4"><a href="nfl.html#cb538-4" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb538-5"><a href="nfl.html#cb538-5" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb538-6"><a href="nfl.html#cb538-6" tabindex="-1"></a><span class="fu">library</span>(pdp)</span>
<span id="cb538-7"><a href="nfl.html#cb538-7" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb538-8"><a href="nfl.html#cb538-8" tabindex="-1"></a><span class="fu">library</span>(nflfastR)</span>
<span id="cb538-9"><a href="nfl.html#cb538-9" tabindex="-1"></a></span>
<span id="cb538-10"><a href="nfl.html#cb538-10" tabindex="-1"></a><span class="co"># Load the offensive yearly data</span></span>
<span id="cb538-11"><a href="nfl.html#cb538-11" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;offense_yearly_data.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 5453 Columns: 76
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (5): name, height_ft, position, team, season_type
## dbl (71): id, height_cm, season, completions, attempts, passing_yards, passi...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="nfl.html#cb540-1" tabindex="-1"></a><span class="co"># Sort the dataset by player name and season</span></span>
<span id="cb540-2"><a href="nfl.html#cb540-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[<span class="fu">order</span>(data<span class="sc">$</span>name, data<span class="sc">$</span>season), ]</span>
<span id="cb540-3"><a href="nfl.html#cb540-3" tabindex="-1"></a></span>
<span id="cb540-4"><a href="nfl.html#cb540-4" tabindex="-1"></a><span class="co"># Adjust columns</span></span>
<span id="cb540-5"><a href="nfl.html#cb540-5" tabindex="-1"></a><span class="fu">names</span>(data)[<span class="fu">names</span>(data) <span class="sc">==</span> <span class="st">&quot;height_cm&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;height_in&quot;</span></span>
<span id="cb540-6"><a href="nfl.html#cb540-6" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[, <span class="sc">!</span><span class="fu">names</span>(data) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;height_ft&quot;</span>)]</span>
<span id="cb540-7"><a href="nfl.html#cb540-7" tabindex="-1"></a></span>
<span id="cb540-8"><a href="nfl.html#cb540-8" tabindex="-1"></a><span class="co"># Split the dataset by position</span></span>
<span id="cb540-9"><a href="nfl.html#cb540-9" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">split</span>(data, data<span class="sc">$</span>position)</span>
<span id="cb540-10"><a href="nfl.html#cb540-10" tabindex="-1"></a></span>
<span id="cb540-11"><a href="nfl.html#cb540-11" tabindex="-1"></a><span class="co"># Access the WR and RB data</span></span>
<span id="cb540-12"><a href="nfl.html#cb540-12" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>WR</span>
<span id="cb540-13"><a href="nfl.html#cb540-13" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>RB</span>
<span id="cb540-14"><a href="nfl.html#cb540-14" tabindex="-1"></a></span>
<span id="cb540-15"><a href="nfl.html#cb540-15" tabindex="-1"></a><span class="co"># Identify zero-variance columns and remove them, excluding &#39;position&#39;</span></span>
<span id="cb540-16"><a href="nfl.html#cb540-16" tabindex="-1"></a><span class="co"># For WR data</span></span>
<span id="cb540-17"><a href="nfl.html#cb540-17" tabindex="-1"></a>zero_var_cols_wr <span class="ot">&lt;-</span> <span class="fu">nearZeroVar</span>(wr_data)</span>
<span id="cb540-18"><a href="nfl.html#cb540-18" tabindex="-1"></a>zero_var_colnames_wr <span class="ot">&lt;-</span> <span class="fu">colnames</span>(wr_data)[zero_var_cols_wr]</span>
<span id="cb540-19"><a href="nfl.html#cb540-19" tabindex="-1"></a>cols_to_remove_wr <span class="ot">&lt;-</span> zero_var_colnames_wr[zero_var_colnames_wr <span class="sc">!=</span> <span class="st">&quot;position&quot;</span>]</span>
<span id="cb540-20"><a href="nfl.html#cb540-20" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> wr_data[, <span class="sc">!</span><span class="fu">names</span>(wr_data) <span class="sc">%in%</span> cols_to_remove_wr]</span>
<span id="cb540-21"><a href="nfl.html#cb540-21" tabindex="-1"></a></span>
<span id="cb540-22"><a href="nfl.html#cb540-22" tabindex="-1"></a><span class="co"># For RB data</span></span>
<span id="cb540-23"><a href="nfl.html#cb540-23" tabindex="-1"></a>zero_var_cols_rb <span class="ot">&lt;-</span> <span class="fu">nearZeroVar</span>(rb_data)</span>
<span id="cb540-24"><a href="nfl.html#cb540-24" tabindex="-1"></a>zero_var_colnames_rb <span class="ot">&lt;-</span> <span class="fu">colnames</span>(rb_data)[zero_var_cols_rb]</span>
<span id="cb540-25"><a href="nfl.html#cb540-25" tabindex="-1"></a>cols_to_remove_rb <span class="ot">&lt;-</span> zero_var_colnames_rb[zero_var_colnames_rb <span class="sc">!=</span> <span class="st">&quot;position&quot;</span>]</span>
<span id="cb540-26"><a href="nfl.html#cb540-26" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> rb_data[, <span class="sc">!</span><span class="fu">names</span>(rb_data) <span class="sc">%in%</span> cols_to_remove_rb]</span>
<span id="cb540-27"><a href="nfl.html#cb540-27" tabindex="-1"></a></span>
<span id="cb540-28"><a href="nfl.html#cb540-28" tabindex="-1"></a><span class="co"># Assuming the previous steps up to filtering the 2023 data are done</span></span>
<span id="cb540-29"><a href="nfl.html#cb540-29" tabindex="-1"></a><span class="co"># Filter the data for the 2023 season</span></span>
<span id="cb540-30"><a href="nfl.html#cb540-30" tabindex="-1"></a>wr_2023 <span class="ot">&lt;-</span> <span class="fu">subset</span>(wr_data, season <span class="sc">==</span> <span class="dv">2023</span>)</span>
<span id="cb540-31"><a href="nfl.html#cb540-31" tabindex="-1"></a>rb_2023 <span class="ot">&lt;-</span> <span class="fu">subset</span>(rb_data, season <span class="sc">==</span> <span class="dv">2023</span>)</span>
<span id="cb540-32"><a href="nfl.html#cb540-32" tabindex="-1"></a></span>
<span id="cb540-33"><a href="nfl.html#cb540-33" tabindex="-1"></a><span class="co"># Fetch current rosters for 2024</span></span>
<span id="cb540-34"><a href="nfl.html#cb540-34" tabindex="-1"></a>rosters <span class="ot">&lt;-</span> <span class="fu">fast_scraper_roster</span>(<span class="at">season =</span> <span class="dv">2024</span>)</span>
<span id="cb540-35"><a href="nfl.html#cb540-35" tabindex="-1"></a>wr_rosters <span class="ot">&lt;-</span> rosters <span class="sc">%&gt;%</span> <span class="fu">filter</span>(position <span class="sc">==</span> <span class="st">&quot;WR&quot;</span>)</span>
<span id="cb540-36"><a href="nfl.html#cb540-36" tabindex="-1"></a>rb_rosters <span class="ot">&lt;-</span> rosters <span class="sc">%&gt;%</span> <span class="fu">filter</span>(position <span class="sc">==</span> <span class="st">&quot;RB&quot;</span>)</span>
<span id="cb540-37"><a href="nfl.html#cb540-37" tabindex="-1"></a></span>
<span id="cb540-38"><a href="nfl.html#cb540-38" tabindex="-1"></a><span class="co"># For WR data</span></span>
<span id="cb540-39"><a href="nfl.html#cb540-39" tabindex="-1"></a>wr_rosters_temp <span class="ot">&lt;-</span> wr_rosters[, <span class="fu">c</span>(<span class="st">&quot;full_name&quot;</span>, <span class="st">&quot;team&quot;</span>)]</span>
<span id="cb540-40"><a href="nfl.html#cb540-40" tabindex="-1"></a><span class="fu">names</span>(wr_rosters_temp)[<span class="fu">names</span>(wr_rosters_temp) <span class="sc">==</span> <span class="st">&quot;team&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team_roster&quot;</span></span>
<span id="cb540-41"><a href="nfl.html#cb540-41" tabindex="-1"></a>wr_2023_2024 <span class="ot">&lt;-</span> <span class="fu">merge</span>(wr_2023, wr_rosters_temp, <span class="at">by.x =</span> <span class="st">&quot;name&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;full_name&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb540-42"><a href="nfl.html#cb540-42" tabindex="-1"></a><span class="co"># Replace NA in team with team_roster if available</span></span>
<span id="cb540-43"><a href="nfl.html#cb540-43" tabindex="-1"></a>wr_2023_2024<span class="sc">$</span>team <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(wr_2023_2024<span class="sc">$</span>team_roster), </span>
<span id="cb540-44"><a href="nfl.html#cb540-44" tabindex="-1"></a>                           wr_2023_2024<span class="sc">$</span>team, </span>
<span id="cb540-45"><a href="nfl.html#cb540-45" tabindex="-1"></a>                           wr_2023_2024<span class="sc">$</span>team_roster)</span>
<span id="cb540-46"><a href="nfl.html#cb540-46" tabindex="-1"></a>wr_2023_2024 <span class="ot">&lt;-</span> wr_2023_2024[, <span class="sc">!</span><span class="fu">names</span>(wr_2023_2024) <span class="sc">%in%</span> <span class="st">&quot;team_roster&quot;</span>]</span>
<span id="cb540-47"><a href="nfl.html#cb540-47" tabindex="-1"></a></span>
<span id="cb540-48"><a href="nfl.html#cb540-48" tabindex="-1"></a><span class="co"># For RB data</span></span>
<span id="cb540-49"><a href="nfl.html#cb540-49" tabindex="-1"></a>rb_rosters_temp <span class="ot">&lt;-</span> rb_rosters[, <span class="fu">c</span>(<span class="st">&quot;full_name&quot;</span>, <span class="st">&quot;team&quot;</span>)]</span>
<span id="cb540-50"><a href="nfl.html#cb540-50" tabindex="-1"></a><span class="fu">names</span>(rb_rosters_temp)[<span class="fu">names</span>(rb_rosters_temp) <span class="sc">==</span> <span class="st">&quot;team&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team_roster&quot;</span></span>
<span id="cb540-51"><a href="nfl.html#cb540-51" tabindex="-1"></a>rb_2023_2024 <span class="ot">&lt;-</span> <span class="fu">merge</span>(rb_2023, rb_rosters_temp, <span class="at">by.x =</span> <span class="st">&quot;name&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;full_name&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb540-52"><a href="nfl.html#cb540-52" tabindex="-1"></a><span class="co"># Replace NA in team with team_roster if available</span></span>
<span id="cb540-53"><a href="nfl.html#cb540-53" tabindex="-1"></a>rb_2023_2024<span class="sc">$</span>team <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(rb_2023_2024<span class="sc">$</span>team_roster), </span>
<span id="cb540-54"><a href="nfl.html#cb540-54" tabindex="-1"></a>                           rb_2023_2024<span class="sc">$</span>team, </span>
<span id="cb540-55"><a href="nfl.html#cb540-55" tabindex="-1"></a>                           rb_2023_2024<span class="sc">$</span>team_roster)</span>
<span id="cb540-56"><a href="nfl.html#cb540-56" tabindex="-1"></a>rb_2023_2024 <span class="ot">&lt;-</span> rb_2023_2024[, <span class="sc">!</span><span class="fu">names</span>(rb_2023_2024) <span class="sc">%in%</span> <span class="st">&quot;team_roster&quot;</span>]</span>
<span id="cb540-57"><a href="nfl.html#cb540-57" tabindex="-1"></a></span>
<span id="cb540-58"><a href="nfl.html#cb540-58" tabindex="-1"></a><span class="co"># Now, wr_2023_2024 and rb_2023_2024 should have the correct teams for the players in 2023, with fallback to original team if NA.</span></span></code></pre></div>
<p>now in wr_data and rb we need to look to include teamate stats. (we will group them for the 2023/2024 one later) we will create collums that have a the teamates states. to determine a teamate use the team and the season… now we obviously cant use every teamate. so for now we wil use the best qb on that team the 2 best wrs(that isnt themselves) and the best rb… now we have to determine what best is. best for qb will be pass yards. best for rbs will be rush yards. and best for wrs will be receving yards we may need to restructure it from the begining a bit because some colloms where dropped but u figure that out</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="nfl.html#cb541-1" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb541-2"><a href="nfl.html#cb541-2" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb541-3"><a href="nfl.html#cb541-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb541-4"><a href="nfl.html#cb541-4" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb541-5"><a href="nfl.html#cb541-5" tabindex="-1"></a></span>
<span id="cb541-6"><a href="nfl.html#cb541-6" tabindex="-1"></a><span class="co"># Load the offensive yearly data</span></span>
<span id="cb541-7"><a href="nfl.html#cb541-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;offense_yearly_data.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 5453 Columns: 76
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (5): name, height_ft, position, team, season_type
## dbl (71): id, height_cm, season, completions, attempts, passing_yards, passi...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="nfl.html#cb543-1" tabindex="-1"></a><span class="co"># Sort the dataset by player name and season</span></span>
<span id="cb543-2"><a href="nfl.html#cb543-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[<span class="fu">order</span>(data<span class="sc">$</span>name, data<span class="sc">$</span>season), ]</span>
<span id="cb543-3"><a href="nfl.html#cb543-3" tabindex="-1"></a></span>
<span id="cb543-4"><a href="nfl.html#cb543-4" tabindex="-1"></a><span class="co"># Adjust columns</span></span>
<span id="cb543-5"><a href="nfl.html#cb543-5" tabindex="-1"></a><span class="fu">names</span>(data)[<span class="fu">names</span>(data) <span class="sc">==</span> <span class="st">&quot;height_cm&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;height_in&quot;</span>  <span class="co"># Rename column</span></span>
<span id="cb543-6"><a href="nfl.html#cb543-6" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[, <span class="sc">!</span><span class="fu">names</span>(data) <span class="sc">%in%</span> <span class="st">&quot;height_ft&quot;</span>]          <span class="co"># Remove height_ft column</span></span>
<span id="cb543-7"><a href="nfl.html#cb543-7" tabindex="-1"></a></span>
<span id="cb543-8"><a href="nfl.html#cb543-8" tabindex="-1"></a><span class="co"># Split the dataset by position</span></span>
<span id="cb543-9"><a href="nfl.html#cb543-9" tabindex="-1"></a>data_split <span class="ot">&lt;-</span> <span class="fu">split</span>(data, data<span class="sc">$</span>position)</span>
<span id="cb543-10"><a href="nfl.html#cb543-10" tabindex="-1"></a></span>
<span id="cb543-11"><a href="nfl.html#cb543-11" tabindex="-1"></a><span class="co"># Access the WR, RB, and QB data</span></span>
<span id="cb543-12"><a href="nfl.html#cb543-12" tabindex="-1"></a>wr_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>WR</span>
<span id="cb543-13"><a href="nfl.html#cb543-13" tabindex="-1"></a>rb_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>RB</span>
<span id="cb543-14"><a href="nfl.html#cb543-14" tabindex="-1"></a>qb_data <span class="ot">&lt;-</span> data_split<span class="sc">$</span>QB</span>
<span id="cb543-15"><a href="nfl.html#cb543-15" tabindex="-1"></a></span>
<span id="cb543-16"><a href="nfl.html#cb543-16" tabindex="-1"></a></span>
<span id="cb543-17"><a href="nfl.html#cb543-17" tabindex="-1"></a></span>
<span id="cb543-18"><a href="nfl.html#cb543-18" tabindex="-1"></a><span class="co"># Load the necessary libraries</span></span>
<span id="cb543-19"><a href="nfl.html#cb543-19" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb543-20"><a href="nfl.html#cb543-20" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb543-21"><a href="nfl.html#cb543-21" tabindex="-1"></a></span>
<span id="cb543-22"><a href="nfl.html#cb543-22" tabindex="-1"></a><span class="co"># Load the offensive yearly data</span></span>
<span id="cb543-23"><a href="nfl.html#cb543-23" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;offense_yearly_data.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 5453 Columns: 76
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (5): name, height_ft, position, team, season_type
## dbl (71): id, height_cm, season, completions, attempts, passing_yards, passi...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="nfl.html#cb545-1" tabindex="-1"></a><span class="co"># Group by season and team to get a column with the names of all team members</span></span>
<span id="cb545-2"><a href="nfl.html#cb545-2" tabindex="-1"></a>get_team_members <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb545-3"><a href="nfl.html#cb545-3" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb545-4"><a href="nfl.html#cb545-4" tabindex="-1"></a>    <span class="fu">group_by</span>(season, team) <span class="sc">%&gt;%</span></span>
<span id="cb545-5"><a href="nfl.html#cb545-5" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">team_members =</span> <span class="fu">paste</span>(name, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb545-6"><a href="nfl.html#cb545-6" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb545-7"><a href="nfl.html#cb545-7" tabindex="-1"></a>}</span>
<span id="cb545-8"><a href="nfl.html#cb545-8" tabindex="-1"></a></span>
<span id="cb545-9"><a href="nfl.html#cb545-9" tabindex="-1"></a><span class="co"># Apply the function to WR, RB, and QB data</span></span>
<span id="cb545-10"><a href="nfl.html#cb545-10" tabindex="-1"></a>wr_team_members <span class="ot">&lt;-</span> <span class="fu">get_team_members</span>(data_split<span class="sc">$</span>WR)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;season&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="nfl.html#cb547-1" tabindex="-1"></a>rb_team_members <span class="ot">&lt;-</span> <span class="fu">get_team_members</span>(data_split<span class="sc">$</span>RB)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;season&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="nfl.html#cb549-1" tabindex="-1"></a>qb_team_members <span class="ot">&lt;-</span> <span class="fu">get_team_members</span>(data_split<span class="sc">$</span>QB)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;season&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="nfl.html#cb551-1" tabindex="-1"></a><span class="co"># Function to get team members</span></span>
<span id="cb551-2"><a href="nfl.html#cb551-2" tabindex="-1"></a>get_team_members <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb551-3"><a href="nfl.html#cb551-3" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb551-4"><a href="nfl.html#cb551-4" tabindex="-1"></a>    <span class="fu">group_by</span>(season, team) <span class="sc">%&gt;%</span></span>
<span id="cb551-5"><a href="nfl.html#cb551-5" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">team_members =</span> <span class="fu">paste</span>(name, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb551-6"><a href="nfl.html#cb551-6" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb551-7"><a href="nfl.html#cb551-7" tabindex="-1"></a>}</span>
<span id="cb551-8"><a href="nfl.html#cb551-8" tabindex="-1"></a></span>
<span id="cb551-9"><a href="nfl.html#cb551-9" tabindex="-1"></a><span class="co"># Apply the function to existing data</span></span>
<span id="cb551-10"><a href="nfl.html#cb551-10" tabindex="-1"></a>wr_team_members <span class="ot">&lt;-</span> <span class="fu">get_team_members</span>(data_split<span class="sc">$</span>WR)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;season&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="nfl.html#cb553-1" tabindex="-1"></a>rb_team_members <span class="ot">&lt;-</span> <span class="fu">get_team_members</span>(data_split<span class="sc">$</span>RB)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;season&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="nfl.html#cb555-1" tabindex="-1"></a>qb_team_members <span class="ot">&lt;-</span> <span class="fu">get_team_members</span>(data_split<span class="sc">$</span>QB)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;season&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="nfl.html#cb557-1" tabindex="-1"></a><span class="co"># Function to get top WRs by team</span></span>
<span id="cb557-2"><a href="nfl.html#cb557-2" tabindex="-1"></a>get_top_wr_team_members <span class="ot">&lt;-</span> <span class="cf">function</span>(ranked_wr_data) {</span>
<span id="cb557-3"><a href="nfl.html#cb557-3" tabindex="-1"></a>  <span class="co"># Sort data</span></span>
<span id="cb557-4"><a href="nfl.html#cb557-4" tabindex="-1"></a>  ranked_wr_data <span class="ot">&lt;-</span> ranked_wr_data[<span class="fu">order</span>(ranked_wr_data<span class="sc">$</span>season, </span>
<span id="cb557-5"><a href="nfl.html#cb557-5" tabindex="-1"></a>                                         ranked_wr_data<span class="sc">$</span>team, </span>
<span id="cb557-6"><a href="nfl.html#cb557-6" tabindex="-1"></a>                                         ranked_wr_data<span class="sc">$</span>rank), ]</span>
<span id="cb557-7"><a href="nfl.html#cb557-7" tabindex="-1"></a>  </span>
<span id="cb557-8"><a href="nfl.html#cb557-8" tabindex="-1"></a>  <span class="co"># Function to get nth value safely</span></span>
<span id="cb557-9"><a href="nfl.html#cb557-9" tabindex="-1"></a>  get_nth <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n) {</span>
<span id="cb557-10"><a href="nfl.html#cb557-10" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(x) <span class="sc">&gt;=</span> n) <span class="fu">return</span>(x[n])</span>
<span id="cb557-11"><a href="nfl.html#cb557-11" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb557-12"><a href="nfl.html#cb557-12" tabindex="-1"></a>  }</span>
<span id="cb557-13"><a href="nfl.html#cb557-13" tabindex="-1"></a>  </span>
<span id="cb557-14"><a href="nfl.html#cb557-14" tabindex="-1"></a>  <span class="co"># Split data by season and team</span></span>
<span id="cb557-15"><a href="nfl.html#cb557-15" tabindex="-1"></a>  split_data <span class="ot">&lt;-</span> <span class="fu">split</span>(ranked_wr_data, </span>
<span id="cb557-16"><a href="nfl.html#cb557-16" tabindex="-1"></a>                      <span class="fu">list</span>(ranked_wr_data<span class="sc">$</span>season, ranked_wr_data<span class="sc">$</span>team))</span>
<span id="cb557-17"><a href="nfl.html#cb557-17" tabindex="-1"></a>  </span>
<span id="cb557-18"><a href="nfl.html#cb557-18" tabindex="-1"></a>  <span class="co"># Create result data frame</span></span>
<span id="cb557-19"><a href="nfl.html#cb557-19" tabindex="-1"></a>  result_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(split_data, <span class="cf">function</span>(group) {</span>
<span id="cb557-20"><a href="nfl.html#cb557-20" tabindex="-1"></a>    <span class="co"># If the group is empty, return NULL</span></span>
<span id="cb557-21"><a href="nfl.html#cb557-21" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(group) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb557-22"><a href="nfl.html#cb557-22" tabindex="-1"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>) </span>
<span id="cb557-23"><a href="nfl.html#cb557-23" tabindex="-1"></a>    }</span>
<span id="cb557-24"><a href="nfl.html#cb557-24" tabindex="-1"></a>    </span>
<span id="cb557-25"><a href="nfl.html#cb557-25" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb557-26"><a href="nfl.html#cb557-26" tabindex="-1"></a>      <span class="at">season =</span> <span class="fu">unique</span>(group<span class="sc">$</span>season),</span>
<span id="cb557-27"><a href="nfl.html#cb557-27" tabindex="-1"></a>      <span class="at">team =</span> <span class="fu">unique</span>(group<span class="sc">$</span>team),</span>
<span id="cb557-28"><a href="nfl.html#cb557-28" tabindex="-1"></a>      <span class="at">WR1_name =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>name, <span class="dv">1</span>),</span>
<span id="cb557-29"><a href="nfl.html#cb557-29" tabindex="-1"></a>      <span class="at">WR1_yards =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>receiving_yards, <span class="dv">1</span>),</span>
<span id="cb557-30"><a href="nfl.html#cb557-30" tabindex="-1"></a>      <span class="at">WR2_name =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>name, <span class="dv">2</span>),</span>
<span id="cb557-31"><a href="nfl.html#cb557-31" tabindex="-1"></a>      <span class="at">WR2_yards =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>receiving_yards, <span class="dv">2</span>),</span>
<span id="cb557-32"><a href="nfl.html#cb557-32" tabindex="-1"></a>      <span class="at">WR3_name =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>name, <span class="dv">3</span>),</span>
<span id="cb557-33"><a href="nfl.html#cb557-33" tabindex="-1"></a>      <span class="at">WR3_yards =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>receiving_yards, <span class="dv">3</span>),</span>
<span id="cb557-34"><a href="nfl.html#cb557-34" tabindex="-1"></a>      <span class="at">WR4_name =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>name, <span class="dv">4</span>),</span>
<span id="cb557-35"><a href="nfl.html#cb557-35" tabindex="-1"></a>      <span class="at">WR4_yards =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>receiving_yards, <span class="dv">4</span>),</span>
<span id="cb557-36"><a href="nfl.html#cb557-36" tabindex="-1"></a>      <span class="at">WR5_name =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>name, <span class="dv">5</span>),</span>
<span id="cb557-37"><a href="nfl.html#cb557-37" tabindex="-1"></a>      <span class="at">WR5_yards =</span> <span class="fu">get_nth</span>(group<span class="sc">$</span>receiving_yards, <span class="dv">5</span>),</span>
<span id="cb557-38"><a href="nfl.html#cb557-38" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb557-39"><a href="nfl.html#cb557-39" tabindex="-1"></a>    )</span>
<span id="cb557-40"><a href="nfl.html#cb557-40" tabindex="-1"></a>  })</span>
<span id="cb557-41"><a href="nfl.html#cb557-41" tabindex="-1"></a>  </span>
<span id="cb557-42"><a href="nfl.html#cb557-42" tabindex="-1"></a>  <span class="co"># Filter out NULL entries</span></span>
<span id="cb557-43"><a href="nfl.html#cb557-43" tabindex="-1"></a>  result_list <span class="ot">&lt;-</span> <span class="fu">Filter</span>(<span class="fu">Negate</span>(is.null), result_list)</span>
<span id="cb557-44"><a href="nfl.html#cb557-44" tabindex="-1"></a>  </span>
<span id="cb557-45"><a href="nfl.html#cb557-45" tabindex="-1"></a>  <span class="co"># Combine all data frames into one</span></span>
<span id="cb557-46"><a href="nfl.html#cb557-46" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, result_list)</span>
<span id="cb557-47"><a href="nfl.html#cb557-47" tabindex="-1"></a>  </span>
<span id="cb557-48"><a href="nfl.html#cb557-48" tabindex="-1"></a>  <span class="co"># Create team_key</span></span>
<span id="cb557-49"><a href="nfl.html#cb557-49" tabindex="-1"></a>  result<span class="sc">$</span>team_key <span class="ot">&lt;-</span> <span class="fu">paste</span>(result<span class="sc">$</span>team, result<span class="sc">$</span>season, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb557-50"><a href="nfl.html#cb557-50" tabindex="-1"></a>  </span>
<span id="cb557-51"><a href="nfl.html#cb557-51" tabindex="-1"></a>  <span class="co"># Reorder columns</span></span>
<span id="cb557-52"><a href="nfl.html#cb557-52" tabindex="-1"></a>  col_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;team_key&quot;</span>, <span class="st">&quot;season&quot;</span>, <span class="st">&quot;team&quot;</span>, </span>
<span id="cb557-53"><a href="nfl.html#cb557-53" tabindex="-1"></a>                 <span class="fu">names</span>(result)[<span class="sc">!</span><span class="fu">names</span>(result) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;team_key&quot;</span>, <span class="st">&quot;season&quot;</span>, <span class="st">&quot;team&quot;</span>)])</span>
<span id="cb557-54"><a href="nfl.html#cb557-54" tabindex="-1"></a>  result <span class="ot">&lt;-</span> result[, col_order]</span>
<span id="cb557-55"><a href="nfl.html#cb557-55" tabindex="-1"></a>  </span>
<span id="cb557-56"><a href="nfl.html#cb557-56" tabindex="-1"></a>  <span class="fu">rownames</span>(result) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb557-57"><a href="nfl.html#cb557-57" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb557-58"><a href="nfl.html#cb557-58" tabindex="-1"></a>}</span>
<span id="cb557-59"><a href="nfl.html#cb557-59" tabindex="-1"></a></span>
<span id="cb557-60"><a href="nfl.html#cb557-60" tabindex="-1"></a><span class="co"># Create a function to calculate dense rank</span></span>
<span id="cb557-61"><a href="nfl.html#cb557-61" tabindex="-1"></a>dense_rank_desc <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb557-62"><a href="nfl.html#cb557-62" tabindex="-1"></a>  <span class="co"># Sort unique values in descending order</span></span>
<span id="cb557-63"><a href="nfl.html#cb557-63" tabindex="-1"></a>  sorted_unique <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(x), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb557-64"><a href="nfl.html#cb557-64" tabindex="-1"></a>  <span class="co"># Create rank mapping</span></span>
<span id="cb557-65"><a href="nfl.html#cb557-65" tabindex="-1"></a>  rank_map <span class="ot">&lt;-</span> <span class="fu">seq_along</span>(sorted_unique)</span>
<span id="cb557-66"><a href="nfl.html#cb557-66" tabindex="-1"></a>  <span class="fu">names</span>(rank_map) <span class="ot">&lt;-</span> sorted_unique</span>
<span id="cb557-67"><a href="nfl.html#cb557-67" tabindex="-1"></a>  <span class="co"># Return ranks</span></span>
<span id="cb557-68"><a href="nfl.html#cb557-68" tabindex="-1"></a>  rank_map[<span class="fu">as.character</span>(x)]</span>
<span id="cb557-69"><a href="nfl.html#cb557-69" tabindex="-1"></a>}</span>
<span id="cb557-70"><a href="nfl.html#cb557-70" tabindex="-1"></a></span>
<span id="cb557-71"><a href="nfl.html#cb557-71" tabindex="-1"></a><span class="co"># Split data by season and team</span></span>
<span id="cb557-72"><a href="nfl.html#cb557-72" tabindex="-1"></a>splits <span class="ot">&lt;-</span> <span class="fu">split</span>(wr_data, <span class="fu">list</span>(wr_data<span class="sc">$</span>season, wr_data<span class="sc">$</span>team))</span>
<span id="cb557-73"><a href="nfl.html#cb557-73" tabindex="-1"></a></span>
<span id="cb557-74"><a href="nfl.html#cb557-74" tabindex="-1"></a><span class="co"># Function to process each group</span></span>
<span id="cb557-75"><a href="nfl.html#cb557-75" tabindex="-1"></a>process_group <span class="ot">&lt;-</span> <span class="cf">function</span>(group) {</span>
<span id="cb557-76"><a href="nfl.html#cb557-76" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(group) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb557-77"><a href="nfl.html#cb557-77" tabindex="-1"></a>  </span>
<span id="cb557-78"><a href="nfl.html#cb557-78" tabindex="-1"></a>  <span class="co"># Calculate rank within group</span></span>
<span id="cb557-79"><a href="nfl.html#cb557-79" tabindex="-1"></a>  group<span class="sc">$</span>rank <span class="ot">&lt;-</span> <span class="fu">dense_rank_desc</span>(group<span class="sc">$</span>receiving_yards)</span>
<span id="cb557-80"><a href="nfl.html#cb557-80" tabindex="-1"></a>  </span>
<span id="cb557-81"><a href="nfl.html#cb557-81" tabindex="-1"></a>  <span class="co"># Select only needed columns</span></span>
<span id="cb557-82"><a href="nfl.html#cb557-82" tabindex="-1"></a>  cols_to_keep <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;season&quot;</span>, <span class="st">&quot;team&quot;</span>, <span class="st">&quot;name&quot;</span>, <span class="st">&quot;receiving_yards&quot;</span>, <span class="st">&quot;rank&quot;</span>)</span>
<span id="cb557-83"><a href="nfl.html#cb557-83" tabindex="-1"></a>  group <span class="ot">&lt;-</span> group[, cols_to_keep[cols_to_keep <span class="sc">%in%</span> <span class="fu">names</span>(group)]]</span>
<span id="cb557-84"><a href="nfl.html#cb557-84" tabindex="-1"></a>  </span>
<span id="cb557-85"><a href="nfl.html#cb557-85" tabindex="-1"></a>  <span class="fu">return</span>(group)</span>
<span id="cb557-86"><a href="nfl.html#cb557-86" tabindex="-1"></a>}</span>
<span id="cb557-87"><a href="nfl.html#cb557-87" tabindex="-1"></a></span>
<span id="cb557-88"><a href="nfl.html#cb557-88" tabindex="-1"></a><span class="co"># Apply processing to each group and combine results</span></span>
<span id="cb557-89"><a href="nfl.html#cb557-89" tabindex="-1"></a>ranked_wr_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(splits, process_group))</span>
<span id="cb557-90"><a href="nfl.html#cb557-90" tabindex="-1"></a></span>
<span id="cb557-91"><a href="nfl.html#cb557-91" tabindex="-1"></a><span class="co"># Reset row names</span></span>
<span id="cb557-92"><a href="nfl.html#cb557-92" tabindex="-1"></a><span class="fu">rownames</span>(ranked_wr_data) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb557-93"><a href="nfl.html#cb557-93" tabindex="-1"></a></span>
<span id="cb557-94"><a href="nfl.html#cb557-94" tabindex="-1"></a><span class="co"># Create WR summary</span></span>
<span id="cb557-95"><a href="nfl.html#cb557-95" tabindex="-1"></a>wr_summary <span class="ot">&lt;-</span> <span class="fu">get_top_wr_team_members</span>(ranked_wr_data)</span>
<span id="cb557-96"><a href="nfl.html#cb557-96" tabindex="-1"></a></span>
<span id="cb557-97"><a href="nfl.html#cb557-97" tabindex="-1"></a><span class="co"># Check structure</span></span>
<span id="cb557-98"><a href="nfl.html#cb557-98" tabindex="-1"></a><span class="fu">str</span>(wr_summary)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    326 obs. of  13 variables:
##  $ team_key : chr  &quot;ARI_2016&quot; &quot;ARI_2017&quot; &quot;ARI_2018&quot; &quot;ARI_2019&quot; ...
##  $ season   : num  2016 2017 2018 2019 2020 ...
##  $ team     : chr  &quot;ARI&quot; &quot;ARI&quot; &quot;ARI&quot; &quot;ARI&quot; ...
##  $ WR1_name : chr  &quot;Larry Fitzgerald&quot; &quot;Larry Fitzgerald&quot; &quot;Larry Fitzgerald&quot; &quot;Larry Fitzgerald&quot; ...
##  $ WR1_yards: num  1023 1156 734 804 1407 ...
##  $ WR2_name : chr  &quot;J.J. Nelson&quot; &quot;J.J. Nelson&quot; &quot;Christian Kirk&quot; &quot;Christian Kirk&quot; ...
##  $ WR2_yards: num  568 508 590 709 621 848 709 565 711 921 ...
##  $ WR3_name : chr  &quot;John Brown&quot; &quot;Jaron Brown&quot; &quot;Trent Sherfield&quot; &quot;Damiere Byrd&quot; ...
##  $ WR3_yards: num  517 477 210 359 409 572 467 352 580 556 ...
##  $ WR4_name : chr  &quot;Jaron Brown&quot; &quot;John Brown&quot; &quot;Chad Williams&quot; &quot;Pharoh Cooper&quot; ...
##  $ WR4_yards: num  187 299 171 243 224 435 414 280 210 504 ...
##  $ WR5_name : chr  &quot;Brittan Golden&quot; &quot;Brittan Golden&quot; &quot;J.J. Nelson&quot; &quot;Andy Isabella&quot; ...
##  $ WR5_yards: num  82 70 64 189 173 208 236 19 12 102 ...</code></pre>
</div>
<div id="testing" class="section level2 hasAnchor" number="16.7">
<h2><span class="header-section-number">16.7</span> Testing<a href="nfl.html#testing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="nfl.html#cb559-1" tabindex="-1"></a><span class="co"># Create team_key and merge with wr_summary</span></span>
<span id="cb559-2"><a href="nfl.html#cb559-2" tabindex="-1"></a>wr_data_final <span class="ot">&lt;-</span> wr_data</span>
<span id="cb559-3"><a href="nfl.html#cb559-3" tabindex="-1"></a>wr_data_final<span class="sc">$</span>team_key <span class="ot">&lt;-</span> <span class="fu">paste</span>(wr_data_final<span class="sc">$</span>team, wr_data_final<span class="sc">$</span>season, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb559-4"><a href="nfl.html#cb559-4" tabindex="-1"></a>wr_data_final <span class="ot">&lt;-</span> <span class="fu">merge</span>(wr_data_final, wr_summary, <span class="at">by =</span> <span class="st">&quot;team_key&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb559-5"><a href="nfl.html#cb559-5" tabindex="-1"></a></span>
<span id="cb559-6"><a href="nfl.html#cb559-6" tabindex="-1"></a><span class="co"># Rename columns and create initial wr_dataf</span></span>
<span id="cb559-7"><a href="nfl.html#cb559-7" tabindex="-1"></a>wr_dataf <span class="ot">&lt;-</span> wr_data_final</span>
<span id="cb559-8"><a href="nfl.html#cb559-8" tabindex="-1"></a><span class="fu">names</span>(wr_dataf)[<span class="fu">names</span>(wr_dataf) <span class="sc">==</span> <span class="st">&quot;season.x&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;season&quot;</span></span>
<span id="cb559-9"><a href="nfl.html#cb559-9" tabindex="-1"></a><span class="fu">names</span>(wr_dataf)[<span class="fu">names</span>(wr_dataf) <span class="sc">==</span> <span class="st">&quot;team.x&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;team&quot;</span></span>
<span id="cb559-10"><a href="nfl.html#cb559-10" tabindex="-1"></a><span class="fu">names</span>(wr_dataf)[<span class="fu">names</span>(wr_dataf) <span class="sc">==</span> <span class="st">&quot;name&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;player_name&quot;</span></span>
<span id="cb559-11"><a href="nfl.html#cb559-11" tabindex="-1"></a></span>
<span id="cb559-12"><a href="nfl.html#cb559-12" tabindex="-1"></a><span class="co"># Remove ID column if it exists</span></span>
<span id="cb559-13"><a href="nfl.html#cb559-13" tabindex="-1"></a><span class="cf">if</span>(<span class="st">&quot;id&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(wr_dataf)) {</span>
<span id="cb559-14"><a href="nfl.html#cb559-14" tabindex="-1"></a>    wr_dataf <span class="ot">&lt;-</span> wr_dataf[, <span class="sc">!</span><span class="fu">names</span>(wr_dataf) <span class="sc">==</span> <span class="st">&quot;id&quot;</span>]</span>
<span id="cb559-15"><a href="nfl.html#cb559-15" tabindex="-1"></a>}</span>
<span id="cb559-16"><a href="nfl.html#cb559-16" tabindex="-1"></a></span>
<span id="cb559-17"><a href="nfl.html#cb559-17" tabindex="-1"></a><span class="co"># Subset 2023 data</span></span>
<span id="cb559-18"><a href="nfl.html#cb559-18" tabindex="-1"></a>wr_2023 <span class="ot">&lt;-</span> wr_dataf[wr_dataf<span class="sc">$</span>season <span class="sc">==</span> <span class="dv">2023</span>, ]</span>
<span id="cb559-19"><a href="nfl.html#cb559-19" tabindex="-1"></a></span>
<span id="cb559-20"><a href="nfl.html#cb559-20" tabindex="-1"></a><span class="co"># Create next season&#39;s fantasy points</span></span>
<span id="cb559-21"><a href="nfl.html#cb559-21" tabindex="-1"></a>create_next_points <span class="ot">&lt;-</span> <span class="cf">function</span>(points, player) {</span>
<span id="cb559-22"><a href="nfl.html#cb559-22" tabindex="-1"></a>    <span class="fu">ave</span>(points, player, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">c</span>(x[<span class="sc">-</span><span class="dv">1</span>], <span class="cn">NA</span>))</span>
<span id="cb559-23"><a href="nfl.html#cb559-23" tabindex="-1"></a>}</span>
<span id="cb559-24"><a href="nfl.html#cb559-24" tabindex="-1"></a>wr_dataf<span class="sc">$</span>next_fantasy_points <span class="ot">&lt;-</span> <span class="fu">create_next_points</span>(wr_dataf<span class="sc">$</span>fantasy_points, wr_dataf<span class="sc">$</span>player_name)</span>
<span id="cb559-25"><a href="nfl.html#cb559-25" tabindex="-1"></a>wr_dataf<span class="sc">$</span>next_fantasy_points_ppr <span class="ot">&lt;-</span> <span class="fu">create_next_points</span>(wr_dataf<span class="sc">$</span>fantasy_points_ppr, wr_dataf<span class="sc">$</span>player_name)</span>
<span id="cb559-26"><a href="nfl.html#cb559-26" tabindex="-1"></a></span>
<span id="cb559-27"><a href="nfl.html#cb559-27" tabindex="-1"></a><span class="co"># Filter rookie seasons</span></span>
<span id="cb559-28"><a href="nfl.html#cb559-28" tabindex="-1"></a>wr_dataf <span class="ot">&lt;-</span> wr_dataf[wr_dataf<span class="sc">$</span>rookie_season <span class="sc">!=</span> <span class="dv">0</span>, ]</span>
<span id="cb559-29"><a href="nfl.html#cb559-29" tabindex="-1"></a>wr_dataf <span class="ot">&lt;-</span> wr_dataf[wr_dataf<span class="sc">$</span>rookie_season <span class="sc">!=</span> wr_dataf<span class="sc">$</span>season, ]</span>
<span id="cb559-30"><a href="nfl.html#cb559-30" tabindex="-1"></a></span>
<span id="cb559-31"><a href="nfl.html#cb559-31" tabindex="-1"></a><span class="co"># Remove next_fantasy_points_ppr</span></span>
<span id="cb559-32"><a href="nfl.html#cb559-32" tabindex="-1"></a>wr_dataf<span class="sc">$</span>next_fantasy_points_ppr <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb559-33"><a href="nfl.html#cb559-33" tabindex="-1"></a></span>
<span id="cb559-34"><a href="nfl.html#cb559-34" tabindex="-1"></a><span class="co"># Remove zero-variance columns</span></span>
<span id="cb559-35"><a href="nfl.html#cb559-35" tabindex="-1"></a>n_distinct <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">unique</span>(x))</span>
<span id="cb559-36"><a href="nfl.html#cb559-36" tabindex="-1"></a>zero_var_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(wr_dataf)[<span class="fu">sapply</span>(wr_dataf, n_distinct) <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb559-37"><a href="nfl.html#cb559-37" tabindex="-1"></a>wr_dataf <span class="ot">&lt;-</span> wr_dataf[, <span class="sc">!</span><span class="fu">names</span>(wr_dataf) <span class="sc">%in%</span> zero_var_cols]</span>
<span id="cb559-38"><a href="nfl.html#cb559-38" tabindex="-1"></a></span>
<span id="cb559-39"><a href="nfl.html#cb559-39" tabindex="-1"></a><span class="co"># Remove non-predictive columns</span></span>
<span id="cb559-40"><a href="nfl.html#cb559-40" tabindex="-1"></a>columns_to_remove <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;player_name&quot;</span>, <span class="st">&quot;team_key&quot;</span>, <span class="st">&quot;WR2_name&quot;</span>, <span class="st">&quot;WR1_name&quot;</span>, </span>
<span id="cb559-41"><a href="nfl.html#cb559-41" tabindex="-1"></a>                      <span class="st">&quot;RB3_name&quot;</span>, <span class="st">&quot;RB2_name&quot;</span>, <span class="st">&quot;RB1_name&quot;</span>, <span class="st">&quot;QB_name&quot;</span>, </span>
<span id="cb559-42"><a href="nfl.html#cb559-42" tabindex="-1"></a>                      <span class="st">&quot;season&quot;</span>, <span class="st">&quot;team&quot;</span>, <span class="st">&quot;season.y&quot;</span>, <span class="st">&quot;team.y&quot;</span>)</span>
<span id="cb559-43"><a href="nfl.html#cb559-43" tabindex="-1"></a>wr_dataf <span class="ot">&lt;-</span> wr_dataf[, <span class="sc">!</span><span class="fu">names</span>(wr_dataf) <span class="sc">%in%</span> columns_to_remove]</span>
<span id="cb559-44"><a href="nfl.html#cb559-44" tabindex="-1"></a></span>
<span id="cb559-45"><a href="nfl.html#cb559-45" tabindex="-1"></a><span class="co"># Train Random Forest model</span></span>
<span id="cb559-46"><a href="nfl.html#cb559-46" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(next_fantasy_points <span class="sc">~</span> ., </span>
<span id="cb559-47"><a href="nfl.html#cb559-47" tabindex="-1"></a>                        <span class="at">ntree =</span> <span class="dv">1200</span>, </span>
<span id="cb559-48"><a href="nfl.html#cb559-48" tabindex="-1"></a>                        <span class="at">data =</span> wr_dataf, </span>
<span id="cb559-49"><a href="nfl.html#cb559-49" tabindex="-1"></a>                        <span class="at">importance =</span> <span class="cn">TRUE</span>, </span>
<span id="cb559-50"><a href="nfl.html#cb559-50" tabindex="-1"></a>                        <span class="at">na.action =</span> na.omit)</span>
<span id="cb559-51"><a href="nfl.html#cb559-51" tabindex="-1"></a></span>
<span id="cb559-52"><a href="nfl.html#cb559-52" tabindex="-1"></a><span class="co"># Calculate performance metrics</span></span>
<span id="cb559-53"><a href="nfl.html#cb559-53" tabindex="-1"></a>oob_predictions <span class="ot">&lt;-</span> rf_model<span class="sc">$</span>predicted</span>
<span id="cb559-54"><a href="nfl.html#cb559-54" tabindex="-1"></a>absolute_errors <span class="ot">&lt;-</span> <span class="fu">abs</span>(oob_predictions <span class="sc">-</span> rf_model<span class="sc">$</span>y)</span>
<span id="cb559-55"><a href="nfl.html#cb559-55" tabindex="-1"></a>oob_mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(absolute_errors)</span>
<span id="cb559-56"><a href="nfl.html#cb559-56" tabindex="-1"></a>oob_mse <span class="ot">&lt;-</span> rf_model<span class="sc">$</span>mse[<span class="dv">1200</span>]</span>
<span id="cb559-57"><a href="nfl.html#cb559-57" tabindex="-1"></a>oobrmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(oob_mse)</span>
<span id="cb559-58"><a href="nfl.html#cb559-58" tabindex="-1"></a></span>
<span id="cb559-59"><a href="nfl.html#cb559-59" tabindex="-1"></a><span class="co"># Print metrics</span></span>
<span id="cb559-60"><a href="nfl.html#cb559-60" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;OOB MAE:&quot;</span>, oob_mae))</span></code></pre></div>
<pre><code>## [1] &quot;OOB MAE: 33.185773344464&quot;</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="nfl.html#cb561-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;OOB rMSE:&quot;</span>, oobrmse))</span></code></pre></div>
<pre><code>## [1] &quot;OOB rMSE: 43.5526590552396&quot;</code></pre>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="nfl.html#cb563-1" tabindex="-1"></a><span class="co"># Feature importance</span></span>
<span id="cb563-2"><a href="nfl.html#cb563-2" tabindex="-1"></a>importance_values <span class="ot">&lt;-</span> <span class="fu">importance</span>(rf_model)</span>
<span id="cb563-3"><a href="nfl.html#cb563-3" tabindex="-1"></a>ordered_importance <span class="ot">&lt;-</span> <span class="fu">order</span>(importance_values[, <span class="st">&quot;%IncMSE&quot;</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb563-4"><a href="nfl.html#cb563-4" tabindex="-1"></a>top10_mse <span class="ot">&lt;-</span> importance_values[ordered_importance[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], ]</span>
<span id="cb563-5"><a href="nfl.html#cb563-5" tabindex="-1"></a></span>
<span id="cb563-6"><a href="nfl.html#cb563-6" tabindex="-1"></a><span class="co"># Plot importance</span></span>
<span id="cb563-7"><a href="nfl.html#cb563-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb563-8"><a href="nfl.html#cb563-8" tabindex="-1"></a><span class="fu">barplot</span>(top10_mse[, <span class="st">&quot;%IncMSE&quot;</span>], </span>
<span id="cb563-9"><a href="nfl.html#cb563-9" tabindex="-1"></a>        <span class="at">names.arg =</span> <span class="fu">rownames</span>(top10_mse),</span>
<span id="cb563-10"><a href="nfl.html#cb563-10" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;Top 10 Features by %IncMSE (Enhanced Model)&quot;</span>,</span>
<span id="cb563-11"><a href="nfl.html#cb563-11" tabindex="-1"></a>        <span class="at">las =</span> <span class="dv">2</span>, </span>
<span id="cb563-12"><a href="nfl.html#cb563-12" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb563-13"><a href="nfl.html#cb563-13" tabindex="-1"></a>        <span class="at">horiz =</span> <span class="cn">TRUE</span>, </span>
<span id="cb563-14"><a href="nfl.html#cb563-14" tabindex="-1"></a>        <span class="at">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-236-1.png" width="672" /></p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="nfl.html#cb564-1" tabindex="-1"></a><span class="co"># Save player names and clean 2023 data</span></span>
<span id="cb564-2"><a href="nfl.html#cb564-2" tabindex="-1"></a>nms <span class="ot">&lt;-</span> wr_2023<span class="sc">$</span>player_name</span>
<span id="cb564-3"><a href="nfl.html#cb564-3" tabindex="-1"></a>wr_2023 <span class="ot">&lt;-</span> wr_2023[, <span class="sc">!</span><span class="fu">names</span>(wr_2023) <span class="sc">%in%</span> <span class="fu">c</span>(zero_var_cols, columns_to_remove)]</span>
<span id="cb564-4"><a href="nfl.html#cb564-4" tabindex="-1"></a></span>
<span id="cb564-5"><a href="nfl.html#cb564-5" tabindex="-1"></a><span class="co"># Generate predictions</span></span>
<span id="cb564-6"><a href="nfl.html#cb564-6" tabindex="-1"></a>predicted_2024_fantasy_points <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata =</span> wr_2023)</span>
<span id="cb564-7"><a href="nfl.html#cb564-7" tabindex="-1"></a></span>
<span id="cb564-8"><a href="nfl.html#cb564-8" tabindex="-1"></a><span class="co"># Create and sort results</span></span>
<span id="cb564-9"><a href="nfl.html#cb564-9" tabindex="-1"></a>results_wr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb564-10"><a href="nfl.html#cb564-10" tabindex="-1"></a>    <span class="at">name =</span> nms,</span>
<span id="cb564-11"><a href="nfl.html#cb564-11" tabindex="-1"></a>    <span class="at">predicted_2024_fantasy_points =</span> predicted_2024_fantasy_points</span>
<span id="cb564-12"><a href="nfl.html#cb564-12" tabindex="-1"></a>)</span>
<span id="cb564-13"><a href="nfl.html#cb564-13" tabindex="-1"></a>results_wr <span class="ot">&lt;-</span> results_wr[<span class="fu">order</span>(results_wr<span class="sc">$</span>predicted_2024_fantasy_points, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb564-14"><a href="nfl.html#cb564-14" tabindex="-1"></a></span>
<span id="cb564-15"><a href="nfl.html#cb564-15" tabindex="-1"></a><span class="co"># Print predictions</span></span>
<span id="cb564-16"><a href="nfl.html#cb564-16" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;2024 WR Predictions (Enhanced Model):&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2024 WR Predictions (Enhanced Model):&quot;</code></pre>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="nfl.html#cb566-1" tabindex="-1"></a><span class="fu">print</span>(results_wr)</span></code></pre></div>
<pre><code>##                          name predicted_2024_fantasy_points
## 1243              Tyreek Hill                    185.162621
## 709         Amon-Ra St. Brown                    181.902197
## 571               CeeDee Lamb                    176.375749
## 1104               Puka Nacua                    173.810705
## 1667               A.J. Brown                    156.575436
## 836              Nico Collins                    147.701385
## 1149             Keenan Allen                    144.626829
## 1298         Justin Jefferson                    138.842454
## 381                D.J. Moore                    138.780915
## 1869            Brandon Aiyuk                    138.453522
## 1437              Chris Olave                    137.055756
## 449             Ja&#39;Marr Chase                    135.917803
## 835                 Tank Dell                    135.092963
## 1950               Mike Evans                    129.856823
## 1173            Davante Adams                    127.095602
## 1874             Deebo Samuel                    125.512753
## 569             Brandin Cooks                    125.328287
## 1244            Jaylen Waddle                    124.441766
## 1732           George Pickens                    120.920435
## 503              Amari Cooper                    118.602809
## 244              Stefon Diggs                    117.551138
## 1664            DeVonta Smith                    112.078249
## 2023          DeAndre Hopkins                    111.497775
## 984             Calvin Ridley                    108.000884
## 1602           Garrett Wilson                    104.717264
## 1949             Chris Godwin                    104.210092
## 780               Jayden Reed                    103.529231
## 1296           Jordan Addison                    100.667143
## 2101           Terry McLaurin                    100.389592
## 1734          Diontae Johnson                     99.751770
## 49             Marquise Brown                     96.965655
## 986            Christian Kirk                     95.732603
## 1370      JuJu Smith-Schuster                     95.419767
## 1109              Cooper Kupp                     93.957530
## 170            Nelson Agholor                     92.892029
## 1801            Tyler Lockett                     92.884345
## 640          Courtland Sutton                     92.713896
## 505              Elijah Moore                     90.776869
## 169               Zay Flowers                     90.768064
## 711              Marvin Jones                     89.829859
## 1441           Rashid Shaheed                     89.650017
## 456               Tee Higgins                     89.281682
## 119              Drake London                     88.013422
## 784               Romeo Doubs                     87.764446
## 786          Christian Watson                     85.741719
## 639               Jerry Jeudy                     80.608937
## 1105              Tutu Atwell                     78.751648
## 1055              Rashee Rice                     78.091953
## 907                Josh Downs                     77.574511
## 1150              Josh Palmer                     76.983056
## 834              Robert Woods                     76.829277
## 1371          Demario Douglas                     76.507717
## 1247           Chase Claypool                     75.226794
## 2096            Curtis Samuel                     74.858425
## 300            Jonathan Mingo                     73.380302
## 1153         Quentin Johnston                     73.238412
## 453                Tyler Boyd                     72.865363
## 1733           Allen Robinson                     71.645617
## 2100             Jahan Dotson                     71.436261
## 1525           Darius Slayton                     71.088471
## 785                 Bo Melton                     70.135551
## 1524        Wan&#39;Dale Robinson                     69.948916
## 1800       Jaxon Smith-Njigba                     69.461586
## 47             Michael Wilson                     68.431257
## 306              Adam Thielen                     67.960838
## 782          Dontayvion Wicks                     67.672484
## 1107        Demarcus Robinson                     67.517942
## 905               Alec Pierce                     66.141972
## 120              Mack Hollins                     65.823145
## 1603             Randall Cobb                     65.553190
## 1175            Jakobi Meyers                     64.292969
## 168            Rashod Bateman                     63.942489
## 455             Trenton Irwin                     63.889527
## 1665              Julio Jones                     63.091664
## 1365           DeVante Parker                     61.914881
## 242             Khalil Shakir                     61.345004
## 1440           Michael Thomas                     60.914386
## 1605             Allen Lazard                     58.735050
## 1522              Jalin Hyatt                     58.300095
## 507          Marquise Goodwin                     57.427049
## 1151            Mike Williams                     57.196543
## 506            Cedric Tillman                     56.528484
## 51              Rondale Moore                     56.160105
## 1871             Willie Snead                     52.976833
## 643               Marvin Mims                     52.964329
## 1052             Richie James                     52.804939
## 832                Noah Brown                     52.679326
## 1154            Alex Erickson                     52.509506
## 378            Darnell Mooney                     52.086392
## 1369          Kendrick Bourne                     51.253158
## 2024              Chris Moore                     50.045149
## 988                 Zay Jones                     49.764489
## 2028            Treylon Burks                     49.640461
## 1057 Marquez Valdes-Scantling                     49.377940
## 708          Jameson Williams                     49.324772
## 1951              Trey Palmer                     48.739577
## 1172               Tre Tucker                     48.528006
## 173          Laquon Treadwell                     48.210274
## 1054           Kadarius Toney                     48.115705
## 1299              K.J. Osborn                     47.591019
## 1438               A.T. Perry                     46.901041
## 1176           DeAndre Carter                     46.119276
## 1174           Hunter Renfrow                     45.005643
## 1056               Skyy Moore                     44.714032
## 568             Jalen Tolbert                     44.321699
## 1248            Erik Ezukanma                     43.473493
## 1870             Chris Conley                     43.341574
## 1152             Derius Davis                     43.210672
## 1368             Jalen Reagor                     42.651032
## 1526           Isaiah Hodgins                     42.549517
## 1301           Brandon Powell                     41.731107
## 379               Tyler Scott                     41.636601
## 1872              Ronnie Bell                     41.324308
## 1873           Jauan Jennings                     41.262680
## 50                Greg Dortch                     40.800184
## 1604            Xavier Gipson                     40.793818
## 2097          Jamison Crowder                     40.759849
## 638           Brandon Johnson                     39.362354
## 171            Devin Duvernay                     39.212830
## 454            Andrei Iosivas                     39.185428
## 2026    Nick Westbrook-Ikhine                     38.663963
## 572              Jalen Brooks                     37.934622
## 710             Josh Reynolds                     37.847174
## 1663             Quez Watkins                     37.468539
## 1523          Parris Campbell                     37.392809
## 1730            Calvin Austin                     37.079670
## 1108            Tyler Johnson                     36.189691
## 48                Zach Pascal                     35.976621
## 383              Trent Taylor                     34.774925
## 502                David Bell                     34.412056
## 837         Xavier Hutchinson                     34.147361
## 1607           Jason Brownlee                     33.931763
## 1527         Sterling Shepard                     33.816765
## 1155              Keelan Doss                     33.138372
## 989               Jamal Agnew                     33.015933
## 985         Parker Washington                     32.752353
## 570            Michael Gallup                     32.693754
## 1364          Tyquan Thornton                     32.280751
## 906           Isaiah McKenzie                     31.911440
## 504              James Proche                     31.888204
## 1051           Mecole Hardman                     30.967637
## 1246          Braxton Berrios                     30.411571
## 1053            Justin Watson                     30.253522
## 1948          Deven Thompkins                     29.802537
## 240           Trent Sherfield                     29.589862
## 1802                Jake Bobo                     29.321234
## 305      Ihmir Smith-Marsette                     29.141881
## 1147              Simi Fehoko                     28.591626
## 783               Malik Heath                     27.692556
## 117             Van Jefferson                     27.144753
## 2099              Dyami Brown                     27.010045
## 2025             Kyle Philips                     26.721271
## 641           Phillip Dorsett                     26.244963
## 1297             Jalen Nailor                     26.176881
## 1666        Olamide Zaccheaus                     26.140126
## 382            Collin Johnson                     26.052158
## 1367            Ty Montgomery                     25.724863
## 1300         Trishton Jackson                     25.583921
## 1731             Miles Boykin                     25.108936
## 1366           Kayshon Boutte                     24.964324
## 172             Tylan Wallace                     24.411415
## 380     Equanimeous St. Brown                     24.297427
## 1245            Robbie Chosen                     23.823578
## 712             Antoine Green                     23.785908
## 909             Amari Rodgers                     23.777108
## 983                 Tim Jones                     23.584516
## 707             Kalif Raymond                     23.134101
## 1875          Ray-Ray McCloud                     22.882116
## 706     Donovan Peoples-Jones                     22.714729
## 1436           Keith Kirkwood                     22.444647
## 116            KhaDarel Hodge                     21.997801
## 1103          Austin Trammell                     20.917124
## 642       Lil&#39;Jordan Humphrey                     20.895207
## 118              Scott Miller                     20.411157
## 1148             Jalen Guyton                     20.293935
## 1803         D&#39;Wayne Eskridge                     20.213843
## 1799            Cody Thompson                     20.101604
## 451             Charlie Jones                     19.442446
## 1606            Irvin Charles                     19.035434
## 904           D.J. Montgomery                     18.224262
## 1106            Ben Skowronek                     17.767927
## 1528         Gunner Olszewski                     17.594065
## 903            Juwann Winfree                     17.539985
## 450          Shedrick Jackson                     17.439769
## 1242           River Cracraft                     16.962426
## 2098            Byron Pringle                     16.638514
## 781              Samori Toure                     16.189997
## 1668            Britain Covey                     15.996191
## 1952            Rakim Jarrett                     15.667073
## 1953              David Moore                     15.505266
## 2022            Colton Dowell                     14.706743
## 1608             Malik Taylor                     14.628111
## 241              Deonte Harty                     13.234701
## 303             Mike Strachan                     12.597809
## 987              Elijah Cooks                     12.225265
## 1058              Justyn Ross                     11.635965
## 833               Steven Sims                     11.447536
## 2027             Mason Kinsey                      9.686098
## 243                Gabe Davis                            NA
## 301          Laviska Shenault                            NA
## 302                D.J. Chark                            NA
## 304          Terrace Marshall                            NA
## 377               Velus Jones                            NA
## 452           Kwamie Lassiter                            NA
## 908           Michael Pittman                            NA
## 1439              Lynn Bowden                            NA
## 1804               DK Metcalf                            NA</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro-econ-stats.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/15_NFL.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
