<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 h20 | Machine Learning Applications</title>
  <meta name="description" content="Introduction" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 h20 | Machine Learning Applications" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Introduction" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 h20 | Machine Learning Applications" />
  
  <meta name="twitter:description" content="Introduction" />
  

<meta name="author" content="Simon P. Raymond" />


<meta name="date" content="2024-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multi-variable-classification.html"/>
<link rel="next" href="econometrics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MachineLearning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About Myself</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#notes-for-public"><i class="fa fa-check"></i><b>1.2</b> Notes for public</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#work-in-progress"><i class="fa fa-check"></i><b>1.3</b> Work in progress</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>2</b> Algorithms</a>
<ul>
<li class="chapter" data-level="2.1" data-path="algorithms.html"><a href="algorithms.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="algorithms.html"><a href="algorithms.html#parametric"><i class="fa fa-check"></i><b>2.2</b> Parametric</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="algorithms.html"><a href="algorithms.html#lm"><i class="fa fa-check"></i><b>2.2.1</b> LM</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="algorithms.html"><a href="algorithms.html#trees"><i class="fa fa-check"></i><b>2.3</b> Trees</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="algorithms.html"><a href="algorithms.html#cart"><i class="fa fa-check"></i><b>2.3.1</b> CART</a></li>
<li class="chapter" data-level="2.3.2" data-path="algorithms.html"><a href="algorithms.html#bagging"><i class="fa fa-check"></i><b>2.3.2</b> Bagging</a></li>
<li class="chapter" data-level="2.3.3" data-path="algorithms.html"><a href="algorithms.html#rf"><i class="fa fa-check"></i><b>2.3.3</b> RF</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="algorithms.html"><a href="algorithms.html#boosting"><i class="fa fa-check"></i><b>2.4</b> Boosting</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="algorithms.html"><a href="algorithms.html#adaboost"><i class="fa fa-check"></i><b>2.4.1</b> Adaboost</a></li>
<li class="chapter" data-level="2.4.2" data-path="algorithms.html"><a href="algorithms.html#gbm-boost"><i class="fa fa-check"></i><b>2.4.2</b> GBM boost</a></li>
<li class="chapter" data-level="2.4.3" data-path="algorithms.html"><a href="algorithms.html#xgboost"><i class="fa fa-check"></i><b>2.4.3</b> XGBoost</a></li>
<li class="chapter" data-level="2.4.4" data-path="algorithms.html"><a href="algorithms.html#light-gbm-boost"><i class="fa fa-check"></i><b>2.4.4</b> Light GBM boost</a></li>
<li class="chapter" data-level="2.4.5" data-path="algorithms.html"><a href="algorithms.html#catboost"><i class="fa fa-check"></i><b>2.4.5</b> Catboost</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="algorithms.html"><a href="algorithms.html#other-non-parametric"><i class="fa fa-check"></i><b>2.5</b> Other Non-parametric</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="algorithms.html"><a href="algorithms.html#knn"><i class="fa fa-check"></i><b>2.5.1</b> KNN</a></li>
<li class="chapter" data-level="2.5.2" data-path="algorithms.html"><a href="algorithms.html#nueralnet"><i class="fa fa-check"></i><b>2.5.2</b> Nueralnet</a></li>
<li class="chapter" data-level="2.5.3" data-path="algorithms.html"><a href="algorithms.html#svm"><i class="fa fa-check"></i><b>2.5.3</b> SVM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="binary-application.html"><a href="binary-application.html"><i class="fa fa-check"></i><b>3</b> Binary Application</a>
<ul>
<li class="chapter" data-level="3.1" data-path="binary-application.html"><a href="binary-application.html#data-1"><i class="fa fa-check"></i><b>3.1</b> Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="binary-application.html"><a href="binary-application.html#data-prep"><i class="fa fa-check"></i><b>3.1.1</b> Data Prep</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="binary-application.html"><a href="binary-application.html#model-selection"><i class="fa fa-check"></i><b>3.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="binary-application.html"><a href="binary-application.html#functions"><i class="fa fa-check"></i><b>3.2.1</b> Functions</a></li>
<li class="chapter" data-level="3.2.2" data-path="binary-application.html"><a href="binary-application.html#xgb"><i class="fa fa-check"></i><b>3.2.2</b> XGB</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="binary-application.html"><a href="binary-application.html#comparisions"><i class="fa fa-check"></i><b>3.3</b> Comparisions</a></li>
<li class="chapter" data-level="3.4" data-path="binary-application.html"><a href="binary-application.html#statistic-selection"><i class="fa fa-check"></i><b>3.4</b> Statistic selection</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="binary-application.html"><a href="binary-application.html#section"><i class="fa fa-check"></i><b>3.4.1</b> 0.5</a></li>
<li class="chapter" data-level="3.4.2" data-path="binary-application.html"><a href="binary-application.html#youdens-j-statistic"><i class="fa fa-check"></i><b>3.4.2</b> Youden’s J Statistic</a></li>
<li class="chapter" data-level="3.4.3" data-path="binary-application.html"><a href="binary-application.html#fscore"><i class="fa fa-check"></i><b>3.4.3</b> Fscore</a></li>
<li class="chapter" data-level="3.4.4" data-path="binary-application.html"><a href="binary-application.html#roc-curve"><i class="fa fa-check"></i><b>3.4.4</b> ROC curve</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regressional-application.html"><a href="regressional-application.html"><i class="fa fa-check"></i><b>4</b> Regressional Application</a>
<ul>
<li class="chapter" data-level="4.1" data-path="regressional-application.html"><a href="regressional-application.html#data-2"><i class="fa fa-check"></i><b>4.1</b> Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="regressional-application.html"><a href="regressional-application.html#data-prep-1"><i class="fa fa-check"></i><b>4.1.1</b> Data Prep</a></li>
<li class="chapter" data-level="4.1.2" data-path="regressional-application.html"><a href="regressional-application.html#data-explorations"><i class="fa fa-check"></i><b>4.1.2</b> Data Explorations</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="regressional-application.html"><a href="regressional-application.html#model-selection-1"><i class="fa fa-check"></i><b>4.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="regressional-application.html"><a href="regressional-application.html#rf-1"><i class="fa fa-check"></i><b>4.2.1</b> RF</a></li>
<li class="chapter" data-level="4.2.2" data-path="regressional-application.html"><a href="regressional-application.html#lm-1"><i class="fa fa-check"></i><b>4.2.2</b> LM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="imbalanced-application.html"><a href="imbalanced-application.html"><i class="fa fa-check"></i><b>5</b> Imbalanced Application</a>
<ul>
<li class="chapter" data-level="5.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#data-3"><i class="fa fa-check"></i><b>5.1</b> Data</a></li>
<li class="chapter" data-level="5.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#approaches"><i class="fa fa-check"></i><b>5.2</b> Approaches</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#no-changes"><i class="fa fa-check"></i><b>5.2.1</b> No changes</a></li>
<li class="chapter" data-level="5.2.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#undersample"><i class="fa fa-check"></i><b>5.2.2</b> Undersample</a></li>
<li class="chapter" data-level="5.2.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#oversampling"><i class="fa fa-check"></i><b>5.2.3</b> Oversampling</a></li>
<li class="chapter" data-level="5.2.4" data-path="imbalanced-application.html"><a href="imbalanced-application.html#smoteing"><i class="fa fa-check"></i><b>5.2.4</b> Smoteing</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#statistic-selection-1"><i class="fa fa-check"></i><b>5.3</b> Statistic selection</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="speeds.html"><a href="speeds.html"><i class="fa fa-check"></i><b>6</b> Speeds</a>
<ul>
<li class="chapter" data-level="6.1" data-path="speeds.html"><a href="speeds.html#functions-to-run-the-tests"><i class="fa fa-check"></i><b>6.1</b> Functions to run the tests</a></li>
<li class="chapter" data-level="6.2" data-path="speeds.html"><a href="speeds.html#data-4"><i class="fa fa-check"></i><b>6.2</b> Data</a></li>
<li class="chapter" data-level="6.3" data-path="speeds.html"><a href="speeds.html#rows"><i class="fa fa-check"></i><b>6.3</b> 10,000 rows</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix"><i class="fa fa-check"></i><b>6.3.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.3.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix"><i class="fa fa-check"></i><b>6.3.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="speeds.html"><a href="speeds.html#rows-1"><i class="fa fa-check"></i><b>6.4</b> 500,000 rows</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix-1"><i class="fa fa-check"></i><b>6.4.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix-1"><i class="fa fa-check"></i><b>6.4.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="speeds.html"><a href="speeds.html#presentations"><i class="fa fa-check"></i><b>6.5</b> Presentations</a></li>
<li class="chapter" data-level="6.6" data-path="speeds.html"><a href="speeds.html#analysis"><i class="fa fa-check"></i><b>6.6</b> Analysis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="speeds.html"><a href="speeds.html#graphs"><i class="fa fa-check"></i><b>6.6.1</b> Graphs</a></li>
<li class="chapter" data-level="6.6.2" data-path="speeds.html"><a href="speeds.html#takaways"><i class="fa fa-check"></i><b>6.6.2</b> Takaways</a></li>
<li class="chapter" data-level="6.6.3" data-path="speeds.html"><a href="speeds.html#things-to-change"><i class="fa fa-check"></i><b>6.6.3</b> Things to change</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html"><i class="fa fa-check"></i><b>7</b> Multi Variable Classification</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#data-5"><i class="fa fa-check"></i><b>7.1</b> Data</a></li>
<li class="chapter" data-level="7.2" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#aucs"><i class="fa fa-check"></i><b>7.2</b> AUCs</a></li>
<li class="chapter" data-level="7.3" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#confusion-table"><i class="fa fa-check"></i><b>7.3</b> Confusion Table</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="h20.html"><a href="h20.html"><i class="fa fa-check"></i><b>8</b> h20</a>
<ul>
<li class="chapter" data-level="8.1" data-path="h20.html"><a href="h20.html#set-up"><i class="fa fa-check"></i><b>8.1</b> Set-Up</a></li>
<li class="chapter" data-level="8.2" data-path="h20.html"><a href="h20.html#eda"><i class="fa fa-check"></i><b>8.2</b> EDA</a></li>
<li class="chapter" data-level="8.3" data-path="h20.html"><a href="h20.html#models-h20"><i class="fa fa-check"></i><b>8.3</b> Models h20</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="h20.html"><a href="h20.html#random-forest"><i class="fa fa-check"></i><b>8.3.1</b> Random Forest</a></li>
<li class="chapter" data-level="8.3.2" data-path="h20.html"><a href="h20.html#gradient-boosting-machine"><i class="fa fa-check"></i><b>8.3.2</b> Gradient Boosting Machine</a></li>
<li class="chapter" data-level="8.3.3" data-path="h20.html"><a href="h20.html#automl"><i class="fa fa-check"></i><b>8.3.3</b> AutoML</a></li>
<li class="chapter" data-level="8.3.4" data-path="h20.html"><a href="h20.html#xgboost-1"><i class="fa fa-check"></i><b>8.3.4</b> XGBoost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="econometrics.html"><a href="econometrics.html"><i class="fa fa-check"></i><b>9</b> 08_Econometrics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="econometrics.html"><a href="econometrics.html#a.-california-test-scores"><i class="fa fa-check"></i><b>9.1</b> A. California Test Scores</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="econometrics.html"><a href="econometrics.html#introduction"><i class="fa fa-check"></i><b>9.1.1</b> Introduction</a></li>
<li class="chapter" data-level="9.1.2" data-path="econometrics.html"><a href="econometrics.html#theory"><i class="fa fa-check"></i><b>9.1.2</b> Theory</a></li>
<li class="chapter" data-level="9.1.3" data-path="econometrics.html"><a href="econometrics.html#building-the-models"><i class="fa fa-check"></i><b>9.1.3</b> Building The models</a></li>
<li class="chapter" data-level="9.1.4" data-path="econometrics.html"><a href="econometrics.html#proofs"><i class="fa fa-check"></i><b>9.1.4</b> Proofs</a></li>
<li class="chapter" data-level="9.1.5" data-path="econometrics.html"><a href="econometrics.html#tests"><i class="fa fa-check"></i><b>9.1.5</b> Tests</a></li>
<li class="chapter" data-level="9.1.6" data-path="econometrics.html"><a href="econometrics.html#significances-and-tests"><i class="fa fa-check"></i><b>9.1.6</b> Significances and Tests</a></li>
<li class="chapter" data-level="9.1.7" data-path="econometrics.html"><a href="econometrics.html#conclusion"><i class="fa fa-check"></i><b>9.1.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="econometrics.html"><a href="econometrics.html#auto-correlation"><i class="fa fa-check"></i><b>9.2</b> Auto Correlation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="parrallel-processing.html"><a href="parrallel-processing.html"><i class="fa fa-check"></i><b>10</b> Parrallel Processing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="parrallel-processing.html"><a href="parrallel-processing.html#parallel-with-parlapply"><i class="fa fa-check"></i><b>10.1</b> 1. parallel with parLapply</a></li>
<li class="chapter" data-level="10.2" data-path="parrallel-processing.html"><a href="parrallel-processing.html#foreach-with-doparallel"><i class="fa fa-check"></i><b>10.2</b> 2. foreach with doParallel</a></li>
<li class="chapter" data-level="10.3" data-path="parrallel-processing.html"><a href="parrallel-processing.html#future-with-future.apply"><i class="fa fa-check"></i><b>10.3</b> 3. future with future.apply</a></li>
<li class="chapter" data-level="10.4" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-with-furrr"><i class="fa fa-check"></i><b>10.4</b> 4. purrr with furrr</a></li>
<li class="chapter" data-level="10.5" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-synchronously"><i class="fa fa-check"></i><b>10.5</b> 5. purrr Synchronously</a></li>
<li class="chapter" data-level="10.6" data-path="parrallel-processing.html"><a href="parrallel-processing.html#comparisions-1"><i class="fa fa-check"></i><b>10.6</b> comparisions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="randomforestinsight.html"><a href="randomforestinsight.html"><i class="fa fa-check"></i><b>11</b> 10_RandomForestInsight</a></li>
<li class="chapter" data-level="12" data-path="sequential-data-embedding.html"><a href="sequential-data-embedding.html"><i class="fa fa-check"></i><b>12</b> Sequential Data Embedding</a></li>
<li class="chapter" data-level="13" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html"><i class="fa fa-check"></i><b>13</b> HCC_Survey_Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#our-data-and-purpose"><i class="fa fa-check"></i><b>13.1</b> Our data and Purpose</a></li>
<li class="chapter" data-level="13.2" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>13.2</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="13.3" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#modeling-random-forest"><i class="fa fa-check"></i><b>13.3</b> Modeling Random Forest</a></li>
<li class="chapter" data-level="13.4" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#global-importance"><i class="fa fa-check"></i><b>13.4</b> Global Importance</a></li>
<li class="chapter" data-level="13.5" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#local-importance"><i class="fa fa-check"></i><b>13.5</b> Local Importance</a></li>
<li class="chapter" data-level="13.6" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#partial-dependence-plots"><i class="fa fa-check"></i><b>13.6</b> Partial Dependence Plots</a></li>
<li class="chapter" data-level="13.7" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#random-forest-explainer"><i class="fa fa-check"></i><b>13.7</b> Random Forest Explainer</a></li>
<li class="chapter" data-level="13.8" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#final-notes"><i class="fa fa-check"></i><b>13.8</b> Final Notes</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="what_is_stacked_ensambled.html"><a href="what_is_stacked_ensambled.html"><i class="fa fa-check"></i><b>14</b> 13_What_Is_Stacked_Ensambled</a></li>
<li class="chapter" data-level="15" data-path="intro_econ_stats.html"><a href="intro_econ_stats.html"><i class="fa fa-check"></i><b>15</b> 14_Intro_Econ_Stats</a></li>
<li class="chapter" data-level="16" data-path="nfl.html"><a href="nfl.html"><i class="fa fa-check"></i><b>16</b> NFL</a>
<ul>
<li class="chapter" data-level="16.1" data-path="nfl.html"><a href="nfl.html#wbs"><i class="fa fa-check"></i><b>16.1</b> WBs</a></li>
<li class="chapter" data-level="16.2" data-path="nfl.html"><a href="nfl.html#rbs"><i class="fa fa-check"></i><b>16.2</b> RBs</a></li>
<li class="chapter" data-level="16.3" data-path="nfl.html"><a href="nfl.html#qbs"><i class="fa fa-check"></i><b>16.3</b> QBs</a></li>
<li class="chapter" data-level="16.4" data-path="nfl.html"><a href="nfl.html#plots-and-analysis"><i class="fa fa-check"></i><b>16.4</b> Plots and Analysis</a></li>
<li class="chapter" data-level="16.5" data-path="nfl.html"><a href="nfl.html#lists-to-do"><i class="fa fa-check"></i><b>16.5</b> Lists to do</a></li>
<li class="chapter" data-level="16.6" data-path="nfl.html"><a href="nfl.html#team-mates"><i class="fa fa-check"></i><b>16.6</b> team mates</a></li>
<li class="chapter" data-level="16.7" data-path="nfl.html"><a href="nfl.html#testing"><i class="fa fa-check"></i><b>16.7</b> Testing</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning Applications</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="h20" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> h20<a href="h20.html#h20" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="set-up" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Set-Up<a href="h20.html#set-up" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="h20.html#cb185-1" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb185-2"><a href="h20.html#cb185-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb185-3"><a href="h20.html#cb185-3" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb185-4"><a href="h20.html#cb185-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb185-5"><a href="h20.html#cb185-5" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span>
<span id="cb185-6"><a href="h20.html#cb185-6" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb185-7"><a href="h20.html#cb185-7" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="h20.html#cb187-1" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code></pre></div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="h20.html#cb188-1" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb188-2"><a href="h20.html#cb188-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;machine failure.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 10000 Columns: 14
## ── Column specification ──────────
## Delimiter: &quot;,&quot;
## chr  (2): Product ID, Type
## dbl (12): UDI, Air temperature [K], Process temperature [K], Rotational spee...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="h20.html#cb190-1" tabindex="-1"></a><span class="fu">glimpse</span>(data)</span></code></pre></div>
<pre><code>## Rows: 10,000
## Columns: 14
## $ UDI                       &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 1…
## $ `Product ID`              &lt;chr&gt; &quot;M14860&quot;, &quot;L47181&quot;, &quot;L47182&quot;, &quot;L47183&quot;, &quot;L47…
## $ Type                      &lt;chr&gt; &quot;M&quot;, &quot;L&quot;, &quot;L&quot;, &quot;L&quot;, &quot;L&quot;, &quot;M&quot;, &quot;L&quot;, &quot;L&quot;, &quot;M&quot;,…
## $ `Air temperature [K]`     &lt;dbl&gt; 298.1, 298.2, 298.1, 298.2, 298.2, 298.1, 29…
## $ `Process temperature [K]` &lt;dbl&gt; 308.6, 308.7, 308.5, 308.6, 308.7, 308.6, 30…
## $ `Rotational speed [rpm]`  &lt;dbl&gt; 1551, 1408, 1498, 1433, 1408, 1425, 1558, 15…
## $ `Torque [Nm]`             &lt;dbl&gt; 42.8, 46.3, 49.4, 39.5, 40.0, 41.9, 42.4, 40…
## $ `Tool wear [min]`         &lt;dbl&gt; 0, 3, 5, 7, 9, 11, 14, 16, 18, 21, 24, 29, 3…
## $ `Machine failure`         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ TWF                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ HDF                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ PWF                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ OSF                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ RNF                       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…</code></pre>
<p>ID: A unique identifier for each observation in the dataset.
Product Id: A combined identifier that starts with the machine type followed by a numeric identifier.
Type: Categorizes the type of machine, which can affect its failure rates and operational characteristics.
Air Temperature [K]: The ambient air temperature around the machine, measured in Kelvin, which might influence machine performance.
Process Temperature [K]: The operational temperature of the machine during the process, also measured in Kelvin.
Rotational Speed [rpm]: Indicates how fast the machine operates, measured in rotations per minute.
Torque [Nm]: Measures the twisting force that causes rotation, in Newton-meters. High torque may indicate higher operational stress.
Tool Wear [min]: Tracks the amount of wear on the machine’s tools, suggesting when maintenance or replacement might be necessary.
Machine Failure: The target variable indicating if a failure occurred (1) or not (0).
Additional columns related to specific failure types include:</p>
<p>TWF (Tool Wear Failure): Indicates failures due to the tool wearing out.
HDF (Heat Dissipation Failure): Relates to failures caused by inadequate heat dissipation.
PWF (Power Failure): Associated with failures due to power issues.
OSF (Overstrain Failure): Indicates failures from overstressing the machine.
RNF (Random Failure): Captures failures that are random or do not fit into other specified categories.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="h20.html#cb192-1" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code></pre></div>
<pre><code>## Warning: package &#39;janitor&#39; was built under R version 4.3.3</code></pre>
<pre><code>## 
## Attaching package: &#39;janitor&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     chisq.test, fisher.test</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="h20.html#cb196-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb196-2"><a href="h20.html#cb196-2" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code></pre></div>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="h20.html#cb197-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb197-2"><a href="h20.html#cb197-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(type, twf, hdf, pwf, osf, rnf, machine_failure), as.factor))</span>
<span id="cb197-3"><a href="h20.html#cb197-3" tabindex="-1"></a></span>
<span id="cb197-4"><a href="h20.html#cb197-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)] <span class="co"># kill the two ids</span></span>
<span id="cb197-5"><a href="h20.html#cb197-5" tabindex="-1"></a></span>
<span id="cb197-6"><a href="h20.html#cb197-6" tabindex="-1"></a></span>
<span id="cb197-7"><a href="h20.html#cb197-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb197-8"><a href="h20.html#cb197-8" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">y =</span> machine_failure) <span class="sc">%&gt;%</span>  </span>
<span id="cb197-9"><a href="h20.html#cb197-9" tabindex="-1"></a>  <span class="fu">relocate</span>(y, <span class="at">.before =</span> <span class="dv">1</span>)        </span></code></pre></div>
<p>The data is ready for gerneral usage</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="h20.html#cb198-1" tabindex="-1"></a><span class="fu">introduce</span>(data)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 9
##    rows columns discrete_columns continuous_columns all_missing_columns
##   &lt;int&gt;   &lt;int&gt;            &lt;int&gt;              &lt;int&gt;               &lt;int&gt;
## 1 10000      12                7                  5                   0
## # ℹ 4 more variables: total_missing_values &lt;int&gt;, complete_rows &lt;int&gt;,
## #   total_observations &lt;int&gt;, memory_usage &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="h20.html#cb200-1" tabindex="-1"></a><span class="fu">plot_missing</span>(data)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
</div>
<div id="eda" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> EDA<a href="h20.html#eda" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="h20.html#cb201-1" tabindex="-1"></a><span class="co"># Histograms for numerical variables</span></span>
<span id="cb201-2"><a href="h20.html#cb201-2" tabindex="-1"></a><span class="fu">plot_histogram</span>(data)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-107-1.png" width="672" /></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="h20.html#cb202-1" tabindex="-1"></a><span class="co"># For factor variables, use bar plots</span></span>
<span id="cb202-2"><a href="h20.html#cb202-2" tabindex="-1"></a><span class="fu">plot_bar</span>(data)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="h20.html#cb203-1" tabindex="-1"></a><span class="co"># Summary statistics for numerical data</span></span>
<span id="cb203-2"><a href="h20.html#cb203-2" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb203-3"><a href="h20.html#cb203-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="fu">list</span>(<span class="at">mean =</span> mean, <span class="at">sd =</span> sd, <span class="at">median =</span> median, <span class="at">IQR =</span> IQR, <span class="at">min =</span> min, <span class="at">max =</span> max)))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 30
##   air_temperature_k_mean air_temperature_k_sd air_temperature_k_median
##                    &lt;dbl&gt;                &lt;dbl&gt;                    &lt;dbl&gt;
## 1                   300.                 2.00                     300.
## # ℹ 27 more variables: air_temperature_k_IQR &lt;dbl&gt;,
## #   air_temperature_k_min &lt;dbl&gt;, air_temperature_k_max &lt;dbl&gt;,
## #   process_temperature_k_mean &lt;dbl&gt;, process_temperature_k_sd &lt;dbl&gt;,
## #   process_temperature_k_median &lt;dbl&gt;, process_temperature_k_IQR &lt;dbl&gt;,
## #   process_temperature_k_min &lt;dbl&gt;, process_temperature_k_max &lt;dbl&gt;,
## #   rotational_speed_rpm_mean &lt;dbl&gt;, rotational_speed_rpm_sd &lt;dbl&gt;,
## #   rotational_speed_rpm_median &lt;dbl&gt;, rotational_speed_rpm_IQR &lt;dbl&gt;, …</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="h20.html#cb205-1" tabindex="-1"></a><span class="co"># Identify zero variance features</span></span>
<span id="cb205-2"><a href="h20.html#cb205-2" tabindex="-1"></a>zero_var_indices <span class="ot">&lt;-</span> <span class="fu">nearZeroVar</span>(data, <span class="at">saveMetrics =</span> <span class="cn">TRUE</span>)</span>
<span id="cb205-3"><a href="h20.html#cb205-3" tabindex="-1"></a></span>
<span id="cb205-4"><a href="h20.html#cb205-4" tabindex="-1"></a><span class="co"># View the metrics to determine which variables have zero or near-zero variance</span></span>
<span id="cb205-5"><a href="h20.html#cb205-5" tabindex="-1"></a><span class="fu">print</span>(zero_var_indices)</span></code></pre></div>
<pre><code>##                        freqRatio percentUnique zeroVar   nzv
## y                      28.498525          0.02   FALSE  TRUE
## type                    2.002002          0.03   FALSE FALSE
## air_temperature_k       1.207792          0.93   FALSE FALSE
## process_temperature_k   1.161172          0.82   FALSE FALSE
## rotational_speed_rpm    1.116279          9.41   FALSE FALSE
## torque_nm               1.040000          5.77   FALSE FALSE
## tool_wear_min           1.739130          2.46   FALSE FALSE
## twf                   216.391304          0.02   FALSE  TRUE
## hdf                    85.956522          0.02   FALSE  TRUE
## pwf                   104.263158          0.02   FALSE  TRUE
## osf                   101.040816          0.02   FALSE  TRUE
## rnf                   525.315789          0.02   FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="h20.html#cb207-1" tabindex="-1"></a><span class="co"># Optionally, print the names of columns with zero variance</span></span>
<span id="cb207-2"><a href="h20.html#cb207-2" tabindex="-1"></a>zero_var_columns <span class="ot">&lt;-</span> <span class="fu">names</span>(data)[zero_var_indices<span class="sc">$</span>nzv]</span>
<span id="cb207-3"><a href="h20.html#cb207-3" tabindex="-1"></a><span class="fu">print</span>(zero_var_columns)</span></code></pre></div>
<pre><code>## [1] &quot;y&quot;   &quot;twf&quot; &quot;hdf&quot; &quot;pwf&quot; &quot;osf&quot; &quot;rnf&quot;</code></pre>
<p>for now we wont care about the type of failure we just will care about whether it failed or not</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="h20.html#cb209-1" tabindex="-1"></a><span class="co"># right now i am forced to use the numerical positions of the collumns due to issues knitting into a book. in practice we want to use  select and name the columns</span></span>
<span id="cb209-2"><a href="h20.html#cb209-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[, <span class="sc">-</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">12</span>)]</span></code></pre></div>
</div>
<div id="models-h20" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Models h20<a href="h20.html#models-h20" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="h20.html#cb210-1" tabindex="-1"></a><span class="fu">library</span>(h2o)</span></code></pre></div>
<pre><code>## 
## ----------------------------------------------------------------------
## 
## Your next step is to start H2O:
##     &gt; h2o.init()
## 
## For H2O package documentation, ask for help:
##     &gt; ??h2o
## 
## After starting H2O, you can use the Web UI at http://localhost:54321
## For more information visit https://docs.h2o.ai
## 
## ----------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;h2o&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:lubridate&#39;:
## 
##     day, hour, month, week, year</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     cor, sd, var</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     %*%, %in%, &amp;&amp;, ||, apply, as.factor, as.numeric, colnames,
##     colnames&lt;-, ifelse, is.character, is.factor, is.numeric, log,
##     log10, log1p, log2, round, signif, trunc</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="h20.html#cb216-1" tabindex="-1"></a><span class="co">#dir.create(&quot;C:/Users/simon/Dropbox/github_ML/Codes&amp;Processes/h2o_logs&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="h20.html#cb217-1" tabindex="-1"></a><span class="fu">h2o.init</span>(<span class="at">max_mem_size =</span> <span class="st">&quot;12g&quot;</span>, <span class="at">log_dir =</span> <span class="st">&quot;C:/Users/simon/Dropbox/github_ML/Codes&amp;Processes/h2o_logs&quot;</span>)</span></code></pre></div>
<pre><code>##  Connection successful!
## 
## R is connected to the H2O cluster: 
##     H2O cluster uptime:         1 hours 40 minutes 
##     H2O cluster timezone:       America/Halifax 
##     H2O data parsing timezone:  UTC 
##     H2O cluster version:        3.46.0.1 
##     H2O cluster version age:    9 months and 3 days 
##     H2O cluster name:           H2O_started_from_R_simon_ndv362 
##     H2O cluster total nodes:    1 
##     H2O cluster total memory:   12.00 GB 
##     H2O cluster total cores:    20 
##     H2O cluster allowed cores:  20 
##     H2O cluster healthy:        TRUE 
##     H2O Connection ip:          localhost 
##     H2O Connection port:        54321 
##     H2O Connection proxy:       NA 
##     H2O Internal Security:      FALSE 
##     R Version:                  R version 4.3.2 (2023-10-31 ucrt)</code></pre>
<pre><code>## Warning in h2o.clusterInfo(): 
## Your H2O cluster version is (9 months and 3 days) old. There may be a newer version available.
## Please download and install the latest version from: https://h2o-release.s3.amazonaws.com/h2o/latest_stable.html</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="h20.html#cb220-1" tabindex="-1"></a>data_h2o <span class="ot">&lt;-</span> <span class="fu">as.h2o</span>(data)</span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="h20.html#cb222-1" tabindex="-1"></a>data_h2o<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data_h2o<span class="sc">$</span>y)</span></code></pre></div>
<div id="random-forest" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Random Forest<a href="h20.html#random-forest" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="h20.html#cb223-1" tabindex="-1"></a>auc_values <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb223-2"><a href="h20.html#cb223-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb223-3"><a href="h20.html#cb223-3" tabindex="-1"></a>  <span class="co"># Split the data into train and test sets</span></span>
<span id="cb223-4"><a href="h20.html#cb223-4" tabindex="-1"></a>  splits <span class="ot">&lt;-</span> <span class="fu">h2o.splitFrame</span>(<span class="at">data =</span> data_h2o, <span class="at">ratios =</span> <span class="fl">0.8</span>)</span>
<span id="cb223-5"><a href="h20.html#cb223-5" tabindex="-1"></a>  train <span class="ot">&lt;-</span> splits[[<span class="dv">1</span>]]</span>
<span id="cb223-6"><a href="h20.html#cb223-6" tabindex="-1"></a>  test <span class="ot">&lt;-</span> splits[[<span class="dv">2</span>]]</span>
<span id="cb223-7"><a href="h20.html#cb223-7" tabindex="-1"></a></span>
<span id="cb223-8"><a href="h20.html#cb223-8" tabindex="-1"></a>  <span class="co"># Train a Random Forest model</span></span>
<span id="cb223-9"><a href="h20.html#cb223-9" tabindex="-1"></a>  rf_model <span class="ot">&lt;-</span> <span class="fu">h2o.randomForest</span>(</span>
<span id="cb223-10"><a href="h20.html#cb223-10" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">names</span>(train)[<span class="sc">-</span><span class="fu">which</span>(<span class="fu">names</span>(train) <span class="sc">==</span> <span class="st">&quot;y&quot;</span>)],  </span>
<span id="cb223-11"><a href="h20.html#cb223-11" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,                                       </span>
<span id="cb223-12"><a href="h20.html#cb223-12" tabindex="-1"></a>    <span class="at">training_frame =</span> train,</span>
<span id="cb223-13"><a href="h20.html#cb223-13" tabindex="-1"></a>    <span class="at">ntrees =</span> <span class="dv">1200</span>                               </span>
<span id="cb223-14"><a href="h20.html#cb223-14" tabindex="-1"></a>  )</span>
<span id="cb223-15"><a href="h20.html#cb223-15" tabindex="-1"></a></span>
<span id="cb223-16"><a href="h20.html#cb223-16" tabindex="-1"></a>  <span class="co"># Perform predictions</span></span>
<span id="cb223-17"><a href="h20.html#cb223-17" tabindex="-1"></a>  predictions <span class="ot">&lt;-</span> <span class="fu">h2o.predict</span>(rf_model, test)</span>
<span id="cb223-18"><a href="h20.html#cb223-18" tabindex="-1"></a></span>
<span id="cb223-19"><a href="h20.html#cb223-19" tabindex="-1"></a>  <span class="co"># Get performance object</span></span>
<span id="cb223-20"><a href="h20.html#cb223-20" tabindex="-1"></a>  perf <span class="ot">&lt;-</span> <span class="fu">h2o.performance</span>(rf_model, <span class="at">newdata =</span> test)</span>
<span id="cb223-21"><a href="h20.html#cb223-21" tabindex="-1"></a></span>
<span id="cb223-22"><a href="h20.html#cb223-22" tabindex="-1"></a>  <span class="co"># Calculate AUC</span></span>
<span id="cb223-23"><a href="h20.html#cb223-23" tabindex="-1"></a>  auc_values[i] <span class="ot">&lt;-</span> <span class="fu">h2o.auc</span>(perf)</span>
<span id="cb223-24"><a href="h20.html#cb223-24" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=========                                                             |  14%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |==========================================================            |  84%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |========================================================              |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |========================================================              |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  36%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  36%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  16%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |==========================================================            |  82%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  36%
  |                                                                            
  |==========================================================            |  82%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |========================================================              |  79%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  16%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  16%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |========================================================              |  79%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=====================================================                 |  75%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |==========================================================            |  82%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  36%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |========================================================              |  79%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |=============================================================         |  88%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="h20.html#cb225-1" tabindex="-1"></a><span class="co"># Calculate the mean AUC value    </span></span>
<span id="cb225-2"><a href="h20.html#cb225-2" tabindex="-1"></a><span class="fu">mean</span>(auc_values)</span></code></pre></div>
<pre><code>## [1] 0.9705556</code></pre>
</div>
<div id="gradient-boosting-machine" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Gradient Boosting Machine<a href="h20.html#gradient-boosting-machine" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>note that cartesian uses all the grid values. the random version just selects random values from the grid which is very valid</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="h20.html#cb227-1" tabindex="-1"></a><span class="co"># Define the hyperparameter grid with added ntrees and learn_rate_annealing options</span></span>
<span id="cb227-2"><a href="h20.html#cb227-2" tabindex="-1"></a>hyper_params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb227-3"><a href="h20.html#cb227-3" tabindex="-1"></a>  <span class="at">max_depth =</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="at">by =</span> <span class="dv">3</span>), </span>
<span id="cb227-4"><a href="h20.html#cb227-4" tabindex="-1"></a>  <span class="at">min_rows =</span> <span class="fu">c</span>(<span class="dv">10</span>), </span>
<span id="cb227-5"><a href="h20.html#cb227-5" tabindex="-1"></a>  <span class="at">learn_rate =</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.2</span>, <span class="at">by =</span> <span class="fl">0.04</span>), </span>
<span id="cb227-6"><a href="h20.html#cb227-6" tabindex="-1"></a>  <span class="at">learn_rate_annealing =</span> <span class="fu">seq</span>(<span class="fl">0.99</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">2</span>),</span>
<span id="cb227-7"><a href="h20.html#cb227-7" tabindex="-1"></a>  <span class="at">col_sample_rate_per_tree =</span> <span class="fu">seq</span>(<span class="fl">0.75</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">2</span>), </span>
<span id="cb227-8"><a href="h20.html#cb227-8" tabindex="-1"></a>  <span class="at">col_sample_rate =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1</span>), </span>
<span id="cb227-9"><a href="h20.html#cb227-9" tabindex="-1"></a>  <span class="at">ntrees =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">250</span>, <span class="dv">500</span>, <span class="dv">750</span>),</span>
<span id="cb227-10"><a href="h20.html#cb227-10" tabindex="-1"></a>  <span class="at">min_split_improvement =</span> <span class="fu">c</span>(<span class="fl">1e-5</span>)</span>
<span id="cb227-11"><a href="h20.html#cb227-11" tabindex="-1"></a>)</span>
<span id="cb227-12"><a href="h20.html#cb227-12" tabindex="-1"></a></span>
<span id="cb227-13"><a href="h20.html#cb227-13" tabindex="-1"></a>search_criteria <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">strategy =</span> <span class="st">&quot;Cartesian&quot;</span>)</span></code></pre></div>
<p>How is column sampling implemented for GBM?
For an example model using:</p>
<p>100-column dataset</p>
<p>col_sample_rate_per_tree=0.754</p>
<p>col_sample_rate=0.8 (Refers to available columns after per-tree sampling)</p>
<p>For each tree, the floor is used to determine the number - in this example, (0.754 * 100)=75 out of the 100 - of columns that are randomly picked, and then the floor is used to determine the number - in this case, (0.754 * 0.8 * 100)=60 - of columns that are then randomly chosen for each split decision (out of the 75).</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="h20.html#cb228-1" tabindex="-1"></a><span class="co"># Grid search setup with added parameters</span></span>
<span id="cb228-2"><a href="h20.html#cb228-2" tabindex="-1"></a>grid_result <span class="ot">&lt;-</span> <span class="fu">h2o.grid</span>(</span>
<span id="cb228-3"><a href="h20.html#cb228-3" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="st">&quot;gbm&quot;</span>,</span>
<span id="cb228-4"><a href="h20.html#cb228-4" tabindex="-1"></a>  <span class="at">grid_id =</span> <span class="st">&quot;gbm_grid_search_extended&quot;</span>,</span>
<span id="cb228-5"><a href="h20.html#cb228-5" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(data_h2o), <span class="st">&quot;y&quot;</span>),</span>
<span id="cb228-6"><a href="h20.html#cb228-6" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb228-7"><a href="h20.html#cb228-7" tabindex="-1"></a>  <span class="at">training_frame =</span> data_h2o,</span>
<span id="cb228-8"><a href="h20.html#cb228-8" tabindex="-1"></a>  <span class="at">hyper_params =</span> hyper_params,</span>
<span id="cb228-9"><a href="h20.html#cb228-9" tabindex="-1"></a>  <span class="at">search_criteria =</span> search_criteria,</span>
<span id="cb228-10"><a href="h20.html#cb228-10" tabindex="-1"></a>  <span class="at">nfolds =</span> <span class="dv">5</span></span>
<span id="cb228-11"><a href="h20.html#cb228-11" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="h20.html#cb230-1" tabindex="-1"></a><span class="co"># Retrieve the grid results, sorted by AUC</span></span>
<span id="cb230-2"><a href="h20.html#cb230-2" tabindex="-1"></a>full_grid <span class="ot">&lt;-</span> <span class="fu">h2o.getGrid</span>(<span class="at">grid_id =</span> <span class="st">&quot;gbm_grid_search_extended&quot;</span>, <span class="at">sort_by =</span> <span class="st">&quot;auc&quot;</span>, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb230-3"><a href="h20.html#cb230-3" tabindex="-1"></a></span>
<span id="cb230-4"><a href="h20.html#cb230-4" tabindex="-1"></a><span class="co"># Extract the grid results into a data frame</span></span>
<span id="cb230-5"><a href="h20.html#cb230-5" tabindex="-1"></a>full_summary_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(full_grid<span class="sc">@</span>summary_table)</span>
<span id="cb230-6"><a href="h20.html#cb230-6" tabindex="-1"></a></span>
<span id="cb230-7"><a href="h20.html#cb230-7" tabindex="-1"></a><span class="co"># Print the structure of the data frame</span></span>
<span id="cb230-8"><a href="h20.html#cb230-8" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">str</span>(full_summary_df))</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    160 obs. of  10 variables:
##  $ col_sample_rate         : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ col_sample_rate_per_tree: num  1 0.75 1 0.75 0.75 0.75 1 1 1 1 ...
##  $ learn_rate              : num  0.13 0.13 0.05 0.13 0.17 0.09 0.13 0.09 0.13 0.17 ...
##  $ learn_rate_annealing    : num  0.99 0.99 1 0.99 0.99 0.99 0.99 0.99 1 0.99 ...
##  $ max_depth               : num  6 6 6 6 6 6 6 6 6 6 ...
##  $ min_rows                : num  10 10 10 10 10 10 10 10 10 10 ...
##  $ min_split_improvement   : num  1e-05 1e-05 1e-05 1e-05 1e-05 1e-05 1e-05 1e-05 1e-05 1e-05 ...
##  $ ntrees                  : num  250 500 250 750 750 500 500 250 100 500 ...
##  $ model_ids               : chr  &quot;gbm_grid_search_extended_model_68&quot; &quot;gbm_grid_search_extended_model_107&quot; &quot;gbm_grid_search_extended_model_74&quot; &quot;gbm_grid_search_extended_model_147&quot; ...
##  $ auc                     : num  0.98 0.977 0.977 0.976 0.976 ...
##  - attr(*, &quot;header&quot;)= chr &quot;Hyper-Parameter Search Summary&quot;
##  - attr(*, &quot;formats&quot;)= chr [1:10] &quot;%.5f&quot; &quot;%.5f&quot; &quot;%.5f&quot; &quot;%.5f&quot; ...
##  - attr(*, &quot;description&quot;)= chr &quot;ordered by decreasing auc&quot;
## NULL</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="h20.html#cb232-1" tabindex="-1"></a>splits <span class="ot">&lt;-</span> <span class="fu">h2o.splitFrame</span>(<span class="at">data =</span> data_h2o, <span class="at">ratios =</span> <span class="fl">0.8</span>)</span>
<span id="cb232-2"><a href="h20.html#cb232-2" tabindex="-1"></a>train <span class="ot">&lt;-</span> splits[[<span class="dv">1</span>]]</span>
<span id="cb232-3"><a href="h20.html#cb232-3" tabindex="-1"></a>test <span class="ot">&lt;-</span> splits[[<span class="dv">2</span>]]</span>
<span id="cb232-4"><a href="h20.html#cb232-4" tabindex="-1"></a></span>
<span id="cb232-5"><a href="h20.html#cb232-5" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="fu">h2o.getModel</span>(full_grid<span class="sc">@</span>model_ids[[<span class="dv">1</span>]])</span>
<span id="cb232-6"><a href="h20.html#cb232-6" tabindex="-1"></a></span>
<span id="cb232-7"><a href="h20.html#cb232-7" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">h2o.predict</span>(best_model, test)</span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="h20.html#cb234-1" tabindex="-1"></a>actual <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.vector</span>(test<span class="sc">$</span>y), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;0&quot;</span>))</span>
<span id="cb234-2"><a href="h20.html#cb234-2" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">as.vector</span>(predictions<span class="sc">$</span>predict), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;0&quot;</span>)) <span class="co"># maxed f1 score</span></span>
<span id="cb234-3"><a href="h20.html#cb234-3" tabindex="-1"></a></span>
<span id="cb234-4"><a href="h20.html#cb234-4" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Actual =</span> actual, <span class="at">Predicted =</span> predicted)</span>
<span id="cb234-5"><a href="h20.html#cb234-5" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span></code></pre></div>
<pre><code>##       Predicted
## Actual    1    0
##      1   72    1
##      0    0 1925</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="h20.html#cb236-1" tabindex="-1"></a><span class="co"># Access the best model from the grid search</span></span>
<span id="cb236-2"><a href="h20.html#cb236-2" tabindex="-1"></a>best_model_id <span class="ot">&lt;-</span> grid_result<span class="sc">@</span>model_ids[[<span class="dv">1</span>]]</span>
<span id="cb236-3"><a href="h20.html#cb236-3" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="fu">h2o.getModel</span>(best_model_id)</span>
<span id="cb236-4"><a href="h20.html#cb236-4" tabindex="-1"></a></span>
<span id="cb236-5"><a href="h20.html#cb236-5" tabindex="-1"></a><span class="co"># Retrieve the panel with all parameters used by the best model</span></span>
<span id="cb236-6"><a href="h20.html#cb236-6" tabindex="-1"></a>best_params <span class="ot">&lt;-</span> best_model<span class="sc">@</span>allparameters</span>
<span id="cb236-7"><a href="h20.html#cb236-7" tabindex="-1"></a></span>
<span id="cb236-8"><a href="h20.html#cb236-8" tabindex="-1"></a><span class="co"># Display winning hyperparameters</span></span>
<span id="cb236-9"><a href="h20.html#cb236-9" tabindex="-1"></a>best_params <span class="ot">&lt;-</span> best_model<span class="sc">@</span>allparameters</span>
<span id="cb236-10"><a href="h20.html#cb236-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Winning Hyperparameters:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Winning Hyperparameters:</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="h20.html#cb238-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Max Depth: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, best_params<span class="sc">$</span>max_depth))</span></code></pre></div>
<pre><code>## Max Depth: 6</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="h20.html#cb240-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Min Rows: %d</span><span class="sc">\n</span><span class="st">&quot;</span>, best_params<span class="sc">$</span>min_rows))</span></code></pre></div>
<pre><code>## Min Rows: 10</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="h20.html#cb242-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Learn Rate: %.2f</span><span class="sc">\n</span><span class="st">&quot;</span>, best_params<span class="sc">$</span>learn_rate))</span></code></pre></div>
<pre><code>## Learn Rate: 0.13</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="h20.html#cb244-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Learn Rate Annealing: %.2f</span><span class="sc">\n</span><span class="st">&quot;</span>, best_params<span class="sc">$</span>learn_rate_annealing))</span></code></pre></div>
<pre><code>## Learn Rate Annealing: 0.99</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="h20.html#cb246-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Sample Rate: %.2f</span><span class="sc">\n</span><span class="st">&quot;</span>, best_params<span class="sc">$</span>col_sample_rate_per_tree))</span></code></pre></div>
<pre><code>## Sample Rate: 1.00</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="h20.html#cb248-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Column Sample Rate: %.2f</span><span class="sc">\n</span><span class="st">&quot;</span>, best_params<span class="sc">$</span>col_sample_rate))</span></code></pre></div>
<pre><code>## Column Sample Rate: 1.00</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="h20.html#cb250-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Number of Trees (ntrees): %d</span><span class="sc">\n</span><span class="st">&quot;</span>, best_params<span class="sc">$</span>ntrees))</span></code></pre></div>
<pre><code>## Number of Trees (ntrees): 250</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="h20.html#cb252-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">&quot;Minimum Split Improvement: %.1e</span><span class="sc">\n</span><span class="st">&quot;</span>, best_params<span class="sc">$</span>min_split_improvement))</span></code></pre></div>
<pre><code>## Minimum Split Improvement: 1.0e-05</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="h20.html#cb254-1" tabindex="-1"></a><span class="co"># Retrieve the parameters used by the best model</span></span>
<span id="cb254-2"><a href="h20.html#cb254-2" tabindex="-1"></a></span>
<span id="cb254-3"><a href="h20.html#cb254-3" tabindex="-1"></a><span class="co"># Loop to perform repeated train-test split and model evaluation</span></span>
<span id="cb254-4"><a href="h20.html#cb254-4" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb254-5"><a href="h20.html#cb254-5" tabindex="-1"></a>auc_scores <span class="ot">&lt;-</span> <span class="fu">numeric</span>(r)</span>
<span id="cb254-6"><a href="h20.html#cb254-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>r) {</span>
<span id="cb254-7"><a href="h20.html#cb254-7" tabindex="-1"></a>  splits <span class="ot">&lt;-</span> <span class="fu">h2o.splitFrame</span>(<span class="at">data =</span> data_h2o, <span class="at">ratios =</span> <span class="fl">0.8</span>, <span class="at">seed =</span> i)</span>
<span id="cb254-8"><a href="h20.html#cb254-8" tabindex="-1"></a>  train <span class="ot">&lt;-</span> splits[[<span class="dv">1</span>]]</span>
<span id="cb254-9"><a href="h20.html#cb254-9" tabindex="-1"></a>  test <span class="ot">&lt;-</span> splits[[<span class="dv">2</span>]]</span>
<span id="cb254-10"><a href="h20.html#cb254-10" tabindex="-1"></a>  </span>
<span id="cb254-11"><a href="h20.html#cb254-11" tabindex="-1"></a>  <span class="co"># Train the model with the best parameters from the grid search</span></span>
<span id="cb254-12"><a href="h20.html#cb254-12" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">h2o.gbm</span>(</span>
<span id="cb254-13"><a href="h20.html#cb254-13" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(train), <span class="st">&quot;y&quot;</span>), </span>
<span id="cb254-14"><a href="h20.html#cb254-14" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;y&quot;</span>, </span>
<span id="cb254-15"><a href="h20.html#cb254-15" tabindex="-1"></a>    <span class="at">training_frame =</span> train,</span>
<span id="cb254-16"><a href="h20.html#cb254-16" tabindex="-1"></a>    <span class="at">validation_frame =</span> test,</span>
<span id="cb254-17"><a href="h20.html#cb254-17" tabindex="-1"></a>    <span class="at">learn_rate =</span> best_params<span class="sc">$</span>learn_rate,</span>
<span id="cb254-18"><a href="h20.html#cb254-18" tabindex="-1"></a>    <span class="at">max_depth =</span> best_params<span class="sc">$</span>max_depth,</span>
<span id="cb254-19"><a href="h20.html#cb254-19" tabindex="-1"></a>    <span class="at">col_sample_rate_per_tree =</span> best_params<span class="sc">$</span>col_sample_rate_per_tree,</span>
<span id="cb254-20"><a href="h20.html#cb254-20" tabindex="-1"></a>    <span class="at">col_sample_rate =</span> best_params<span class="sc">$</span>col_sample_rate,</span>
<span id="cb254-21"><a href="h20.html#cb254-21" tabindex="-1"></a>    <span class="at">ntrees =</span> best_params<span class="sc">$</span>ntrees,</span>
<span id="cb254-22"><a href="h20.html#cb254-22" tabindex="-1"></a>    <span class="at">learn_rate_annealing =</span> best_params<span class="sc">$</span>learn_rate_annealing,</span>
<span id="cb254-23"><a href="h20.html#cb254-23" tabindex="-1"></a>    <span class="at">min_split_improvement =</span> best_params<span class="sc">$</span>min_split_improvement</span>
<span id="cb254-24"><a href="h20.html#cb254-24" tabindex="-1"></a>  )</span>
<span id="cb254-25"><a href="h20.html#cb254-25" tabindex="-1"></a>  perf <span class="ot">&lt;-</span> <span class="fu">h2o.performance</span>(model, <span class="at">newdata =</span> test)</span>
<span id="cb254-26"><a href="h20.html#cb254-26" tabindex="-1"></a>  auc_scores[i] <span class="ot">&lt;-</span> <span class="fu">h2o.auc</span>(perf)</span>
<span id="cb254-27"><a href="h20.html#cb254-27" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  45%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  45%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  45%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  45%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  45%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="h20.html#cb256-1" tabindex="-1"></a>mean_auc <span class="ot">&lt;-</span> <span class="fu">mean</span>(auc_scores)</span>
<span id="cb256-2"><a href="h20.html#cb256-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Average AUC over&quot;</span>, r, <span class="st">&quot;trials:&quot;</span>, mean_auc))</span></code></pre></div>
<pre><code>## [1] &quot;Average AUC over 100 trials: 0.975179909924385&quot;</code></pre>
</div>
<div id="automl" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> AutoML<a href="h20.html#automl" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="h20.html#cb258-1" tabindex="-1"></a><span class="co"># Step 1: Define your target variable</span></span>
<span id="cb258-2"><a href="h20.html#cb258-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="st">&quot;y&quot;</span>  </span>
<span id="cb258-3"><a href="h20.html#cb258-3" tabindex="-1"></a></span>
<span id="cb258-4"><a href="h20.html#cb258-4" tabindex="-1"></a><span class="co"># Step 2: Define predictors </span></span>
<span id="cb258-5"><a href="h20.html#cb258-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(data_h2o), y)  </span>
<span id="cb258-6"><a href="h20.html#cb258-6" tabindex="-1"></a></span>
<span id="cb258-7"><a href="h20.html#cb258-7" tabindex="-1"></a><span class="co"># Step 3: Run AutoML</span></span>
<span id="cb258-8"><a href="h20.html#cb258-8" tabindex="-1"></a>aml <span class="ot">&lt;-</span> <span class="fu">h2o.automl</span>(</span>
<span id="cb258-9"><a href="h20.html#cb258-9" tabindex="-1"></a>  <span class="at">x =</span> x, </span>
<span id="cb258-10"><a href="h20.html#cb258-10" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb258-11"><a href="h20.html#cb258-11" tabindex="-1"></a>  <span class="at">training_frame =</span> data_h2o,</span>
<span id="cb258-12"><a href="h20.html#cb258-12" tabindex="-1"></a>  <span class="at">max_models =</span> <span class="dv">20</span>,  </span>
<span id="cb258-13"><a href="h20.html#cb258-13" tabindex="-1"></a>  <span class="at">max_runtime_secs =</span> <span class="dv">3600</span><span class="sc">*</span><span class="dv">5</span></span>
<span id="cb258-14"><a href="h20.html#cb258-14" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |==                                                                    |   3%
## 01:53:37.874: AutoML: XGBoost is not available; skipping it.
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |================                                                      |  24%
  |                                                                            
  |===================                                                   |  26%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |======================================================                |  76%
  |                                                                            
  |========================================================              |  79%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="h20.html#cb260-1" tabindex="-1"></a><span class="co"># Step 4: View the AutoML Leaderboard</span></span>
<span id="cb260-2"><a href="h20.html#cb260-2" tabindex="-1"></a>lb <span class="ot">&lt;-</span> <span class="fu">h2o.get_leaderboard</span>(aml, <span class="at">extra_columns =</span> <span class="st">&quot;ALL&quot;</span>)</span>
<span id="cb260-3"><a href="h20.html#cb260-3" tabindex="-1"></a><span class="fu">print</span>(lb)</span></code></pre></div>
<pre><code>##                                                 model_id       auc    logloss
## 1             GBM_grid_1_AutoML_1_20241217_15337_model_5 0.9785118 0.05020290
## 2 StackedEnsemble_BestOfFamily_1_AutoML_1_20241217_15337 0.9764793 0.04961507
## 3    StackedEnsemble_AllModels_1_AutoML_1_20241217_15337 0.9762244 0.04832240
## 4                          GBM_3_AutoML_1_20241217_15337 0.9734979 0.05358725
## 5                          GBM_4_AutoML_1_20241217_15337 0.9708714 0.05677718
## 6                          GBM_1_AutoML_1_20241217_15337 0.9705430 0.06252544
##       aucpr mean_per_class_error      rmse        mse training_time_ms
## 1 0.7958558            0.1492782 0.1148742 0.01319607              367
## 2 0.8063697            0.1532890 0.1132089 0.01281626             1980
## 3 0.8138875            0.1333128 0.1110668 0.01233584             4403
## 4 0.7886287            0.1492265 0.1160056 0.01345729              298
## 5 0.7758282            0.1639240 0.1191760 0.01420293              294
## 6 0.6912423            0.1634067 0.1318574 0.01738638              448
##   predict_time_per_row_ms            algo
## 1                0.008128             GBM
## 2                0.009886 StackedEnsemble
## 3                0.012892 StackedEnsemble
## 4                0.007161             GBM
## 5                0.007765             GBM
## 6                0.015873             GBM
## 
## [22 rows x 10 columns]</code></pre>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="h20.html#cb262-1" tabindex="-1"></a><span class="co"># Step 5: Get the best model</span></span>
<span id="cb262-2"><a href="h20.html#cb262-2" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> aml<span class="sc">@</span>leader</span>
<span id="cb262-3"><a href="h20.html#cb262-3" tabindex="-1"></a></span>
<span id="cb262-4"><a href="h20.html#cb262-4" tabindex="-1"></a><span class="fu">h2o.performance</span>(best_model, data_h2o) </span></code></pre></div>
<pre><code>## H2OBinomialMetrics: gbm
## 
## MSE:  0.00452924
## RMSE:  0.06729963
## LogLoss:  0.01869065
## Mean Per-Class Error:  0.04075459
## AUC:  0.9991194
## AUCPR:  0.9794259
## Gini:  0.9982388
## R^2:  0.8617059
## AIC:  NaN
## 
## Confusion Matrix (vertical: actual; across: predicted) for F1-optimal threshold:
##           0   1    Error       Rate
## 0      9643  18 0.001863   =18/9661
## 1        27 312 0.079646    =27/339
## Totals 9670 330 0.004500  =45/10000
## 
## Maximum Metrics: Maximum metrics at their respective thresholds
##                         metric threshold       value idx
## 1                       max f1  0.347916    0.932735 165
## 2                       max f2  0.253541    0.941860 187
## 3                 max f0point5  0.470818    0.956123 140
## 4                 max accuracy  0.358436    0.995500 162
## 5                max precision  0.993408    1.000000   0
## 6                   max recall  0.033332    1.000000 313
## 7              max specificity  0.993408    1.000000   0
## 8             max absolute_mcc  0.347916    0.930498 165
## 9   max min_per_class_accuracy  0.126158    0.986130 236
## 10 max mean_per_class_accuracy  0.125019    0.988588 237
## 11                     max tns  0.993408 9661.000000   0
## 12                     max fns  0.993408  337.000000   0
## 13                     max fps  0.000230 9661.000000 399
## 14                     max tps  0.033332  339.000000 313
## 15                     max tnr  0.993408    1.000000   0
## 16                     max fnr  0.993408    0.994100   0
## 17                     max fpr  0.000230    1.000000 399
## 18                     max tpr  0.033332    1.000000 313
## 
## Gains/Lift Table: Extract with `h2o.gainsLift(&lt;model&gt;, &lt;data&gt;)` or `h2o.gainsLift(&lt;model&gt;, valid=&lt;T/F&gt;, xval=&lt;T/F&gt;)`</code></pre>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="h20.html#cb264-1" tabindex="-1"></a><span class="co"># Retrieve the best model from AutoML</span></span>
<span id="cb264-2"><a href="h20.html#cb264-2" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> aml<span class="sc">@</span>leader</span>
<span id="cb264-3"><a href="h20.html#cb264-3" tabindex="-1"></a></span>
<span id="cb264-4"><a href="h20.html#cb264-4" tabindex="-1"></a><span class="co"># Initialize a vector to store AUC scores or any other performance metric</span></span>
<span id="cb264-5"><a href="h20.html#cb264-5" tabindex="-1"></a>performance_scores <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb264-6"><a href="h20.html#cb264-6" tabindex="-1"></a></span>
<span id="cb264-7"><a href="h20.html#cb264-7" tabindex="-1"></a><span class="co"># Loop to perform the train-test split, predict, and calculate performance 100 times</span></span>
<span id="cb264-8"><a href="h20.html#cb264-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb264-9"><a href="h20.html#cb264-9" tabindex="-1"></a>  <span class="co"># Split the data into 80% training and 20% testing</span></span>
<span id="cb264-10"><a href="h20.html#cb264-10" tabindex="-1"></a>  splits <span class="ot">&lt;-</span> <span class="fu">h2o.splitFrame</span>(<span class="at">data =</span> data_h2o, <span class="at">ratios =</span> <span class="fl">0.8</span>)</span>
<span id="cb264-11"><a href="h20.html#cb264-11" tabindex="-1"></a>  train <span class="ot">&lt;-</span> splits[[<span class="dv">1</span>]]</span>
<span id="cb264-12"><a href="h20.html#cb264-12" tabindex="-1"></a>  test <span class="ot">&lt;-</span> splits[[<span class="dv">2</span>]]</span>
<span id="cb264-13"><a href="h20.html#cb264-13" tabindex="-1"></a>  </span>
<span id="cb264-14"><a href="h20.html#cb264-14" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">h2o.predict</span>(best_model, test)</span>
<span id="cb264-15"><a href="h20.html#cb264-15" tabindex="-1"></a>  </span>
<span id="cb264-16"><a href="h20.html#cb264-16" tabindex="-1"></a>  <span class="co"># Evaluate performance</span></span>
<span id="cb264-17"><a href="h20.html#cb264-17" tabindex="-1"></a>  perf <span class="ot">&lt;-</span> <span class="fu">h2o.performance</span>(best_model, <span class="at">newdata =</span> test)</span>
<span id="cb264-18"><a href="h20.html#cb264-18" tabindex="-1"></a>  auc_score <span class="ot">&lt;-</span> <span class="fu">h2o.auc</span>(perf)</span>
<span id="cb264-19"><a href="h20.html#cb264-19" tabindex="-1"></a>  performance_scores[i] <span class="ot">&lt;-</span> auc_score</span>
<span id="cb264-20"><a href="h20.html#cb264-20" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%
## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |======================================================================| 100%</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="h20.html#cb266-1" tabindex="-1"></a><span class="co"># Calculate average performance across all splits</span></span>
<span id="cb266-2"><a href="h20.html#cb266-2" tabindex="-1"></a>average_performance <span class="ot">&lt;-</span> <span class="fu">mean</span>(performance_scores)</span>
<span id="cb266-3"><a href="h20.html#cb266-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Average AUC over 100 trials: &quot;</span>, average_performance))</span></code></pre></div>
<pre><code>## [1] &quot;Average AUC over 100 trials:  0.999094809504338&quot;</code></pre>
<p>now we get the info about the winning model</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="h20.html#cb268-1" tabindex="-1"></a>best_model<span class="sc">@</span>model_id</span></code></pre></div>
<pre><code>## [1] &quot;GBM_grid_1_AutoML_1_20241217_15337_model_5&quot;</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="h20.html#cb270-1" tabindex="-1"></a>best_model<span class="sc">@</span>parameters</span></code></pre></div>
<pre><code>## $model_id
## [1] &quot;GBM_grid_1_AutoML_1_20241217_15337_model_5&quot;
## 
## $training_frame
## [1] &quot;AutoML_1_20241217_15337_training_RTMP_sid_88fc_5&quot;
## 
## $nfolds
## [1] 5
## 
## $keep_cross_validation_models
## [1] FALSE
## 
## $keep_cross_validation_predictions
## [1] TRUE
## 
## $score_tree_interval
## [1] 5
## 
## $fold_assignment
## [1] &quot;Modulo&quot;
## 
## $ntrees
## [1] 71
## 
## $max_depth
## [1] 11
## 
## $min_rows
## [1] 30
## 
## $stopping_metric
## [1] &quot;logloss&quot;
## 
## $stopping_tolerance
## [1] 0.01
## 
## $seed
## [1] &quot;6732902278549859389&quot;
## 
## $distribution
## [1] &quot;bernoulli&quot;
## 
## $sample_rate
## [1] 0.7
## 
## $histogram_type
## [1] &quot;UniformAdaptive&quot;
## 
## $categorical_encoding
## [1] &quot;Enum&quot;
## 
## $calibration_method
## [1] &quot;PlattScaling&quot;
## 
## $x
## [1] &quot;type&quot;                  &quot;air_temperature_k&quot;     &quot;process_temperature_k&quot;
## [4] &quot;rotational_speed_rpm&quot;  &quot;torque_nm&quot;             &quot;tool_wear_min&quot;        
## 
## $y
## [1] &quot;y&quot;</code></pre>
<p>its stacked ensambled so we need to get the models that are in the stack</p>
<p>lets get the base models</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="h20.html#cb272-1" tabindex="-1"></a>base_models <span class="ot">&lt;-</span> best_model<span class="sc">@</span>model<span class="sc">$</span>base_models</span>
<span id="cb272-2"><a href="h20.html#cb272-2" tabindex="-1"></a>base_models</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>now the meta one</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="h20.html#cb274-1" tabindex="-1"></a>metalearner <span class="ot">&lt;-</span> best_model<span class="sc">@</span>model<span class="sc">$</span>metalearner</span>
<span id="cb274-2"><a href="h20.html#cb274-2" tabindex="-1"></a>metalearner</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>=</p>
<p>GLM: Generalized Linear Model
DRF: Distributed Random Forest
GBM: Gradient Boosting Machine
DeepLearning: Neural Networks
StackedEnsemble: Ensemble methods
XGBoost: eXtreme Gradient Boosting (if available in your H2O installation</p>
</div>
<div id="xgboost-1" class="section level3 hasAnchor" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> XGBoost<a href="h20.html#xgboost-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>we need to set up the gpus for this</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="h20.html#cb276-1" tabindex="-1"></a><span class="co"># Check if XGBoost is available</span></span>
<span id="cb276-2"><a href="h20.html#cb276-2" tabindex="-1"></a><span class="fu">h2o.xgboost.available</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Cannot build a XGboost model - no backend found.&quot;</code></pre>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="h20.html#cb279-1" tabindex="-1"></a><span class="fu">h2o.shutdown</span>(<span class="at">prompt =</span> <span class="cn">FALSE</span>)</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multi-variable-classification.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="econometrics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/07_H2O.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
