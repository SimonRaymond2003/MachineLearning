<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Sequential Data Embedding | Machine Learning Applications</title>
  <meta name="description" content="Introduction" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Sequential Data Embedding | Machine Learning Applications" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Introduction" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Sequential Data Embedding | Machine Learning Applications" />
  
  <meta name="twitter:description" content="Introduction" />
  

<meta name="author" content="Simon P. Raymond" />


<meta name="date" content="2024-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="randomforestinsight.html"/>
<link rel="next" href="hcc_survey_analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MachineLearning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About Myself</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#notes-for-public"><i class="fa fa-check"></i><b>1.2</b> Notes for public</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#work-in-progress"><i class="fa fa-check"></i><b>1.3</b> Work in progress</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>2</b> Algorithms</a>
<ul>
<li class="chapter" data-level="2.1" data-path="algorithms.html"><a href="algorithms.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="algorithms.html"><a href="algorithms.html#parametric"><i class="fa fa-check"></i><b>2.2</b> Parametric</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="algorithms.html"><a href="algorithms.html#lm"><i class="fa fa-check"></i><b>2.2.1</b> LM</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="algorithms.html"><a href="algorithms.html#trees"><i class="fa fa-check"></i><b>2.3</b> Trees</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="algorithms.html"><a href="algorithms.html#cart"><i class="fa fa-check"></i><b>2.3.1</b> CART</a></li>
<li class="chapter" data-level="2.3.2" data-path="algorithms.html"><a href="algorithms.html#bagging"><i class="fa fa-check"></i><b>2.3.2</b> Bagging</a></li>
<li class="chapter" data-level="2.3.3" data-path="algorithms.html"><a href="algorithms.html#rf"><i class="fa fa-check"></i><b>2.3.3</b> RF</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="algorithms.html"><a href="algorithms.html#boosting"><i class="fa fa-check"></i><b>2.4</b> Boosting</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="algorithms.html"><a href="algorithms.html#adaboost"><i class="fa fa-check"></i><b>2.4.1</b> Adaboost</a></li>
<li class="chapter" data-level="2.4.2" data-path="algorithms.html"><a href="algorithms.html#gbm-boost"><i class="fa fa-check"></i><b>2.4.2</b> GBM boost</a></li>
<li class="chapter" data-level="2.4.3" data-path="algorithms.html"><a href="algorithms.html#xgboost"><i class="fa fa-check"></i><b>2.4.3</b> XGBoost</a></li>
<li class="chapter" data-level="2.4.4" data-path="algorithms.html"><a href="algorithms.html#light-gbm-boost"><i class="fa fa-check"></i><b>2.4.4</b> Light GBM boost</a></li>
<li class="chapter" data-level="2.4.5" data-path="algorithms.html"><a href="algorithms.html#catboost"><i class="fa fa-check"></i><b>2.4.5</b> Catboost</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="algorithms.html"><a href="algorithms.html#other-non-parametric"><i class="fa fa-check"></i><b>2.5</b> Other Non-parametric</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="algorithms.html"><a href="algorithms.html#knn"><i class="fa fa-check"></i><b>2.5.1</b> KNN</a></li>
<li class="chapter" data-level="2.5.2" data-path="algorithms.html"><a href="algorithms.html#nueralnet"><i class="fa fa-check"></i><b>2.5.2</b> Nueralnet</a></li>
<li class="chapter" data-level="2.5.3" data-path="algorithms.html"><a href="algorithms.html#svm"><i class="fa fa-check"></i><b>2.5.3</b> SVM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="binary-application.html"><a href="binary-application.html"><i class="fa fa-check"></i><b>3</b> Binary Application</a>
<ul>
<li class="chapter" data-level="3.1" data-path="binary-application.html"><a href="binary-application.html#data-1"><i class="fa fa-check"></i><b>3.1</b> Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="binary-application.html"><a href="binary-application.html#data-prep"><i class="fa fa-check"></i><b>3.1.1</b> Data Prep</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="binary-application.html"><a href="binary-application.html#model-selection"><i class="fa fa-check"></i><b>3.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="binary-application.html"><a href="binary-application.html#functions"><i class="fa fa-check"></i><b>3.2.1</b> Functions</a></li>
<li class="chapter" data-level="3.2.2" data-path="binary-application.html"><a href="binary-application.html#xgb"><i class="fa fa-check"></i><b>3.2.2</b> XGB</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="binary-application.html"><a href="binary-application.html#comparisions"><i class="fa fa-check"></i><b>3.3</b> Comparisions</a></li>
<li class="chapter" data-level="3.4" data-path="binary-application.html"><a href="binary-application.html#statistic-selection"><i class="fa fa-check"></i><b>3.4</b> Statistic selection</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="binary-application.html"><a href="binary-application.html#section"><i class="fa fa-check"></i><b>3.4.1</b> 0.5</a></li>
<li class="chapter" data-level="3.4.2" data-path="binary-application.html"><a href="binary-application.html#youdens-j-statistic"><i class="fa fa-check"></i><b>3.4.2</b> Youden’s J Statistic</a></li>
<li class="chapter" data-level="3.4.3" data-path="binary-application.html"><a href="binary-application.html#fscore"><i class="fa fa-check"></i><b>3.4.3</b> Fscore</a></li>
<li class="chapter" data-level="3.4.4" data-path="binary-application.html"><a href="binary-application.html#roc-curve"><i class="fa fa-check"></i><b>3.4.4</b> ROC curve</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regressional-application.html"><a href="regressional-application.html"><i class="fa fa-check"></i><b>4</b> Regressional Application</a>
<ul>
<li class="chapter" data-level="4.1" data-path="regressional-application.html"><a href="regressional-application.html#data-2"><i class="fa fa-check"></i><b>4.1</b> Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="regressional-application.html"><a href="regressional-application.html#data-prep-1"><i class="fa fa-check"></i><b>4.1.1</b> Data Prep</a></li>
<li class="chapter" data-level="4.1.2" data-path="regressional-application.html"><a href="regressional-application.html#data-explorations"><i class="fa fa-check"></i><b>4.1.2</b> Data Explorations</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="regressional-application.html"><a href="regressional-application.html#model-selection-1"><i class="fa fa-check"></i><b>4.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="regressional-application.html"><a href="regressional-application.html#rf-1"><i class="fa fa-check"></i><b>4.2.1</b> RF</a></li>
<li class="chapter" data-level="4.2.2" data-path="regressional-application.html"><a href="regressional-application.html#lm-1"><i class="fa fa-check"></i><b>4.2.2</b> LM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="imbalanced-application.html"><a href="imbalanced-application.html"><i class="fa fa-check"></i><b>5</b> Imbalanced Application</a>
<ul>
<li class="chapter" data-level="5.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#data-3"><i class="fa fa-check"></i><b>5.1</b> Data</a></li>
<li class="chapter" data-level="5.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#approaches"><i class="fa fa-check"></i><b>5.2</b> Approaches</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#no-changes"><i class="fa fa-check"></i><b>5.2.1</b> No changes</a></li>
<li class="chapter" data-level="5.2.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#undersample"><i class="fa fa-check"></i><b>5.2.2</b> Undersample</a></li>
<li class="chapter" data-level="5.2.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#oversampling"><i class="fa fa-check"></i><b>5.2.3</b> Oversampling</a></li>
<li class="chapter" data-level="5.2.4" data-path="imbalanced-application.html"><a href="imbalanced-application.html#smoteing"><i class="fa fa-check"></i><b>5.2.4</b> Smoteing</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#statistic-selection-1"><i class="fa fa-check"></i><b>5.3</b> Statistic selection</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="speeds.html"><a href="speeds.html"><i class="fa fa-check"></i><b>6</b> Speeds</a>
<ul>
<li class="chapter" data-level="6.1" data-path="speeds.html"><a href="speeds.html#functions-to-run-the-tests"><i class="fa fa-check"></i><b>6.1</b> Functions to run the tests</a></li>
<li class="chapter" data-level="6.2" data-path="speeds.html"><a href="speeds.html#data-4"><i class="fa fa-check"></i><b>6.2</b> Data</a></li>
<li class="chapter" data-level="6.3" data-path="speeds.html"><a href="speeds.html#rows"><i class="fa fa-check"></i><b>6.3</b> 10,000 rows</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix"><i class="fa fa-check"></i><b>6.3.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.3.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix"><i class="fa fa-check"></i><b>6.3.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="speeds.html"><a href="speeds.html#rows-1"><i class="fa fa-check"></i><b>6.4</b> 500,000 rows</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix-1"><i class="fa fa-check"></i><b>6.4.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix-1"><i class="fa fa-check"></i><b>6.4.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="speeds.html"><a href="speeds.html#presentations"><i class="fa fa-check"></i><b>6.5</b> Presentations</a></li>
<li class="chapter" data-level="6.6" data-path="speeds.html"><a href="speeds.html#analysis"><i class="fa fa-check"></i><b>6.6</b> Analysis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="speeds.html"><a href="speeds.html#graphs"><i class="fa fa-check"></i><b>6.6.1</b> Graphs</a></li>
<li class="chapter" data-level="6.6.2" data-path="speeds.html"><a href="speeds.html#takaways"><i class="fa fa-check"></i><b>6.6.2</b> Takaways</a></li>
<li class="chapter" data-level="6.6.3" data-path="speeds.html"><a href="speeds.html#things-to-change"><i class="fa fa-check"></i><b>6.6.3</b> Things to change</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html"><i class="fa fa-check"></i><b>7</b> Multi Variable Classification</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#data-5"><i class="fa fa-check"></i><b>7.1</b> Data</a></li>
<li class="chapter" data-level="7.2" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#aucs"><i class="fa fa-check"></i><b>7.2</b> AUCs</a></li>
<li class="chapter" data-level="7.3" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#confusion-table"><i class="fa fa-check"></i><b>7.3</b> Confusion Table</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="h20.html"><a href="h20.html"><i class="fa fa-check"></i><b>8</b> h20</a>
<ul>
<li class="chapter" data-level="8.1" data-path="h20.html"><a href="h20.html#set-up"><i class="fa fa-check"></i><b>8.1</b> Set-Up</a></li>
<li class="chapter" data-level="8.2" data-path="h20.html"><a href="h20.html#eda"><i class="fa fa-check"></i><b>8.2</b> EDA</a></li>
<li class="chapter" data-level="8.3" data-path="h20.html"><a href="h20.html#models-h20"><i class="fa fa-check"></i><b>8.3</b> Models h20</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="h20.html"><a href="h20.html#random-forest"><i class="fa fa-check"></i><b>8.3.1</b> Random Forest</a></li>
<li class="chapter" data-level="8.3.2" data-path="h20.html"><a href="h20.html#gradient-boosting-machine"><i class="fa fa-check"></i><b>8.3.2</b> Gradient Boosting Machine</a></li>
<li class="chapter" data-level="8.3.3" data-path="h20.html"><a href="h20.html#automl"><i class="fa fa-check"></i><b>8.3.3</b> AutoML</a></li>
<li class="chapter" data-level="8.3.4" data-path="h20.html"><a href="h20.html#xgboost-1"><i class="fa fa-check"></i><b>8.3.4</b> XGBoost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="econometrics.html"><a href="econometrics.html"><i class="fa fa-check"></i><b>9</b> 08_Econometrics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="econometrics.html"><a href="econometrics.html#a.-california-test-scores"><i class="fa fa-check"></i><b>9.1</b> A. California Test Scores</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="econometrics.html"><a href="econometrics.html#introduction"><i class="fa fa-check"></i><b>9.1.1</b> Introduction</a></li>
<li class="chapter" data-level="9.1.2" data-path="econometrics.html"><a href="econometrics.html#theory"><i class="fa fa-check"></i><b>9.1.2</b> Theory</a></li>
<li class="chapter" data-level="9.1.3" data-path="econometrics.html"><a href="econometrics.html#building-the-models"><i class="fa fa-check"></i><b>9.1.3</b> Building The models</a></li>
<li class="chapter" data-level="9.1.4" data-path="econometrics.html"><a href="econometrics.html#proofs"><i class="fa fa-check"></i><b>9.1.4</b> Proofs</a></li>
<li class="chapter" data-level="9.1.5" data-path="econometrics.html"><a href="econometrics.html#tests"><i class="fa fa-check"></i><b>9.1.5</b> Tests</a></li>
<li class="chapter" data-level="9.1.6" data-path="econometrics.html"><a href="econometrics.html#significances-and-tests"><i class="fa fa-check"></i><b>9.1.6</b> Significances and Tests</a></li>
<li class="chapter" data-level="9.1.7" data-path="econometrics.html"><a href="econometrics.html#conclusion"><i class="fa fa-check"></i><b>9.1.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="econometrics.html"><a href="econometrics.html#auto-correlation"><i class="fa fa-check"></i><b>9.2</b> Auto Correlation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="parrallel-processing.html"><a href="parrallel-processing.html"><i class="fa fa-check"></i><b>10</b> Parrallel Processing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="parrallel-processing.html"><a href="parrallel-processing.html#parallel-with-parlapply"><i class="fa fa-check"></i><b>10.1</b> 1. parallel with parLapply</a></li>
<li class="chapter" data-level="10.2" data-path="parrallel-processing.html"><a href="parrallel-processing.html#foreach-with-doparallel"><i class="fa fa-check"></i><b>10.2</b> 2. foreach with doParallel</a></li>
<li class="chapter" data-level="10.3" data-path="parrallel-processing.html"><a href="parrallel-processing.html#future-with-future.apply"><i class="fa fa-check"></i><b>10.3</b> 3. future with future.apply</a></li>
<li class="chapter" data-level="10.4" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-with-furrr"><i class="fa fa-check"></i><b>10.4</b> 4. purrr with furrr</a></li>
<li class="chapter" data-level="10.5" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-synchronously"><i class="fa fa-check"></i><b>10.5</b> 5. purrr Synchronously</a></li>
<li class="chapter" data-level="10.6" data-path="parrallel-processing.html"><a href="parrallel-processing.html#comparisions-1"><i class="fa fa-check"></i><b>10.6</b> comparisions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="randomforestinsight.html"><a href="randomforestinsight.html"><i class="fa fa-check"></i><b>11</b> 10_RandomForestInsight</a></li>
<li class="chapter" data-level="12" data-path="sequential-data-embedding.html"><a href="sequential-data-embedding.html"><i class="fa fa-check"></i><b>12</b> Sequential Data Embedding</a></li>
<li class="chapter" data-level="13" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html"><i class="fa fa-check"></i><b>13</b> HCC_Survey_Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#our-data-and-purpose"><i class="fa fa-check"></i><b>13.1</b> Our data and Purpose</a></li>
<li class="chapter" data-level="13.2" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>13.2</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="13.3" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#modeling-random-forest"><i class="fa fa-check"></i><b>13.3</b> Modeling Random Forest</a></li>
<li class="chapter" data-level="13.4" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#global-importance"><i class="fa fa-check"></i><b>13.4</b> Global Importance</a></li>
<li class="chapter" data-level="13.5" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#local-importance"><i class="fa fa-check"></i><b>13.5</b> Local Importance</a></li>
<li class="chapter" data-level="13.6" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#partial-dependence-plots"><i class="fa fa-check"></i><b>13.6</b> Partial Dependence Plots</a></li>
<li class="chapter" data-level="13.7" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#random-forest-explainer"><i class="fa fa-check"></i><b>13.7</b> Random Forest Explainer</a></li>
<li class="chapter" data-level="13.8" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#final-notes"><i class="fa fa-check"></i><b>13.8</b> Final Notes</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="what_is_stacked_ensambled.html"><a href="what_is_stacked_ensambled.html"><i class="fa fa-check"></i><b>14</b> 13_What_Is_Stacked_Ensambled</a></li>
<li class="chapter" data-level="15" data-path="intro_econ_stats.html"><a href="intro_econ_stats.html"><i class="fa fa-check"></i><b>15</b> 14_Intro_Econ_Stats</a></li>
<li class="chapter" data-level="16" data-path="nfl.html"><a href="nfl.html"><i class="fa fa-check"></i><b>16</b> NFL</a>
<ul>
<li class="chapter" data-level="16.1" data-path="nfl.html"><a href="nfl.html#wbs"><i class="fa fa-check"></i><b>16.1</b> WBs</a></li>
<li class="chapter" data-level="16.2" data-path="nfl.html"><a href="nfl.html#rbs"><i class="fa fa-check"></i><b>16.2</b> RBs</a></li>
<li class="chapter" data-level="16.3" data-path="nfl.html"><a href="nfl.html#qbs"><i class="fa fa-check"></i><b>16.3</b> QBs</a></li>
<li class="chapter" data-level="16.4" data-path="nfl.html"><a href="nfl.html#plots-and-analysis"><i class="fa fa-check"></i><b>16.4</b> Plots and Analysis</a></li>
<li class="chapter" data-level="16.5" data-path="nfl.html"><a href="nfl.html#lists-to-do"><i class="fa fa-check"></i><b>16.5</b> Lists to do</a></li>
<li class="chapter" data-level="16.6" data-path="nfl.html"><a href="nfl.html#team-mates"><i class="fa fa-check"></i><b>16.6</b> team mates</a></li>
<li class="chapter" data-level="16.7" data-path="nfl.html"><a href="nfl.html#testing"><i class="fa fa-check"></i><b>16.7</b> Testing</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning Applications</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sequential-data-embedding" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Sequential Data Embedding<a href="sequential-data-embedding.html#sequential-data-embedding" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>With time series data we cannot shuffle the data due to the temporal nature of the data. This means we cannot shuffle the data. While models like ARIMA do exist they are not strong enough for forcasting. we want to get our data to the point where we can use our machine learning models on it.</p>
<p>first lets make a toy dataset to work with. it will have a y and one X</p>
<p>Since we set rho to be less then 1 our fake data is stationary.</p>
<p>If rho is = 1 then we have non-stationary data and must decompose it to get to this position. You can take the first differance in that case.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="sequential-data-embedding.html#cb333-1" tabindex="-1"></a><span class="co"># Stationary data rho &lt; 1 </span></span>
<span id="cb333-2"><a href="sequential-data-embedding.html#cb333-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb333-3"><a href="sequential-data-embedding.html#cb333-3" tabindex="-1"></a>rho_y <span class="ot">&lt;-</span> <span class="fl">0.80</span></span>
<span id="cb333-4"><a href="sequential-data-embedding.html#cb333-4" tabindex="-1"></a>rho_x <span class="ot">&lt;-</span> <span class="fl">0.75</span>  <span class="co"># A different rho for X</span></span>
<span id="cb333-5"><a href="sequential-data-embedding.html#cb333-5" tabindex="-1"></a></span>
<span id="cb333-6"><a href="sequential-data-embedding.html#cb333-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb333-7"><a href="sequential-data-embedding.html#cb333-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb333-8"><a href="sequential-data-embedding.html#cb333-8" tabindex="-1"></a></span>
<span id="cb333-9"><a href="sequential-data-embedding.html#cb333-9" tabindex="-1"></a>e_y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># White noise for y</span></span>
<span id="cb333-10"><a href="sequential-data-embedding.html#cb333-10" tabindex="-1"></a>e_x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># White noise for X</span></span>
<span id="cb333-11"><a href="sequential-data-embedding.html#cb333-11" tabindex="-1"></a></span>
<span id="cb333-12"><a href="sequential-data-embedding.html#cb333-12" tabindex="-1"></a><span class="co"># Generate y and X as separate autoregressive processes</span></span>
<span id="cb333-13"><a href="sequential-data-embedding.html#cb333-13" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) { </span>
<span id="cb333-14"><a href="sequential-data-embedding.html#cb333-14" tabindex="-1"></a>  y[j <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> y[j] <span class="sc">*</span> rho_y <span class="sc">+</span> e_y[j]</span>
<span id="cb333-15"><a href="sequential-data-embedding.html#cb333-15" tabindex="-1"></a>  x[j <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> x[j] <span class="sc">*</span> rho_x <span class="sc">+</span> e_x[j]</span>
<span id="cb333-16"><a href="sequential-data-embedding.html#cb333-16" tabindex="-1"></a>}</span>
<span id="cb333-17"><a href="sequential-data-embedding.html#cb333-17" tabindex="-1"></a></span>
<span id="cb333-18"><a href="sequential-data-embedding.html#cb333-18" tabindex="-1"></a>ylagged <span class="ot">&lt;-</span> y[<span class="dv">2</span><span class="sc">:</span>n]</span>
<span id="cb333-19"><a href="sequential-data-embedding.html#cb333-19" tabindex="-1"></a>xlagged <span class="ot">&lt;-</span> x[<span class="dv">2</span><span class="sc">:</span>n]</span>
<span id="cb333-20"><a href="sequential-data-embedding.html#cb333-20" tabindex="-1"></a></span>
<span id="cb333-21"><a href="sequential-data-embedding.html#cb333-21" tabindex="-1"></a><span class="co"># y over time</span></span>
<span id="cb333-22"><a href="sequential-data-embedding.html#cb333-22" tabindex="-1"></a><span class="fu">plot</span>(y[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb333-23"><a href="sequential-data-embedding.html#cb333-23" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb333-24"><a href="sequential-data-embedding.html#cb333-24" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb333-25"><a href="sequential-data-embedding.html#cb333-25" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb333-26"><a href="sequential-data-embedding.html#cb333-26" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>,</span>
<span id="cb333-27"><a href="sequential-data-embedding.html#cb333-27" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;y over time&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="sequential-data-embedding.html#cb334-1" tabindex="-1"></a><span class="co"># x over time</span></span>
<span id="cb334-2"><a href="sequential-data-embedding.html#cb334-2" tabindex="-1"></a><span class="fu">plot</span>(x[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb334-3"><a href="sequential-data-embedding.html#cb334-3" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb334-4"><a href="sequential-data-embedding.html#cb334-4" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb334-5"><a href="sequential-data-embedding.html#cb334-5" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb334-6"><a href="sequential-data-embedding.html#cb334-6" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>,</span>
<span id="cb334-7"><a href="sequential-data-embedding.html#cb334-7" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;x over time&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-153-2.png" width="672" /></p>
<p>So we begin by predicting y + 1 but we must first prove we can embed and shuffle the data</p>
<p>we will use 2 points back of y and three points back of x to predict the next point of y.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="sequential-data-embedding.html#cb335-1" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb335-2"><a href="sequential-data-embedding.html#cb335-2" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="dv">11</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb335-3"><a href="sequential-data-embedding.html#cb335-3" tabindex="-1"></a><span class="co"># Create the embedded matrix for Y and X</span></span>
<span id="cb335-4"><a href="sequential-data-embedding.html#cb335-4" tabindex="-1"></a>y_emb <span class="ot">&lt;-</span> <span class="fu">embed</span>(y2, <span class="dv">4</span>)</span>
<span id="cb335-5"><a href="sequential-data-embedding.html#cb335-5" tabindex="-1"></a>x_emb <span class="ot">&lt;-</span> <span class="fu">embed</span>(x2, <span class="dv">4</span>)</span>
<span id="cb335-6"><a href="sequential-data-embedding.html#cb335-6" tabindex="-1"></a><span class="fu">colnames</span>(y_emb) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Y(t)&quot;</span>, <span class="st">&quot;Y(t-1)&quot;</span>, <span class="st">&quot;Y(t-2)&quot;</span>, <span class="st">&quot;Y(t-3)&quot;</span>)</span>
<span id="cb335-7"><a href="sequential-data-embedding.html#cb335-7" tabindex="-1"></a><span class="fu">colnames</span>(x_emb) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X(t)&quot;</span>, <span class="st">&quot;X(t-1)&quot;</span>, <span class="st">&quot;X(t-2)&quot;</span>, <span class="st">&quot;X(t-3)&quot;</span>)</span>
<span id="cb335-8"><a href="sequential-data-embedding.html#cb335-8" tabindex="-1"></a>fd <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y_emb, x_emb)</span>
<span id="cb335-9"><a href="sequential-data-embedding.html#cb335-9" tabindex="-1"></a><span class="fu">head</span>(fd)</span></code></pre></div>
<pre><code>##      Y(t) Y(t-1) Y(t-2) Y(t-3) X(t) X(t-1) X(t-2) X(t-3)
## [1,]    4      3      2      1   14     13     12     11
## [2,]    5      4      3      2   15     14     13     12
## [3,]    6      5      4      3   16     15     14     13
## [4,]    7      6      5      4   17     16     15     14
## [5,]    8      7      6      5   18     17     16     15
## [6,]    9      8      7      6   19     18     17     16</code></pre>
<p>now for each point we are predicting(y + 1), (y+2), and (y+3) we need to edit the data</p>
<p>for predicting point y(t+1) the formula is</p>
<p><span class="math display">\[
\hat{y}(t+1) = f\left( y(t), y(t-1), y(t-2), x(t), x(t-1), x(t-2), x(t-3) \right)
\]</span></p>
<p>and the data is</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="sequential-data-embedding.html#cb337-1" tabindex="-1"></a><span class="fu">head</span>(fd)</span></code></pre></div>
<pre><code>##      Y(t) Y(t-1) Y(t-2) Y(t-3) X(t) X(t-1) X(t-2) X(t-3)
## [1,]    4      3      2      1   14     13     12     11
## [2,]    5      4      3      2   15     14     13     12
## [3,]    6      5      4      3   16     15     14     13
## [4,]    7      6      5      4   17     16     15     14
## [5,]    8      7      6      5   18     17     16     15
## [6,]    9      8      7      6   19     18     17     16</code></pre>
<p>in this case row seven is y where t = 10… 10(t) - 3(lags) = 7(rows)</p>
<p>for the seccond point we are predicting y(t+2) the formula is
<span class="math display">\[
\hat{y}(t+2) = f\left( y(t), y(t-1), y(t-2), x(t), x(t-1), x(t-2), x(t-3) \right)
\]</span></p>
<p>and the data is</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="sequential-data-embedding.html#cb339-1" tabindex="-1"></a><span class="co"># Shift the first column (Y(t)) up by one position</span></span>
<span id="cb339-2"><a href="sequential-data-embedding.html#cb339-2" tabindex="-1"></a>sd <span class="ot">&lt;-</span> fd[<span class="sc">-</span><span class="fu">nrow</span>(fd), ] <span class="co"># Remove the last row</span></span>
<span id="cb339-3"><a href="sequential-data-embedding.html#cb339-3" tabindex="-1"></a>sd[, <span class="dv">1</span>] <span class="ot">&lt;-</span> fd[<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>]  <span class="co"># Shift the first column up by one</span></span>
<span id="cb339-4"><a href="sequential-data-embedding.html#cb339-4" tabindex="-1"></a></span>
<span id="cb339-5"><a href="sequential-data-embedding.html#cb339-5" tabindex="-1"></a><span class="co"># Display the result to verify</span></span>
<span id="cb339-6"><a href="sequential-data-embedding.html#cb339-6" tabindex="-1"></a><span class="fu">head</span>(sd)</span></code></pre></div>
<pre><code>##      Y(t) Y(t-1) Y(t-2) Y(t-3) X(t) X(t-1) X(t-2) X(t-3)
## [1,]    5      3      2      1   14     13     12     11
## [2,]    6      4      3      2   15     14     13     12
## [3,]    7      5      4      3   16     15     14     13
## [4,]    8      6      5      4   17     16     15     14
## [5,]    9      7      6      5   18     17     16     15
## [6,]   10      8      7      6   19     18     17     16</code></pre>
<p><span class="math display">\[
\hat{y}(t+3) = f\left( y(t), y(t-1), y(t-2), x(t), x(t-1), x(t-2), x(t-3) \right)
\]</span></p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="sequential-data-embedding.html#cb341-1" tabindex="-1"></a><span class="co"># Shift the first column (Y(t+2)) up by one position to prepare for y(t+3)</span></span>
<span id="cb341-2"><a href="sequential-data-embedding.html#cb341-2" tabindex="-1"></a>td <span class="ot">&lt;-</span> sd[<span class="sc">-</span><span class="fu">nrow</span>(sd), ]  <span class="co"># Remove the last row</span></span>
<span id="cb341-3"><a href="sequential-data-embedding.html#cb341-3" tabindex="-1"></a>td[, <span class="dv">1</span>] <span class="ot">&lt;-</span> sd[<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>]   <span class="co"># Shift the first column up by one</span></span>
<span id="cb341-4"><a href="sequential-data-embedding.html#cb341-4" tabindex="-1"></a></span>
<span id="cb341-5"><a href="sequential-data-embedding.html#cb341-5" tabindex="-1"></a><span class="co"># Display the result to verify</span></span>
<span id="cb341-6"><a href="sequential-data-embedding.html#cb341-6" tabindex="-1"></a><span class="fu">head</span>(td)</span></code></pre></div>
<pre><code>##      Y(t) Y(t-1) Y(t-2) Y(t-3) X(t) X(t-1) X(t-2) X(t-3)
## [1,]    6      3      2      1   14     13     12     11
## [2,]    7      4      3      2   15     14     13     12
## [3,]    8      5      4      3   16     15     14     13
## [4,]    9      6      5      4   17     16     15     14
## [5,]   10      7      6      5   18     17     16     15</code></pre>
<p>now we will aplly this to our data and prove that we can shuffle the data</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="sequential-data-embedding.html#cb343-1" tabindex="-1"></a>y_emb <span class="ot">&lt;-</span> <span class="fu">embed</span>(y, <span class="dv">4</span>)</span>
<span id="cb343-2"><a href="sequential-data-embedding.html#cb343-2" tabindex="-1"></a>x_emb <span class="ot">&lt;-</span> <span class="fu">embed</span>(x, <span class="dv">4</span>)</span>
<span id="cb343-3"><a href="sequential-data-embedding.html#cb343-3" tabindex="-1"></a><span class="fu">colnames</span>(y_emb) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Y(t)&quot;</span>, <span class="st">&quot;Y(t-1)&quot;</span>, <span class="st">&quot;Y(t-2)&quot;</span>, <span class="st">&quot;Y(t-3)&quot;</span>)</span>
<span id="cb343-4"><a href="sequential-data-embedding.html#cb343-4" tabindex="-1"></a><span class="fu">colnames</span>(x_emb) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X(t)&quot;</span>, <span class="st">&quot;X(t-1)&quot;</span>, <span class="st">&quot;X(t-2)&quot;</span>, <span class="st">&quot;X(t-3)&quot;</span>)</span></code></pre></div>
<p>They each lose 3 rows at the end of the data set.</p>
<p>now get the data set for predicting y(t+1) same as before</p>
<p>now y(t+2) and y(t+3)</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="sequential-data-embedding.html#cb344-1" tabindex="-1"></a><span class="co"># First, embed the original data for y and x</span></span>
<span id="cb344-2"><a href="sequential-data-embedding.html#cb344-2" tabindex="-1"></a>y_emb <span class="ot">&lt;-</span> <span class="fu">embed</span>(y, <span class="dv">4</span>)</span>
<span id="cb344-3"><a href="sequential-data-embedding.html#cb344-3" tabindex="-1"></a>x_emb <span class="ot">&lt;-</span> <span class="fu">embed</span>(x, <span class="dv">4</span>)</span>
<span id="cb344-4"><a href="sequential-data-embedding.html#cb344-4" tabindex="-1"></a><span class="fu">colnames</span>(y_emb) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Yt&quot;</span>, <span class="st">&quot;Y(t-1)&quot;</span>, <span class="st">&quot;Y(t-2)&quot;</span>, <span class="st">&quot;Y(t-3)&quot;</span>)</span>
<span id="cb344-5"><a href="sequential-data-embedding.html#cb344-5" tabindex="-1"></a><span class="fu">colnames</span>(x_emb) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X(t)&quot;</span>, <span class="st">&quot;X(t-1)&quot;</span>, <span class="st">&quot;X(t-2)&quot;</span>, <span class="st">&quot;X(t-3)&quot;</span>)</span>
<span id="cb344-6"><a href="sequential-data-embedding.html#cb344-6" tabindex="-1"></a>fd <span class="ot">&lt;-</span> <span class="fu">cbind</span>(y_emb, x_emb)</span>
<span id="cb344-7"><a href="sequential-data-embedding.html#cb344-7" tabindex="-1"></a></span>
<span id="cb344-8"><a href="sequential-data-embedding.html#cb344-8" tabindex="-1"></a><span class="co"># Shift the first column (Y(t)) up by one position for y(t+2)</span></span>
<span id="cb344-9"><a href="sequential-data-embedding.html#cb344-9" tabindex="-1"></a>sd <span class="ot">&lt;-</span> fd[<span class="sc">-</span><span class="fu">nrow</span>(fd), ] <span class="co"># Remove the last row</span></span>
<span id="cb344-10"><a href="sequential-data-embedding.html#cb344-10" tabindex="-1"></a>sd[, <span class="dv">1</span>] <span class="ot">&lt;-</span> fd[<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>]  <span class="co"># Shift the first column up by one</span></span>
<span id="cb344-11"><a href="sequential-data-embedding.html#cb344-11" tabindex="-1"></a></span>
<span id="cb344-12"><a href="sequential-data-embedding.html#cb344-12" tabindex="-1"></a><span class="co"># Display the resulting dataset</span></span>
<span id="cb344-13"><a href="sequential-data-embedding.html#cb344-13" tabindex="-1"></a><span class="fu">head</span>(sd)</span></code></pre></div>
<pre><code>##            Yt    Y(t-1)    Y(t-2)    Y(t-3)       X(t)     X(t-1)     X(t-2)
## [1,] 1.929294 0.5787050 1.7820067 0.0000000  0.1548195  1.5972208  0.2145459
## [2,] 4.146824 0.8104935 0.5787050 1.7820067  0.9563507  0.1548195  1.5972208
## [3,] 3.861559 1.9292935 0.8104935 0.5787050 -0.4656051  0.9563507  0.1548195
## [4,] 3.775874 4.1468239 1.9292935 0.8104935  0.2394009 -0.4656051  0.9563507
## [5,] 3.837588 3.8615592 4.1468239 1.9292935  1.4626364  0.2394009 -0.4656051
## [6,] 3.010381 3.7758736 3.8615592 4.1468239 -0.8892229  1.4626364  0.2394009
##          X(t-3)
## [1,]  0.0000000
## [2,]  0.2145459
## [3,]  1.5972208
## [4,]  0.1548195
## [5,]  0.9563507
## [6,] -0.4656051</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="sequential-data-embedding.html#cb346-1" tabindex="-1"></a><span class="co"># Shift the first column (Y(t+2)) up by one position to prepare for y(t+3)</span></span>
<span id="cb346-2"><a href="sequential-data-embedding.html#cb346-2" tabindex="-1"></a>td <span class="ot">&lt;-</span> sd[<span class="sc">-</span><span class="fu">nrow</span>(sd), ]  <span class="co"># Remove the last row</span></span>
<span id="cb346-3"><a href="sequential-data-embedding.html#cb346-3" tabindex="-1"></a>td[, <span class="dv">1</span>] <span class="ot">&lt;-</span> sd[<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>]   <span class="co"># Shift the first column up by one</span></span>
<span id="cb346-4"><a href="sequential-data-embedding.html#cb346-4" tabindex="-1"></a></span>
<span id="cb346-5"><a href="sequential-data-embedding.html#cb346-5" tabindex="-1"></a><span class="co"># Display the resulting dataset</span></span>
<span id="cb346-6"><a href="sequential-data-embedding.html#cb346-6" tabindex="-1"></a><span class="fu">head</span>(td)</span></code></pre></div>
<pre><code>##            Yt    Y(t-1)    Y(t-2)    Y(t-3)       X(t)     X(t-1)     X(t-2)
## [1,] 4.146824 0.5787050 1.7820067 0.0000000  0.1548195  1.5972208  0.2145459
## [2,] 3.861559 0.8104935 0.5787050 1.7820067  0.9563507  0.1548195  1.5972208
## [3,] 3.775874 1.9292935 0.8104935 0.5787050 -0.4656051  0.9563507  0.1548195
## [4,] 3.837588 4.1468239 1.9292935 0.8104935  0.2394009 -0.4656051  0.9563507
## [5,] 3.010381 3.8615592 4.1468239 1.9292935  1.4626364  0.2394009 -0.4656051
## [6,] 2.971880 3.7758736 3.8615592 4.1468239 -0.8892229  1.4626364  0.2394009
##          X(t-3)
## [1,]  0.0000000
## [2,]  0.2145459
## [3,]  1.5972208
## [4,]  0.1548195
## [5,]  0.9563507
## [6,] -0.4656051</code></pre>
<p>apply lm to each of the data sets then shuffle and check the coeficients</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="sequential-data-embedding.html#cb348-1" tabindex="-1"></a><span class="co"># Fit a linear model to predict Y(t+1)</span></span>
<span id="cb348-2"><a href="sequential-data-embedding.html#cb348-2" tabindex="-1"></a>fd <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(fd)</span>
<span id="cb348-3"><a href="sequential-data-embedding.html#cb348-3" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(sd)</span>
<span id="cb348-4"><a href="sequential-data-embedding.html#cb348-4" tabindex="-1"></a>td <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(td)</span>
<span id="cb348-5"><a href="sequential-data-embedding.html#cb348-5" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yt <span class="sc">~</span> ., <span class="at">data =</span> fd)</span>
<span id="cb348-6"><a href="sequential-data-embedding.html#cb348-6" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yt <span class="sc">~</span> ., <span class="at">data =</span> sd)</span>
<span id="cb348-7"><a href="sequential-data-embedding.html#cb348-7" tabindex="-1"></a>lm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yt <span class="sc">~</span> ., <span class="at">data =</span> td)</span>
<span id="cb348-8"><a href="sequential-data-embedding.html#cb348-8" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Yt ~ ., data = fd)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.92947 -0.51938  0.00807  0.72227  2.36213 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.09117    0.10707   0.851    0.397    
## `Y(t-1)`     0.85598    0.10690   8.007 4.21e-12 ***
## `Y(t-2)`    -0.09809    0.14038  -0.699    0.487    
## `Y(t-3)`     0.07958    0.10640   0.748    0.456    
## `X(t)`      -0.14637    0.11209  -1.306    0.195    
## `X(t-1)`     0.19891    0.13247   1.502    0.137    
## `X(t-2)`    -0.01600    0.13123  -0.122    0.903    
## `X(t-3)`     0.04416    0.11058   0.399    0.691    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.998 on 89 degrees of freedom
## Multiple R-squared:  0.6996, Adjusted R-squared:  0.676 
## F-statistic: 29.62 on 7 and 89 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="sequential-data-embedding.html#cb350-1" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Yt ~ ., data = sd)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.27684 -0.95502  0.01087  0.84341  3.04907 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.146103   0.138208   1.057   0.2933    
## `Y(t-1)`     0.643308   0.138307   4.651 1.15e-05 ***
## `Y(t-2)`    -0.133187   0.180526  -0.738   0.4626    
## `Y(t-3)`     0.233729   0.137782   1.696   0.0934 .  
## `X(t)`      -0.006291   0.144171  -0.044   0.9653    
## `X(t-1)`     0.195887   0.170375   1.150   0.2534    
## `X(t-2)`     0.099337   0.169022   0.588   0.5582    
## `X(t-3)`    -0.144014   0.142646  -1.010   0.3155    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.283 on 88 degrees of freedom
## Multiple R-squared:  0.509,  Adjusted R-squared:  0.4699 
## F-statistic: 13.03 on 7 and 88 DF,  p-value: 2.128e-11</code></pre>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="sequential-data-embedding.html#cb352-1" tabindex="-1"></a><span class="fu">summary</span>(lm3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Yt ~ ., data = td)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.8378 -0.8876 -0.1540  0.7352  3.6533 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  0.17271    0.15236   1.134   0.2601  
## `Y(t-1)`     0.38835    0.15293   2.539   0.0129 *
## `Y(t-2)`     0.10300    0.19877   0.518   0.6057  
## `Y(t-3)`     0.18286    0.15115   1.210   0.2296  
## `X(t)`       0.10152    0.15843   0.641   0.5233  
## `X(t-1)`     0.26238    0.18708   1.402   0.1643  
## `X(t-2)`    -0.02088    0.18596  -0.112   0.9109  
## `X(t-3)`    -0.23294    0.15649  -1.489   0.1402  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.408 on 87 degrees of freedom
## Multiple R-squared:  0.412,  Adjusted R-squared:  0.3647 
## F-statistic: 8.709 on 7 and 87 DF,  p-value: 4.541e-08</code></pre>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="sequential-data-embedding.html#cb354-1" tabindex="-1"></a><span class="co"># Shuffle the data</span></span>
<span id="cb354-2"><a href="sequential-data-embedding.html#cb354-2" tabindex="-1"></a>fd <span class="ot">&lt;-</span> fd[<span class="fu">sample</span>(<span class="fu">nrow</span>(fd)), ]</span>
<span id="cb354-3"><a href="sequential-data-embedding.html#cb354-3" tabindex="-1"></a>sd <span class="ot">&lt;-</span> sd[<span class="fu">sample</span>(<span class="fu">nrow</span>(sd)), ]</span>
<span id="cb354-4"><a href="sequential-data-embedding.html#cb354-4" tabindex="-1"></a>td <span class="ot">&lt;-</span> td[<span class="fu">sample</span>(<span class="fu">nrow</span>(td)), ]</span></code></pre></div>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="sequential-data-embedding.html#cb355-1" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yt <span class="sc">~</span> ., <span class="at">data =</span> fd)</span>
<span id="cb355-2"><a href="sequential-data-embedding.html#cb355-2" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yt <span class="sc">~</span> ., <span class="at">data =</span> sd)</span>
<span id="cb355-3"><a href="sequential-data-embedding.html#cb355-3" tabindex="-1"></a>lm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Yt <span class="sc">~</span> ., <span class="at">data =</span> td)</span>
<span id="cb355-4"><a href="sequential-data-embedding.html#cb355-4" tabindex="-1"></a><span class="fu">summary</span>(lm1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Yt ~ ., data = fd)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.92947 -0.51938  0.00807  0.72227  2.36213 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.09117    0.10707   0.851    0.397    
## `Y(t-1)`     0.85598    0.10690   8.007 4.21e-12 ***
## `Y(t-2)`    -0.09809    0.14038  -0.699    0.487    
## `Y(t-3)`     0.07958    0.10640   0.748    0.456    
## `X(t)`      -0.14637    0.11209  -1.306    0.195    
## `X(t-1)`     0.19891    0.13247   1.502    0.137    
## `X(t-2)`    -0.01600    0.13123  -0.122    0.903    
## `X(t-3)`     0.04416    0.11058   0.399    0.691    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.998 on 89 degrees of freedom
## Multiple R-squared:  0.6996, Adjusted R-squared:  0.676 
## F-statistic: 29.62 on 7 and 89 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="sequential-data-embedding.html#cb357-1" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Yt ~ ., data = sd)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.27684 -0.95502  0.01087  0.84341  3.04907 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.146103   0.138208   1.057   0.2933    
## `Y(t-1)`     0.643308   0.138307   4.651 1.15e-05 ***
## `Y(t-2)`    -0.133187   0.180526  -0.738   0.4626    
## `Y(t-3)`     0.233729   0.137782   1.696   0.0934 .  
## `X(t)`      -0.006291   0.144171  -0.044   0.9653    
## `X(t-1)`     0.195887   0.170375   1.150   0.2534    
## `X(t-2)`     0.099337   0.169022   0.588   0.5582    
## `X(t-3)`    -0.144014   0.142646  -1.010   0.3155    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.283 on 88 degrees of freedom
## Multiple R-squared:  0.509,  Adjusted R-squared:  0.4699 
## F-statistic: 13.03 on 7 and 88 DF,  p-value: 2.128e-11</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="sequential-data-embedding.html#cb359-1" tabindex="-1"></a><span class="fu">summary</span>(lm3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Yt ~ ., data = td)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.8378 -0.8876 -0.1540  0.7352  3.6533 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  0.17271    0.15236   1.134   0.2601  
## `Y(t-1)`     0.38835    0.15293   2.539   0.0129 *
## `Y(t-2)`     0.10300    0.19877   0.518   0.6057  
## `Y(t-3)`     0.18286    0.15115   1.210   0.2296  
## `X(t)`       0.10152    0.15843   0.641   0.5233  
## `X(t-1)`     0.26238    0.18708   1.402   0.1643  
## `X(t-2)`    -0.02088    0.18596  -0.112   0.9109  
## `X(t-3)`    -0.23294    0.15649  -1.489   0.1402  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.408 on 87 degrees of freedom
## Multiple R-squared:  0.412,  Adjusted R-squared:  0.3647 
## F-statistic: 8.709 on 7 and 87 DF,  p-value: 4.541e-08</code></pre>
<p>Now at this point we can use any machine learning model we want to predict the next three points in the time series.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="randomforestinsight.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hcc_survey_analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/11_SequentialDataEmbedding.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
