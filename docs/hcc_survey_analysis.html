<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 HCC_Survey_Analysis | Machine Learning Applications</title>
  <meta name="description" content="Introduction" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 HCC_Survey_Analysis | Machine Learning Applications" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Introduction" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 HCC_Survey_Analysis | Machine Learning Applications" />
  
  <meta name="twitter:description" content="Introduction" />
  

<meta name="author" content="Simon P. Raymond" />


<meta name="date" content="2024-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sequential-data-embedding.html"/>
<link rel="next" href="what_is_stacked_ensambled.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MachineLearning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About Myself</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#notes-for-public"><i class="fa fa-check"></i><b>1.2</b> Notes for public</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#work-in-progress"><i class="fa fa-check"></i><b>1.3</b> Work in progress</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>2</b> Algorithms</a>
<ul>
<li class="chapter" data-level="2.1" data-path="algorithms.html"><a href="algorithms.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="algorithms.html"><a href="algorithms.html#parametric"><i class="fa fa-check"></i><b>2.2</b> Parametric</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="algorithms.html"><a href="algorithms.html#lm"><i class="fa fa-check"></i><b>2.2.1</b> LM</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="algorithms.html"><a href="algorithms.html#trees"><i class="fa fa-check"></i><b>2.3</b> Trees</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="algorithms.html"><a href="algorithms.html#cart"><i class="fa fa-check"></i><b>2.3.1</b> CART</a></li>
<li class="chapter" data-level="2.3.2" data-path="algorithms.html"><a href="algorithms.html#bagging"><i class="fa fa-check"></i><b>2.3.2</b> Bagging</a></li>
<li class="chapter" data-level="2.3.3" data-path="algorithms.html"><a href="algorithms.html#rf"><i class="fa fa-check"></i><b>2.3.3</b> RF</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="algorithms.html"><a href="algorithms.html#boosting"><i class="fa fa-check"></i><b>2.4</b> Boosting</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="algorithms.html"><a href="algorithms.html#adaboost"><i class="fa fa-check"></i><b>2.4.1</b> Adaboost</a></li>
<li class="chapter" data-level="2.4.2" data-path="algorithms.html"><a href="algorithms.html#gbm-boost"><i class="fa fa-check"></i><b>2.4.2</b> GBM boost</a></li>
<li class="chapter" data-level="2.4.3" data-path="algorithms.html"><a href="algorithms.html#xgboost"><i class="fa fa-check"></i><b>2.4.3</b> XGBoost</a></li>
<li class="chapter" data-level="2.4.4" data-path="algorithms.html"><a href="algorithms.html#light-gbm-boost"><i class="fa fa-check"></i><b>2.4.4</b> Light GBM boost</a></li>
<li class="chapter" data-level="2.4.5" data-path="algorithms.html"><a href="algorithms.html#catboost"><i class="fa fa-check"></i><b>2.4.5</b> Catboost</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="algorithms.html"><a href="algorithms.html#other-non-parametric"><i class="fa fa-check"></i><b>2.5</b> Other Non-parametric</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="algorithms.html"><a href="algorithms.html#knn"><i class="fa fa-check"></i><b>2.5.1</b> KNN</a></li>
<li class="chapter" data-level="2.5.2" data-path="algorithms.html"><a href="algorithms.html#nueralnet"><i class="fa fa-check"></i><b>2.5.2</b> Nueralnet</a></li>
<li class="chapter" data-level="2.5.3" data-path="algorithms.html"><a href="algorithms.html#svm"><i class="fa fa-check"></i><b>2.5.3</b> SVM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="binary-application.html"><a href="binary-application.html"><i class="fa fa-check"></i><b>3</b> Binary Application</a>
<ul>
<li class="chapter" data-level="3.1" data-path="binary-application.html"><a href="binary-application.html#data-1"><i class="fa fa-check"></i><b>3.1</b> Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="binary-application.html"><a href="binary-application.html#data-prep"><i class="fa fa-check"></i><b>3.1.1</b> Data Prep</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="binary-application.html"><a href="binary-application.html#model-selection"><i class="fa fa-check"></i><b>3.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="binary-application.html"><a href="binary-application.html#functions"><i class="fa fa-check"></i><b>3.2.1</b> Functions</a></li>
<li class="chapter" data-level="3.2.2" data-path="binary-application.html"><a href="binary-application.html#xgb"><i class="fa fa-check"></i><b>3.2.2</b> XGB</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="binary-application.html"><a href="binary-application.html#comparisions"><i class="fa fa-check"></i><b>3.3</b> Comparisions</a></li>
<li class="chapter" data-level="3.4" data-path="binary-application.html"><a href="binary-application.html#statistic-selection"><i class="fa fa-check"></i><b>3.4</b> Statistic selection</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="binary-application.html"><a href="binary-application.html#section"><i class="fa fa-check"></i><b>3.4.1</b> 0.5</a></li>
<li class="chapter" data-level="3.4.2" data-path="binary-application.html"><a href="binary-application.html#youdens-j-statistic"><i class="fa fa-check"></i><b>3.4.2</b> Youden’s J Statistic</a></li>
<li class="chapter" data-level="3.4.3" data-path="binary-application.html"><a href="binary-application.html#fscore"><i class="fa fa-check"></i><b>3.4.3</b> Fscore</a></li>
<li class="chapter" data-level="3.4.4" data-path="binary-application.html"><a href="binary-application.html#roc-curve"><i class="fa fa-check"></i><b>3.4.4</b> ROC curve</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regressional-application.html"><a href="regressional-application.html"><i class="fa fa-check"></i><b>4</b> Regressional Application</a>
<ul>
<li class="chapter" data-level="4.1" data-path="regressional-application.html"><a href="regressional-application.html#data-2"><i class="fa fa-check"></i><b>4.1</b> Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="regressional-application.html"><a href="regressional-application.html#data-prep-1"><i class="fa fa-check"></i><b>4.1.1</b> Data Prep</a></li>
<li class="chapter" data-level="4.1.2" data-path="regressional-application.html"><a href="regressional-application.html#data-explorations"><i class="fa fa-check"></i><b>4.1.2</b> Data Explorations</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="regressional-application.html"><a href="regressional-application.html#model-selection-1"><i class="fa fa-check"></i><b>4.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="regressional-application.html"><a href="regressional-application.html#rf-1"><i class="fa fa-check"></i><b>4.2.1</b> RF</a></li>
<li class="chapter" data-level="4.2.2" data-path="regressional-application.html"><a href="regressional-application.html#lm-1"><i class="fa fa-check"></i><b>4.2.2</b> LM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="imbalanced-application.html"><a href="imbalanced-application.html"><i class="fa fa-check"></i><b>5</b> Imbalanced Application</a>
<ul>
<li class="chapter" data-level="5.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#data-3"><i class="fa fa-check"></i><b>5.1</b> Data</a></li>
<li class="chapter" data-level="5.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#approaches"><i class="fa fa-check"></i><b>5.2</b> Approaches</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#no-changes"><i class="fa fa-check"></i><b>5.2.1</b> No changes</a></li>
<li class="chapter" data-level="5.2.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#undersample"><i class="fa fa-check"></i><b>5.2.2</b> Undersample</a></li>
<li class="chapter" data-level="5.2.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#oversampling"><i class="fa fa-check"></i><b>5.2.3</b> Oversampling</a></li>
<li class="chapter" data-level="5.2.4" data-path="imbalanced-application.html"><a href="imbalanced-application.html#smoteing"><i class="fa fa-check"></i><b>5.2.4</b> Smoteing</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#statistic-selection-1"><i class="fa fa-check"></i><b>5.3</b> Statistic selection</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="speeds.html"><a href="speeds.html"><i class="fa fa-check"></i><b>6</b> Speeds</a>
<ul>
<li class="chapter" data-level="6.1" data-path="speeds.html"><a href="speeds.html#functions-to-run-the-tests"><i class="fa fa-check"></i><b>6.1</b> Functions to run the tests</a></li>
<li class="chapter" data-level="6.2" data-path="speeds.html"><a href="speeds.html#data-4"><i class="fa fa-check"></i><b>6.2</b> Data</a></li>
<li class="chapter" data-level="6.3" data-path="speeds.html"><a href="speeds.html#rows"><i class="fa fa-check"></i><b>6.3</b> 10,000 rows</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix"><i class="fa fa-check"></i><b>6.3.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.3.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix"><i class="fa fa-check"></i><b>6.3.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="speeds.html"><a href="speeds.html#rows-1"><i class="fa fa-check"></i><b>6.4</b> 500,000 rows</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix-1"><i class="fa fa-check"></i><b>6.4.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix-1"><i class="fa fa-check"></i><b>6.4.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="speeds.html"><a href="speeds.html#presentations"><i class="fa fa-check"></i><b>6.5</b> Presentations</a></li>
<li class="chapter" data-level="6.6" data-path="speeds.html"><a href="speeds.html#analysis"><i class="fa fa-check"></i><b>6.6</b> Analysis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="speeds.html"><a href="speeds.html#graphs"><i class="fa fa-check"></i><b>6.6.1</b> Graphs</a></li>
<li class="chapter" data-level="6.6.2" data-path="speeds.html"><a href="speeds.html#takaways"><i class="fa fa-check"></i><b>6.6.2</b> Takaways</a></li>
<li class="chapter" data-level="6.6.3" data-path="speeds.html"><a href="speeds.html#things-to-change"><i class="fa fa-check"></i><b>6.6.3</b> Things to change</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html"><i class="fa fa-check"></i><b>7</b> Multi Variable Classification</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#data-5"><i class="fa fa-check"></i><b>7.1</b> Data</a></li>
<li class="chapter" data-level="7.2" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#aucs"><i class="fa fa-check"></i><b>7.2</b> AUCs</a></li>
<li class="chapter" data-level="7.3" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#confusion-table"><i class="fa fa-check"></i><b>7.3</b> Confusion Table</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="h20.html"><a href="h20.html"><i class="fa fa-check"></i><b>8</b> h20</a>
<ul>
<li class="chapter" data-level="8.1" data-path="h20.html"><a href="h20.html#set-up"><i class="fa fa-check"></i><b>8.1</b> Set-Up</a></li>
<li class="chapter" data-level="8.2" data-path="h20.html"><a href="h20.html#eda"><i class="fa fa-check"></i><b>8.2</b> EDA</a></li>
<li class="chapter" data-level="8.3" data-path="h20.html"><a href="h20.html#models-h20"><i class="fa fa-check"></i><b>8.3</b> Models h20</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="h20.html"><a href="h20.html#random-forest"><i class="fa fa-check"></i><b>8.3.1</b> Random Forest</a></li>
<li class="chapter" data-level="8.3.2" data-path="h20.html"><a href="h20.html#gradient-boosting-machine"><i class="fa fa-check"></i><b>8.3.2</b> Gradient Boosting Machine</a></li>
<li class="chapter" data-level="8.3.3" data-path="h20.html"><a href="h20.html#automl"><i class="fa fa-check"></i><b>8.3.3</b> AutoML</a></li>
<li class="chapter" data-level="8.3.4" data-path="h20.html"><a href="h20.html#xgboost-1"><i class="fa fa-check"></i><b>8.3.4</b> XGBoost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="econometrics.html"><a href="econometrics.html"><i class="fa fa-check"></i><b>9</b> 08_Econometrics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="econometrics.html"><a href="econometrics.html#a.-california-test-scores"><i class="fa fa-check"></i><b>9.1</b> A. California Test Scores</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="econometrics.html"><a href="econometrics.html#introduction"><i class="fa fa-check"></i><b>9.1.1</b> Introduction</a></li>
<li class="chapter" data-level="9.1.2" data-path="econometrics.html"><a href="econometrics.html#theory"><i class="fa fa-check"></i><b>9.1.2</b> Theory</a></li>
<li class="chapter" data-level="9.1.3" data-path="econometrics.html"><a href="econometrics.html#building-the-models"><i class="fa fa-check"></i><b>9.1.3</b> Building The models</a></li>
<li class="chapter" data-level="9.1.4" data-path="econometrics.html"><a href="econometrics.html#proofs"><i class="fa fa-check"></i><b>9.1.4</b> Proofs</a></li>
<li class="chapter" data-level="9.1.5" data-path="econometrics.html"><a href="econometrics.html#tests"><i class="fa fa-check"></i><b>9.1.5</b> Tests</a></li>
<li class="chapter" data-level="9.1.6" data-path="econometrics.html"><a href="econometrics.html#significances-and-tests"><i class="fa fa-check"></i><b>9.1.6</b> Significances and Tests</a></li>
<li class="chapter" data-level="9.1.7" data-path="econometrics.html"><a href="econometrics.html#conclusion"><i class="fa fa-check"></i><b>9.1.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="econometrics.html"><a href="econometrics.html#auto-correlation"><i class="fa fa-check"></i><b>9.2</b> Auto Correlation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="parrallel-processing.html"><a href="parrallel-processing.html"><i class="fa fa-check"></i><b>10</b> Parrallel Processing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="parrallel-processing.html"><a href="parrallel-processing.html#parallel-with-parlapply"><i class="fa fa-check"></i><b>10.1</b> 1. parallel with parLapply</a></li>
<li class="chapter" data-level="10.2" data-path="parrallel-processing.html"><a href="parrallel-processing.html#foreach-with-doparallel"><i class="fa fa-check"></i><b>10.2</b> 2. foreach with doParallel</a></li>
<li class="chapter" data-level="10.3" data-path="parrallel-processing.html"><a href="parrallel-processing.html#future-with-future.apply"><i class="fa fa-check"></i><b>10.3</b> 3. future with future.apply</a></li>
<li class="chapter" data-level="10.4" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-with-furrr"><i class="fa fa-check"></i><b>10.4</b> 4. purrr with furrr</a></li>
<li class="chapter" data-level="10.5" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-synchronously"><i class="fa fa-check"></i><b>10.5</b> 5. purrr Synchronously</a></li>
<li class="chapter" data-level="10.6" data-path="parrallel-processing.html"><a href="parrallel-processing.html#comparisions-1"><i class="fa fa-check"></i><b>10.6</b> comparisions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="randomforestinsight.html"><a href="randomforestinsight.html"><i class="fa fa-check"></i><b>11</b> 10_RandomForestInsight</a></li>
<li class="chapter" data-level="12" data-path="sequential-data-embedding.html"><a href="sequential-data-embedding.html"><i class="fa fa-check"></i><b>12</b> Sequential Data Embedding</a></li>
<li class="chapter" data-level="13" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html"><i class="fa fa-check"></i><b>13</b> HCC_Survey_Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#our-data-and-purpose"><i class="fa fa-check"></i><b>13.1</b> Our data and Purpose</a></li>
<li class="chapter" data-level="13.2" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>13.2</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="13.3" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#modeling-random-forest"><i class="fa fa-check"></i><b>13.3</b> Modeling Random Forest</a></li>
<li class="chapter" data-level="13.4" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#global-importance"><i class="fa fa-check"></i><b>13.4</b> Global Importance</a></li>
<li class="chapter" data-level="13.5" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#local-importance"><i class="fa fa-check"></i><b>13.5</b> Local Importance</a></li>
<li class="chapter" data-level="13.6" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#partial-dependence-plots"><i class="fa fa-check"></i><b>13.6</b> Partial Dependence Plots</a></li>
<li class="chapter" data-level="13.7" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#random-forest-explainer"><i class="fa fa-check"></i><b>13.7</b> Random Forest Explainer</a></li>
<li class="chapter" data-level="13.8" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#final-notes"><i class="fa fa-check"></i><b>13.8</b> Final Notes</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="what_is_stacked_ensambled.html"><a href="what_is_stacked_ensambled.html"><i class="fa fa-check"></i><b>14</b> 13_What_Is_Stacked_Ensambled</a></li>
<li class="chapter" data-level="15" data-path="intro_econ_stats.html"><a href="intro_econ_stats.html"><i class="fa fa-check"></i><b>15</b> 14_Intro_Econ_Stats</a></li>
<li class="chapter" data-level="16" data-path="nfl.html"><a href="nfl.html"><i class="fa fa-check"></i><b>16</b> NFL</a>
<ul>
<li class="chapter" data-level="16.1" data-path="nfl.html"><a href="nfl.html#wbs"><i class="fa fa-check"></i><b>16.1</b> WBs</a></li>
<li class="chapter" data-level="16.2" data-path="nfl.html"><a href="nfl.html#rbs"><i class="fa fa-check"></i><b>16.2</b> RBs</a></li>
<li class="chapter" data-level="16.3" data-path="nfl.html"><a href="nfl.html#qbs"><i class="fa fa-check"></i><b>16.3</b> QBs</a></li>
<li class="chapter" data-level="16.4" data-path="nfl.html"><a href="nfl.html#plots-and-analysis"><i class="fa fa-check"></i><b>16.4</b> Plots and Analysis</a></li>
<li class="chapter" data-level="16.5" data-path="nfl.html"><a href="nfl.html#lists-to-do"><i class="fa fa-check"></i><b>16.5</b> Lists to do</a></li>
<li class="chapter" data-level="16.6" data-path="nfl.html"><a href="nfl.html#team-mates"><i class="fa fa-check"></i><b>16.6</b> team mates</a></li>
<li class="chapter" data-level="16.7" data-path="nfl.html"><a href="nfl.html#testing"><i class="fa fa-check"></i><b>16.7</b> Testing</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning Applications</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hcc_survey_analysis" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> HCC_Survey_Analysis<a href="hcc_survey_analysis.html#hcc_survey_analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="our-data-and-purpose" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Our data and Purpose<a href="hcc_survey_analysis.html#our-data-and-purpose" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Load our libraries that we will use</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="hcc_survey_analysis.html#cb361-1" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb361-2"><a href="hcc_survey_analysis.html#cb361-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb361-3"><a href="hcc_survey_analysis.html#cb361-3" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span>
<span id="cb361-4"><a href="hcc_survey_analysis.html#cb361-4" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb361-5"><a href="hcc_survey_analysis.html#cb361-5" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb361-6"><a href="hcc_survey_analysis.html#cb361-6" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb361-7"><a href="hcc_survey_analysis.html#cb361-7" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb361-8"><a href="hcc_survey_analysis.html#cb361-8" tabindex="-1"></a><span class="fu">library</span>(randomForestExplainer)</span>
<span id="cb361-9"><a href="hcc_survey_analysis.html#cb361-9" tabindex="-1"></a><span class="fu">library</span>(pdp)</span></code></pre></div>
<pre><code>## Warning: package &#39;pdp&#39; was built under R version 4.3.3</code></pre>
<pre><code>## 
## Attaching package: &#39;pdp&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     partial</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="hcc_survey_analysis.html#cb365-1" tabindex="-1"></a><span class="co"># Read and clean column names</span></span>
<span id="cb365-2"><a href="hcc_survey_analysis.html#cb365-2" tabindex="-1"></a>HCC_Survey <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;HCC_Survey.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 46 Columns: 83
## ── Column specification ──────────
## Delimiter: &quot;,&quot;
## chr  (8): Time, Location, Campus, Involvment, Faith, Formation_Helpful, Eff_...
## dbl (75): cg_SMU, cg_Summit, cg_Other, cg_Dal, cg_Social, cg_Parish, cg_MW, ...
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="hcc_survey_analysis.html#cb367-1" tabindex="-1"></a><span class="fu">names</span>(HCC_Survey) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>, <span class="fu">names</span>(HCC_Survey))</span>
<span id="cb367-2"><a href="hcc_survey_analysis.html#cb367-2" tabindex="-1"></a><span class="fu">names</span>(HCC_Survey) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;&#39;&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">names</span>(HCC_Survey))</span>
<span id="cb367-3"><a href="hcc_survey_analysis.html#cb367-3" tabindex="-1"></a><span class="fu">names</span>(HCC_Survey) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;[()]&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">names</span>(HCC_Survey))</span>
<span id="cb367-4"><a href="hcc_survey_analysis.html#cb367-4" tabindex="-1"></a><span class="fu">names</span>(HCC_Survey) <span class="ot">&lt;-</span> <span class="fu">make.names</span>(<span class="fu">names</span>(HCC_Survey), <span class="at">unique =</span> <span class="cn">TRUE</span>)</span>
<span id="cb367-5"><a href="hcc_survey_analysis.html#cb367-5" tabindex="-1"></a></span>
<span id="cb367-6"><a href="hcc_survey_analysis.html#cb367-6" tabindex="-1"></a><span class="co"># Select initial columns</span></span>
<span id="cb367-7"><a href="hcc_survey_analysis.html#cb367-7" tabindex="-1"></a>cols_to_keep <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Involvment&quot;</span>, <span class="st">&quot;Relations&quot;</span>, </span>
<span id="cb367-8"><a href="hcc_survey_analysis.html#cb367-8" tabindex="-1"></a>                  <span class="fu">grep</span>(<span class="st">&quot;^cg_|^dsc_|^frm_|^srv_&quot;</span>, <span class="fu">names</span>(HCC_Survey), <span class="at">value =</span> <span class="cn">TRUE</span>))</span>
<span id="cb367-9"><a href="hcc_survey_analysis.html#cb367-9" tabindex="-1"></a>HCC_Survey <span class="ot">&lt;-</span> HCC_Survey[, cols_to_keep]</span>
<span id="cb367-10"><a href="hcc_survey_analysis.html#cb367-10" tabindex="-1"></a></span>
<span id="cb367-11"><a href="hcc_survey_analysis.html#cb367-11" tabindex="-1"></a><span class="co"># Create Total_cgs</span></span>
<span id="cb367-12"><a href="hcc_survey_analysis.html#cb367-12" tabindex="-1"></a>cg_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;^cg_&quot;</span>, <span class="fu">names</span>(HCC_Survey), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb367-13"><a href="hcc_survey_analysis.html#cb367-13" tabindex="-1"></a>HCC_Survey<span class="sc">$</span>Total_cgs <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(HCC_Survey[, cg_cols], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb367-14"><a href="hcc_survey_analysis.html#cb367-14" tabindex="-1"></a>HCC_Survey <span class="ot">&lt;-</span> HCC_Survey[, <span class="sc">!</span><span class="fu">names</span>(HCC_Survey) <span class="sc">%in%</span> cg_cols]</span>
<span id="cb367-15"><a href="hcc_survey_analysis.html#cb367-15" tabindex="-1"></a></span>
<span id="cb367-16"><a href="hcc_survey_analysis.html#cb367-16" tabindex="-1"></a><span class="co"># Create CCO</span></span>
<span id="cb367-17"><a href="hcc_survey_analysis.html#cb367-17" tabindex="-1"></a>cco_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;^frm_CCO&quot;</span>, <span class="fu">names</span>(HCC_Survey), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb367-18"><a href="hcc_survey_analysis.html#cb367-18" tabindex="-1"></a>HCC_Survey<span class="sc">$</span>CCO <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">rowSums</span>(HCC_Survey[, cco_cols], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb367-19"><a href="hcc_survey_analysis.html#cb367-19" tabindex="-1"></a>HCC_Survey <span class="ot">&lt;-</span> HCC_Survey[, <span class="sc">!</span><span class="fu">names</span>(HCC_Survey) <span class="sc">%in%</span> cco_cols]</span>
<span id="cb367-20"><a href="hcc_survey_analysis.html#cb367-20" tabindex="-1"></a></span>
<span id="cb367-21"><a href="hcc_survey_analysis.html#cb367-21" tabindex="-1"></a><span class="co"># Create srv_CCO</span></span>
<span id="cb367-22"><a href="hcc_survey_analysis.html#cb367-22" tabindex="-1"></a>srv_cco_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;srv_Leading_a_faith_study&quot;</span>, <span class="st">&quot;srv_CCO_Exec&quot;</span>, <span class="st">&quot;srv_CCO_Events&quot;</span>)</span>
<span id="cb367-23"><a href="hcc_survey_analysis.html#cb367-23" tabindex="-1"></a>HCC_Survey<span class="sc">$</span>srv_CCO <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">rowSums</span>(HCC_Survey[, srv_cco_cols], <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb367-24"><a href="hcc_survey_analysis.html#cb367-24" tabindex="-1"></a>HCC_Survey <span class="ot">&lt;-</span> HCC_Survey[, <span class="sc">!</span><span class="fu">names</span>(HCC_Survey) <span class="sc">%in%</span> srv_cco_cols]</span>
<span id="cb367-25"><a href="hcc_survey_analysis.html#cb367-25" tabindex="-1"></a></span>
<span id="cb367-26"><a href="hcc_survey_analysis.html#cb367-26" tabindex="-1"></a><span class="co"># Remove specified columns and rename</span></span>
<span id="cb367-27"><a href="hcc_survey_analysis.html#cb367-27" tabindex="-1"></a>cols_to_remove <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dsc_Other&quot;</span>, <span class="st">&quot;srv_Other_please_indicate&quot;</span>, <span class="st">&quot;srv_I_didnt_serve_in_ministry&quot;</span>)</span>
<span id="cb367-28"><a href="hcc_survey_analysis.html#cb367-28" tabindex="-1"></a>HCC_Survey <span class="ot">&lt;-</span> HCC_Survey[, <span class="sc">!</span><span class="fu">names</span>(HCC_Survey) <span class="sc">%in%</span> cols_to_remove]</span>
<span id="cb367-29"><a href="hcc_survey_analysis.html#cb367-29" tabindex="-1"></a><span class="fu">names</span>(HCC_Survey)[<span class="fu">names</span>(HCC_Survey) <span class="sc">==</span> <span class="st">&quot;srv_HCC_Volunteering_ex._CLT&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;srv_HCC&quot;</span></span>
<span id="cb367-30"><a href="hcc_survey_analysis.html#cb367-30" tabindex="-1"></a></span>
<span id="cb367-31"><a href="hcc_survey_analysis.html#cb367-31" tabindex="-1"></a><span class="co"># Create Total_dsc and Total_frm</span></span>
<span id="cb367-32"><a href="hcc_survey_analysis.html#cb367-32" tabindex="-1"></a>dsc_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;^dsc_&quot;</span>, <span class="fu">names</span>(HCC_Survey), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb367-33"><a href="hcc_survey_analysis.html#cb367-33" tabindex="-1"></a>frm_cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;^frm_&quot;</span>, <span class="fu">names</span>(HCC_Survey), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb367-34"><a href="hcc_survey_analysis.html#cb367-34" tabindex="-1"></a></span>
<span id="cb367-35"><a href="hcc_survey_analysis.html#cb367-35" tabindex="-1"></a>data <span class="ot">&lt;-</span> HCC_Survey</span>
<span id="cb367-36"><a href="hcc_survey_analysis.html#cb367-36" tabindex="-1"></a>data<span class="sc">$</span>Total_dsc <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(data[, dsc_cols], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb367-37"><a href="hcc_survey_analysis.html#cb367-37" tabindex="-1"></a>data<span class="sc">$</span>Total_frm <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(data[, frm_cols], <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb367-38"><a href="hcc_survey_analysis.html#cb367-38" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[, <span class="sc">!</span><span class="fu">names</span>(data) <span class="sc">%in%</span> <span class="fu">c</span>(dsc_cols, frm_cols)]</span>
<span id="cb367-39"><a href="hcc_survey_analysis.html#cb367-39" tabindex="-1"></a></span>
<span id="cb367-40"><a href="hcc_survey_analysis.html#cb367-40" tabindex="-1"></a><span class="co"># Convert factors and combine Impressions into Casual</span></span>
<span id="cb367-41"><a href="hcc_survey_analysis.html#cb367-41" tabindex="-1"></a>data<span class="sc">$</span>Involvment <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">replace</span>(data<span class="sc">$</span>Involvment, data<span class="sc">$</span>Involvment <span class="sc">==</span> <span class="st">&quot;Impressions&quot;</span>, <span class="st">&quot;Casual&quot;</span>))</span>
<span id="cb367-42"><a href="hcc_survey_analysis.html#cb367-42" tabindex="-1"></a>data<span class="sc">$</span>Relations <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>Relations)</span>
<span id="cb367-43"><a href="hcc_survey_analysis.html#cb367-43" tabindex="-1"></a></span>
<span id="cb367-44"><a href="hcc_survey_analysis.html#cb367-44" tabindex="-1"></a><span class="co"># Sort columns alphabetically</span></span>
<span id="cb367-45"><a href="hcc_survey_analysis.html#cb367-45" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[, <span class="fu">sort</span>(<span class="fu">names</span>(data))]</span>
<span id="cb367-46"><a href="hcc_survey_analysis.html#cb367-46" tabindex="-1"></a></span>
<span id="cb367-47"><a href="hcc_survey_analysis.html#cb367-47" tabindex="-1"></a><span class="co"># Display structure and create data_rf</span></span>
<span id="cb367-48"><a href="hcc_survey_analysis.html#cb367-48" tabindex="-1"></a><span class="fu">glimpse</span>(data)</span></code></pre></div>
<pre><code>## Rows: 46
## Columns: 9
## $ CCO                 &lt;dbl&gt; 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1,…
## $ Involvment          &lt;fct&gt; Casual, Casual, Casual, Casual, Committed, Engaged…
## $ Relations           &lt;fct&gt; 3 to 6, 3 to 6, 3 to 6, 3 to 6, 3 to 6, More than …
## $ srv_CCO             &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0,…
## $ srv_HCC             &lt;dbl&gt; 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1,…
## $ srv_Parish_ministry &lt;dbl&gt; 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1,…
## $ Total_cgs           &lt;dbl&gt; 3, 3, 4, 4, 6, 5, 4, 4, 1, 1, 3, 3, 4, 4, 5, 4, 6,…
## $ Total_dsc           &lt;dbl&gt; 7, 3, 9, 5, 9, 5, 4, 9, 5, 10, 10, 6, 4, 6, 10, 10…
## $ Total_frm           &lt;dbl&gt; 4, 1, 0, 0, 3, 1, 3, 4, 0, 6, 3, 1, 2, 2, 2, 3, 6,…</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="hcc_survey_analysis.html#cb369-1" tabindex="-1"></a>data_rf <span class="ot">&lt;-</span> data</span></code></pre></div>
<p>write the data then re read it</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="hcc_survey_analysis.html#cb370-1" tabindex="-1"></a><span class="fu">write.csv</span>(data, <span class="st">&quot;proccessed_surveyHCC.csv&quot;</span>)</span></code></pre></div>
<p>The following data has been already pre-proccessed</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="hcc_survey_analysis.html#cb371-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;proccessed_surveyHCC.csv&quot;</span>)</span>
<span id="cb371-2"><a href="hcc_survey_analysis.html#cb371-2" tabindex="-1"></a><span class="fu">glimpse</span>(data)</span></code></pre></div>
<pre><code>## Rows: 46
## Columns: 10
## $ X                   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
## $ CCO                 &lt;int&gt; 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1,…
## $ Involvment          &lt;chr&gt; &quot;Casual&quot;, &quot;Casual&quot;, &quot;Casual&quot;, &quot;Casual&quot;, &quot;Committed…
## $ Relations           &lt;chr&gt; &quot;3 to 6&quot;, &quot;3 to 6&quot;, &quot;3 to 6&quot;, &quot;3 to 6&quot;, &quot;3 to 6&quot;, …
## $ srv_CCO             &lt;int&gt; 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0,…
## $ srv_HCC             &lt;int&gt; 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1,…
## $ srv_Parish_ministry &lt;int&gt; 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1,…
## $ Total_cgs           &lt;int&gt; 3, 3, 4, 4, 6, 5, 4, 4, 1, 1, 3, 3, 4, 4, 5, 4, 6,…
## $ Total_dsc           &lt;int&gt; 7, 3, 9, 5, 9, 5, 4, 9, 5, 10, 10, 6, 4, 6, 10, 10…
## $ Total_frm           &lt;int&gt; 4, 1, 0, 0, 3, 1, 3, 4, 0, 6, 3, 1, 2, 2, 2, 3, 6,…</code></pre>
<p>CCO: whether someone has taken a CCO fairht study or not
Involvment: this is categorical and represents the level of involvement of the person
Relations: This counts the number of people a individual identifies as having a close relationship with currently
srv_CCO: This is a binary variable that represents whether someone has served in a CCO ministry or not
srv_HCC: This is a binary variable that represents whether someone has served in a HCC ministry or not
srv_Parish_ministry: This is a binary variable that represents whether someone has served in a Parish ministry or not
Total_cgs: This is the total number of community groups a person is apart of.
Total_dsc: This is the total number of spiritual disciplines a person has in their life currently
Total_frm: This is the total number of formations that a person has attended via HCC.</p>
<p>This is our data we will use</p>
</div>
<div id="exploratory-data-analysis" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Exploratory Data Analysis<a href="hcc_survey_analysis.html#exploratory-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="hcc_survey_analysis.html#cb373-1" tabindex="-1"></a><span class="co"># First read the data and convert categorical variables to factors</span></span>
<span id="cb373-2"><a href="hcc_survey_analysis.html#cb373-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;proccessed_surveyHCC.csv&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb373-3"><a href="hcc_survey_analysis.html#cb373-3" tabindex="-1"></a>data<span class="sc">$</span>Involvment <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>Involvment)</span>
<span id="cb373-4"><a href="hcc_survey_analysis.html#cb373-4" tabindex="-1"></a>data<span class="sc">$</span>Relations <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>Relations)</span>
<span id="cb373-5"><a href="hcc_survey_analysis.html#cb373-5" tabindex="-1"></a></span>
<span id="cb373-6"><a href="hcc_survey_analysis.html#cb373-6" tabindex="-1"></a><span class="co"># Create the model matrix for factors only</span></span>
<span id="cb373-7"><a href="hcc_survey_analysis.html#cb373-7" tabindex="-1"></a>factor_cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data, is.factor)</span>
<span id="cb373-8"><a href="hcc_survey_analysis.html#cb373-8" tabindex="-1"></a>factor_data <span class="ot">&lt;-</span> data[, factor_cols, drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb373-9"><a href="hcc_survey_analysis.html#cb373-9" tabindex="-1"></a>dummy_vars <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>., <span class="at">data =</span> factor_data)[, <span class="sc">-</span><span class="dv">1</span>] <span class="co"># Remove intercept</span></span>
<span id="cb373-10"><a href="hcc_survey_analysis.html#cb373-10" tabindex="-1"></a></span>
<span id="cb373-11"><a href="hcc_survey_analysis.html#cb373-11" tabindex="-1"></a><span class="co"># Combine the dummy variables with the non-factor columns</span></span>
<span id="cb373-12"><a href="hcc_survey_analysis.html#cb373-12" tabindex="-1"></a>numeric_cols <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data, is.numeric)</span>
<span id="cb373-13"><a href="hcc_survey_analysis.html#cb373-13" tabindex="-1"></a>data_encoded <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb373-14"><a href="hcc_survey_analysis.html#cb373-14" tabindex="-1"></a>  <span class="fu">as.data.frame</span>(dummy_vars),</span>
<span id="cb373-15"><a href="hcc_survey_analysis.html#cb373-15" tabindex="-1"></a>  data[, numeric_cols, <span class="at">drop =</span> <span class="cn">FALSE</span>]</span>
<span id="cb373-16"><a href="hcc_survey_analysis.html#cb373-16" tabindex="-1"></a>)</span>
<span id="cb373-17"><a href="hcc_survey_analysis.html#cb373-17" tabindex="-1"></a></span>
<span id="cb373-18"><a href="hcc_survey_analysis.html#cb373-18" tabindex="-1"></a><span class="co"># Make sure Total_dsc is included</span></span>
<span id="cb373-19"><a href="hcc_survey_analysis.html#cb373-19" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="st">&quot;Total_dsc&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(data_encoded)) {</span>
<span id="cb373-20"><a href="hcc_survey_analysis.html#cb373-20" tabindex="-1"></a>  data_encoded<span class="sc">$</span>Total_dsc <span class="ot">&lt;-</span> data<span class="sc">$</span>Total_dsc</span>
<span id="cb373-21"><a href="hcc_survey_analysis.html#cb373-21" tabindex="-1"></a>}</span>
<span id="cb373-22"><a href="hcc_survey_analysis.html#cb373-22" tabindex="-1"></a></span>
<span id="cb373-23"><a href="hcc_survey_analysis.html#cb373-23" tabindex="-1"></a><span class="co"># Calculate correlations</span></span>
<span id="cb373-24"><a href="hcc_survey_analysis.html#cb373-24" tabindex="-1"></a>cols_for_cor <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(data_encoded), <span class="st">&quot;Total_dsc&quot;</span>)</span>
<span id="cb373-25"><a href="hcc_survey_analysis.html#cb373-25" tabindex="-1"></a>correlations_list <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data_encoded[cols_for_cor], <span class="cf">function</span>(x) {</span>
<span id="cb373-26"><a href="hcc_survey_analysis.html#cb373-26" tabindex="-1"></a>  <span class="fu">cor</span>(x, data_encoded<span class="sc">$</span>Total_dsc, <span class="at">use =</span> <span class="st">&quot;complete.obs&quot;</span>)</span>
<span id="cb373-27"><a href="hcc_survey_analysis.html#cb373-27" tabindex="-1"></a>})</span>
<span id="cb373-28"><a href="hcc_survey_analysis.html#cb373-28" tabindex="-1"></a></span>
<span id="cb373-29"><a href="hcc_survey_analysis.html#cb373-29" tabindex="-1"></a><span class="co"># Create correlation data frame</span></span>
<span id="cb373-30"><a href="hcc_survey_analysis.html#cb373-30" tabindex="-1"></a>correlations <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb373-31"><a href="hcc_survey_analysis.html#cb373-31" tabindex="-1"></a>  <span class="at">column =</span> <span class="fu">names</span>(correlations_list),</span>
<span id="cb373-32"><a href="hcc_survey_analysis.html#cb373-32" tabindex="-1"></a>  <span class="at">correlation =</span> <span class="fu">unlist</span>(correlations_list)</span>
<span id="cb373-33"><a href="hcc_survey_analysis.html#cb373-33" tabindex="-1"></a>)</span>
<span id="cb373-34"><a href="hcc_survey_analysis.html#cb373-34" tabindex="-1"></a></span>
<span id="cb373-35"><a href="hcc_survey_analysis.html#cb373-35" tabindex="-1"></a><span class="co"># Sort by absolute correlation</span></span>
<span id="cb373-36"><a href="hcc_survey_analysis.html#cb373-36" tabindex="-1"></a>correlations <span class="ot">&lt;-</span> correlations[<span class="fu">order</span>(<span class="fu">abs</span>(correlations<span class="sc">$</span>correlation), <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb373-37"><a href="hcc_survey_analysis.html#cb373-37" tabindex="-1"></a><span class="fu">rownames</span>(correlations) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb373-38"><a href="hcc_survey_analysis.html#cb373-38" tabindex="-1"></a></span>
<span id="cb373-39"><a href="hcc_survey_analysis.html#cb373-39" tabindex="-1"></a><span class="co"># If you want to keep the ggplot visualization:</span></span>
<span id="cb373-40"><a href="hcc_survey_analysis.html#cb373-40" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb373-41"><a href="hcc_survey_analysis.html#cb373-41" tabindex="-1"></a><span class="fu">ggplot</span>(correlations, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(column, correlation), <span class="at">y =</span> correlation)) <span class="sc">+</span></span>
<span id="cb373-42"><a href="hcc_survey_analysis.html#cb373-42" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb373-43"><a href="hcc_survey_analysis.html#cb373-43" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb373-44"><a href="hcc_survey_analysis.html#cb373-44" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Correlation of All Columns with Total Disciplines&quot;</span>,</span>
<span id="cb373-45"><a href="hcc_survey_analysis.html#cb373-45" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Column&quot;</span>,</span>
<span id="cb373-46"><a href="hcc_survey_analysis.html#cb373-46" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Correlation&quot;</span>) <span class="sc">+</span></span>
<span id="cb373-47"><a href="hcc_survey_analysis.html#cb373-47" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="hcc_survey_analysis.html#cb374-1" tabindex="-1"></a><span class="co"># Print correlations</span></span>
<span id="cb374-2"><a href="hcc_survey_analysis.html#cb374-2" tabindex="-1"></a><span class="fu">print</span>(correlations)</span></code></pre></div>
<pre><code>##                   column correlation
## 1              Total_frm  0.62062501
## 2    srv_Parish_ministry  0.59772804
## 3              Total_cgs  0.47432114
## 4    InvolvmentCommitted  0.44987501
## 5                srv_HCC  0.44519710
## 6                srv_CCO  0.41644453
## 7       Relations7 to 10  0.24458238
## 8                    CCO  0.21960995
## 9        Relations3 to 6 -0.16737169
## 10 RelationsMore than 10  0.08832141
## 11                     X -0.05220109
## 12     InvolvmentEngaged -0.01372312</code></pre>
</div>
<div id="modeling-random-forest" class="section level2 hasAnchor" number="13.3">
<h2><span class="header-section-number">13.3</span> Modeling Random Forest<a href="hcc_survey_analysis.html#modeling-random-forest" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="hcc_survey_analysis.html#cb376-1" tabindex="-1"></a><span class="co"># Train the Random Forest model with 1500 trees</span></span>
<span id="cb376-2"><a href="hcc_survey_analysis.html#cb376-2" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Total_dsc <span class="sc">~</span> ., <span class="at">data =</span> data_rf, <span class="at">ntree =</span> <span class="dv">1500</span>, <span class="at">importance =</span> <span class="cn">TRUE</span>, <span class="at">localImp =</span> <span class="cn">TRUE</span>)</span>
<span id="cb376-3"><a href="hcc_survey_analysis.html#cb376-3" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb376-4"><a href="hcc_survey_analysis.html#cb376-4" tabindex="-1"></a><span class="fu">print</span>(rf_model)</span></code></pre></div>
<pre><code>## 
## Call:
##  randomForest(formula = Total_dsc ~ ., data = data_rf, ntree = 1500,      importance = TRUE, localImp = TRUE) 
##                Type of random forest: regression
##                      Number of trees: 1500
## No. of variables tried at each split: 2
## 
##           Mean of squared residuals: 5.236783
##                     % Var explained: 47.83</code></pre>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="hcc_survey_analysis.html#cb378-1" tabindex="-1"></a><span class="co"># Calculate the RMSE</span></span>
<span id="cb378-2"><a href="hcc_survey_analysis.html#cb378-2" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((rf_model<span class="sc">$</span>predicted <span class="sc">-</span> data_rf<span class="sc">$</span>Total_dsc)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb378-3"><a href="hcc_survey_analysis.html#cb378-3" tabindex="-1"></a>rmse</span></code></pre></div>
<pre><code>## [1] 2.288402</code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="hcc_survey_analysis.html#cb380-1" tabindex="-1"></a><span class="co"># absolute error</span></span>
<span id="cb380-2"><a href="hcc_survey_analysis.html#cb380-2" tabindex="-1"></a>abs_error <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(rf_model<span class="sc">$</span>predicted <span class="sc">-</span> data_rf<span class="sc">$</span>Total_dsc))</span>
<span id="cb380-3"><a href="hcc_survey_analysis.html#cb380-3" tabindex="-1"></a>abs_error</span></code></pre></div>
<pre><code>## [1] 1.842136</code></pre>
</div>
<div id="global-importance" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Global Importance<a href="hcc_survey_analysis.html#global-importance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Get MDI</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="hcc_survey_analysis.html#cb382-1" tabindex="-1"></a><span class="co"># Get the Mean Decrease in Impurity (MDI)</span></span>
<span id="cb382-2"><a href="hcc_survey_analysis.html#cb382-2" tabindex="-1"></a>mdi <span class="ot">&lt;-</span> <span class="fu">importance</span>(rf_model, <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb382-3"><a href="hcc_survey_analysis.html#cb382-3" tabindex="-1"></a>mdi</span></code></pre></div>
<pre><code>##                     IncNodePurity
## CCO                      16.13296
## Involvment               36.69981
## Relations                34.75069
## srv_CCO                  28.76142
## srv_HCC                  24.06673
## srv_Parish_ministry      71.74472
## Total_cgs                52.24009
## Total_frm                93.05213</code></pre>
<p>get MDA</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="hcc_survey_analysis.html#cb384-1" tabindex="-1"></a><span class="co"># Get the Mean Decrease in Accuracy (MDA)</span></span>
<span id="cb384-2"><a href="hcc_survey_analysis.html#cb384-2" tabindex="-1"></a>mda <span class="ot">&lt;-</span> <span class="fu">importance</span>(rf_model, <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb384-3"><a href="hcc_survey_analysis.html#cb384-3" tabindex="-1"></a>mda</span></code></pre></div>
<pre><code>##                        %IncMSE
## CCO                  8.0530544
## Involvment          11.5370935
## Relations            0.9051989
## srv_CCO             10.2868360
## srv_HCC             10.3221455
## srv_Parish_ministry 25.0387096
## Total_cgs           10.8179434
## Total_frm           24.3258848</code></pre>
<p>Plot Mda and mdi</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="hcc_survey_analysis.html#cb386-1" tabindex="-1"></a><span class="co"># Get MDI (Mean Decrease in Node Impurity)</span></span>
<span id="cb386-2"><a href="hcc_survey_analysis.html#cb386-2" tabindex="-1"></a>mdi <span class="ot">&lt;-</span> <span class="fu">importance</span>(rf_model, <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb386-3"><a href="hcc_survey_analysis.html#cb386-3" tabindex="-1"></a></span>
<span id="cb386-4"><a href="hcc_survey_analysis.html#cb386-4" tabindex="-1"></a><span class="co"># Get MDA (Mean Decrease in Accuracy)</span></span>
<span id="cb386-5"><a href="hcc_survey_analysis.html#cb386-5" tabindex="-1"></a>mda <span class="ot">&lt;-</span> <span class="fu">importance</span>(rf_model, <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb386-6"><a href="hcc_survey_analysis.html#cb386-6" tabindex="-1"></a></span>
<span id="cb386-7"><a href="hcc_survey_analysis.html#cb386-7" tabindex="-1"></a><span class="co"># Convert the importance values to a data frame for easier plotting</span></span>
<span id="cb386-8"><a href="hcc_survey_analysis.html#cb386-8" tabindex="-1"></a>importance_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mdi)</span>
<span id="cb386-9"><a href="hcc_survey_analysis.html#cb386-9" tabindex="-1"></a>importance_df<span class="sc">$</span>Feature <span class="ot">&lt;-</span> <span class="fu">rownames</span>(importance_df)</span>
<span id="cb386-10"><a href="hcc_survey_analysis.html#cb386-10" tabindex="-1"></a>importance_df<span class="sc">$</span>MDA <span class="ot">&lt;-</span> mda[, <span class="dv">1</span>]</span>
<span id="cb386-11"><a href="hcc_survey_analysis.html#cb386-11" tabindex="-1"></a></span>
<span id="cb386-12"><a href="hcc_survey_analysis.html#cb386-12" tabindex="-1"></a><span class="co"># Rename the MDI column appropriately</span></span>
<span id="cb386-13"><a href="hcc_survey_analysis.html#cb386-13" tabindex="-1"></a><span class="fu">colnames</span>(importance_df)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;IncNodePurity&quot;</span></span>
<span id="cb386-14"><a href="hcc_survey_analysis.html#cb386-14" tabindex="-1"></a></span>
<span id="cb386-15"><a href="hcc_survey_analysis.html#cb386-15" tabindex="-1"></a><span class="co"># Sort the data frames by MDA and MDI</span></span>
<span id="cb386-16"><a href="hcc_survey_analysis.html#cb386-16" tabindex="-1"></a>mda_df <span class="ot">&lt;-</span> importance_df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(MDA))</span>
<span id="cb386-17"><a href="hcc_survey_analysis.html#cb386-17" tabindex="-1"></a>mdi_df <span class="ot">&lt;-</span> importance_df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(IncNodePurity))</span>
<span id="cb386-18"><a href="hcc_survey_analysis.html#cb386-18" tabindex="-1"></a></span>
<span id="cb386-19"><a href="hcc_survey_analysis.html#cb386-19" tabindex="-1"></a><span class="co"># Plotting MDA</span></span>
<span id="cb386-20"><a href="hcc_survey_analysis.html#cb386-20" tabindex="-1"></a><span class="fu">ggplot</span>(mda_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Feature, MDA), <span class="at">y =</span> MDA)) <span class="sc">+</span></span>
<span id="cb386-21"><a href="hcc_survey_analysis.html#cb386-21" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb386-22"><a href="hcc_survey_analysis.html#cb386-22" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb386-23"><a href="hcc_survey_analysis.html#cb386-23" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Feature Importance: Mean Decrease in Accuracy (MDA)&quot;</span>,</span>
<span id="cb386-24"><a href="hcc_survey_analysis.html#cb386-24" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Feature&quot;</span>,</span>
<span id="cb386-25"><a href="hcc_survey_analysis.html#cb386-25" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean Decrease in Accuracy&quot;</span>) <span class="sc">+</span></span>
<span id="cb386-26"><a href="hcc_survey_analysis.html#cb386-26" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-172-1.png" width="672" /></p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="hcc_survey_analysis.html#cb387-1" tabindex="-1"></a><span class="co"># Plotting MDI</span></span>
<span id="cb387-2"><a href="hcc_survey_analysis.html#cb387-2" tabindex="-1"></a><span class="fu">ggplot</span>(mdi_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Feature, IncNodePurity), <span class="at">y =</span> IncNodePurity)) <span class="sc">+</span></span>
<span id="cb387-3"><a href="hcc_survey_analysis.html#cb387-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;salmon&quot;</span>) <span class="sc">+</span></span>
<span id="cb387-4"><a href="hcc_survey_analysis.html#cb387-4" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb387-5"><a href="hcc_survey_analysis.html#cb387-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Feature Importance: Mean Decrease in Node Impurity (MDI)&quot;</span>,</span>
<span id="cb387-6"><a href="hcc_survey_analysis.html#cb387-6" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Feature&quot;</span>,</span>
<span id="cb387-7"><a href="hcc_survey_analysis.html#cb387-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean Decrease in Node Impurity&quot;</span>) <span class="sc">+</span></span>
<span id="cb387-8"><a href="hcc_survey_analysis.html#cb387-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-172-2.png" width="672" /></p>
<p>MDA doesn’t rely on the internal structure of the model but rather on the model’s performance with altered data.</p>
<p>MDI computes importance scores based on how much each feature contributes to homogeneity in nodes across all trees. For classification, this is often measured by the Gini impurity, and for regression, it can be measured by the variance reduction.</p>
</div>
<div id="local-importance" class="section level2 hasAnchor" number="13.5">
<h2><span class="header-section-number">13.5</span> Local Importance<a href="hcc_survey_analysis.html#local-importance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="hcc_survey_analysis.html#cb388-1" tabindex="-1"></a><span class="co"># Extract the local importance</span></span>
<span id="cb388-2"><a href="hcc_survey_analysis.html#cb388-2" tabindex="-1"></a>local_importance <span class="ot">&lt;-</span> rf_model<span class="sc">$</span>localImp</span>
<span id="cb388-3"><a href="hcc_survey_analysis.html#cb388-3" tabindex="-1"></a></span>
<span id="cb388-4"><a href="hcc_survey_analysis.html#cb388-4" tabindex="-1"></a><span class="co"># View the dimensions of local_importance to understand its structure</span></span>
<span id="cb388-5"><a href="hcc_survey_analysis.html#cb388-5" tabindex="-1"></a><span class="fu">dim</span>(local_importance)</span></code></pre></div>
<pre><code>## [1]  8 46</code></pre>
<p>8 features and 46 observations</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="hcc_survey_analysis.html#cb390-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb390-2"><a href="hcc_survey_analysis.html#cb390-2" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;reshape2&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     smiths</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="hcc_survey_analysis.html#cb393-1" tabindex="-1"></a><span class="co"># Assuming local_importance is a matrix or data frame with observations as columns and features as rows</span></span>
<span id="cb393-2"><a href="hcc_survey_analysis.html#cb393-2" tabindex="-1"></a>local_importance_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(local_importance)</span>
<span id="cb393-3"><a href="hcc_survey_analysis.html#cb393-3" tabindex="-1"></a>local_importance_df<span class="sc">$</span>Feature <span class="ot">&lt;-</span> <span class="fu">rownames</span>(local_importance_df)</span>
<span id="cb393-4"><a href="hcc_survey_analysis.html#cb393-4" tabindex="-1"></a>local_importance_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(local_importance_df, <span class="at">id.vars =</span> <span class="st">&quot;Feature&quot;</span>)</span>
<span id="cb393-5"><a href="hcc_survey_analysis.html#cb393-5" tabindex="-1"></a></span>
<span id="cb393-6"><a href="hcc_survey_analysis.html#cb393-6" tabindex="-1"></a><span class="fu">ggplot</span>(local_importance_melted, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> Feature, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb393-7"><a href="hcc_survey_analysis.html#cb393-7" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb393-8"><a href="hcc_survey_analysis.html#cb393-8" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb393-9"><a href="hcc_survey_analysis.html#cb393-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Heatmap of Local Importance&quot;</span>,</span>
<span id="cb393-10"><a href="hcc_survey_analysis.html#cb393-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Observation&quot;</span>,</span>
<span id="cb393-11"><a href="hcc_survey_analysis.html#cb393-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Feature&quot;</span>) <span class="sc">+</span></span>
<span id="cb393-12"><a href="hcc_survey_analysis.html#cb393-12" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-174-1.png" width="672" /></p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="hcc_survey_analysis.html#cb394-1" tabindex="-1"></a><span class="fu">ggplot</span>(local_importance_melted, <span class="fu">aes</span>(<span class="at">x =</span> Feature, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb394-2"><a href="hcc_survey_analysis.html#cb394-2" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">&quot;lightgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb394-3"><a href="hcc_survey_analysis.html#cb394-3" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb394-4"><a href="hcc_survey_analysis.html#cb394-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Violin Plot of Local Importance by Feature&quot;</span>,</span>
<span id="cb394-5"><a href="hcc_survey_analysis.html#cb394-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Feature&quot;</span>,</span>
<span id="cb394-6"><a href="hcc_survey_analysis.html#cb394-6" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Local Importance&quot;</span>) <span class="sc">+</span></span>
<span id="cb394-7"><a href="hcc_survey_analysis.html#cb394-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-175-1.png" width="672" /></p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="hcc_survey_analysis.html#cb395-1" tabindex="-1"></a>avg_importance <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(local_importance)</span>
<span id="cb395-2"><a href="hcc_survey_analysis.html#cb395-2" tabindex="-1"></a></span>
<span id="cb395-3"><a href="hcc_survey_analysis.html#cb395-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">Feature =</span> <span class="fu">names</span>(avg_importance), </span>
<span id="cb395-4"><a href="hcc_survey_analysis.html#cb395-4" tabindex="-1"></a>                  <span class="at">AvgImportance =</span> avg_importance),</span>
<span id="cb395-5"><a href="hcc_survey_analysis.html#cb395-5" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Feature, AvgImportance), <span class="at">y =</span> AvgImportance)) <span class="sc">+</span></span>
<span id="cb395-6"><a href="hcc_survey_analysis.html#cb395-6" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span></span>
<span id="cb395-7"><a href="hcc_survey_analysis.html#cb395-7" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb395-8"><a href="hcc_survey_analysis.html#cb395-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Average Local Importance by Feature&quot;</span>,</span>
<span id="cb395-9"><a href="hcc_survey_analysis.html#cb395-9" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Feature&quot;</span>,</span>
<span id="cb395-10"><a href="hcc_survey_analysis.html#cb395-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average Local Importance&quot;</span>) <span class="sc">+</span></span>
<span id="cb395-11"><a href="hcc_survey_analysis.html#cb395-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-176-1.png" width="672" /></p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="hcc_survey_analysis.html#cb396-1" tabindex="-1"></a>tfi <span class="ot">&lt;-</span> local_importance[<span class="st">&quot;Total_frm&quot;</span>, ]</span>
<span id="cb396-2"><a href="hcc_survey_analysis.html#cb396-2" tabindex="-1"></a>tfv <span class="ot">&lt;-</span> data_rf<span class="sc">$</span>Total_frm</span>
<span id="cb396-3"><a href="hcc_survey_analysis.html#cb396-3" tabindex="-1"></a><span class="co"># Create a data frame for plotting</span></span>
<span id="cb396-4"><a href="hcc_survey_analysis.html#cb396-4" tabindex="-1"></a>importance_frm_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Total_frm =</span> tfv, <span class="at">Total_frmImportance =</span> tfi)</span>
<span id="cb396-5"><a href="hcc_survey_analysis.html#cb396-5" tabindex="-1"></a></span>
<span id="cb396-6"><a href="hcc_survey_analysis.html#cb396-6" tabindex="-1"></a><span class="fu">ggplot</span>(importance_frm_df, <span class="fu">aes</span>(<span class="at">x =</span> Total_frm, <span class="at">y =</span> Total_frmImportance)) <span class="sc">+</span></span>
<span id="cb396-7"><a href="hcc_survey_analysis.html#cb396-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb396-8"><a href="hcc_survey_analysis.html#cb396-8" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb396-9"><a href="hcc_survey_analysis.html#cb396-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb396-10"><a href="hcc_survey_analysis.html#cb396-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Local Importance of &#39;Total_frm&#39;&quot;</span>, </span>
<span id="cb396-11"><a href="hcc_survey_analysis.html#cb396-11" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Total_frm&quot;</span>, </span>
<span id="cb396-12"><a href="hcc_survey_analysis.html#cb396-12" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Local Importance of Total_frm&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using method =
## &#39;loess&#39; and formula = &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-177-1.png" width="672" /></p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="hcc_survey_analysis.html#cb398-1" tabindex="-1"></a><span class="co"># Extract local importance for &#39;srv_Parish_ministry&#39;</span></span>
<span id="cb398-2"><a href="hcc_survey_analysis.html#cb398-2" tabindex="-1"></a>spi <span class="ot">&lt;-</span> local_importance[<span class="st">&quot;srv_Parish_ministry&quot;</span>, ]</span>
<span id="cb398-3"><a href="hcc_survey_analysis.html#cb398-3" tabindex="-1"></a>spv <span class="ot">&lt;-</span> data_rf<span class="sc">$</span>srv_Parish_ministry</span>
<span id="cb398-4"><a href="hcc_survey_analysis.html#cb398-4" tabindex="-1"></a></span>
<span id="cb398-5"><a href="hcc_survey_analysis.html#cb398-5" tabindex="-1"></a><span class="co"># Create a data frame for plotting</span></span>
<span id="cb398-6"><a href="hcc_survey_analysis.html#cb398-6" tabindex="-1"></a>imp_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">SPM =</span> spv, <span class="at">Imp =</span> spi)</span>
<span id="cb398-7"><a href="hcc_survey_analysis.html#cb398-7" tabindex="-1"></a></span>
<span id="cb398-8"><a href="hcc_survey_analysis.html#cb398-8" tabindex="-1"></a><span class="co"># Plot the violin plot</span></span>
<span id="cb398-9"><a href="hcc_survey_analysis.html#cb398-9" tabindex="-1"></a><span class="fu">ggplot</span>(imp_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(SPM), <span class="at">y =</span> Imp)) <span class="sc">+</span></span>
<span id="cb398-10"><a href="hcc_survey_analysis.html#cb398-10" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">fill =</span> <span class="st">&quot;lightgreen&quot;</span>) <span class="sc">+</span></span>
<span id="cb398-11"><a href="hcc_survey_analysis.html#cb398-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb398-12"><a href="hcc_survey_analysis.html#cb398-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Local Importance by &#39;srv_Parish_ministry&#39; Status&quot;</span>,</span>
<span id="cb398-13"><a href="hcc_survey_analysis.html#cb398-13" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;srv_Parish_ministry (0 or 1)&quot;</span>, </span>
<span id="cb398-14"><a href="hcc_survey_analysis.html#cb398-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Local Importance&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="hcc_survey_analysis.html#cb399-1" tabindex="-1"></a><span class="co"># Plot the jitter plot with boxplot overlay</span></span>
<span id="cb399-2"><a href="hcc_survey_analysis.html#cb399-2" tabindex="-1"></a><span class="fu">ggplot</span>(imp_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(SPM), <span class="at">y =</span> Imp)) <span class="sc">+</span></span>
<span id="cb399-3"><a href="hcc_survey_analysis.html#cb399-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb399-4"><a href="hcc_survey_analysis.html#cb399-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb399-5"><a href="hcc_survey_analysis.html#cb399-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb399-6"><a href="hcc_survey_analysis.html#cb399-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Local Importance by &#39;srv_Parish_ministry&#39; Status&quot;</span>,</span>
<span id="cb399-7"><a href="hcc_survey_analysis.html#cb399-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;srv_Parish_ministry (0 or 1)&quot;</span>, </span>
<span id="cb399-8"><a href="hcc_survey_analysis.html#cb399-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Local Importance&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-178-2.png" width="672" /></p>
</div>
<div id="partial-dependence-plots" class="section level2 hasAnchor" number="13.6">
<h2><span class="header-section-number">13.6</span> Partial Dependence Plots<a href="hcc_survey_analysis.html#partial-dependence-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Partial Dependence Plots (PDPs): PDPs help you understand the relationship between a feature (or features) and the target variable in a machine learning model, such as a Random Forest. Specifically, they show how the predicted outcome varies with changes in a particular feature, while averaging out the effects of all other features in the model.</p>
<p>Single-Feature PDP: For a single feature, the PDP shows the marginal effect of that feature on the predicted outcome.</p>
<p>How It Works: The model’s predictions are averaged over different values of the feature of interest, holding all other features constant. This allows you to see whether the relationship between the feature and the target is linear, monotonic, or more complex.</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="hcc_survey_analysis.html#cb400-1" tabindex="-1"></a>pdp_total_frm <span class="ot">&lt;-</span> <span class="fu">partial</span>(rf_model, <span class="at">pred.var =</span> <span class="st">&quot;Total_frm&quot;</span>)</span>
<span id="cb400-2"><a href="hcc_survey_analysis.html#cb400-2" tabindex="-1"></a><span class="fu">plot</span>(pdp_total_frm, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Partial Dependence of Total_frm&quot;</span>,</span>
<span id="cb400-3"><a href="hcc_survey_analysis.html#cb400-3" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Total_frm&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Predicted Total_dsc&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="hcc_survey_analysis.html#cb401-1" tabindex="-1"></a><span class="co"># Generate PDP data for the binary variable &#39;srv_Parish_ministry&#39;</span></span>
<span id="cb401-2"><a href="hcc_survey_analysis.html#cb401-2" tabindex="-1"></a>pdp_srv_parish <span class="ot">&lt;-</span> <span class="fu">partial</span>(rf_model, <span class="at">pred.var =</span> <span class="st">&quot;srv_Parish_ministry&quot;</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb401-3"><a href="hcc_survey_analysis.html#cb401-3" tabindex="-1"></a></span>
<span id="cb401-4"><a href="hcc_survey_analysis.html#cb401-4" tabindex="-1"></a><span class="co"># Convert the result to a data frame</span></span>
<span id="cb401-5"><a href="hcc_survey_analysis.html#cb401-5" tabindex="-1"></a>pdp_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pdp_srv_parish)</span>
<span id="cb401-6"><a href="hcc_survey_analysis.html#cb401-6" tabindex="-1"></a></span>
<span id="cb401-7"><a href="hcc_survey_analysis.html#cb401-7" tabindex="-1"></a><span class="co"># Calculate the difference between the two bars</span></span>
<span id="cb401-8"><a href="hcc_survey_analysis.html#cb401-8" tabindex="-1"></a>difference <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">diff</span>(pdp_df<span class="sc">$</span>yhat), <span class="dv">2</span>)</span>
<span id="cb401-9"><a href="hcc_survey_analysis.html#cb401-9" tabindex="-1"></a></span>
<span id="cb401-10"><a href="hcc_survey_analysis.html#cb401-10" tabindex="-1"></a><span class="fu">ggplot</span>(pdp_df, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(srv_Parish_ministry), <span class="at">y =</span> yhat)) <span class="sc">+</span></span>
<span id="cb401-11"><a href="hcc_survey_analysis.html#cb401-11" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(srv_Parish_ministry)), <span class="at">width =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb401-12"><a href="hcc_survey_analysis.html#cb401-12" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;green&quot;</span>)) <span class="sc">+</span>  <span class="co"># Custom colors for the bars</span></span>
<span id="cb401-13"><a href="hcc_survey_analysis.html#cb401-13" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(yhat, <span class="dv">2</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span>  <span class="co"># Display the exact values on top of the bars</span></span>
<span id="cb401-14"><a href="hcc_survey_analysis.html#cb401-14" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">max</span>(pdp_df<span class="sc">$</span>yhat) <span class="sc">*</span> <span class="fl">1.2</span>) <span class="sc">+</span>  <span class="co"># Expand y-axis limits slightly</span></span>
<span id="cb401-15"><a href="hcc_survey_analysis.html#cb401-15" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fu">max</span>(pdp_df<span class="sc">$</span>yhat) <span class="sc">*</span> <span class="fl">1.1</span>, </span>
<span id="cb401-16"><a href="hcc_survey_analysis.html#cb401-16" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;Difference of Serving</span><span class="sc">\n</span><span class="st">in Parish Ministry: &quot;</span>, difference), </span>
<span id="cb401-17"><a href="hcc_survey_analysis.html#cb401-17" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span>  <span class="co"># Smaller size and stacked text</span></span>
<span id="cb401-18"><a href="hcc_survey_analysis.html#cb401-18" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb401-19"><a href="hcc_survey_analysis.html#cb401-19" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),  <span class="co"># Grey background</span></span>
<span id="cb401-20"><a href="hcc_survey_analysis.html#cb401-20" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb401-21"><a href="hcc_survey_analysis.html#cb401-21" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span>  <span class="co"># Remove the legend</span></span>
<span id="cb401-22"><a href="hcc_survey_analysis.html#cb401-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Partial Dependence of srv_Parish_ministry&quot;</span>,</span>
<span id="cb401-23"><a href="hcc_survey_analysis.html#cb401-23" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;srv_Parish_ministry (0 or 1)&quot;</span>,</span>
<span id="cb401-24"><a href="hcc_survey_analysis.html#cb401-24" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Predicted Total_dsc&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
</div>
<div id="random-forest-explainer" class="section level2 hasAnchor" number="13.7">
<h2><span class="header-section-number">13.7</span> Random Forest Explainer<a href="hcc_survey_analysis.html#random-forest-explainer" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="hcc_survey_analysis.html#cb402-1" tabindex="-1"></a><span class="co"># Extract the minimum depth distribution of variables</span></span>
<span id="cb402-2"><a href="hcc_survey_analysis.html#cb402-2" tabindex="-1"></a>min_depth_frame <span class="ot">&lt;-</span> <span class="fu">min_depth_distribution</span>(rf_model)</span>
<span id="cb402-3"><a href="hcc_survey_analysis.html#cb402-3" tabindex="-1"></a></span>
<span id="cb402-4"><a href="hcc_survey_analysis.html#cb402-4" tabindex="-1"></a><span class="co"># Measure variable importance</span></span>
<span id="cb402-5"><a href="hcc_survey_analysis.html#cb402-5" tabindex="-1"></a>impf <span class="ot">&lt;-</span> <span class="fu">measure_importance</span>(rf_model)</span>
<span id="cb402-6"><a href="hcc_survey_analysis.html#cb402-6" tabindex="-1"></a>impf</span></code></pre></div>
<pre><code>##              variable mean_min_depth no_of_nodes mse_increase
## 1                 CCO       3.002598        1296   0.29362330
## 2          Involvment       2.159763        2232   0.62082038
## 3           Relations       2.186941        2801   0.04516093
## 4             srv_CCO       2.525087        1609   0.51454140
## 5             srv_HCC       2.934163        1124   0.47609797
## 6 srv_Parish_ministry       1.835050        1954   1.82452498
## 7           Total_cgs       1.863270        3110   0.66980898
## 8           Total_frm       1.562947        3262   2.21378233
##   node_purity_increase no_of_trees times_a_root       p_value
## 1             16.13296        1024           35  1.000000e+00
## 2             36.69981        1287          202  9.211960e-02
## 3             34.75069        1340           92  6.113672e-44
## 4             28.76142        1194          167  1.000000e+00
## 5             24.06673         928          151  1.000000e+00
## 6             71.74472        1348          294  9.999998e-01
## 7             52.24009        1359          219  2.375626e-92
## 8             93.05213        1398          340 3.452951e-122</code></pre>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="hcc_survey_analysis.html#cb404-1" tabindex="-1"></a><span class="fu">plot_multi_way_importance</span>(impf, </span>
<span id="cb404-2"><a href="hcc_survey_analysis.html#cb404-2" tabindex="-1"></a>                          <span class="at">x_measure =</span> <span class="st">&quot;mean_min_depth&quot;</span>,</span>
<span id="cb404-3"><a href="hcc_survey_analysis.html#cb404-3" tabindex="-1"></a>                          <span class="at">y_measure =</span> <span class="st">&quot;node_purity_increase&quot;</span>, <span class="co">#its regressional so not gini</span></span>
<span id="cb404-4"><a href="hcc_survey_analysis.html#cb404-4" tabindex="-1"></a>                          <span class="at">size_measure =</span> <span class="st">&quot;p_value&quot;</span>, </span>
<span id="cb404-5"><a href="hcc_survey_analysis.html#cb404-5" tabindex="-1"></a>                          <span class="at">no_of_labels =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## Warning: Using alpha for a discrete
## variable is not advised.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-182-1.png" width="672" /></p>
<p>node_purity_increase: The total increase in node purity (reduction in variance or MSE) attributed to the variable.</p>
<p>mean_min_depth: The average minimum depth at which the variable is used to split a node.</p>
<p>look more at this</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="hcc_survey_analysis.html#cb406-1" tabindex="-1"></a><span class="fu">plot_min_depth_distribution</span>(min_depth_frame, </span>
<span id="cb406-2"><a href="hcc_survey_analysis.html#cb406-2" tabindex="-1"></a>                            <span class="at">mean_sample =</span> <span class="st">&quot;all_trees&quot;</span>, </span>
<span id="cb406-3"><a href="hcc_survey_analysis.html#cb406-3" tabindex="-1"></a>                            <span class="at">k =</span> <span class="dv">20</span>,</span>
<span id="cb406-4"><a href="hcc_survey_analysis.html#cb406-4" tabindex="-1"></a>                            <span class="at">main =</span> <span class="st">&quot;Distribution of Minimal Depth and Its Mean&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
</div>
<div id="final-notes" class="section level2 hasAnchor" number="13.8">
<h2><span class="header-section-number">13.8</span> Final Notes<a href="hcc_survey_analysis.html#final-notes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We dont loop the RF because it is on whole data and the amount of trees in the RF Model</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sequential-data-embedding.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="what_is_stacked_ensambled.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/12_HCC_Survey_Analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
