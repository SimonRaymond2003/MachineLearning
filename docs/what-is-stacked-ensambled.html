<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 What Is Stacked Ensambled | Machine Learning Applications</title>
  <meta name="description" content="Introduction" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 What Is Stacked Ensambled | Machine Learning Applications" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Introduction" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 What Is Stacked Ensambled | Machine Learning Applications" />
  
  <meta name="twitter:description" content="Introduction" />
  

<meta name="author" content="Simon P. Raymond" />


<meta name="date" content="2024-12-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="hcc_survey_analysis.html"/>
<link rel="next" href="intro-econ-stats.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MachineLearning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About Myself</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#notes-for-public"><i class="fa fa-check"></i><b>1.2</b> Notes for public</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#work-in-progress"><i class="fa fa-check"></i><b>1.3</b> Work in progress</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>2</b> Algorithms</a>
<ul>
<li class="chapter" data-level="2.1" data-path="algorithms.html"><a href="algorithms.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="algorithms.html"><a href="algorithms.html#parametric"><i class="fa fa-check"></i><b>2.2</b> Parametric</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="algorithms.html"><a href="algorithms.html#lm"><i class="fa fa-check"></i><b>2.2.1</b> LM</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="algorithms.html"><a href="algorithms.html#trees"><i class="fa fa-check"></i><b>2.3</b> Trees</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="algorithms.html"><a href="algorithms.html#cart"><i class="fa fa-check"></i><b>2.3.1</b> CART</a></li>
<li class="chapter" data-level="2.3.2" data-path="algorithms.html"><a href="algorithms.html#bagging"><i class="fa fa-check"></i><b>2.3.2</b> Bagging</a></li>
<li class="chapter" data-level="2.3.3" data-path="algorithms.html"><a href="algorithms.html#rf"><i class="fa fa-check"></i><b>2.3.3</b> RF</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="algorithms.html"><a href="algorithms.html#boosting"><i class="fa fa-check"></i><b>2.4</b> Boosting</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="algorithms.html"><a href="algorithms.html#adaboost"><i class="fa fa-check"></i><b>2.4.1</b> Adaboost</a></li>
<li class="chapter" data-level="2.4.2" data-path="algorithms.html"><a href="algorithms.html#gbm-boost"><i class="fa fa-check"></i><b>2.4.2</b> GBM boost</a></li>
<li class="chapter" data-level="2.4.3" data-path="algorithms.html"><a href="algorithms.html#xgboost"><i class="fa fa-check"></i><b>2.4.3</b> XGBoost</a></li>
<li class="chapter" data-level="2.4.4" data-path="algorithms.html"><a href="algorithms.html#light-gbm-boost"><i class="fa fa-check"></i><b>2.4.4</b> Light GBM boost</a></li>
<li class="chapter" data-level="2.4.5" data-path="algorithms.html"><a href="algorithms.html#catboost"><i class="fa fa-check"></i><b>2.4.5</b> Catboost</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="algorithms.html"><a href="algorithms.html#other-non-parametric"><i class="fa fa-check"></i><b>2.5</b> Other Non-parametric</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="algorithms.html"><a href="algorithms.html#knn"><i class="fa fa-check"></i><b>2.5.1</b> KNN</a></li>
<li class="chapter" data-level="2.5.2" data-path="algorithms.html"><a href="algorithms.html#nueralnet"><i class="fa fa-check"></i><b>2.5.2</b> Nueralnet</a></li>
<li class="chapter" data-level="2.5.3" data-path="algorithms.html"><a href="algorithms.html#svm"><i class="fa fa-check"></i><b>2.5.3</b> SVM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="binary-application.html"><a href="binary-application.html"><i class="fa fa-check"></i><b>3</b> Binary Application</a>
<ul>
<li class="chapter" data-level="3.1" data-path="binary-application.html"><a href="binary-application.html#data-1"><i class="fa fa-check"></i><b>3.1</b> Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="binary-application.html"><a href="binary-application.html#data-prep"><i class="fa fa-check"></i><b>3.1.1</b> Data Prep</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="binary-application.html"><a href="binary-application.html#model-selection"><i class="fa fa-check"></i><b>3.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="binary-application.html"><a href="binary-application.html#functions"><i class="fa fa-check"></i><b>3.2.1</b> Functions</a></li>
<li class="chapter" data-level="3.2.2" data-path="binary-application.html"><a href="binary-application.html#xgb"><i class="fa fa-check"></i><b>3.2.2</b> XGB</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="binary-application.html"><a href="binary-application.html#comparisions"><i class="fa fa-check"></i><b>3.3</b> Comparisions</a></li>
<li class="chapter" data-level="3.4" data-path="binary-application.html"><a href="binary-application.html#statistic-selection"><i class="fa fa-check"></i><b>3.4</b> Statistic selection</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="binary-application.html"><a href="binary-application.html#section"><i class="fa fa-check"></i><b>3.4.1</b> 0.5</a></li>
<li class="chapter" data-level="3.4.2" data-path="binary-application.html"><a href="binary-application.html#youdens-j-statistic"><i class="fa fa-check"></i><b>3.4.2</b> Youden’s J Statistic</a></li>
<li class="chapter" data-level="3.4.3" data-path="binary-application.html"><a href="binary-application.html#fscore"><i class="fa fa-check"></i><b>3.4.3</b> Fscore</a></li>
<li class="chapter" data-level="3.4.4" data-path="binary-application.html"><a href="binary-application.html#roc-curve"><i class="fa fa-check"></i><b>3.4.4</b> ROC curve</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regressional-application.html"><a href="regressional-application.html"><i class="fa fa-check"></i><b>4</b> Regressional Application</a>
<ul>
<li class="chapter" data-level="4.1" data-path="regressional-application.html"><a href="regressional-application.html#data-2"><i class="fa fa-check"></i><b>4.1</b> Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="regressional-application.html"><a href="regressional-application.html#data-prep-1"><i class="fa fa-check"></i><b>4.1.1</b> Data Prep</a></li>
<li class="chapter" data-level="4.1.2" data-path="regressional-application.html"><a href="regressional-application.html#data-explorations"><i class="fa fa-check"></i><b>4.1.2</b> Data Explorations</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="regressional-application.html"><a href="regressional-application.html#model-selection-1"><i class="fa fa-check"></i><b>4.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="regressional-application.html"><a href="regressional-application.html#rf-1"><i class="fa fa-check"></i><b>4.2.1</b> RF</a></li>
<li class="chapter" data-level="4.2.2" data-path="regressional-application.html"><a href="regressional-application.html#lm-1"><i class="fa fa-check"></i><b>4.2.2</b> LM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="imbalanced-application.html"><a href="imbalanced-application.html"><i class="fa fa-check"></i><b>5</b> Imbalanced Application</a>
<ul>
<li class="chapter" data-level="5.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#data-3"><i class="fa fa-check"></i><b>5.1</b> Data</a></li>
<li class="chapter" data-level="5.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#approaches"><i class="fa fa-check"></i><b>5.2</b> Approaches</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#no-changes"><i class="fa fa-check"></i><b>5.2.1</b> No changes</a></li>
<li class="chapter" data-level="5.2.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#undersample"><i class="fa fa-check"></i><b>5.2.2</b> Undersample</a></li>
<li class="chapter" data-level="5.2.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#oversampling"><i class="fa fa-check"></i><b>5.2.3</b> Oversampling</a></li>
<li class="chapter" data-level="5.2.4" data-path="imbalanced-application.html"><a href="imbalanced-application.html#smoteing"><i class="fa fa-check"></i><b>5.2.4</b> Smoteing</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#statistic-selection-1"><i class="fa fa-check"></i><b>5.3</b> Statistic selection</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="speeds.html"><a href="speeds.html"><i class="fa fa-check"></i><b>6</b> Speeds</a>
<ul>
<li class="chapter" data-level="6.1" data-path="speeds.html"><a href="speeds.html#functions-to-run-the-tests"><i class="fa fa-check"></i><b>6.1</b> Functions to run the tests</a></li>
<li class="chapter" data-level="6.2" data-path="speeds.html"><a href="speeds.html#data-4"><i class="fa fa-check"></i><b>6.2</b> Data</a></li>
<li class="chapter" data-level="6.3" data-path="speeds.html"><a href="speeds.html#rows"><i class="fa fa-check"></i><b>6.3</b> 10,000 rows</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix"><i class="fa fa-check"></i><b>6.3.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.3.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix"><i class="fa fa-check"></i><b>6.3.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="speeds.html"><a href="speeds.html#rows-1"><i class="fa fa-check"></i><b>6.4</b> 500,000 rows</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix-1"><i class="fa fa-check"></i><b>6.4.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix-1"><i class="fa fa-check"></i><b>6.4.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="speeds.html"><a href="speeds.html#presentations"><i class="fa fa-check"></i><b>6.5</b> Presentations</a></li>
<li class="chapter" data-level="6.6" data-path="speeds.html"><a href="speeds.html#analysis"><i class="fa fa-check"></i><b>6.6</b> Analysis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="speeds.html"><a href="speeds.html#graphs"><i class="fa fa-check"></i><b>6.6.1</b> Graphs</a></li>
<li class="chapter" data-level="6.6.2" data-path="speeds.html"><a href="speeds.html#takaways"><i class="fa fa-check"></i><b>6.6.2</b> Takaways</a></li>
<li class="chapter" data-level="6.6.3" data-path="speeds.html"><a href="speeds.html#things-to-change"><i class="fa fa-check"></i><b>6.6.3</b> Things to change</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html"><i class="fa fa-check"></i><b>7</b> Multi Variable Classification</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#data-5"><i class="fa fa-check"></i><b>7.1</b> Data</a></li>
<li class="chapter" data-level="7.2" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#aucs"><i class="fa fa-check"></i><b>7.2</b> AUCs</a></li>
<li class="chapter" data-level="7.3" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#confusion-table"><i class="fa fa-check"></i><b>7.3</b> Confusion Table</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="h20.html"><a href="h20.html"><i class="fa fa-check"></i><b>8</b> h20</a>
<ul>
<li class="chapter" data-level="8.1" data-path="h20.html"><a href="h20.html#set-up"><i class="fa fa-check"></i><b>8.1</b> Set-Up</a></li>
<li class="chapter" data-level="8.2" data-path="h20.html"><a href="h20.html#eda"><i class="fa fa-check"></i><b>8.2</b> EDA</a></li>
<li class="chapter" data-level="8.3" data-path="h20.html"><a href="h20.html#models-h20"><i class="fa fa-check"></i><b>8.3</b> Models h20</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="h20.html"><a href="h20.html#random-forest"><i class="fa fa-check"></i><b>8.3.1</b> Random Forest</a></li>
<li class="chapter" data-level="8.3.2" data-path="h20.html"><a href="h20.html#gradient-boosting-machine"><i class="fa fa-check"></i><b>8.3.2</b> Gradient Boosting Machine</a></li>
<li class="chapter" data-level="8.3.3" data-path="h20.html"><a href="h20.html#automl"><i class="fa fa-check"></i><b>8.3.3</b> AutoML</a></li>
<li class="chapter" data-level="8.3.4" data-path="h20.html"><a href="h20.html#xgboost-1"><i class="fa fa-check"></i><b>8.3.4</b> XGBoost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="econometrics.html"><a href="econometrics.html"><i class="fa fa-check"></i><b>9</b> Econometrics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="econometrics.html"><a href="econometrics.html#a.-california-test-scores"><i class="fa fa-check"></i><b>9.1</b> A. California Test Scores</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="econometrics.html"><a href="econometrics.html#introduction"><i class="fa fa-check"></i><b>9.1.1</b> Introduction</a></li>
<li class="chapter" data-level="9.1.2" data-path="econometrics.html"><a href="econometrics.html#theory"><i class="fa fa-check"></i><b>9.1.2</b> Theory</a></li>
<li class="chapter" data-level="9.1.3" data-path="econometrics.html"><a href="econometrics.html#building-the-models"><i class="fa fa-check"></i><b>9.1.3</b> Building The models</a></li>
<li class="chapter" data-level="9.1.4" data-path="econometrics.html"><a href="econometrics.html#proofs"><i class="fa fa-check"></i><b>9.1.4</b> Proofs</a></li>
<li class="chapter" data-level="9.1.5" data-path="econometrics.html"><a href="econometrics.html#tests"><i class="fa fa-check"></i><b>9.1.5</b> Tests</a></li>
<li class="chapter" data-level="9.1.6" data-path="econometrics.html"><a href="econometrics.html#significances-and-tests"><i class="fa fa-check"></i><b>9.1.6</b> Significances and Tests</a></li>
<li class="chapter" data-level="9.1.7" data-path="econometrics.html"><a href="econometrics.html#conclusion"><i class="fa fa-check"></i><b>9.1.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="econometrics.html"><a href="econometrics.html#auto-correlation"><i class="fa fa-check"></i><b>9.2</b> Auto Correlation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="parrallel-processing.html"><a href="parrallel-processing.html"><i class="fa fa-check"></i><b>10</b> Parrallel Processing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="parrallel-processing.html"><a href="parrallel-processing.html#parallel-with-parlapply"><i class="fa fa-check"></i><b>10.1</b> 1. parallel with parLapply</a></li>
<li class="chapter" data-level="10.2" data-path="parrallel-processing.html"><a href="parrallel-processing.html#foreach-with-doparallel"><i class="fa fa-check"></i><b>10.2</b> 2. foreach with doParallel</a></li>
<li class="chapter" data-level="10.3" data-path="parrallel-processing.html"><a href="parrallel-processing.html#future-with-future.apply"><i class="fa fa-check"></i><b>10.3</b> 3. future with future.apply</a></li>
<li class="chapter" data-level="10.4" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-with-furrr"><i class="fa fa-check"></i><b>10.4</b> 4. purrr with furrr</a></li>
<li class="chapter" data-level="10.5" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-synchronously"><i class="fa fa-check"></i><b>10.5</b> 5. purrr Synchronously</a></li>
<li class="chapter" data-level="10.6" data-path="parrallel-processing.html"><a href="parrallel-processing.html#comparisions-1"><i class="fa fa-check"></i><b>10.6</b> comparisions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="randomforestinsight.html"><a href="randomforestinsight.html"><i class="fa fa-check"></i><b>11</b> RandomForestInsight</a></li>
<li class="chapter" data-level="12" data-path="sequential-data-embedding.html"><a href="sequential-data-embedding.html"><i class="fa fa-check"></i><b>12</b> Sequential Data Embedding</a></li>
<li class="chapter" data-level="13" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html"><i class="fa fa-check"></i><b>13</b> HCC_Survey_Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#our-data-and-purpose"><i class="fa fa-check"></i><b>13.1</b> Our data and Purpose</a></li>
<li class="chapter" data-level="13.2" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>13.2</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="13.3" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#modeling-random-forest"><i class="fa fa-check"></i><b>13.3</b> Modeling Random Forest</a></li>
<li class="chapter" data-level="13.4" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#global-importance"><i class="fa fa-check"></i><b>13.4</b> Global Importance</a></li>
<li class="chapter" data-level="13.5" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#local-importance"><i class="fa fa-check"></i><b>13.5</b> Local Importance</a></li>
<li class="chapter" data-level="13.6" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#partial-dependence-plots"><i class="fa fa-check"></i><b>13.6</b> Partial Dependence Plots</a></li>
<li class="chapter" data-level="13.7" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#random-forest-explainer"><i class="fa fa-check"></i><b>13.7</b> Random Forest Explainer</a></li>
<li class="chapter" data-level="13.8" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#final-notes"><i class="fa fa-check"></i><b>13.8</b> Final Notes</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="what-is-stacked-ensambled.html"><a href="what-is-stacked-ensambled.html"><i class="fa fa-check"></i><b>14</b> What Is Stacked Ensambled</a></li>
<li class="chapter" data-level="15" data-path="intro-econ-stats.html"><a href="intro-econ-stats.html"><i class="fa fa-check"></i><b>15</b> Intro Econ Stats</a></li>
<li class="chapter" data-level="16" data-path="nfl.html"><a href="nfl.html"><i class="fa fa-check"></i><b>16</b> NFL</a>
<ul>
<li class="chapter" data-level="16.1" data-path="nfl.html"><a href="nfl.html#wbs"><i class="fa fa-check"></i><b>16.1</b> WBs</a></li>
<li class="chapter" data-level="16.2" data-path="nfl.html"><a href="nfl.html#rbs"><i class="fa fa-check"></i><b>16.2</b> RBs</a></li>
<li class="chapter" data-level="16.3" data-path="nfl.html"><a href="nfl.html#qbs"><i class="fa fa-check"></i><b>16.3</b> QBs</a></li>
<li class="chapter" data-level="16.4" data-path="nfl.html"><a href="nfl.html#plots-and-analysis"><i class="fa fa-check"></i><b>16.4</b> Plots and Analysis</a></li>
<li class="chapter" data-level="16.5" data-path="nfl.html"><a href="nfl.html#lists-to-do"><i class="fa fa-check"></i><b>16.5</b> Lists to do</a></li>
<li class="chapter" data-level="16.6" data-path="nfl.html"><a href="nfl.html#team-mates"><i class="fa fa-check"></i><b>16.6</b> team mates</a></li>
<li class="chapter" data-level="16.7" data-path="nfl.html"><a href="nfl.html#testing"><i class="fa fa-check"></i><b>16.7</b> Testing</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning Applications</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="what-is-stacked-ensambled" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> What Is Stacked Ensambled<a href="what-is-stacked-ensambled.html#what-is-stacked-ensambled" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>WE USE RMSE NOT RMSPE…</p>
<p>Stacked ensemble learning, or stacking, involves training multiple different types of models (e.g., decision trees, logistic regression, neural networks) and then combining their predictions using a “meta-model” or “meta-learner.” The meta-model learns to make the final prediction by considering the outputs of the individual models as input features. This approach often leads to better performance than any single model or bagging method like random forest.</p>
<p>Homogeneity vs. Heterogeneity:</p>
<p>Bagging typically uses homogeneous models (e.g., multiple CART trees), while stacked ensembles use heterogeneous models (e.g., GBM, random forest, neural networks).</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="what-is-stacked-ensambled.html#cb411-1" tabindex="-1"></a><span class="co"># Load the required libraries</span></span>
<span id="cb411-2"><a href="what-is-stacked-ensambled.html#cb411-2" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb411-3"><a href="what-is-stacked-ensambled.html#cb411-3" tabindex="-1"></a><span class="fu">library</span>(gbm)</span>
<span id="cb411-4"><a href="what-is-stacked-ensambled.html#cb411-4" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb411-5"><a href="what-is-stacked-ensambled.html#cb411-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb411-6"><a href="what-is-stacked-ensambled.html#cb411-6" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb411-7"><a href="what-is-stacked-ensambled.html#cb411-7" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code></pre></div>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="what-is-stacked-ensambled.html#cb412-1" tabindex="-1"></a><span class="co"># Get the number of cores minus 1</span></span>
<span id="cb412-2"><a href="what-is-stacked-ensambled.html#cb412-2" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb412-3"><a href="what-is-stacked-ensambled.html#cb412-3" tabindex="-1"></a><span class="co"># Load the Boston dataset</span></span>
<span id="cb412-4"><a href="what-is-stacked-ensambled.html#cb412-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> Boston</span></code></pre></div>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="what-is-stacked-ensambled.html#cb413-1" tabindex="-1"></a><span class="co"># Convert the &#39;chas&#39; column to a factor</span></span>
<span id="cb413-2"><a href="what-is-stacked-ensambled.html#cb413-2" tabindex="-1"></a>data<span class="sc">$</span>chas <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>chas)</span>
<span id="cb413-3"><a href="what-is-stacked-ensambled.html#cb413-3" tabindex="-1"></a></span>
<span id="cb413-4"><a href="what-is-stacked-ensambled.html#cb413-4" tabindex="-1"></a><span class="co"># Scale all numeric columns in the data</span></span>
<span id="cb413-5"><a href="what-is-stacked-ensambled.html#cb413-5" tabindex="-1"></a>numeric_columns <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data, is.numeric)</span>
<span id="cb413-6"><a href="what-is-stacked-ensambled.html#cb413-6" tabindex="-1"></a>data[numeric_columns] <span class="ot">&lt;-</span> <span class="fu">scale</span>(data[numeric_columns])</span>
<span id="cb413-7"><a href="what-is-stacked-ensambled.html#cb413-7" tabindex="-1"></a></span>
<span id="cb413-8"><a href="what-is-stacked-ensambled.html#cb413-8" tabindex="-1"></a><span class="co"># Verify that the column names are correct</span></span>
<span id="cb413-9"><a href="what-is-stacked-ensambled.html#cb413-9" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;scale</span><span class="sc">\\</span><span class="st">((.+)</span><span class="sc">\\</span><span class="st">)&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>, <span class="fu">colnames</span>(data))</span>
<span id="cb413-10"><a href="what-is-stacked-ensambled.html#cb413-10" tabindex="-1"></a></span>
<span id="cb413-11"><a href="what-is-stacked-ensambled.html#cb413-11" tabindex="-1"></a><span class="co"># Now, the &#39;medv&#39; column should still be named &#39;medv&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="what-is-stacked-ensambled.html#cb414-1" tabindex="-1"></a><span class="co"># Train linear regression model</span></span>
<span id="cb414-2"><a href="what-is-stacked-ensambled.html#cb414-2" tabindex="-1"></a>lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> data)</span>
<span id="cb414-3"><a href="what-is-stacked-ensambled.html#cb414-3" tabindex="-1"></a></span>
<span id="cb414-4"><a href="what-is-stacked-ensambled.html#cb414-4" tabindex="-1"></a><span class="co"># Train random forest model</span></span>
<span id="cb414-5"><a href="what-is-stacked-ensambled.html#cb414-5" tabindex="-1"></a>rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> data)</span>
<span id="cb414-6"><a href="what-is-stacked-ensambled.html#cb414-6" tabindex="-1"></a></span>
<span id="cb414-7"><a href="what-is-stacked-ensambled.html#cb414-7" tabindex="-1"></a><span class="co"># Train gradient boosting model</span></span>
<span id="cb414-8"><a href="what-is-stacked-ensambled.html#cb414-8" tabindex="-1"></a>gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">n.trees =</span> <span class="dv">100</span>, <span class="at">interaction.depth =</span> <span class="dv">1</span>)</span>
<span id="cb414-9"><a href="what-is-stacked-ensambled.html#cb414-9" tabindex="-1"></a></span>
<span id="cb414-10"><a href="what-is-stacked-ensambled.html#cb414-10" tabindex="-1"></a><span class="co"># Generate predictions</span></span>
<span id="cb414-11"><a href="what-is-stacked-ensambled.html#cb414-11" tabindex="-1"></a>lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_mod, data)</span>
<span id="cb414-12"><a href="what-is-stacked-ensambled.html#cb414-12" tabindex="-1"></a>rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_mod, data)</span>
<span id="cb414-13"><a href="what-is-stacked-ensambled.html#cb414-13" tabindex="-1"></a>gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(gbm_mod, data, <span class="at">n.trees =</span> <span class="dv">100</span>)</span>
<span id="cb414-14"><a href="what-is-stacked-ensambled.html#cb414-14" tabindex="-1"></a></span>
<span id="cb414-15"><a href="what-is-stacked-ensambled.html#cb414-15" tabindex="-1"></a><span class="co"># Combine predictions into a data frame</span></span>
<span id="cb414-16"><a href="what-is-stacked-ensambled.html#cb414-16" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, gbm_pred)</span>
<span id="cb414-17"><a href="what-is-stacked-ensambled.html#cb414-17" tabindex="-1"></a></span>
<span id="cb414-18"><a href="what-is-stacked-ensambled.html#cb414-18" tabindex="-1"></a><span class="co"># Train linear regression as meta-model</span></span>
<span id="cb414-19"><a href="what-is-stacked-ensambled.html#cb414-19" tabindex="-1"></a>meta_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds, <span class="at">medv =</span> data<span class="sc">$</span>medv))</span>
<span id="cb414-20"><a href="what-is-stacked-ensambled.html#cb414-20" tabindex="-1"></a></span>
<span id="cb414-21"><a href="what-is-stacked-ensambled.html#cb414-21" tabindex="-1"></a><span class="co"># Predict using meta-model</span></span>
<span id="cb414-22"><a href="what-is-stacked-ensambled.html#cb414-22" tabindex="-1"></a>meta_lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_lm, preds)</span>
<span id="cb414-23"><a href="what-is-stacked-ensambled.html#cb414-23" tabindex="-1"></a></span>
<span id="cb414-24"><a href="what-is-stacked-ensambled.html#cb414-24" tabindex="-1"></a><span class="co"># Calculate RMSPE (now as RMSE since the percentage part is removed)</span></span>
<span id="cb414-25"><a href="what-is-stacked-ensambled.html#cb414-25" tabindex="-1"></a>rmspe_lm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_lm_pred <span class="sc">-</span> data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb414-26"><a href="what-is-stacked-ensambled.html#cb414-26" tabindex="-1"></a></span>
<span id="cb414-27"><a href="what-is-stacked-ensambled.html#cb414-27" tabindex="-1"></a><span class="co"># Train random forest as meta-model</span></span>
<span id="cb414-28"><a href="what-is-stacked-ensambled.html#cb414-28" tabindex="-1"></a>meta_rf <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds, <span class="at">medv =</span> data<span class="sc">$</span>medv))</span>
<span id="cb414-29"><a href="what-is-stacked-ensambled.html#cb414-29" tabindex="-1"></a></span>
<span id="cb414-30"><a href="what-is-stacked-ensambled.html#cb414-30" tabindex="-1"></a><span class="co"># Predict using meta-model</span></span>
<span id="cb414-31"><a href="what-is-stacked-ensambled.html#cb414-31" tabindex="-1"></a>meta_rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_rf, preds)</span>
<span id="cb414-32"><a href="what-is-stacked-ensambled.html#cb414-32" tabindex="-1"></a></span>
<span id="cb414-33"><a href="what-is-stacked-ensambled.html#cb414-33" tabindex="-1"></a><span class="co"># Calculate RMSPE (now as RMSE since the percentage part is removed)</span></span>
<span id="cb414-34"><a href="what-is-stacked-ensambled.html#cb414-34" tabindex="-1"></a>rmspe_rf <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_rf_pred <span class="sc">-</span> data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb414-35"><a href="what-is-stacked-ensambled.html#cb414-35" tabindex="-1"></a></span>
<span id="cb414-36"><a href="what-is-stacked-ensambled.html#cb414-36" tabindex="-1"></a><span class="co"># Train gradient boosting as meta-model</span></span>
<span id="cb414-37"><a href="what-is-stacked-ensambled.html#cb414-37" tabindex="-1"></a>meta_gbm <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds, <span class="at">medv =</span> data<span class="sc">$</span>medv), <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">n.trees =</span> <span class="dv">100</span>, <span class="at">interaction.depth =</span> <span class="dv">1</span>)</span>
<span id="cb414-38"><a href="what-is-stacked-ensambled.html#cb414-38" tabindex="-1"></a></span>
<span id="cb414-39"><a href="what-is-stacked-ensambled.html#cb414-39" tabindex="-1"></a><span class="co"># Predict using meta-model</span></span>
<span id="cb414-40"><a href="what-is-stacked-ensambled.html#cb414-40" tabindex="-1"></a>meta_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_gbm, preds, <span class="at">n.trees =</span> <span class="dv">100</span>)</span>
<span id="cb414-41"><a href="what-is-stacked-ensambled.html#cb414-41" tabindex="-1"></a></span>
<span id="cb414-42"><a href="what-is-stacked-ensambled.html#cb414-42" tabindex="-1"></a><span class="co"># Calculate RMSPE (now as RMSE since the percentage part is removed)</span></span>
<span id="cb414-43"><a href="what-is-stacked-ensambled.html#cb414-43" tabindex="-1"></a>rmspe_gbm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_gbm_pred <span class="sc">-</span> data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb414-44"><a href="what-is-stacked-ensambled.html#cb414-44" tabindex="-1"></a></span>
<span id="cb414-45"><a href="what-is-stacked-ensambled.html#cb414-45" tabindex="-1"></a><span class="co"># Calculate RMSPE for base models (now as RMSE since the percentage part is removed)</span></span>
<span id="cb414-46"><a href="what-is-stacked-ensambled.html#cb414-46" tabindex="-1"></a>rmspe_base_lm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((lm_pred <span class="sc">-</span> data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb414-47"><a href="what-is-stacked-ensambled.html#cb414-47" tabindex="-1"></a>rmspe_base_rf <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((rf_pred <span class="sc">-</span> data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb414-48"><a href="what-is-stacked-ensambled.html#cb414-48" tabindex="-1"></a>rmspe_base_gbm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((gbm_pred <span class="sc">-</span> data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb414-49"><a href="what-is-stacked-ensambled.html#cb414-49" tabindex="-1"></a></span>
<span id="cb414-50"><a href="what-is-stacked-ensambled.html#cb414-50" tabindex="-1"></a><span class="co"># Find the best base model&#39;s RMSPE</span></span>
<span id="cb414-51"><a href="what-is-stacked-ensambled.html#cb414-51" tabindex="-1"></a>best_base_rmspe <span class="ot">&lt;-</span> <span class="fu">min</span>(rmspe_base_lm, rmspe_base_rf, rmspe_base_gbm)</span>
<span id="cb414-52"><a href="what-is-stacked-ensambled.html#cb414-52" tabindex="-1"></a>worst_base_rmspe <span class="ot">&lt;-</span> <span class="fu">max</span>(rmspe_base_lm, rmspe_base_rf, rmspe_base_gbm)</span>
<span id="cb414-53"><a href="what-is-stacked-ensambled.html#cb414-53" tabindex="-1"></a><span class="co"># Print the RMSPEs</span></span>
<span id="cb414-54"><a href="what-is-stacked-ensambled.html#cb414-54" tabindex="-1"></a><span class="fu">print</span>(rmspe_lm)</span></code></pre></div>
<pre><code>## [1] 0.1033253</code></pre>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="what-is-stacked-ensambled.html#cb416-1" tabindex="-1"></a><span class="fu">print</span>(rmspe_rf)</span></code></pre></div>
<pre><code>## [1] 0.08868791</code></pre>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="what-is-stacked-ensambled.html#cb418-1" tabindex="-1"></a><span class="fu">print</span>(rmspe_gbm)</span></code></pre></div>
<pre><code>## [1] 0.1286706</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="what-is-stacked-ensambled.html#cb420-1" tabindex="-1"></a><span class="fu">print</span>(best_base_rmspe)</span></code></pre></div>
<pre><code>## [1] 0.1547934</code></pre>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="what-is-stacked-ensambled.html#cb422-1" tabindex="-1"></a><span class="fu">print</span>(worst_base_rmspe)</span></code></pre></div>
<pre><code>## [1] 0.5087679</code></pre>
<p>Now we see that the stacked ensemble models have lower RMSPE compared to the individual base models.</p>
<p>However the GBM model wasnt tuned at all. what is the effect of tuning the GBM model?</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="what-is-stacked-ensambled.html#cb424-1" tabindex="-1"></a><span class="co"># Hyperparameter tuning grid</span></span>
<span id="cb424-2"><a href="what-is-stacked-ensambled.html#cb424-2" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb424-3"><a href="what-is-stacked-ensambled.html#cb424-3" tabindex="-1"></a>  <span class="at">n.trees =</span> <span class="fu">seq</span>(<span class="dv">50</span>, <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">50</span>),</span>
<span id="cb424-4"><a href="what-is-stacked-ensambled.html#cb424-4" tabindex="-1"></a>  <span class="at">shrinkage =</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="at">by =</span> <span class="fl">0.04</span>),</span>
<span id="cb424-5"><a href="what-is-stacked-ensambled.html#cb424-5" tabindex="-1"></a>  <span class="at">interaction.depth =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb424-6"><a href="what-is-stacked-ensambled.html#cb424-6" tabindex="-1"></a>)</span>
<span id="cb424-7"><a href="what-is-stacked-ensambled.html#cb424-7" tabindex="-1"></a></span>
<span id="cb424-8"><a href="what-is-stacked-ensambled.html#cb424-8" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n.trees =</span> <span class="fu">integer</span>(), <span class="at">shrinkage =</span> <span class="fu">numeric</span>(), <span class="at">interaction.depth =</span> <span class="fu">integer</span>(), <span class="at">cv.error =</span> <span class="fu">numeric</span>())</span>
<span id="cb424-9"><a href="what-is-stacked-ensambled.html#cb424-9" tabindex="-1"></a></span>
<span id="cb424-10"><a href="what-is-stacked-ensambled.html#cb424-10" tabindex="-1"></a><span class="co"># Loop over the grid</span></span>
<span id="cb424-11"><a href="what-is-stacked-ensambled.html#cb424-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid)) {</span>
<span id="cb424-12"><a href="what-is-stacked-ensambled.html#cb424-12" tabindex="-1"></a>  </span>
<span id="cb424-13"><a href="what-is-stacked-ensambled.html#cb424-13" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;/&quot;</span>, <span class="fu">nrow</span>(grid), <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb424-14"><a href="what-is-stacked-ensambled.html#cb424-14" tabindex="-1"></a>  </span>
<span id="cb424-15"><a href="what-is-stacked-ensambled.html#cb424-15" tabindex="-1"></a>  gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., </span>
<span id="cb424-16"><a href="what-is-stacked-ensambled.html#cb424-16" tabindex="-1"></a>                 <span class="at">data =</span> data, </span>
<span id="cb424-17"><a href="what-is-stacked-ensambled.html#cb424-17" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb424-18"><a href="what-is-stacked-ensambled.html#cb424-18" tabindex="-1"></a>                 <span class="at">n.trees =</span> grid<span class="sc">$</span>n.trees[i], </span>
<span id="cb424-19"><a href="what-is-stacked-ensambled.html#cb424-19" tabindex="-1"></a>                 <span class="at">shrinkage =</span> grid<span class="sc">$</span>shrinkage[i], </span>
<span id="cb424-20"><a href="what-is-stacked-ensambled.html#cb424-20" tabindex="-1"></a>                 <span class="at">interaction.depth =</span> grid<span class="sc">$</span>interaction.depth[i], </span>
<span id="cb424-21"><a href="what-is-stacked-ensambled.html#cb424-21" tabindex="-1"></a>                 <span class="at">cv.folds =</span> <span class="dv">3</span>, </span>
<span id="cb424-22"><a href="what-is-stacked-ensambled.html#cb424-22" tabindex="-1"></a>                 <span class="at">n.cores =</span> nc, </span>
<span id="cb424-23"><a href="what-is-stacked-ensambled.html#cb424-23" tabindex="-1"></a>                 <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb424-24"><a href="what-is-stacked-ensambled.html#cb424-24" tabindex="-1"></a>  </span>
<span id="cb424-25"><a href="what-is-stacked-ensambled.html#cb424-25" tabindex="-1"></a>  <span class="co"># Get the cross-validation error</span></span>
<span id="cb424-26"><a href="what-is-stacked-ensambled.html#cb424-26" tabindex="-1"></a>  cv_error <span class="ot">&lt;-</span> <span class="fu">min</span>(gbm_mod<span class="sc">$</span>cv.error)</span>
<span id="cb424-27"><a href="what-is-stacked-ensambled.html#cb424-27" tabindex="-1"></a>  </span>
<span id="cb424-28"><a href="what-is-stacked-ensambled.html#cb424-28" tabindex="-1"></a>  <span class="co"># Store the results</span></span>
<span id="cb424-29"><a href="what-is-stacked-ensambled.html#cb424-29" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(<span class="at">n.trees =</span> grid<span class="sc">$</span>n.trees[i], <span class="at">shrinkage =</span> grid<span class="sc">$</span>shrinkage[i], <span class="at">interaction.depth =</span> grid<span class="sc">$</span>interaction.depth[i], <span class="at">cv.error =</span> cv_error))</span>
<span id="cb424-30"><a href="what-is-stacked-ensambled.html#cb424-30" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Progress: 1 / 24 iterations completedProgress: 2 / 24 iterations completedProgress: 3 / 24 iterations completedProgress: 4 / 24 iterations completedProgress: 5 / 24 iterations completedProgress: 6 / 24 iterations completedProgress: 7 / 24 iterations completedProgress: 8 / 24 iterations completedProgress: 9 / 24 iterations completedProgress: 10 / 24 iterations completedProgress: 11 / 24 iterations completedProgress: 12 / 24 iterations completedProgress: 13 / 24 iterations completedProgress: 14 / 24 iterations completedProgress: 15 / 24 iterations completedProgress: 16 / 24 iterations completedProgress: 17 / 24 iterations completedProgress: 18 / 24 iterations completedProgress: 19 / 24 iterations completedProgress: 20 / 24 iterations completedProgress: 21 / 24 iterations completedProgress: 22 / 24 iterations completedProgress: 23 / 24 iterations completedProgress: 24 / 24 iterations completed</code></pre>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="what-is-stacked-ensambled.html#cb426-1" tabindex="-1"></a><span class="co"># Find the best hyperparameters - base R version</span></span>
<span id="cb426-2"><a href="what-is-stacked-ensambled.html#cb426-2" tabindex="-1"></a>best_params <span class="ot">&lt;-</span> results[<span class="fu">order</span>(results<span class="sc">$</span>cv.error), ][<span class="dv">1</span>, ]</span>
<span id="cb426-3"><a href="what-is-stacked-ensambled.html#cb426-3" tabindex="-1"></a><span class="fu">print</span>(best_params)</span></code></pre></div>
<pre><code>##    n.trees shrinkage interaction.depth  cv.error
## 24     200      0.13                 3 0.1317512</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="what-is-stacked-ensambled.html#cb428-1" tabindex="-1"></a>rmspe_t2 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb428-2"><a href="what-is-stacked-ensambled.html#cb428-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb428-3"><a href="what-is-stacked-ensambled.html#cb428-3" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb428-4"><a href="what-is-stacked-ensambled.html#cb428-4" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb428-5"><a href="what-is-stacked-ensambled.html#cb428-5" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb428-6"><a href="what-is-stacked-ensambled.html#cb428-6" tabindex="-1"></a></span>
<span id="cb428-7"><a href="what-is-stacked-ensambled.html#cb428-7" tabindex="-1"></a><span class="co"># Train the GBM model with the best hyperparameters</span></span>
<span id="cb428-8"><a href="what-is-stacked-ensambled.html#cb428-8" tabindex="-1"></a>best_gbm <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., </span>
<span id="cb428-9"><a href="what-is-stacked-ensambled.html#cb428-9" tabindex="-1"></a>                <span class="at">data =</span> train_data, </span>
<span id="cb428-10"><a href="what-is-stacked-ensambled.html#cb428-10" tabindex="-1"></a>                <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb428-11"><a href="what-is-stacked-ensambled.html#cb428-11" tabindex="-1"></a>                <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb428-12"><a href="what-is-stacked-ensambled.html#cb428-12" tabindex="-1"></a></span>
<span id="cb428-13"><a href="what-is-stacked-ensambled.html#cb428-13" tabindex="-1"></a><span class="co"># Predict on the test set</span></span>
<span id="cb428-14"><a href="what-is-stacked-ensambled.html#cb428-14" tabindex="-1"></a>test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_gbm, test_data, <span class="at">n.trees =</span> <span class="dv">100</span>)</span>
<span id="cb428-15"><a href="what-is-stacked-ensambled.html#cb428-15" tabindex="-1"></a></span>
<span id="cb428-16"><a href="what-is-stacked-ensambled.html#cb428-16" tabindex="-1"></a><span class="co"># Calculate RMSPE on the test set (now as RMSE since the percentage part is removed)</span></span>
<span id="cb428-17"><a href="what-is-stacked-ensambled.html#cb428-17" tabindex="-1"></a>rmspe_t2[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb428-18"><a href="what-is-stacked-ensambled.html#cb428-18" tabindex="-1"></a></span>
<span id="cb428-19"><a href="what-is-stacked-ensambled.html#cb428-19" tabindex="-1"></a>}</span>
<span id="cb428-20"><a href="what-is-stacked-ensambled.html#cb428-20" tabindex="-1"></a></span>
<span id="cb428-21"><a href="what-is-stacked-ensambled.html#cb428-21" tabindex="-1"></a><span class="fu">mean</span>(rmspe_t2)</span></code></pre></div>
<pre><code>## [1] 0.4371209</code></pre>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="what-is-stacked-ensambled.html#cb430-1" tabindex="-1"></a>rmspe_test <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb430-2"><a href="what-is-stacked-ensambled.html#cb430-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb430-3"><a href="what-is-stacked-ensambled.html#cb430-3" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb430-4"><a href="what-is-stacked-ensambled.html#cb430-4" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb430-5"><a href="what-is-stacked-ensambled.html#cb430-5" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb430-6"><a href="what-is-stacked-ensambled.html#cb430-6" tabindex="-1"></a></span>
<span id="cb430-7"><a href="what-is-stacked-ensambled.html#cb430-7" tabindex="-1"></a><span class="co"># Train the GBM model with the best hyperparameters</span></span>
<span id="cb430-8"><a href="what-is-stacked-ensambled.html#cb430-8" tabindex="-1"></a>best_gbm <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., </span>
<span id="cb430-9"><a href="what-is-stacked-ensambled.html#cb430-9" tabindex="-1"></a>                <span class="at">data =</span> train_data, </span>
<span id="cb430-10"><a href="what-is-stacked-ensambled.html#cb430-10" tabindex="-1"></a>                <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb430-11"><a href="what-is-stacked-ensambled.html#cb430-11" tabindex="-1"></a>                <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees, </span>
<span id="cb430-12"><a href="what-is-stacked-ensambled.html#cb430-12" tabindex="-1"></a>                <span class="at">shrinkage =</span> best_params<span class="sc">$</span>shrinkage, </span>
<span id="cb430-13"><a href="what-is-stacked-ensambled.html#cb430-13" tabindex="-1"></a>                <span class="at">interaction.depth =</span> best_params<span class="sc">$</span>interaction.depth)</span>
<span id="cb430-14"><a href="what-is-stacked-ensambled.html#cb430-14" tabindex="-1"></a></span>
<span id="cb430-15"><a href="what-is-stacked-ensambled.html#cb430-15" tabindex="-1"></a><span class="co"># Predict on the test set</span></span>
<span id="cb430-16"><a href="what-is-stacked-ensambled.html#cb430-16" tabindex="-1"></a>test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_gbm, test_data, <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees)</span>
<span id="cb430-17"><a href="what-is-stacked-ensambled.html#cb430-17" tabindex="-1"></a></span>
<span id="cb430-18"><a href="what-is-stacked-ensambled.html#cb430-18" tabindex="-1"></a><span class="co"># Calculate RMSPE on the test set (now as RMSE since the percentage part is removed)</span></span>
<span id="cb430-19"><a href="what-is-stacked-ensambled.html#cb430-19" tabindex="-1"></a>rmspe_test[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb430-20"><a href="what-is-stacked-ensambled.html#cb430-20" tabindex="-1"></a></span>
<span id="cb430-21"><a href="what-is-stacked-ensambled.html#cb430-21" tabindex="-1"></a>}</span>
<span id="cb430-22"><a href="what-is-stacked-ensambled.html#cb430-22" tabindex="-1"></a></span>
<span id="cb430-23"><a href="what-is-stacked-ensambled.html#cb430-23" tabindex="-1"></a><span class="fu">mean</span>(rmspe_test)</span></code></pre></div>
<pre><code>## [1] 0.3744278</code></pre>
<p>Now we see that we have a slightly tuned gbm model. SO will this better tuned base model effect the stacked ensemble model?</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="what-is-stacked-ensambled.html#cb432-1" tabindex="-1"></a><span class="co"># Store RMSPE results for the two stacked ensembles</span></span>
<span id="cb432-2"><a href="what-is-stacked-ensambled.html#cb432-2" tabindex="-1"></a>rmspe_ensemble_original <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb432-3"><a href="what-is-stacked-ensambled.html#cb432-3" tabindex="-1"></a>rmspe_ensemble_tuned <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb432-4"><a href="what-is-stacked-ensambled.html#cb432-4" tabindex="-1"></a></span>
<span id="cb432-5"><a href="what-is-stacked-ensambled.html#cb432-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb432-6"><a href="what-is-stacked-ensambled.html#cb432-6" tabindex="-1"></a>   <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb432-7"><a href="what-is-stacked-ensambled.html#cb432-7" tabindex="-1"></a></span>
<span id="cb432-8"><a href="what-is-stacked-ensambled.html#cb432-8" tabindex="-1"></a>  <span class="co"># Bootstrapping</span></span>
<span id="cb432-9"><a href="what-is-stacked-ensambled.html#cb432-9" tabindex="-1"></a>  train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb432-10"><a href="what-is-stacked-ensambled.html#cb432-10" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb432-11"><a href="what-is-stacked-ensambled.html#cb432-11" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb432-12"><a href="what-is-stacked-ensambled.html#cb432-12" tabindex="-1"></a>  </span>
<span id="cb432-13"><a href="what-is-stacked-ensambled.html#cb432-13" tabindex="-1"></a>  <span class="co"># Original Base Models</span></span>
<span id="cb432-14"><a href="what-is-stacked-ensambled.html#cb432-14" tabindex="-1"></a>  lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb432-15"><a href="what-is-stacked-ensambled.html#cb432-15" tabindex="-1"></a>  rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb432-16"><a href="what-is-stacked-ensambled.html#cb432-16" tabindex="-1"></a>  gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">n.trees =</span> <span class="dv">100</span>, <span class="at">interaction.depth =</span> <span class="dv">1</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb432-17"><a href="what-is-stacked-ensambled.html#cb432-17" tabindex="-1"></a>  </span>
<span id="cb432-18"><a href="what-is-stacked-ensambled.html#cb432-18" tabindex="-1"></a>  <span class="co"># Generate predictions</span></span>
<span id="cb432-19"><a href="what-is-stacked-ensambled.html#cb432-19" tabindex="-1"></a>  lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_mod, test_data)</span>
<span id="cb432-20"><a href="what-is-stacked-ensambled.html#cb432-20" tabindex="-1"></a>  rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_mod, test_data)</span>
<span id="cb432-21"><a href="what-is-stacked-ensambled.html#cb432-21" tabindex="-1"></a>  gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(gbm_mod, test_data, <span class="at">n.trees =</span> <span class="dv">100</span>)</span>
<span id="cb432-22"><a href="what-is-stacked-ensambled.html#cb432-22" tabindex="-1"></a>  </span>
<span id="cb432-23"><a href="what-is-stacked-ensambled.html#cb432-23" tabindex="-1"></a>  <span class="co"># Combine predictions into a data frame</span></span>
<span id="cb432-24"><a href="what-is-stacked-ensambled.html#cb432-24" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, gbm_pred)</span>
<span id="cb432-25"><a href="what-is-stacked-ensambled.html#cb432-25" tabindex="-1"></a>  </span>
<span id="cb432-26"><a href="what-is-stacked-ensambled.html#cb432-26" tabindex="-1"></a>  <span class="co"># Train and evaluate original stacked ensemble</span></span>
<span id="cb432-27"><a href="what-is-stacked-ensambled.html#cb432-27" tabindex="-1"></a>  meta_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds, <span class="at">medv =</span> test_data<span class="sc">$</span>medv))</span>
<span id="cb432-28"><a href="what-is-stacked-ensambled.html#cb432-28" tabindex="-1"></a>  meta_lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_lm, preds)</span>
<span id="cb432-29"><a href="what-is-stacked-ensambled.html#cb432-29" tabindex="-1"></a>  rmspe_ensemble_original[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_lm_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb432-30"><a href="what-is-stacked-ensambled.html#cb432-30" tabindex="-1"></a>  </span>
<span id="cb432-31"><a href="what-is-stacked-ensambled.html#cb432-31" tabindex="-1"></a>  <span class="co"># Train and evaluate stacked ensemble with tuned GBM model</span></span>
<span id="cb432-32"><a href="what-is-stacked-ensambled.html#cb432-32" tabindex="-1"></a>  tuned_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb432-33"><a href="what-is-stacked-ensambled.html#cb432-33" tabindex="-1"></a>                       <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees, </span>
<span id="cb432-34"><a href="what-is-stacked-ensambled.html#cb432-34" tabindex="-1"></a>                       <span class="at">shrinkage =</span> best_params<span class="sc">$</span>shrinkage, </span>
<span id="cb432-35"><a href="what-is-stacked-ensambled.html#cb432-35" tabindex="-1"></a>                       <span class="at">interaction.depth =</span> best_params<span class="sc">$</span>interaction.depth, </span>
<span id="cb432-36"><a href="what-is-stacked-ensambled.html#cb432-36" tabindex="-1"></a>                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb432-37"><a href="what-is-stacked-ensambled.html#cb432-37" tabindex="-1"></a>  </span>
<span id="cb432-38"><a href="what-is-stacked-ensambled.html#cb432-38" tabindex="-1"></a>  gbm_pred_tuned <span class="ot">&lt;-</span> <span class="fu">predict</span>(tuned_gbm_mod, test_data, <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees)</span>
<span id="cb432-39"><a href="what-is-stacked-ensambled.html#cb432-39" tabindex="-1"></a>  </span>
<span id="cb432-40"><a href="what-is-stacked-ensambled.html#cb432-40" tabindex="-1"></a>  <span class="co"># Combine predictions with tuned GBM</span></span>
<span id="cb432-41"><a href="what-is-stacked-ensambled.html#cb432-41" tabindex="-1"></a>  preds_tuned <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, gbm_pred_tuned)</span>
<span id="cb432-42"><a href="what-is-stacked-ensambled.html#cb432-42" tabindex="-1"></a>  </span>
<span id="cb432-43"><a href="what-is-stacked-ensambled.html#cb432-43" tabindex="-1"></a>  meta_lm_tuned <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds_tuned, <span class="at">medv =</span> test_data<span class="sc">$</span>medv))</span>
<span id="cb432-44"><a href="what-is-stacked-ensambled.html#cb432-44" tabindex="-1"></a>  meta_lm_pred_tuned <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_lm_tuned, preds_tuned)</span>
<span id="cb432-45"><a href="what-is-stacked-ensambled.html#cb432-45" tabindex="-1"></a>  rmspe_ensemble_tuned[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_lm_pred_tuned <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb432-46"><a href="what-is-stacked-ensambled.html#cb432-46" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Progress: 1 iterations completedProgress: 2 iterations completedProgress: 3 iterations completedProgress: 4 iterations completedProgress: 5 iterations completedProgress: 6 iterations completedProgress: 7 iterations completedProgress: 8 iterations completedProgress: 9 iterations completedProgress: 10 iterations completedProgress: 11 iterations completedProgress: 12 iterations completedProgress: 13 iterations completedProgress: 14 iterations completedProgress: 15 iterations completedProgress: 16 iterations completedProgress: 17 iterations completedProgress: 18 iterations completedProgress: 19 iterations completedProgress: 20 iterations completedProgress: 21 iterations completedProgress: 22 iterations completedProgress: 23 iterations completedProgress: 24 iterations completedProgress: 25 iterations completedProgress: 26 iterations completedProgress: 27 iterations completedProgress: 28 iterations completedProgress: 29 iterations completedProgress: 30 iterations completedProgress: 31 iterations completedProgress: 32 iterations completedProgress: 33 iterations completedProgress: 34 iterations completedProgress: 35 iterations completedProgress: 36 iterations completedProgress: 37 iterations completedProgress: 38 iterations completedProgress: 39 iterations completedProgress: 40 iterations completedProgress: 41 iterations completedProgress: 42 iterations completedProgress: 43 iterations completedProgress: 44 iterations completedProgress: 45 iterations completedProgress: 46 iterations completedProgress: 47 iterations completedProgress: 48 iterations completedProgress: 49 iterations completedProgress: 50 iterations completedProgress: 51 iterations completedProgress: 52 iterations completedProgress: 53 iterations completedProgress: 54 iterations completedProgress: 55 iterations completedProgress: 56 iterations completedProgress: 57 iterations completedProgress: 58 iterations completedProgress: 59 iterations completedProgress: 60 iterations completedProgress: 61 iterations completedProgress: 62 iterations completedProgress: 63 iterations completedProgress: 64 iterations completedProgress: 65 iterations completedProgress: 66 iterations completedProgress: 67 iterations completedProgress: 68 iterations completedProgress: 69 iterations completedProgress: 70 iterations completedProgress: 71 iterations completedProgress: 72 iterations completedProgress: 73 iterations completedProgress: 74 iterations completedProgress: 75 iterations completedProgress: 76 iterations completedProgress: 77 iterations completedProgress: 78 iterations completedProgress: 79 iterations completedProgress: 80 iterations completedProgress: 81 iterations completedProgress: 82 iterations completedProgress: 83 iterations completedProgress: 84 iterations completedProgress: 85 iterations completedProgress: 86 iterations completedProgress: 87 iterations completedProgress: 88 iterations completedProgress: 89 iterations completedProgress: 90 iterations completedProgress: 91 iterations completedProgress: 92 iterations completedProgress: 93 iterations completedProgress: 94 iterations completedProgress: 95 iterations completedProgress: 96 iterations completedProgress: 97 iterations completedProgress: 98 iterations completedProgress: 99 iterations completedProgress: 100 iterations completedProgress: 101 iterations completedProgress: 102 iterations completedProgress: 103 iterations completedProgress: 104 iterations completedProgress: 105 iterations completedProgress: 106 iterations completedProgress: 107 iterations completedProgress: 108 iterations completedProgress: 109 iterations completedProgress: 110 iterations completedProgress: 111 iterations completedProgress: 112 iterations completedProgress: 113 iterations completedProgress: 114 iterations completedProgress: 115 iterations completedProgress: 116 iterations completedProgress: 117 iterations completedProgress: 118 iterations completedProgress: 119 iterations completedProgress: 120 iterations completedProgress: 121 iterations completedProgress: 122 iterations completedProgress: 123 iterations completedProgress: 124 iterations completedProgress: 125 iterations completedProgress: 126 iterations completedProgress: 127 iterations completedProgress: 128 iterations completedProgress: 129 iterations completedProgress: 130 iterations completedProgress: 131 iterations completedProgress: 132 iterations completedProgress: 133 iterations completedProgress: 134 iterations completedProgress: 135 iterations completedProgress: 136 iterations completedProgress: 137 iterations completedProgress: 138 iterations completedProgress: 139 iterations completedProgress: 140 iterations completedProgress: 141 iterations completedProgress: 142 iterations completedProgress: 143 iterations completedProgress: 144 iterations completedProgress: 145 iterations completedProgress: 146 iterations completedProgress: 147 iterations completedProgress: 148 iterations completedProgress: 149 iterations completedProgress: 150 iterations completedProgress: 151 iterations completedProgress: 152 iterations completedProgress: 153 iterations completedProgress: 154 iterations completedProgress: 155 iterations completedProgress: 156 iterations completedProgress: 157 iterations completedProgress: 158 iterations completedProgress: 159 iterations completedProgress: 160 iterations completedProgress: 161 iterations completedProgress: 162 iterations completedProgress: 163 iterations completedProgress: 164 iterations completedProgress: 165 iterations completedProgress: 166 iterations completedProgress: 167 iterations completedProgress: 168 iterations completedProgress: 169 iterations completedProgress: 170 iterations completedProgress: 171 iterations completedProgress: 172 iterations completedProgress: 173 iterations completedProgress: 174 iterations completedProgress: 175 iterations completedProgress: 176 iterations completedProgress: 177 iterations completedProgress: 178 iterations completedProgress: 179 iterations completedProgress: 180 iterations completedProgress: 181 iterations completedProgress: 182 iterations completedProgress: 183 iterations completedProgress: 184 iterations completedProgress: 185 iterations completedProgress: 186 iterations completedProgress: 187 iterations completedProgress: 188 iterations completedProgress: 189 iterations completedProgress: 190 iterations completedProgress: 191 iterations completedProgress: 192 iterations completedProgress: 193 iterations completedProgress: 194 iterations completedProgress: 195 iterations completedProgress: 196 iterations completedProgress: 197 iterations completedProgress: 198 iterations completedProgress: 199 iterations completedProgress: 200 iterations completedProgress: 201 iterations completedProgress: 202 iterations completedProgress: 203 iterations completedProgress: 204 iterations completedProgress: 205 iterations completedProgress: 206 iterations completedProgress: 207 iterations completedProgress: 208 iterations completedProgress: 209 iterations completedProgress: 210 iterations completedProgress: 211 iterations completedProgress: 212 iterations completedProgress: 213 iterations completedProgress: 214 iterations completedProgress: 215 iterations completedProgress: 216 iterations completedProgress: 217 iterations completedProgress: 218 iterations completedProgress: 219 iterations completedProgress: 220 iterations completedProgress: 221 iterations completedProgress: 222 iterations completedProgress: 223 iterations completedProgress: 224 iterations completedProgress: 225 iterations completedProgress: 226 iterations completedProgress: 227 iterations completedProgress: 228 iterations completedProgress: 229 iterations completedProgress: 230 iterations completedProgress: 231 iterations completedProgress: 232 iterations completedProgress: 233 iterations completedProgress: 234 iterations completedProgress: 235 iterations completedProgress: 236 iterations completedProgress: 237 iterations completedProgress: 238 iterations completedProgress: 239 iterations completedProgress: 240 iterations completedProgress: 241 iterations completedProgress: 242 iterations completedProgress: 243 iterations completedProgress: 244 iterations completedProgress: 245 iterations completedProgress: 246 iterations completedProgress: 247 iterations completedProgress: 248 iterations completedProgress: 249 iterations completedProgress: 250 iterations completedProgress: 251 iterations completedProgress: 252 iterations completedProgress: 253 iterations completedProgress: 254 iterations completedProgress: 255 iterations completedProgress: 256 iterations completedProgress: 257 iterations completedProgress: 258 iterations completedProgress: 259 iterations completedProgress: 260 iterations completedProgress: 261 iterations completedProgress: 262 iterations completedProgress: 263 iterations completedProgress: 264 iterations completedProgress: 265 iterations completedProgress: 266 iterations completedProgress: 267 iterations completedProgress: 268 iterations completedProgress: 269 iterations completedProgress: 270 iterations completedProgress: 271 iterations completedProgress: 272 iterations completedProgress: 273 iterations completedProgress: 274 iterations completedProgress: 275 iterations completedProgress: 276 iterations completedProgress: 277 iterations completedProgress: 278 iterations completedProgress: 279 iterations completedProgress: 280 iterations completedProgress: 281 iterations completedProgress: 282 iterations completedProgress: 283 iterations completedProgress: 284 iterations completedProgress: 285 iterations completedProgress: 286 iterations completedProgress: 287 iterations completedProgress: 288 iterations completedProgress: 289 iterations completedProgress: 290 iterations completedProgress: 291 iterations completedProgress: 292 iterations completedProgress: 293 iterations completedProgress: 294 iterations completedProgress: 295 iterations completedProgress: 296 iterations completedProgress: 297 iterations completedProgress: 298 iterations completedProgress: 299 iterations completedProgress: 300 iterations completedProgress: 301 iterations completedProgress: 302 iterations completedProgress: 303 iterations completedProgress: 304 iterations completedProgress: 305 iterations completedProgress: 306 iterations completedProgress: 307 iterations completedProgress: 308 iterations completedProgress: 309 iterations completedProgress: 310 iterations completedProgress: 311 iterations completedProgress: 312 iterations completedProgress: 313 iterations completedProgress: 314 iterations completedProgress: 315 iterations completedProgress: 316 iterations completedProgress: 317 iterations completedProgress: 318 iterations completedProgress: 319 iterations completedProgress: 320 iterations completedProgress: 321 iterations completedProgress: 322 iterations completedProgress: 323 iterations completedProgress: 324 iterations completedProgress: 325 iterations completedProgress: 326 iterations completedProgress: 327 iterations completedProgress: 328 iterations completedProgress: 329 iterations completedProgress: 330 iterations completedProgress: 331 iterations completedProgress: 332 iterations completedProgress: 333 iterations completedProgress: 334 iterations completedProgress: 335 iterations completedProgress: 336 iterations completedProgress: 337 iterations completedProgress: 338 iterations completedProgress: 339 iterations completedProgress: 340 iterations completedProgress: 341 iterations completedProgress: 342 iterations completedProgress: 343 iterations completedProgress: 344 iterations completedProgress: 345 iterations completedProgress: 346 iterations completedProgress: 347 iterations completedProgress: 348 iterations completedProgress: 349 iterations completedProgress: 350 iterations completedProgress: 351 iterations completedProgress: 352 iterations completedProgress: 353 iterations completedProgress: 354 iterations completedProgress: 355 iterations completedProgress: 356 iterations completedProgress: 357 iterations completedProgress: 358 iterations completedProgress: 359 iterations completedProgress: 360 iterations completedProgress: 361 iterations completedProgress: 362 iterations completedProgress: 363 iterations completedProgress: 364 iterations completedProgress: 365 iterations completedProgress: 366 iterations completedProgress: 367 iterations completedProgress: 368 iterations completedProgress: 369 iterations completedProgress: 370 iterations completedProgress: 371 iterations completedProgress: 372 iterations completedProgress: 373 iterations completedProgress: 374 iterations completedProgress: 375 iterations completedProgress: 376 iterations completedProgress: 377 iterations completedProgress: 378 iterations completedProgress: 379 iterations completedProgress: 380 iterations completedProgress: 381 iterations completedProgress: 382 iterations completedProgress: 383 iterations completedProgress: 384 iterations completedProgress: 385 iterations completedProgress: 386 iterations completedProgress: 387 iterations completedProgress: 388 iterations completedProgress: 389 iterations completedProgress: 390 iterations completedProgress: 391 iterations completedProgress: 392 iterations completedProgress: 393 iterations completedProgress: 394 iterations completedProgress: 395 iterations completedProgress: 396 iterations completedProgress: 397 iterations completedProgress: 398 iterations completedProgress: 399 iterations completedProgress: 400 iterations completedProgress: 401 iterations completedProgress: 402 iterations completedProgress: 403 iterations completedProgress: 404 iterations completedProgress: 405 iterations completedProgress: 406 iterations completedProgress: 407 iterations completedProgress: 408 iterations completedProgress: 409 iterations completedProgress: 410 iterations completedProgress: 411 iterations completedProgress: 412 iterations completedProgress: 413 iterations completedProgress: 414 iterations completedProgress: 415 iterations completedProgress: 416 iterations completedProgress: 417 iterations completedProgress: 418 iterations completedProgress: 419 iterations completedProgress: 420 iterations completedProgress: 421 iterations completedProgress: 422 iterations completedProgress: 423 iterations completedProgress: 424 iterations completedProgress: 425 iterations completedProgress: 426 iterations completedProgress: 427 iterations completedProgress: 428 iterations completedProgress: 429 iterations completedProgress: 430 iterations completedProgress: 431 iterations completedProgress: 432 iterations completedProgress: 433 iterations completedProgress: 434 iterations completedProgress: 435 iterations completedProgress: 436 iterations completedProgress: 437 iterations completedProgress: 438 iterations completedProgress: 439 iterations completedProgress: 440 iterations completedProgress: 441 iterations completedProgress: 442 iterations completedProgress: 443 iterations completedProgress: 444 iterations completedProgress: 445 iterations completedProgress: 446 iterations completedProgress: 447 iterations completedProgress: 448 iterations completedProgress: 449 iterations completedProgress: 450 iterations completedProgress: 451 iterations completedProgress: 452 iterations completedProgress: 453 iterations completedProgress: 454 iterations completedProgress: 455 iterations completedProgress: 456 iterations completedProgress: 457 iterations completedProgress: 458 iterations completedProgress: 459 iterations completedProgress: 460 iterations completedProgress: 461 iterations completedProgress: 462 iterations completedProgress: 463 iterations completedProgress: 464 iterations completedProgress: 465 iterations completedProgress: 466 iterations completedProgress: 467 iterations completedProgress: 468 iterations completedProgress: 469 iterations completedProgress: 470 iterations completedProgress: 471 iterations completedProgress: 472 iterations completedProgress: 473 iterations completedProgress: 474 iterations completedProgress: 475 iterations completedProgress: 476 iterations completedProgress: 477 iterations completedProgress: 478 iterations completedProgress: 479 iterations completedProgress: 480 iterations completedProgress: 481 iterations completedProgress: 482 iterations completedProgress: 483 iterations completedProgress: 484 iterations completedProgress: 485 iterations completedProgress: 486 iterations completedProgress: 487 iterations completedProgress: 488 iterations completedProgress: 489 iterations completedProgress: 490 iterations completedProgress: 491 iterations completedProgress: 492 iterations completedProgress: 493 iterations completedProgress: 494 iterations completedProgress: 495 iterations completedProgress: 496 iterations completedProgress: 497 iterations completedProgress: 498 iterations completedProgress: 499 iterations completedProgress: 500 iterations completedProgress: 501 iterations completedProgress: 502 iterations completedProgress: 503 iterations completedProgress: 504 iterations completedProgress: 505 iterations completedProgress: 506 iterations completedProgress: 507 iterations completedProgress: 508 iterations completedProgress: 509 iterations completedProgress: 510 iterations completedProgress: 511 iterations completedProgress: 512 iterations completedProgress: 513 iterations completedProgress: 514 iterations completedProgress: 515 iterations completedProgress: 516 iterations completedProgress: 517 iterations completedProgress: 518 iterations completedProgress: 519 iterations completedProgress: 520 iterations completedProgress: 521 iterations completedProgress: 522 iterations completedProgress: 523 iterations completedProgress: 524 iterations completedProgress: 525 iterations completedProgress: 526 iterations completedProgress: 527 iterations completedProgress: 528 iterations completedProgress: 529 iterations completedProgress: 530 iterations completedProgress: 531 iterations completedProgress: 532 iterations completedProgress: 533 iterations completedProgress: 534 iterations completedProgress: 535 iterations completedProgress: 536 iterations completedProgress: 537 iterations completedProgress: 538 iterations completedProgress: 539 iterations completedProgress: 540 iterations completedProgress: 541 iterations completedProgress: 542 iterations completedProgress: 543 iterations completedProgress: 544 iterations completedProgress: 545 iterations completedProgress: 546 iterations completedProgress: 547 iterations completedProgress: 548 iterations completedProgress: 549 iterations completedProgress: 550 iterations completedProgress: 551 iterations completedProgress: 552 iterations completedProgress: 553 iterations completedProgress: 554 iterations completedProgress: 555 iterations completedProgress: 556 iterations completedProgress: 557 iterations completedProgress: 558 iterations completedProgress: 559 iterations completedProgress: 560 iterations completedProgress: 561 iterations completedProgress: 562 iterations completedProgress: 563 iterations completedProgress: 564 iterations completedProgress: 565 iterations completedProgress: 566 iterations completedProgress: 567 iterations completedProgress: 568 iterations completedProgress: 569 iterations completedProgress: 570 iterations completedProgress: 571 iterations completedProgress: 572 iterations completedProgress: 573 iterations completedProgress: 574 iterations completedProgress: 575 iterations completedProgress: 576 iterations completedProgress: 577 iterations completedProgress: 578 iterations completedProgress: 579 iterations completedProgress: 580 iterations completedProgress: 581 iterations completedProgress: 582 iterations completedProgress: 583 iterations completedProgress: 584 iterations completedProgress: 585 iterations completedProgress: 586 iterations completedProgress: 587 iterations completedProgress: 588 iterations completedProgress: 589 iterations completedProgress: 590 iterations completedProgress: 591 iterations completedProgress: 592 iterations completedProgress: 593 iterations completedProgress: 594 iterations completedProgress: 595 iterations completedProgress: 596 iterations completedProgress: 597 iterations completedProgress: 598 iterations completedProgress: 599 iterations completedProgress: 600 iterations completedProgress: 601 iterations completedProgress: 602 iterations completedProgress: 603 iterations completedProgress: 604 iterations completedProgress: 605 iterations completedProgress: 606 iterations completedProgress: 607 iterations completedProgress: 608 iterations completedProgress: 609 iterations completedProgress: 610 iterations completedProgress: 611 iterations completedProgress: 612 iterations completedProgress: 613 iterations completedProgress: 614 iterations completedProgress: 615 iterations completedProgress: 616 iterations completedProgress: 617 iterations completedProgress: 618 iterations completedProgress: 619 iterations completedProgress: 620 iterations completedProgress: 621 iterations completedProgress: 622 iterations completedProgress: 623 iterations completedProgress: 624 iterations completedProgress: 625 iterations completedProgress: 626 iterations completedProgress: 627 iterations completedProgress: 628 iterations completedProgress: 629 iterations completedProgress: 630 iterations completedProgress: 631 iterations completedProgress: 632 iterations completedProgress: 633 iterations completedProgress: 634 iterations completedProgress: 635 iterations completedProgress: 636 iterations completedProgress: 637 iterations completedProgress: 638 iterations completedProgress: 639 iterations completedProgress: 640 iterations completedProgress: 641 iterations completedProgress: 642 iterations completedProgress: 643 iterations completedProgress: 644 iterations completedProgress: 645 iterations completedProgress: 646 iterations completedProgress: 647 iterations completedProgress: 648 iterations completedProgress: 649 iterations completedProgress: 650 iterations completedProgress: 651 iterations completedProgress: 652 iterations completedProgress: 653 iterations completedProgress: 654 iterations completedProgress: 655 iterations completedProgress: 656 iterations completedProgress: 657 iterations completedProgress: 658 iterations completedProgress: 659 iterations completedProgress: 660 iterations completedProgress: 661 iterations completedProgress: 662 iterations completedProgress: 663 iterations completedProgress: 664 iterations completedProgress: 665 iterations completedProgress: 666 iterations completedProgress: 667 iterations completedProgress: 668 iterations completedProgress: 669 iterations completedProgress: 670 iterations completedProgress: 671 iterations completedProgress: 672 iterations completedProgress: 673 iterations completedProgress: 674 iterations completedProgress: 675 iterations completedProgress: 676 iterations completedProgress: 677 iterations completedProgress: 678 iterations completedProgress: 679 iterations completedProgress: 680 iterations completedProgress: 681 iterations completedProgress: 682 iterations completedProgress: 683 iterations completedProgress: 684 iterations completedProgress: 685 iterations completedProgress: 686 iterations completedProgress: 687 iterations completedProgress: 688 iterations completedProgress: 689 iterations completedProgress: 690 iterations completedProgress: 691 iterations completedProgress: 692 iterations completedProgress: 693 iterations completedProgress: 694 iterations completedProgress: 695 iterations completedProgress: 696 iterations completedProgress: 697 iterations completedProgress: 698 iterations completedProgress: 699 iterations completedProgress: 700 iterations completedProgress: 701 iterations completedProgress: 702 iterations completedProgress: 703 iterations completedProgress: 704 iterations completedProgress: 705 iterations completedProgress: 706 iterations completedProgress: 707 iterations completedProgress: 708 iterations completedProgress: 709 iterations completedProgress: 710 iterations completedProgress: 711 iterations completedProgress: 712 iterations completedProgress: 713 iterations completedProgress: 714 iterations completedProgress: 715 iterations completedProgress: 716 iterations completedProgress: 717 iterations completedProgress: 718 iterations completedProgress: 719 iterations completedProgress: 720 iterations completedProgress: 721 iterations completedProgress: 722 iterations completedProgress: 723 iterations completedProgress: 724 iterations completedProgress: 725 iterations completedProgress: 726 iterations completedProgress: 727 iterations completedProgress: 728 iterations completedProgress: 729 iterations completedProgress: 730 iterations completedProgress: 731 iterations completedProgress: 732 iterations completedProgress: 733 iterations completedProgress: 734 iterations completedProgress: 735 iterations completedProgress: 736 iterations completedProgress: 737 iterations completedProgress: 738 iterations completedProgress: 739 iterations completedProgress: 740 iterations completedProgress: 741 iterations completedProgress: 742 iterations completedProgress: 743 iterations completedProgress: 744 iterations completedProgress: 745 iterations completedProgress: 746 iterations completedProgress: 747 iterations completedProgress: 748 iterations completedProgress: 749 iterations completedProgress: 750 iterations completedProgress: 751 iterations completedProgress: 752 iterations completedProgress: 753 iterations completedProgress: 754 iterations completedProgress: 755 iterations completedProgress: 756 iterations completedProgress: 757 iterations completedProgress: 758 iterations completedProgress: 759 iterations completedProgress: 760 iterations completedProgress: 761 iterations completedProgress: 762 iterations completedProgress: 763 iterations completedProgress: 764 iterations completedProgress: 765 iterations completedProgress: 766 iterations completedProgress: 767 iterations completedProgress: 768 iterations completedProgress: 769 iterations completedProgress: 770 iterations completedProgress: 771 iterations completedProgress: 772 iterations completedProgress: 773 iterations completedProgress: 774 iterations completedProgress: 775 iterations completedProgress: 776 iterations completedProgress: 777 iterations completedProgress: 778 iterations completedProgress: 779 iterations completedProgress: 780 iterations completedProgress: 781 iterations completedProgress: 782 iterations completedProgress: 783 iterations completedProgress: 784 iterations completedProgress: 785 iterations completedProgress: 786 iterations completedProgress: 787 iterations completedProgress: 788 iterations completedProgress: 789 iterations completedProgress: 790 iterations completedProgress: 791 iterations completedProgress: 792 iterations completedProgress: 793 iterations completedProgress: 794 iterations completedProgress: 795 iterations completedProgress: 796 iterations completedProgress: 797 iterations completedProgress: 798 iterations completedProgress: 799 iterations completedProgress: 800 iterations completedProgress: 801 iterations completedProgress: 802 iterations completedProgress: 803 iterations completedProgress: 804 iterations completedProgress: 805 iterations completedProgress: 806 iterations completedProgress: 807 iterations completedProgress: 808 iterations completedProgress: 809 iterations completedProgress: 810 iterations completedProgress: 811 iterations completedProgress: 812 iterations completedProgress: 813 iterations completedProgress: 814 iterations completedProgress: 815 iterations completedProgress: 816 iterations completedProgress: 817 iterations completedProgress: 818 iterations completedProgress: 819 iterations completedProgress: 820 iterations completedProgress: 821 iterations completedProgress: 822 iterations completedProgress: 823 iterations completedProgress: 824 iterations completedProgress: 825 iterations completedProgress: 826 iterations completedProgress: 827 iterations completedProgress: 828 iterations completedProgress: 829 iterations completedProgress: 830 iterations completedProgress: 831 iterations completedProgress: 832 iterations completedProgress: 833 iterations completedProgress: 834 iterations completedProgress: 835 iterations completedProgress: 836 iterations completedProgress: 837 iterations completedProgress: 838 iterations completedProgress: 839 iterations completedProgress: 840 iterations completedProgress: 841 iterations completedProgress: 842 iterations completedProgress: 843 iterations completedProgress: 844 iterations completedProgress: 845 iterations completedProgress: 846 iterations completedProgress: 847 iterations completedProgress: 848 iterations completedProgress: 849 iterations completedProgress: 850 iterations completedProgress: 851 iterations completedProgress: 852 iterations completedProgress: 853 iterations completedProgress: 854 iterations completedProgress: 855 iterations completedProgress: 856 iterations completedProgress: 857 iterations completedProgress: 858 iterations completedProgress: 859 iterations completedProgress: 860 iterations completedProgress: 861 iterations completedProgress: 862 iterations completedProgress: 863 iterations completedProgress: 864 iterations completedProgress: 865 iterations completedProgress: 866 iterations completedProgress: 867 iterations completedProgress: 868 iterations completedProgress: 869 iterations completedProgress: 870 iterations completedProgress: 871 iterations completedProgress: 872 iterations completedProgress: 873 iterations completedProgress: 874 iterations completedProgress: 875 iterations completedProgress: 876 iterations completedProgress: 877 iterations completedProgress: 878 iterations completedProgress: 879 iterations completedProgress: 880 iterations completedProgress: 881 iterations completedProgress: 882 iterations completedProgress: 883 iterations completedProgress: 884 iterations completedProgress: 885 iterations completedProgress: 886 iterations completedProgress: 887 iterations completedProgress: 888 iterations completedProgress: 889 iterations completedProgress: 890 iterations completedProgress: 891 iterations completedProgress: 892 iterations completedProgress: 893 iterations completedProgress: 894 iterations completedProgress: 895 iterations completedProgress: 896 iterations completedProgress: 897 iterations completedProgress: 898 iterations completedProgress: 899 iterations completedProgress: 900 iterations completedProgress: 901 iterations completedProgress: 902 iterations completedProgress: 903 iterations completedProgress: 904 iterations completedProgress: 905 iterations completedProgress: 906 iterations completedProgress: 907 iterations completedProgress: 908 iterations completedProgress: 909 iterations completedProgress: 910 iterations completedProgress: 911 iterations completedProgress: 912 iterations completedProgress: 913 iterations completedProgress: 914 iterations completedProgress: 915 iterations completedProgress: 916 iterations completedProgress: 917 iterations completedProgress: 918 iterations completedProgress: 919 iterations completedProgress: 920 iterations completedProgress: 921 iterations completedProgress: 922 iterations completedProgress: 923 iterations completedProgress: 924 iterations completedProgress: 925 iterations completedProgress: 926 iterations completedProgress: 927 iterations completedProgress: 928 iterations completedProgress: 929 iterations completedProgress: 930 iterations completedProgress: 931 iterations completedProgress: 932 iterations completedProgress: 933 iterations completedProgress: 934 iterations completedProgress: 935 iterations completedProgress: 936 iterations completedProgress: 937 iterations completedProgress: 938 iterations completedProgress: 939 iterations completedProgress: 940 iterations completedProgress: 941 iterations completedProgress: 942 iterations completedProgress: 943 iterations completedProgress: 944 iterations completedProgress: 945 iterations completedProgress: 946 iterations completedProgress: 947 iterations completedProgress: 948 iterations completedProgress: 949 iterations completedProgress: 950 iterations completedProgress: 951 iterations completedProgress: 952 iterations completedProgress: 953 iterations completedProgress: 954 iterations completedProgress: 955 iterations completedProgress: 956 iterations completedProgress: 957 iterations completedProgress: 958 iterations completedProgress: 959 iterations completedProgress: 960 iterations completedProgress: 961 iterations completedProgress: 962 iterations completedProgress: 963 iterations completedProgress: 964 iterations completedProgress: 965 iterations completedProgress: 966 iterations completedProgress: 967 iterations completedProgress: 968 iterations completedProgress: 969 iterations completedProgress: 970 iterations completedProgress: 971 iterations completedProgress: 972 iterations completedProgress: 973 iterations completedProgress: 974 iterations completedProgress: 975 iterations completedProgress: 976 iterations completedProgress: 977 iterations completedProgress: 978 iterations completedProgress: 979 iterations completedProgress: 980 iterations completedProgress: 981 iterations completedProgress: 982 iterations completedProgress: 983 iterations completedProgress: 984 iterations completedProgress: 985 iterations completedProgress: 986 iterations completedProgress: 987 iterations completedProgress: 988 iterations completedProgress: 989 iterations completedProgress: 990 iterations completedProgress: 991 iterations completedProgress: 992 iterations completedProgress: 993 iterations completedProgress: 994 iterations completedProgress: 995 iterations completedProgress: 996 iterations completedProgress: 997 iterations completedProgress: 998 iterations completedProgress: 999 iterations completedProgress: 1000 iterations completed</code></pre>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="what-is-stacked-ensambled.html#cb434-1" tabindex="-1"></a><span class="co"># Calculate mean RMSPE for both ensembles</span></span>
<span id="cb434-2"><a href="what-is-stacked-ensambled.html#cb434-2" tabindex="-1"></a>mean_rmspe_ensemble_original <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_ensemble_original)</span>
<span id="cb434-3"><a href="what-is-stacked-ensambled.html#cb434-3" tabindex="-1"></a>mean_rmspe_ensemble_tuned <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_ensemble_tuned)</span>
<span id="cb434-4"><a href="what-is-stacked-ensambled.html#cb434-4" tabindex="-1"></a></span>
<span id="cb434-5"><a href="what-is-stacked-ensambled.html#cb434-5" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb434-6"><a href="what-is-stacked-ensambled.html#cb434-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE of Original Stacked Ensemble:&quot;</span>, mean_rmspe_ensemble_original))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE of Original Stacked Ensemble: 0.352672885826131&quot;</code></pre>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="what-is-stacked-ensambled.html#cb436-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE of Tuned Stacked Ensemble:&quot;</span>, mean_rmspe_ensemble_tuned))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE of Tuned Stacked Ensemble: 0.345268424936948&quot;</code></pre>
<p>We can see a difference in the average RMSPE</p>
<p>now we will ask the question does adding a model that is simply worse and similar to the other models help the ensemble model?</p>
<p>we will now stacked ensambled all 4 base models that we have</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="what-is-stacked-ensambled.html#cb438-1" tabindex="-1"></a><span class="co"># Store RMSPE results for the stacked ensemble with all four models</span></span>
<span id="cb438-2"><a href="what-is-stacked-ensambled.html#cb438-2" tabindex="-1"></a>rmspe_ensemble_four <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb438-3"><a href="what-is-stacked-ensambled.html#cb438-3" tabindex="-1"></a></span>
<span id="cb438-4"><a href="what-is-stacked-ensambled.html#cb438-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb438-5"><a href="what-is-stacked-ensambled.html#cb438-5" tabindex="-1"></a>     <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb438-6"><a href="what-is-stacked-ensambled.html#cb438-6" tabindex="-1"></a></span>
<span id="cb438-7"><a href="what-is-stacked-ensambled.html#cb438-7" tabindex="-1"></a>  </span>
<span id="cb438-8"><a href="what-is-stacked-ensambled.html#cb438-8" tabindex="-1"></a>  <span class="co"># Bootstrapping</span></span>
<span id="cb438-9"><a href="what-is-stacked-ensambled.html#cb438-9" tabindex="-1"></a>  train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb438-10"><a href="what-is-stacked-ensambled.html#cb438-10" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb438-11"><a href="what-is-stacked-ensambled.html#cb438-11" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb438-12"><a href="what-is-stacked-ensambled.html#cb438-12" tabindex="-1"></a>  </span>
<span id="cb438-13"><a href="what-is-stacked-ensambled.html#cb438-13" tabindex="-1"></a>  <span class="co"># Re-train the original models on bootstrapped training data</span></span>
<span id="cb438-14"><a href="what-is-stacked-ensambled.html#cb438-14" tabindex="-1"></a>  lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb438-15"><a href="what-is-stacked-ensambled.html#cb438-15" tabindex="-1"></a>  rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb438-16"><a href="what-is-stacked-ensambled.html#cb438-16" tabindex="-1"></a>  </span>
<span id="cb438-17"><a href="what-is-stacked-ensambled.html#cb438-17" tabindex="-1"></a>  <span class="co"># Train both GBM models on the bootstrapped training data</span></span>
<span id="cb438-18"><a href="what-is-stacked-ensambled.html#cb438-18" tabindex="-1"></a>  base_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">n.trees =</span> <span class="dv">100</span>, <span class="at">interaction.depth =</span> <span class="dv">1</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb438-19"><a href="what-is-stacked-ensambled.html#cb438-19" tabindex="-1"></a>  tuned_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb438-20"><a href="what-is-stacked-ensambled.html#cb438-20" tabindex="-1"></a>                       <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees, </span>
<span id="cb438-21"><a href="what-is-stacked-ensambled.html#cb438-21" tabindex="-1"></a>                       <span class="at">shrinkage =</span> best_params<span class="sc">$</span>shrinkage, </span>
<span id="cb438-22"><a href="what-is-stacked-ensambled.html#cb438-22" tabindex="-1"></a>                       <span class="at">interaction.depth =</span> best_params<span class="sc">$</span>interaction.depth, </span>
<span id="cb438-23"><a href="what-is-stacked-ensambled.html#cb438-23" tabindex="-1"></a>                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb438-24"><a href="what-is-stacked-ensambled.html#cb438-24" tabindex="-1"></a>  </span>
<span id="cb438-25"><a href="what-is-stacked-ensambled.html#cb438-25" tabindex="-1"></a>  <span class="co"># Generate predictions on the bootstrapped test set</span></span>
<span id="cb438-26"><a href="what-is-stacked-ensambled.html#cb438-26" tabindex="-1"></a>  lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_mod, test_data)</span>
<span id="cb438-27"><a href="what-is-stacked-ensambled.html#cb438-27" tabindex="-1"></a>  rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_mod, test_data)</span>
<span id="cb438-28"><a href="what-is-stacked-ensambled.html#cb438-28" tabindex="-1"></a>  base_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(base_gbm_mod, test_data, <span class="at">n.trees =</span> <span class="dv">100</span>)</span>
<span id="cb438-29"><a href="what-is-stacked-ensambled.html#cb438-29" tabindex="-1"></a>  tuned_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(tuned_gbm_mod, test_data, <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees)</span>
<span id="cb438-30"><a href="what-is-stacked-ensambled.html#cb438-30" tabindex="-1"></a>  </span>
<span id="cb438-31"><a href="what-is-stacked-ensambled.html#cb438-31" tabindex="-1"></a>  <span class="co"># Combine predictions into a data frame</span></span>
<span id="cb438-32"><a href="what-is-stacked-ensambled.html#cb438-32" tabindex="-1"></a>  preds_four <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, base_gbm_pred, tuned_gbm_pred)</span>
<span id="cb438-33"><a href="what-is-stacked-ensambled.html#cb438-33" tabindex="-1"></a>  </span>
<span id="cb438-34"><a href="what-is-stacked-ensambled.html#cb438-34" tabindex="-1"></a>  <span class="co"># Train and evaluate the stacked ensemble with all four models</span></span>
<span id="cb438-35"><a href="what-is-stacked-ensambled.html#cb438-35" tabindex="-1"></a>  meta_four <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds_four, <span class="at">medv =</span> test_data<span class="sc">$</span>medv))</span>
<span id="cb438-36"><a href="what-is-stacked-ensambled.html#cb438-36" tabindex="-1"></a>  meta_four_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_four, preds_four)</span>
<span id="cb438-37"><a href="what-is-stacked-ensambled.html#cb438-37" tabindex="-1"></a>  </span>
<span id="cb438-38"><a href="what-is-stacked-ensambled.html#cb438-38" tabindex="-1"></a>  <span class="co"># Calculate RMSPE for the ensemble with all four models</span></span>
<span id="cb438-39"><a href="what-is-stacked-ensambled.html#cb438-39" tabindex="-1"></a>  rmspe_ensemble_four[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_four_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb438-40"><a href="what-is-stacked-ensambled.html#cb438-40" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Progress: 1 iterations completedProgress: 2 iterations completedProgress: 3 iterations completedProgress: 4 iterations completedProgress: 5 iterations completedProgress: 6 iterations completedProgress: 7 iterations completedProgress: 8 iterations completedProgress: 9 iterations completedProgress: 10 iterations completedProgress: 11 iterations completedProgress: 12 iterations completedProgress: 13 iterations completedProgress: 14 iterations completedProgress: 15 iterations completedProgress: 16 iterations completedProgress: 17 iterations completedProgress: 18 iterations completedProgress: 19 iterations completedProgress: 20 iterations completedProgress: 21 iterations completedProgress: 22 iterations completedProgress: 23 iterations completedProgress: 24 iterations completedProgress: 25 iterations completedProgress: 26 iterations completedProgress: 27 iterations completedProgress: 28 iterations completedProgress: 29 iterations completedProgress: 30 iterations completedProgress: 31 iterations completedProgress: 32 iterations completedProgress: 33 iterations completedProgress: 34 iterations completedProgress: 35 iterations completedProgress: 36 iterations completedProgress: 37 iterations completedProgress: 38 iterations completedProgress: 39 iterations completedProgress: 40 iterations completedProgress: 41 iterations completedProgress: 42 iterations completedProgress: 43 iterations completedProgress: 44 iterations completedProgress: 45 iterations completedProgress: 46 iterations completedProgress: 47 iterations completedProgress: 48 iterations completedProgress: 49 iterations completedProgress: 50 iterations completedProgress: 51 iterations completedProgress: 52 iterations completedProgress: 53 iterations completedProgress: 54 iterations completedProgress: 55 iterations completedProgress: 56 iterations completedProgress: 57 iterations completedProgress: 58 iterations completedProgress: 59 iterations completedProgress: 60 iterations completedProgress: 61 iterations completedProgress: 62 iterations completedProgress: 63 iterations completedProgress: 64 iterations completedProgress: 65 iterations completedProgress: 66 iterations completedProgress: 67 iterations completedProgress: 68 iterations completedProgress: 69 iterations completedProgress: 70 iterations completedProgress: 71 iterations completedProgress: 72 iterations completedProgress: 73 iterations completedProgress: 74 iterations completedProgress: 75 iterations completedProgress: 76 iterations completedProgress: 77 iterations completedProgress: 78 iterations completedProgress: 79 iterations completedProgress: 80 iterations completedProgress: 81 iterations completedProgress: 82 iterations completedProgress: 83 iterations completedProgress: 84 iterations completedProgress: 85 iterations completedProgress: 86 iterations completedProgress: 87 iterations completedProgress: 88 iterations completedProgress: 89 iterations completedProgress: 90 iterations completedProgress: 91 iterations completedProgress: 92 iterations completedProgress: 93 iterations completedProgress: 94 iterations completedProgress: 95 iterations completedProgress: 96 iterations completedProgress: 97 iterations completedProgress: 98 iterations completedProgress: 99 iterations completedProgress: 100 iterations completedProgress: 101 iterations completedProgress: 102 iterations completedProgress: 103 iterations completedProgress: 104 iterations completedProgress: 105 iterations completedProgress: 106 iterations completedProgress: 107 iterations completedProgress: 108 iterations completedProgress: 109 iterations completedProgress: 110 iterations completedProgress: 111 iterations completedProgress: 112 iterations completedProgress: 113 iterations completedProgress: 114 iterations completedProgress: 115 iterations completedProgress: 116 iterations completedProgress: 117 iterations completedProgress: 118 iterations completedProgress: 119 iterations completedProgress: 120 iterations completedProgress: 121 iterations completedProgress: 122 iterations completedProgress: 123 iterations completedProgress: 124 iterations completedProgress: 125 iterations completedProgress: 126 iterations completedProgress: 127 iterations completedProgress: 128 iterations completedProgress: 129 iterations completedProgress: 130 iterations completedProgress: 131 iterations completedProgress: 132 iterations completedProgress: 133 iterations completedProgress: 134 iterations completedProgress: 135 iterations completedProgress: 136 iterations completedProgress: 137 iterations completedProgress: 138 iterations completedProgress: 139 iterations completedProgress: 140 iterations completedProgress: 141 iterations completedProgress: 142 iterations completedProgress: 143 iterations completedProgress: 144 iterations completedProgress: 145 iterations completedProgress: 146 iterations completedProgress: 147 iterations completedProgress: 148 iterations completedProgress: 149 iterations completedProgress: 150 iterations completedProgress: 151 iterations completedProgress: 152 iterations completedProgress: 153 iterations completedProgress: 154 iterations completedProgress: 155 iterations completedProgress: 156 iterations completedProgress: 157 iterations completedProgress: 158 iterations completedProgress: 159 iterations completedProgress: 160 iterations completedProgress: 161 iterations completedProgress: 162 iterations completedProgress: 163 iterations completedProgress: 164 iterations completedProgress: 165 iterations completedProgress: 166 iterations completedProgress: 167 iterations completedProgress: 168 iterations completedProgress: 169 iterations completedProgress: 170 iterations completedProgress: 171 iterations completedProgress: 172 iterations completedProgress: 173 iterations completedProgress: 174 iterations completedProgress: 175 iterations completedProgress: 176 iterations completedProgress: 177 iterations completedProgress: 178 iterations completedProgress: 179 iterations completedProgress: 180 iterations completedProgress: 181 iterations completedProgress: 182 iterations completedProgress: 183 iterations completedProgress: 184 iterations completedProgress: 185 iterations completedProgress: 186 iterations completedProgress: 187 iterations completedProgress: 188 iterations completedProgress: 189 iterations completedProgress: 190 iterations completedProgress: 191 iterations completedProgress: 192 iterations completedProgress: 193 iterations completedProgress: 194 iterations completedProgress: 195 iterations completedProgress: 196 iterations completedProgress: 197 iterations completedProgress: 198 iterations completedProgress: 199 iterations completedProgress: 200 iterations completedProgress: 201 iterations completedProgress: 202 iterations completedProgress: 203 iterations completedProgress: 204 iterations completedProgress: 205 iterations completedProgress: 206 iterations completedProgress: 207 iterations completedProgress: 208 iterations completedProgress: 209 iterations completedProgress: 210 iterations completedProgress: 211 iterations completedProgress: 212 iterations completedProgress: 213 iterations completedProgress: 214 iterations completedProgress: 215 iterations completedProgress: 216 iterations completedProgress: 217 iterations completedProgress: 218 iterations completedProgress: 219 iterations completedProgress: 220 iterations completedProgress: 221 iterations completedProgress: 222 iterations completedProgress: 223 iterations completedProgress: 224 iterations completedProgress: 225 iterations completedProgress: 226 iterations completedProgress: 227 iterations completedProgress: 228 iterations completedProgress: 229 iterations completedProgress: 230 iterations completedProgress: 231 iterations completedProgress: 232 iterations completedProgress: 233 iterations completedProgress: 234 iterations completedProgress: 235 iterations completedProgress: 236 iterations completedProgress: 237 iterations completedProgress: 238 iterations completedProgress: 239 iterations completedProgress: 240 iterations completedProgress: 241 iterations completedProgress: 242 iterations completedProgress: 243 iterations completedProgress: 244 iterations completedProgress: 245 iterations completedProgress: 246 iterations completedProgress: 247 iterations completedProgress: 248 iterations completedProgress: 249 iterations completedProgress: 250 iterations completedProgress: 251 iterations completedProgress: 252 iterations completedProgress: 253 iterations completedProgress: 254 iterations completedProgress: 255 iterations completedProgress: 256 iterations completedProgress: 257 iterations completedProgress: 258 iterations completedProgress: 259 iterations completedProgress: 260 iterations completedProgress: 261 iterations completedProgress: 262 iterations completedProgress: 263 iterations completedProgress: 264 iterations completedProgress: 265 iterations completedProgress: 266 iterations completedProgress: 267 iterations completedProgress: 268 iterations completedProgress: 269 iterations completedProgress: 270 iterations completedProgress: 271 iterations completedProgress: 272 iterations completedProgress: 273 iterations completedProgress: 274 iterations completedProgress: 275 iterations completedProgress: 276 iterations completedProgress: 277 iterations completedProgress: 278 iterations completedProgress: 279 iterations completedProgress: 280 iterations completedProgress: 281 iterations completedProgress: 282 iterations completedProgress: 283 iterations completedProgress: 284 iterations completedProgress: 285 iterations completedProgress: 286 iterations completedProgress: 287 iterations completedProgress: 288 iterations completedProgress: 289 iterations completedProgress: 290 iterations completedProgress: 291 iterations completedProgress: 292 iterations completedProgress: 293 iterations completedProgress: 294 iterations completedProgress: 295 iterations completedProgress: 296 iterations completedProgress: 297 iterations completedProgress: 298 iterations completedProgress: 299 iterations completedProgress: 300 iterations completedProgress: 301 iterations completedProgress: 302 iterations completedProgress: 303 iterations completedProgress: 304 iterations completedProgress: 305 iterations completedProgress: 306 iterations completedProgress: 307 iterations completedProgress: 308 iterations completedProgress: 309 iterations completedProgress: 310 iterations completedProgress: 311 iterations completedProgress: 312 iterations completedProgress: 313 iterations completedProgress: 314 iterations completedProgress: 315 iterations completedProgress: 316 iterations completedProgress: 317 iterations completedProgress: 318 iterations completedProgress: 319 iterations completedProgress: 320 iterations completedProgress: 321 iterations completedProgress: 322 iterations completedProgress: 323 iterations completedProgress: 324 iterations completedProgress: 325 iterations completedProgress: 326 iterations completedProgress: 327 iterations completedProgress: 328 iterations completedProgress: 329 iterations completedProgress: 330 iterations completedProgress: 331 iterations completedProgress: 332 iterations completedProgress: 333 iterations completedProgress: 334 iterations completedProgress: 335 iterations completedProgress: 336 iterations completedProgress: 337 iterations completedProgress: 338 iterations completedProgress: 339 iterations completedProgress: 340 iterations completedProgress: 341 iterations completedProgress: 342 iterations completedProgress: 343 iterations completedProgress: 344 iterations completedProgress: 345 iterations completedProgress: 346 iterations completedProgress: 347 iterations completedProgress: 348 iterations completedProgress: 349 iterations completedProgress: 350 iterations completedProgress: 351 iterations completedProgress: 352 iterations completedProgress: 353 iterations completedProgress: 354 iterations completedProgress: 355 iterations completedProgress: 356 iterations completedProgress: 357 iterations completedProgress: 358 iterations completedProgress: 359 iterations completedProgress: 360 iterations completedProgress: 361 iterations completedProgress: 362 iterations completedProgress: 363 iterations completedProgress: 364 iterations completedProgress: 365 iterations completedProgress: 366 iterations completedProgress: 367 iterations completedProgress: 368 iterations completedProgress: 369 iterations completedProgress: 370 iterations completedProgress: 371 iterations completedProgress: 372 iterations completedProgress: 373 iterations completedProgress: 374 iterations completedProgress: 375 iterations completedProgress: 376 iterations completedProgress: 377 iterations completedProgress: 378 iterations completedProgress: 379 iterations completedProgress: 380 iterations completedProgress: 381 iterations completedProgress: 382 iterations completedProgress: 383 iterations completedProgress: 384 iterations completedProgress: 385 iterations completedProgress: 386 iterations completedProgress: 387 iterations completedProgress: 388 iterations completedProgress: 389 iterations completedProgress: 390 iterations completedProgress: 391 iterations completedProgress: 392 iterations completedProgress: 393 iterations completedProgress: 394 iterations completedProgress: 395 iterations completedProgress: 396 iterations completedProgress: 397 iterations completedProgress: 398 iterations completedProgress: 399 iterations completedProgress: 400 iterations completedProgress: 401 iterations completedProgress: 402 iterations completedProgress: 403 iterations completedProgress: 404 iterations completedProgress: 405 iterations completedProgress: 406 iterations completedProgress: 407 iterations completedProgress: 408 iterations completedProgress: 409 iterations completedProgress: 410 iterations completedProgress: 411 iterations completedProgress: 412 iterations completedProgress: 413 iterations completedProgress: 414 iterations completedProgress: 415 iterations completedProgress: 416 iterations completedProgress: 417 iterations completedProgress: 418 iterations completedProgress: 419 iterations completedProgress: 420 iterations completedProgress: 421 iterations completedProgress: 422 iterations completedProgress: 423 iterations completedProgress: 424 iterations completedProgress: 425 iterations completedProgress: 426 iterations completedProgress: 427 iterations completedProgress: 428 iterations completedProgress: 429 iterations completedProgress: 430 iterations completedProgress: 431 iterations completedProgress: 432 iterations completedProgress: 433 iterations completedProgress: 434 iterations completedProgress: 435 iterations completedProgress: 436 iterations completedProgress: 437 iterations completedProgress: 438 iterations completedProgress: 439 iterations completedProgress: 440 iterations completedProgress: 441 iterations completedProgress: 442 iterations completedProgress: 443 iterations completedProgress: 444 iterations completedProgress: 445 iterations completedProgress: 446 iterations completedProgress: 447 iterations completedProgress: 448 iterations completedProgress: 449 iterations completedProgress: 450 iterations completedProgress: 451 iterations completedProgress: 452 iterations completedProgress: 453 iterations completedProgress: 454 iterations completedProgress: 455 iterations completedProgress: 456 iterations completedProgress: 457 iterations completedProgress: 458 iterations completedProgress: 459 iterations completedProgress: 460 iterations completedProgress: 461 iterations completedProgress: 462 iterations completedProgress: 463 iterations completedProgress: 464 iterations completedProgress: 465 iterations completedProgress: 466 iterations completedProgress: 467 iterations completedProgress: 468 iterations completedProgress: 469 iterations completedProgress: 470 iterations completedProgress: 471 iterations completedProgress: 472 iterations completedProgress: 473 iterations completedProgress: 474 iterations completedProgress: 475 iterations completedProgress: 476 iterations completedProgress: 477 iterations completedProgress: 478 iterations completedProgress: 479 iterations completedProgress: 480 iterations completedProgress: 481 iterations completedProgress: 482 iterations completedProgress: 483 iterations completedProgress: 484 iterations completedProgress: 485 iterations completedProgress: 486 iterations completedProgress: 487 iterations completedProgress: 488 iterations completedProgress: 489 iterations completedProgress: 490 iterations completedProgress: 491 iterations completedProgress: 492 iterations completedProgress: 493 iterations completedProgress: 494 iterations completedProgress: 495 iterations completedProgress: 496 iterations completedProgress: 497 iterations completedProgress: 498 iterations completedProgress: 499 iterations completedProgress: 500 iterations completedProgress: 501 iterations completedProgress: 502 iterations completedProgress: 503 iterations completedProgress: 504 iterations completedProgress: 505 iterations completedProgress: 506 iterations completedProgress: 507 iterations completedProgress: 508 iterations completedProgress: 509 iterations completedProgress: 510 iterations completedProgress: 511 iterations completedProgress: 512 iterations completedProgress: 513 iterations completedProgress: 514 iterations completedProgress: 515 iterations completedProgress: 516 iterations completedProgress: 517 iterations completedProgress: 518 iterations completedProgress: 519 iterations completedProgress: 520 iterations completedProgress: 521 iterations completedProgress: 522 iterations completedProgress: 523 iterations completedProgress: 524 iterations completedProgress: 525 iterations completedProgress: 526 iterations completedProgress: 527 iterations completedProgress: 528 iterations completedProgress: 529 iterations completedProgress: 530 iterations completedProgress: 531 iterations completedProgress: 532 iterations completedProgress: 533 iterations completedProgress: 534 iterations completedProgress: 535 iterations completedProgress: 536 iterations completedProgress: 537 iterations completedProgress: 538 iterations completedProgress: 539 iterations completedProgress: 540 iterations completedProgress: 541 iterations completedProgress: 542 iterations completedProgress: 543 iterations completedProgress: 544 iterations completedProgress: 545 iterations completedProgress: 546 iterations completedProgress: 547 iterations completedProgress: 548 iterations completedProgress: 549 iterations completedProgress: 550 iterations completedProgress: 551 iterations completedProgress: 552 iterations completedProgress: 553 iterations completedProgress: 554 iterations completedProgress: 555 iterations completedProgress: 556 iterations completedProgress: 557 iterations completedProgress: 558 iterations completedProgress: 559 iterations completedProgress: 560 iterations completedProgress: 561 iterations completedProgress: 562 iterations completedProgress: 563 iterations completedProgress: 564 iterations completedProgress: 565 iterations completedProgress: 566 iterations completedProgress: 567 iterations completedProgress: 568 iterations completedProgress: 569 iterations completedProgress: 570 iterations completedProgress: 571 iterations completedProgress: 572 iterations completedProgress: 573 iterations completedProgress: 574 iterations completedProgress: 575 iterations completedProgress: 576 iterations completedProgress: 577 iterations completedProgress: 578 iterations completedProgress: 579 iterations completedProgress: 580 iterations completedProgress: 581 iterations completedProgress: 582 iterations completedProgress: 583 iterations completedProgress: 584 iterations completedProgress: 585 iterations completedProgress: 586 iterations completedProgress: 587 iterations completedProgress: 588 iterations completedProgress: 589 iterations completedProgress: 590 iterations completedProgress: 591 iterations completedProgress: 592 iterations completedProgress: 593 iterations completedProgress: 594 iterations completedProgress: 595 iterations completedProgress: 596 iterations completedProgress: 597 iterations completedProgress: 598 iterations completedProgress: 599 iterations completedProgress: 600 iterations completedProgress: 601 iterations completedProgress: 602 iterations completedProgress: 603 iterations completedProgress: 604 iterations completedProgress: 605 iterations completedProgress: 606 iterations completedProgress: 607 iterations completedProgress: 608 iterations completedProgress: 609 iterations completedProgress: 610 iterations completedProgress: 611 iterations completedProgress: 612 iterations completedProgress: 613 iterations completedProgress: 614 iterations completedProgress: 615 iterations completedProgress: 616 iterations completedProgress: 617 iterations completedProgress: 618 iterations completedProgress: 619 iterations completedProgress: 620 iterations completedProgress: 621 iterations completedProgress: 622 iterations completedProgress: 623 iterations completedProgress: 624 iterations completedProgress: 625 iterations completedProgress: 626 iterations completedProgress: 627 iterations completedProgress: 628 iterations completedProgress: 629 iterations completedProgress: 630 iterations completedProgress: 631 iterations completedProgress: 632 iterations completedProgress: 633 iterations completedProgress: 634 iterations completedProgress: 635 iterations completedProgress: 636 iterations completedProgress: 637 iterations completedProgress: 638 iterations completedProgress: 639 iterations completedProgress: 640 iterations completedProgress: 641 iterations completedProgress: 642 iterations completedProgress: 643 iterations completedProgress: 644 iterations completedProgress: 645 iterations completedProgress: 646 iterations completedProgress: 647 iterations completedProgress: 648 iterations completedProgress: 649 iterations completedProgress: 650 iterations completedProgress: 651 iterations completedProgress: 652 iterations completedProgress: 653 iterations completedProgress: 654 iterations completedProgress: 655 iterations completedProgress: 656 iterations completedProgress: 657 iterations completedProgress: 658 iterations completedProgress: 659 iterations completedProgress: 660 iterations completedProgress: 661 iterations completedProgress: 662 iterations completedProgress: 663 iterations completedProgress: 664 iterations completedProgress: 665 iterations completedProgress: 666 iterations completedProgress: 667 iterations completedProgress: 668 iterations completedProgress: 669 iterations completedProgress: 670 iterations completedProgress: 671 iterations completedProgress: 672 iterations completedProgress: 673 iterations completedProgress: 674 iterations completedProgress: 675 iterations completedProgress: 676 iterations completedProgress: 677 iterations completedProgress: 678 iterations completedProgress: 679 iterations completedProgress: 680 iterations completedProgress: 681 iterations completedProgress: 682 iterations completedProgress: 683 iterations completedProgress: 684 iterations completedProgress: 685 iterations completedProgress: 686 iterations completedProgress: 687 iterations completedProgress: 688 iterations completedProgress: 689 iterations completedProgress: 690 iterations completedProgress: 691 iterations completedProgress: 692 iterations completedProgress: 693 iterations completedProgress: 694 iterations completedProgress: 695 iterations completedProgress: 696 iterations completedProgress: 697 iterations completedProgress: 698 iterations completedProgress: 699 iterations completedProgress: 700 iterations completedProgress: 701 iterations completedProgress: 702 iterations completedProgress: 703 iterations completedProgress: 704 iterations completedProgress: 705 iterations completedProgress: 706 iterations completedProgress: 707 iterations completedProgress: 708 iterations completedProgress: 709 iterations completedProgress: 710 iterations completedProgress: 711 iterations completedProgress: 712 iterations completedProgress: 713 iterations completedProgress: 714 iterations completedProgress: 715 iterations completedProgress: 716 iterations completedProgress: 717 iterations completedProgress: 718 iterations completedProgress: 719 iterations completedProgress: 720 iterations completedProgress: 721 iterations completedProgress: 722 iterations completedProgress: 723 iterations completedProgress: 724 iterations completedProgress: 725 iterations completedProgress: 726 iterations completedProgress: 727 iterations completedProgress: 728 iterations completedProgress: 729 iterations completedProgress: 730 iterations completedProgress: 731 iterations completedProgress: 732 iterations completedProgress: 733 iterations completedProgress: 734 iterations completedProgress: 735 iterations completedProgress: 736 iterations completedProgress: 737 iterations completedProgress: 738 iterations completedProgress: 739 iterations completedProgress: 740 iterations completedProgress: 741 iterations completedProgress: 742 iterations completedProgress: 743 iterations completedProgress: 744 iterations completedProgress: 745 iterations completedProgress: 746 iterations completedProgress: 747 iterations completedProgress: 748 iterations completedProgress: 749 iterations completedProgress: 750 iterations completedProgress: 751 iterations completedProgress: 752 iterations completedProgress: 753 iterations completedProgress: 754 iterations completedProgress: 755 iterations completedProgress: 756 iterations completedProgress: 757 iterations completedProgress: 758 iterations completedProgress: 759 iterations completedProgress: 760 iterations completedProgress: 761 iterations completedProgress: 762 iterations completedProgress: 763 iterations completedProgress: 764 iterations completedProgress: 765 iterations completedProgress: 766 iterations completedProgress: 767 iterations completedProgress: 768 iterations completedProgress: 769 iterations completedProgress: 770 iterations completedProgress: 771 iterations completedProgress: 772 iterations completedProgress: 773 iterations completedProgress: 774 iterations completedProgress: 775 iterations completedProgress: 776 iterations completedProgress: 777 iterations completedProgress: 778 iterations completedProgress: 779 iterations completedProgress: 780 iterations completedProgress: 781 iterations completedProgress: 782 iterations completedProgress: 783 iterations completedProgress: 784 iterations completedProgress: 785 iterations completedProgress: 786 iterations completedProgress: 787 iterations completedProgress: 788 iterations completedProgress: 789 iterations completedProgress: 790 iterations completedProgress: 791 iterations completedProgress: 792 iterations completedProgress: 793 iterations completedProgress: 794 iterations completedProgress: 795 iterations completedProgress: 796 iterations completedProgress: 797 iterations completedProgress: 798 iterations completedProgress: 799 iterations completedProgress: 800 iterations completedProgress: 801 iterations completedProgress: 802 iterations completedProgress: 803 iterations completedProgress: 804 iterations completedProgress: 805 iterations completedProgress: 806 iterations completedProgress: 807 iterations completedProgress: 808 iterations completedProgress: 809 iterations completedProgress: 810 iterations completedProgress: 811 iterations completedProgress: 812 iterations completedProgress: 813 iterations completedProgress: 814 iterations completedProgress: 815 iterations completedProgress: 816 iterations completedProgress: 817 iterations completedProgress: 818 iterations completedProgress: 819 iterations completedProgress: 820 iterations completedProgress: 821 iterations completedProgress: 822 iterations completedProgress: 823 iterations completedProgress: 824 iterations completedProgress: 825 iterations completedProgress: 826 iterations completedProgress: 827 iterations completedProgress: 828 iterations completedProgress: 829 iterations completedProgress: 830 iterations completedProgress: 831 iterations completedProgress: 832 iterations completedProgress: 833 iterations completedProgress: 834 iterations completedProgress: 835 iterations completedProgress: 836 iterations completedProgress: 837 iterations completedProgress: 838 iterations completedProgress: 839 iterations completedProgress: 840 iterations completedProgress: 841 iterations completedProgress: 842 iterations completedProgress: 843 iterations completedProgress: 844 iterations completedProgress: 845 iterations completedProgress: 846 iterations completedProgress: 847 iterations completedProgress: 848 iterations completedProgress: 849 iterations completedProgress: 850 iterations completedProgress: 851 iterations completedProgress: 852 iterations completedProgress: 853 iterations completedProgress: 854 iterations completedProgress: 855 iterations completedProgress: 856 iterations completedProgress: 857 iterations completedProgress: 858 iterations completedProgress: 859 iterations completedProgress: 860 iterations completedProgress: 861 iterations completedProgress: 862 iterations completedProgress: 863 iterations completedProgress: 864 iterations completedProgress: 865 iterations completedProgress: 866 iterations completedProgress: 867 iterations completedProgress: 868 iterations completedProgress: 869 iterations completedProgress: 870 iterations completedProgress: 871 iterations completedProgress: 872 iterations completedProgress: 873 iterations completedProgress: 874 iterations completedProgress: 875 iterations completedProgress: 876 iterations completedProgress: 877 iterations completedProgress: 878 iterations completedProgress: 879 iterations completedProgress: 880 iterations completedProgress: 881 iterations completedProgress: 882 iterations completedProgress: 883 iterations completedProgress: 884 iterations completedProgress: 885 iterations completedProgress: 886 iterations completedProgress: 887 iterations completedProgress: 888 iterations completedProgress: 889 iterations completedProgress: 890 iterations completedProgress: 891 iterations completedProgress: 892 iterations completedProgress: 893 iterations completedProgress: 894 iterations completedProgress: 895 iterations completedProgress: 896 iterations completedProgress: 897 iterations completedProgress: 898 iterations completedProgress: 899 iterations completedProgress: 900 iterations completedProgress: 901 iterations completedProgress: 902 iterations completedProgress: 903 iterations completedProgress: 904 iterations completedProgress: 905 iterations completedProgress: 906 iterations completedProgress: 907 iterations completedProgress: 908 iterations completedProgress: 909 iterations completedProgress: 910 iterations completedProgress: 911 iterations completedProgress: 912 iterations completedProgress: 913 iterations completedProgress: 914 iterations completedProgress: 915 iterations completedProgress: 916 iterations completedProgress: 917 iterations completedProgress: 918 iterations completedProgress: 919 iterations completedProgress: 920 iterations completedProgress: 921 iterations completedProgress: 922 iterations completedProgress: 923 iterations completedProgress: 924 iterations completedProgress: 925 iterations completedProgress: 926 iterations completedProgress: 927 iterations completedProgress: 928 iterations completedProgress: 929 iterations completedProgress: 930 iterations completedProgress: 931 iterations completedProgress: 932 iterations completedProgress: 933 iterations completedProgress: 934 iterations completedProgress: 935 iterations completedProgress: 936 iterations completedProgress: 937 iterations completedProgress: 938 iterations completedProgress: 939 iterations completedProgress: 940 iterations completedProgress: 941 iterations completedProgress: 942 iterations completedProgress: 943 iterations completedProgress: 944 iterations completedProgress: 945 iterations completedProgress: 946 iterations completedProgress: 947 iterations completedProgress: 948 iterations completedProgress: 949 iterations completedProgress: 950 iterations completedProgress: 951 iterations completedProgress: 952 iterations completedProgress: 953 iterations completedProgress: 954 iterations completedProgress: 955 iterations completedProgress: 956 iterations completedProgress: 957 iterations completedProgress: 958 iterations completedProgress: 959 iterations completedProgress: 960 iterations completedProgress: 961 iterations completedProgress: 962 iterations completedProgress: 963 iterations completedProgress: 964 iterations completedProgress: 965 iterations completedProgress: 966 iterations completedProgress: 967 iterations completedProgress: 968 iterations completedProgress: 969 iterations completedProgress: 970 iterations completedProgress: 971 iterations completedProgress: 972 iterations completedProgress: 973 iterations completedProgress: 974 iterations completedProgress: 975 iterations completedProgress: 976 iterations completedProgress: 977 iterations completedProgress: 978 iterations completedProgress: 979 iterations completedProgress: 980 iterations completedProgress: 981 iterations completedProgress: 982 iterations completedProgress: 983 iterations completedProgress: 984 iterations completedProgress: 985 iterations completedProgress: 986 iterations completedProgress: 987 iterations completedProgress: 988 iterations completedProgress: 989 iterations completedProgress: 990 iterations completedProgress: 991 iterations completedProgress: 992 iterations completedProgress: 993 iterations completedProgress: 994 iterations completedProgress: 995 iterations completedProgress: 996 iterations completedProgress: 997 iterations completedProgress: 998 iterations completedProgress: 999 iterations completedProgress: 1000 iterations completed</code></pre>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="what-is-stacked-ensambled.html#cb440-1" tabindex="-1"></a><span class="co"># Calculate mean RMSPE for the ensemble with all four models</span></span>
<span id="cb440-2"><a href="what-is-stacked-ensambled.html#cb440-2" tabindex="-1"></a>mean_rmspe_ensemble_four <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_ensemble_four)</span>
<span id="cb440-3"><a href="what-is-stacked-ensambled.html#cb440-3" tabindex="-1"></a></span>
<span id="cb440-4"><a href="what-is-stacked-ensambled.html#cb440-4" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb440-5"><a href="what-is-stacked-ensambled.html#cb440-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE of Stacked Ensemble with All Four Models:&quot;</span>, mean_rmspe_ensemble_four))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE of Stacked Ensemble with All Four Models: 0.33885977131557&quot;</code></pre>
<p>So we do see a better rmspe probably due to having more base models. so lets look at the covariance matrix of the base models to see if they are correlated</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="what-is-stacked-ensambled.html#cb442-1" tabindex="-1"></a><span class="co"># Initialize the matrix to accumulate correlations</span></span>
<span id="cb442-2"><a href="what-is-stacked-ensambled.html#cb442-2" tabindex="-1"></a>cor_matrix_sum <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb442-3"><a href="what-is-stacked-ensambled.html#cb442-3" tabindex="-1"></a></span>
<span id="cb442-4"><a href="what-is-stacked-ensambled.html#cb442-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb442-5"><a href="what-is-stacked-ensambled.html#cb442-5" tabindex="-1"></a>     <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb442-6"><a href="what-is-stacked-ensambled.html#cb442-6" tabindex="-1"></a>  </span>
<span id="cb442-7"><a href="what-is-stacked-ensambled.html#cb442-7" tabindex="-1"></a>  <span class="co"># Bootstrapping</span></span>
<span id="cb442-8"><a href="what-is-stacked-ensambled.html#cb442-8" tabindex="-1"></a>  train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb442-9"><a href="what-is-stacked-ensambled.html#cb442-9" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb442-10"><a href="what-is-stacked-ensambled.html#cb442-10" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb442-11"><a href="what-is-stacked-ensambled.html#cb442-11" tabindex="-1"></a>  </span>
<span id="cb442-12"><a href="what-is-stacked-ensambled.html#cb442-12" tabindex="-1"></a>  <span class="co"># Re-train the original models on bootstrapped training data</span></span>
<span id="cb442-13"><a href="what-is-stacked-ensambled.html#cb442-13" tabindex="-1"></a>  lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb442-14"><a href="what-is-stacked-ensambled.html#cb442-14" tabindex="-1"></a>  rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb442-15"><a href="what-is-stacked-ensambled.html#cb442-15" tabindex="-1"></a>  </span>
<span id="cb442-16"><a href="what-is-stacked-ensambled.html#cb442-16" tabindex="-1"></a>  <span class="co"># Train both GBM models on the bootstrapped training data</span></span>
<span id="cb442-17"><a href="what-is-stacked-ensambled.html#cb442-17" tabindex="-1"></a>  base_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">n.trees =</span> <span class="dv">100</span>, <span class="at">interaction.depth =</span> <span class="dv">1</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb442-18"><a href="what-is-stacked-ensambled.html#cb442-18" tabindex="-1"></a>  tuned_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb442-19"><a href="what-is-stacked-ensambled.html#cb442-19" tabindex="-1"></a>                       <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees, </span>
<span id="cb442-20"><a href="what-is-stacked-ensambled.html#cb442-20" tabindex="-1"></a>                       <span class="at">shrinkage =</span> best_params<span class="sc">$</span>shrinkage, </span>
<span id="cb442-21"><a href="what-is-stacked-ensambled.html#cb442-21" tabindex="-1"></a>                       <span class="at">interaction.depth =</span> best_params<span class="sc">$</span>interaction.depth, </span>
<span id="cb442-22"><a href="what-is-stacked-ensambled.html#cb442-22" tabindex="-1"></a>                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb442-23"><a href="what-is-stacked-ensambled.html#cb442-23" tabindex="-1"></a>  </span>
<span id="cb442-24"><a href="what-is-stacked-ensambled.html#cb442-24" tabindex="-1"></a>  <span class="co"># Generate predictions on the bootstrapped test set</span></span>
<span id="cb442-25"><a href="what-is-stacked-ensambled.html#cb442-25" tabindex="-1"></a>  lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_mod, test_data)</span>
<span id="cb442-26"><a href="what-is-stacked-ensambled.html#cb442-26" tabindex="-1"></a>  rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_mod, test_data)</span>
<span id="cb442-27"><a href="what-is-stacked-ensambled.html#cb442-27" tabindex="-1"></a>  base_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(base_gbm_mod, test_data, <span class="at">n.trees =</span> <span class="dv">100</span>)</span>
<span id="cb442-28"><a href="what-is-stacked-ensambled.html#cb442-28" tabindex="-1"></a>  tuned_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(tuned_gbm_mod, test_data, <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees)</span>
<span id="cb442-29"><a href="what-is-stacked-ensambled.html#cb442-29" tabindex="-1"></a>  </span>
<span id="cb442-30"><a href="what-is-stacked-ensambled.html#cb442-30" tabindex="-1"></a>  <span class="co"># Combine predictions into a data frame</span></span>
<span id="cb442-31"><a href="what-is-stacked-ensambled.html#cb442-31" tabindex="-1"></a>  preds_four <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, base_gbm_pred, tuned_gbm_pred)</span>
<span id="cb442-32"><a href="what-is-stacked-ensambled.html#cb442-32" tabindex="-1"></a>  </span>
<span id="cb442-33"><a href="what-is-stacked-ensambled.html#cb442-33" tabindex="-1"></a>  <span class="co"># Calculate the correlation matrix for the current iteration</span></span>
<span id="cb442-34"><a href="what-is-stacked-ensambled.html#cb442-34" tabindex="-1"></a>  cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(preds_four)</span>
<span id="cb442-35"><a href="what-is-stacked-ensambled.html#cb442-35" tabindex="-1"></a>  </span>
<span id="cb442-36"><a href="what-is-stacked-ensambled.html#cb442-36" tabindex="-1"></a>  <span class="co"># Accumulate the correlation matrices</span></span>
<span id="cb442-37"><a href="what-is-stacked-ensambled.html#cb442-37" tabindex="-1"></a>  cor_matrix_sum <span class="ot">&lt;-</span> cor_matrix_sum <span class="sc">+</span> cor_matrix</span>
<span id="cb442-38"><a href="what-is-stacked-ensambled.html#cb442-38" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Progress: 1 iterations completedProgress: 2 iterations completedProgress: 3 iterations completedProgress: 4 iterations completedProgress: 5 iterations completedProgress: 6 iterations completedProgress: 7 iterations completedProgress: 8 iterations completedProgress: 9 iterations completedProgress: 10 iterations completedProgress: 11 iterations completedProgress: 12 iterations completedProgress: 13 iterations completedProgress: 14 iterations completedProgress: 15 iterations completedProgress: 16 iterations completedProgress: 17 iterations completedProgress: 18 iterations completedProgress: 19 iterations completedProgress: 20 iterations completedProgress: 21 iterations completedProgress: 22 iterations completedProgress: 23 iterations completedProgress: 24 iterations completedProgress: 25 iterations completedProgress: 26 iterations completedProgress: 27 iterations completedProgress: 28 iterations completedProgress: 29 iterations completedProgress: 30 iterations completedProgress: 31 iterations completedProgress: 32 iterations completedProgress: 33 iterations completedProgress: 34 iterations completedProgress: 35 iterations completedProgress: 36 iterations completedProgress: 37 iterations completedProgress: 38 iterations completedProgress: 39 iterations completedProgress: 40 iterations completedProgress: 41 iterations completedProgress: 42 iterations completedProgress: 43 iterations completedProgress: 44 iterations completedProgress: 45 iterations completedProgress: 46 iterations completedProgress: 47 iterations completedProgress: 48 iterations completedProgress: 49 iterations completedProgress: 50 iterations completedProgress: 51 iterations completedProgress: 52 iterations completedProgress: 53 iterations completedProgress: 54 iterations completedProgress: 55 iterations completedProgress: 56 iterations completedProgress: 57 iterations completedProgress: 58 iterations completedProgress: 59 iterations completedProgress: 60 iterations completedProgress: 61 iterations completedProgress: 62 iterations completedProgress: 63 iterations completedProgress: 64 iterations completedProgress: 65 iterations completedProgress: 66 iterations completedProgress: 67 iterations completedProgress: 68 iterations completedProgress: 69 iterations completedProgress: 70 iterations completedProgress: 71 iterations completedProgress: 72 iterations completedProgress: 73 iterations completedProgress: 74 iterations completedProgress: 75 iterations completedProgress: 76 iterations completedProgress: 77 iterations completedProgress: 78 iterations completedProgress: 79 iterations completedProgress: 80 iterations completedProgress: 81 iterations completedProgress: 82 iterations completedProgress: 83 iterations completedProgress: 84 iterations completedProgress: 85 iterations completedProgress: 86 iterations completedProgress: 87 iterations completedProgress: 88 iterations completedProgress: 89 iterations completedProgress: 90 iterations completedProgress: 91 iterations completedProgress: 92 iterations completedProgress: 93 iterations completedProgress: 94 iterations completedProgress: 95 iterations completedProgress: 96 iterations completedProgress: 97 iterations completedProgress: 98 iterations completedProgress: 99 iterations completedProgress: 100 iterations completedProgress: 101 iterations completedProgress: 102 iterations completedProgress: 103 iterations completedProgress: 104 iterations completedProgress: 105 iterations completedProgress: 106 iterations completedProgress: 107 iterations completedProgress: 108 iterations completedProgress: 109 iterations completedProgress: 110 iterations completedProgress: 111 iterations completedProgress: 112 iterations completedProgress: 113 iterations completedProgress: 114 iterations completedProgress: 115 iterations completedProgress: 116 iterations completedProgress: 117 iterations completedProgress: 118 iterations completedProgress: 119 iterations completedProgress: 120 iterations completedProgress: 121 iterations completedProgress: 122 iterations completedProgress: 123 iterations completedProgress: 124 iterations completedProgress: 125 iterations completedProgress: 126 iterations completedProgress: 127 iterations completedProgress: 128 iterations completedProgress: 129 iterations completedProgress: 130 iterations completedProgress: 131 iterations completedProgress: 132 iterations completedProgress: 133 iterations completedProgress: 134 iterations completedProgress: 135 iterations completedProgress: 136 iterations completedProgress: 137 iterations completedProgress: 138 iterations completedProgress: 139 iterations completedProgress: 140 iterations completedProgress: 141 iterations completedProgress: 142 iterations completedProgress: 143 iterations completedProgress: 144 iterations completedProgress: 145 iterations completedProgress: 146 iterations completedProgress: 147 iterations completedProgress: 148 iterations completedProgress: 149 iterations completedProgress: 150 iterations completedProgress: 151 iterations completedProgress: 152 iterations completedProgress: 153 iterations completedProgress: 154 iterations completedProgress: 155 iterations completedProgress: 156 iterations completedProgress: 157 iterations completedProgress: 158 iterations completedProgress: 159 iterations completedProgress: 160 iterations completedProgress: 161 iterations completedProgress: 162 iterations completedProgress: 163 iterations completedProgress: 164 iterations completedProgress: 165 iterations completedProgress: 166 iterations completedProgress: 167 iterations completedProgress: 168 iterations completedProgress: 169 iterations completedProgress: 170 iterations completedProgress: 171 iterations completedProgress: 172 iterations completedProgress: 173 iterations completedProgress: 174 iterations completedProgress: 175 iterations completedProgress: 176 iterations completedProgress: 177 iterations completedProgress: 178 iterations completedProgress: 179 iterations completedProgress: 180 iterations completedProgress: 181 iterations completedProgress: 182 iterations completedProgress: 183 iterations completedProgress: 184 iterations completedProgress: 185 iterations completedProgress: 186 iterations completedProgress: 187 iterations completedProgress: 188 iterations completedProgress: 189 iterations completedProgress: 190 iterations completedProgress: 191 iterations completedProgress: 192 iterations completedProgress: 193 iterations completedProgress: 194 iterations completedProgress: 195 iterations completedProgress: 196 iterations completedProgress: 197 iterations completedProgress: 198 iterations completedProgress: 199 iterations completedProgress: 200 iterations completedProgress: 201 iterations completedProgress: 202 iterations completedProgress: 203 iterations completedProgress: 204 iterations completedProgress: 205 iterations completedProgress: 206 iterations completedProgress: 207 iterations completedProgress: 208 iterations completedProgress: 209 iterations completedProgress: 210 iterations completedProgress: 211 iterations completedProgress: 212 iterations completedProgress: 213 iterations completedProgress: 214 iterations completedProgress: 215 iterations completedProgress: 216 iterations completedProgress: 217 iterations completedProgress: 218 iterations completedProgress: 219 iterations completedProgress: 220 iterations completedProgress: 221 iterations completedProgress: 222 iterations completedProgress: 223 iterations completedProgress: 224 iterations completedProgress: 225 iterations completedProgress: 226 iterations completedProgress: 227 iterations completedProgress: 228 iterations completedProgress: 229 iterations completedProgress: 230 iterations completedProgress: 231 iterations completedProgress: 232 iterations completedProgress: 233 iterations completedProgress: 234 iterations completedProgress: 235 iterations completedProgress: 236 iterations completedProgress: 237 iterations completedProgress: 238 iterations completedProgress: 239 iterations completedProgress: 240 iterations completedProgress: 241 iterations completedProgress: 242 iterations completedProgress: 243 iterations completedProgress: 244 iterations completedProgress: 245 iterations completedProgress: 246 iterations completedProgress: 247 iterations completedProgress: 248 iterations completedProgress: 249 iterations completedProgress: 250 iterations completedProgress: 251 iterations completedProgress: 252 iterations completedProgress: 253 iterations completedProgress: 254 iterations completedProgress: 255 iterations completedProgress: 256 iterations completedProgress: 257 iterations completedProgress: 258 iterations completedProgress: 259 iterations completedProgress: 260 iterations completedProgress: 261 iterations completedProgress: 262 iterations completedProgress: 263 iterations completedProgress: 264 iterations completedProgress: 265 iterations completedProgress: 266 iterations completedProgress: 267 iterations completedProgress: 268 iterations completedProgress: 269 iterations completedProgress: 270 iterations completedProgress: 271 iterations completedProgress: 272 iterations completedProgress: 273 iterations completedProgress: 274 iterations completedProgress: 275 iterations completedProgress: 276 iterations completedProgress: 277 iterations completedProgress: 278 iterations completedProgress: 279 iterations completedProgress: 280 iterations completedProgress: 281 iterations completedProgress: 282 iterations completedProgress: 283 iterations completedProgress: 284 iterations completedProgress: 285 iterations completedProgress: 286 iterations completedProgress: 287 iterations completedProgress: 288 iterations completedProgress: 289 iterations completedProgress: 290 iterations completedProgress: 291 iterations completedProgress: 292 iterations completedProgress: 293 iterations completedProgress: 294 iterations completedProgress: 295 iterations completedProgress: 296 iterations completedProgress: 297 iterations completedProgress: 298 iterations completedProgress: 299 iterations completedProgress: 300 iterations completedProgress: 301 iterations completedProgress: 302 iterations completedProgress: 303 iterations completedProgress: 304 iterations completedProgress: 305 iterations completedProgress: 306 iterations completedProgress: 307 iterations completedProgress: 308 iterations completedProgress: 309 iterations completedProgress: 310 iterations completedProgress: 311 iterations completedProgress: 312 iterations completedProgress: 313 iterations completedProgress: 314 iterations completedProgress: 315 iterations completedProgress: 316 iterations completedProgress: 317 iterations completedProgress: 318 iterations completedProgress: 319 iterations completedProgress: 320 iterations completedProgress: 321 iterations completedProgress: 322 iterations completedProgress: 323 iterations completedProgress: 324 iterations completedProgress: 325 iterations completedProgress: 326 iterations completedProgress: 327 iterations completedProgress: 328 iterations completedProgress: 329 iterations completedProgress: 330 iterations completedProgress: 331 iterations completedProgress: 332 iterations completedProgress: 333 iterations completedProgress: 334 iterations completedProgress: 335 iterations completedProgress: 336 iterations completedProgress: 337 iterations completedProgress: 338 iterations completedProgress: 339 iterations completedProgress: 340 iterations completedProgress: 341 iterations completedProgress: 342 iterations completedProgress: 343 iterations completedProgress: 344 iterations completedProgress: 345 iterations completedProgress: 346 iterations completedProgress: 347 iterations completedProgress: 348 iterations completedProgress: 349 iterations completedProgress: 350 iterations completedProgress: 351 iterations completedProgress: 352 iterations completedProgress: 353 iterations completedProgress: 354 iterations completedProgress: 355 iterations completedProgress: 356 iterations completedProgress: 357 iterations completedProgress: 358 iterations completedProgress: 359 iterations completedProgress: 360 iterations completedProgress: 361 iterations completedProgress: 362 iterations completedProgress: 363 iterations completedProgress: 364 iterations completedProgress: 365 iterations completedProgress: 366 iterations completedProgress: 367 iterations completedProgress: 368 iterations completedProgress: 369 iterations completedProgress: 370 iterations completedProgress: 371 iterations completedProgress: 372 iterations completedProgress: 373 iterations completedProgress: 374 iterations completedProgress: 375 iterations completedProgress: 376 iterations completedProgress: 377 iterations completedProgress: 378 iterations completedProgress: 379 iterations completedProgress: 380 iterations completedProgress: 381 iterations completedProgress: 382 iterations completedProgress: 383 iterations completedProgress: 384 iterations completedProgress: 385 iterations completedProgress: 386 iterations completedProgress: 387 iterations completedProgress: 388 iterations completedProgress: 389 iterations completedProgress: 390 iterations completedProgress: 391 iterations completedProgress: 392 iterations completedProgress: 393 iterations completedProgress: 394 iterations completedProgress: 395 iterations completedProgress: 396 iterations completedProgress: 397 iterations completedProgress: 398 iterations completedProgress: 399 iterations completedProgress: 400 iterations completedProgress: 401 iterations completedProgress: 402 iterations completedProgress: 403 iterations completedProgress: 404 iterations completedProgress: 405 iterations completedProgress: 406 iterations completedProgress: 407 iterations completedProgress: 408 iterations completedProgress: 409 iterations completedProgress: 410 iterations completedProgress: 411 iterations completedProgress: 412 iterations completedProgress: 413 iterations completedProgress: 414 iterations completedProgress: 415 iterations completedProgress: 416 iterations completedProgress: 417 iterations completedProgress: 418 iterations completedProgress: 419 iterations completedProgress: 420 iterations completedProgress: 421 iterations completedProgress: 422 iterations completedProgress: 423 iterations completedProgress: 424 iterations completedProgress: 425 iterations completedProgress: 426 iterations completedProgress: 427 iterations completedProgress: 428 iterations completedProgress: 429 iterations completedProgress: 430 iterations completedProgress: 431 iterations completedProgress: 432 iterations completedProgress: 433 iterations completedProgress: 434 iterations completedProgress: 435 iterations completedProgress: 436 iterations completedProgress: 437 iterations completedProgress: 438 iterations completedProgress: 439 iterations completedProgress: 440 iterations completedProgress: 441 iterations completedProgress: 442 iterations completedProgress: 443 iterations completedProgress: 444 iterations completedProgress: 445 iterations completedProgress: 446 iterations completedProgress: 447 iterations completedProgress: 448 iterations completedProgress: 449 iterations completedProgress: 450 iterations completedProgress: 451 iterations completedProgress: 452 iterations completedProgress: 453 iterations completedProgress: 454 iterations completedProgress: 455 iterations completedProgress: 456 iterations completedProgress: 457 iterations completedProgress: 458 iterations completedProgress: 459 iterations completedProgress: 460 iterations completedProgress: 461 iterations completedProgress: 462 iterations completedProgress: 463 iterations completedProgress: 464 iterations completedProgress: 465 iterations completedProgress: 466 iterations completedProgress: 467 iterations completedProgress: 468 iterations completedProgress: 469 iterations completedProgress: 470 iterations completedProgress: 471 iterations completedProgress: 472 iterations completedProgress: 473 iterations completedProgress: 474 iterations completedProgress: 475 iterations completedProgress: 476 iterations completedProgress: 477 iterations completedProgress: 478 iterations completedProgress: 479 iterations completedProgress: 480 iterations completedProgress: 481 iterations completedProgress: 482 iterations completedProgress: 483 iterations completedProgress: 484 iterations completedProgress: 485 iterations completedProgress: 486 iterations completedProgress: 487 iterations completedProgress: 488 iterations completedProgress: 489 iterations completedProgress: 490 iterations completedProgress: 491 iterations completedProgress: 492 iterations completedProgress: 493 iterations completedProgress: 494 iterations completedProgress: 495 iterations completedProgress: 496 iterations completedProgress: 497 iterations completedProgress: 498 iterations completedProgress: 499 iterations completedProgress: 500 iterations completedProgress: 501 iterations completedProgress: 502 iterations completedProgress: 503 iterations completedProgress: 504 iterations completedProgress: 505 iterations completedProgress: 506 iterations completedProgress: 507 iterations completedProgress: 508 iterations completedProgress: 509 iterations completedProgress: 510 iterations completedProgress: 511 iterations completedProgress: 512 iterations completedProgress: 513 iterations completedProgress: 514 iterations completedProgress: 515 iterations completedProgress: 516 iterations completedProgress: 517 iterations completedProgress: 518 iterations completedProgress: 519 iterations completedProgress: 520 iterations completedProgress: 521 iterations completedProgress: 522 iterations completedProgress: 523 iterations completedProgress: 524 iterations completedProgress: 525 iterations completedProgress: 526 iterations completedProgress: 527 iterations completedProgress: 528 iterations completedProgress: 529 iterations completedProgress: 530 iterations completedProgress: 531 iterations completedProgress: 532 iterations completedProgress: 533 iterations completedProgress: 534 iterations completedProgress: 535 iterations completedProgress: 536 iterations completedProgress: 537 iterations completedProgress: 538 iterations completedProgress: 539 iterations completedProgress: 540 iterations completedProgress: 541 iterations completedProgress: 542 iterations completedProgress: 543 iterations completedProgress: 544 iterations completedProgress: 545 iterations completedProgress: 546 iterations completedProgress: 547 iterations completedProgress: 548 iterations completedProgress: 549 iterations completedProgress: 550 iterations completedProgress: 551 iterations completedProgress: 552 iterations completedProgress: 553 iterations completedProgress: 554 iterations completedProgress: 555 iterations completedProgress: 556 iterations completedProgress: 557 iterations completedProgress: 558 iterations completedProgress: 559 iterations completedProgress: 560 iterations completedProgress: 561 iterations completedProgress: 562 iterations completedProgress: 563 iterations completedProgress: 564 iterations completedProgress: 565 iterations completedProgress: 566 iterations completedProgress: 567 iterations completedProgress: 568 iterations completedProgress: 569 iterations completedProgress: 570 iterations completedProgress: 571 iterations completedProgress: 572 iterations completedProgress: 573 iterations completedProgress: 574 iterations completedProgress: 575 iterations completedProgress: 576 iterations completedProgress: 577 iterations completedProgress: 578 iterations completedProgress: 579 iterations completedProgress: 580 iterations completedProgress: 581 iterations completedProgress: 582 iterations completedProgress: 583 iterations completedProgress: 584 iterations completedProgress: 585 iterations completedProgress: 586 iterations completedProgress: 587 iterations completedProgress: 588 iterations completedProgress: 589 iterations completedProgress: 590 iterations completedProgress: 591 iterations completedProgress: 592 iterations completedProgress: 593 iterations completedProgress: 594 iterations completedProgress: 595 iterations completedProgress: 596 iterations completedProgress: 597 iterations completedProgress: 598 iterations completedProgress: 599 iterations completedProgress: 600 iterations completedProgress: 601 iterations completedProgress: 602 iterations completedProgress: 603 iterations completedProgress: 604 iterations completedProgress: 605 iterations completedProgress: 606 iterations completedProgress: 607 iterations completedProgress: 608 iterations completedProgress: 609 iterations completedProgress: 610 iterations completedProgress: 611 iterations completedProgress: 612 iterations completedProgress: 613 iterations completedProgress: 614 iterations completedProgress: 615 iterations completedProgress: 616 iterations completedProgress: 617 iterations completedProgress: 618 iterations completedProgress: 619 iterations completedProgress: 620 iterations completedProgress: 621 iterations completedProgress: 622 iterations completedProgress: 623 iterations completedProgress: 624 iterations completedProgress: 625 iterations completedProgress: 626 iterations completedProgress: 627 iterations completedProgress: 628 iterations completedProgress: 629 iterations completedProgress: 630 iterations completedProgress: 631 iterations completedProgress: 632 iterations completedProgress: 633 iterations completedProgress: 634 iterations completedProgress: 635 iterations completedProgress: 636 iterations completedProgress: 637 iterations completedProgress: 638 iterations completedProgress: 639 iterations completedProgress: 640 iterations completedProgress: 641 iterations completedProgress: 642 iterations completedProgress: 643 iterations completedProgress: 644 iterations completedProgress: 645 iterations completedProgress: 646 iterations completedProgress: 647 iterations completedProgress: 648 iterations completedProgress: 649 iterations completedProgress: 650 iterations completedProgress: 651 iterations completedProgress: 652 iterations completedProgress: 653 iterations completedProgress: 654 iterations completedProgress: 655 iterations completedProgress: 656 iterations completedProgress: 657 iterations completedProgress: 658 iterations completedProgress: 659 iterations completedProgress: 660 iterations completedProgress: 661 iterations completedProgress: 662 iterations completedProgress: 663 iterations completedProgress: 664 iterations completedProgress: 665 iterations completedProgress: 666 iterations completedProgress: 667 iterations completedProgress: 668 iterations completedProgress: 669 iterations completedProgress: 670 iterations completedProgress: 671 iterations completedProgress: 672 iterations completedProgress: 673 iterations completedProgress: 674 iterations completedProgress: 675 iterations completedProgress: 676 iterations completedProgress: 677 iterations completedProgress: 678 iterations completedProgress: 679 iterations completedProgress: 680 iterations completedProgress: 681 iterations completedProgress: 682 iterations completedProgress: 683 iterations completedProgress: 684 iterations completedProgress: 685 iterations completedProgress: 686 iterations completedProgress: 687 iterations completedProgress: 688 iterations completedProgress: 689 iterations completedProgress: 690 iterations completedProgress: 691 iterations completedProgress: 692 iterations completedProgress: 693 iterations completedProgress: 694 iterations completedProgress: 695 iterations completedProgress: 696 iterations completedProgress: 697 iterations completedProgress: 698 iterations completedProgress: 699 iterations completedProgress: 700 iterations completedProgress: 701 iterations completedProgress: 702 iterations completedProgress: 703 iterations completedProgress: 704 iterations completedProgress: 705 iterations completedProgress: 706 iterations completedProgress: 707 iterations completedProgress: 708 iterations completedProgress: 709 iterations completedProgress: 710 iterations completedProgress: 711 iterations completedProgress: 712 iterations completedProgress: 713 iterations completedProgress: 714 iterations completedProgress: 715 iterations completedProgress: 716 iterations completedProgress: 717 iterations completedProgress: 718 iterations completedProgress: 719 iterations completedProgress: 720 iterations completedProgress: 721 iterations completedProgress: 722 iterations completedProgress: 723 iterations completedProgress: 724 iterations completedProgress: 725 iterations completedProgress: 726 iterations completedProgress: 727 iterations completedProgress: 728 iterations completedProgress: 729 iterations completedProgress: 730 iterations completedProgress: 731 iterations completedProgress: 732 iterations completedProgress: 733 iterations completedProgress: 734 iterations completedProgress: 735 iterations completedProgress: 736 iterations completedProgress: 737 iterations completedProgress: 738 iterations completedProgress: 739 iterations completedProgress: 740 iterations completedProgress: 741 iterations completedProgress: 742 iterations completedProgress: 743 iterations completedProgress: 744 iterations completedProgress: 745 iterations completedProgress: 746 iterations completedProgress: 747 iterations completedProgress: 748 iterations completedProgress: 749 iterations completedProgress: 750 iterations completedProgress: 751 iterations completedProgress: 752 iterations completedProgress: 753 iterations completedProgress: 754 iterations completedProgress: 755 iterations completedProgress: 756 iterations completedProgress: 757 iterations completedProgress: 758 iterations completedProgress: 759 iterations completedProgress: 760 iterations completedProgress: 761 iterations completedProgress: 762 iterations completedProgress: 763 iterations completedProgress: 764 iterations completedProgress: 765 iterations completedProgress: 766 iterations completedProgress: 767 iterations completedProgress: 768 iterations completedProgress: 769 iterations completedProgress: 770 iterations completedProgress: 771 iterations completedProgress: 772 iterations completedProgress: 773 iterations completedProgress: 774 iterations completedProgress: 775 iterations completedProgress: 776 iterations completedProgress: 777 iterations completedProgress: 778 iterations completedProgress: 779 iterations completedProgress: 780 iterations completedProgress: 781 iterations completedProgress: 782 iterations completedProgress: 783 iterations completedProgress: 784 iterations completedProgress: 785 iterations completedProgress: 786 iterations completedProgress: 787 iterations completedProgress: 788 iterations completedProgress: 789 iterations completedProgress: 790 iterations completedProgress: 791 iterations completedProgress: 792 iterations completedProgress: 793 iterations completedProgress: 794 iterations completedProgress: 795 iterations completedProgress: 796 iterations completedProgress: 797 iterations completedProgress: 798 iterations completedProgress: 799 iterations completedProgress: 800 iterations completedProgress: 801 iterations completedProgress: 802 iterations completedProgress: 803 iterations completedProgress: 804 iterations completedProgress: 805 iterations completedProgress: 806 iterations completedProgress: 807 iterations completedProgress: 808 iterations completedProgress: 809 iterations completedProgress: 810 iterations completedProgress: 811 iterations completedProgress: 812 iterations completedProgress: 813 iterations completedProgress: 814 iterations completedProgress: 815 iterations completedProgress: 816 iterations completedProgress: 817 iterations completedProgress: 818 iterations completedProgress: 819 iterations completedProgress: 820 iterations completedProgress: 821 iterations completedProgress: 822 iterations completedProgress: 823 iterations completedProgress: 824 iterations completedProgress: 825 iterations completedProgress: 826 iterations completedProgress: 827 iterations completedProgress: 828 iterations completedProgress: 829 iterations completedProgress: 830 iterations completedProgress: 831 iterations completedProgress: 832 iterations completedProgress: 833 iterations completedProgress: 834 iterations completedProgress: 835 iterations completedProgress: 836 iterations completedProgress: 837 iterations completedProgress: 838 iterations completedProgress: 839 iterations completedProgress: 840 iterations completedProgress: 841 iterations completedProgress: 842 iterations completedProgress: 843 iterations completedProgress: 844 iterations completedProgress: 845 iterations completedProgress: 846 iterations completedProgress: 847 iterations completedProgress: 848 iterations completedProgress: 849 iterations completedProgress: 850 iterations completedProgress: 851 iterations completedProgress: 852 iterations completedProgress: 853 iterations completedProgress: 854 iterations completedProgress: 855 iterations completedProgress: 856 iterations completedProgress: 857 iterations completedProgress: 858 iterations completedProgress: 859 iterations completedProgress: 860 iterations completedProgress: 861 iterations completedProgress: 862 iterations completedProgress: 863 iterations completedProgress: 864 iterations completedProgress: 865 iterations completedProgress: 866 iterations completedProgress: 867 iterations completedProgress: 868 iterations completedProgress: 869 iterations completedProgress: 870 iterations completedProgress: 871 iterations completedProgress: 872 iterations completedProgress: 873 iterations completedProgress: 874 iterations completedProgress: 875 iterations completedProgress: 876 iterations completedProgress: 877 iterations completedProgress: 878 iterations completedProgress: 879 iterations completedProgress: 880 iterations completedProgress: 881 iterations completedProgress: 882 iterations completedProgress: 883 iterations completedProgress: 884 iterations completedProgress: 885 iterations completedProgress: 886 iterations completedProgress: 887 iterations completedProgress: 888 iterations completedProgress: 889 iterations completedProgress: 890 iterations completedProgress: 891 iterations completedProgress: 892 iterations completedProgress: 893 iterations completedProgress: 894 iterations completedProgress: 895 iterations completedProgress: 896 iterations completedProgress: 897 iterations completedProgress: 898 iterations completedProgress: 899 iterations completedProgress: 900 iterations completedProgress: 901 iterations completedProgress: 902 iterations completedProgress: 903 iterations completedProgress: 904 iterations completedProgress: 905 iterations completedProgress: 906 iterations completedProgress: 907 iterations completedProgress: 908 iterations completedProgress: 909 iterations completedProgress: 910 iterations completedProgress: 911 iterations completedProgress: 912 iterations completedProgress: 913 iterations completedProgress: 914 iterations completedProgress: 915 iterations completedProgress: 916 iterations completedProgress: 917 iterations completedProgress: 918 iterations completedProgress: 919 iterations completedProgress: 920 iterations completedProgress: 921 iterations completedProgress: 922 iterations completedProgress: 923 iterations completedProgress: 924 iterations completedProgress: 925 iterations completedProgress: 926 iterations completedProgress: 927 iterations completedProgress: 928 iterations completedProgress: 929 iterations completedProgress: 930 iterations completedProgress: 931 iterations completedProgress: 932 iterations completedProgress: 933 iterations completedProgress: 934 iterations completedProgress: 935 iterations completedProgress: 936 iterations completedProgress: 937 iterations completedProgress: 938 iterations completedProgress: 939 iterations completedProgress: 940 iterations completedProgress: 941 iterations completedProgress: 942 iterations completedProgress: 943 iterations completedProgress: 944 iterations completedProgress: 945 iterations completedProgress: 946 iterations completedProgress: 947 iterations completedProgress: 948 iterations completedProgress: 949 iterations completedProgress: 950 iterations completedProgress: 951 iterations completedProgress: 952 iterations completedProgress: 953 iterations completedProgress: 954 iterations completedProgress: 955 iterations completedProgress: 956 iterations completedProgress: 957 iterations completedProgress: 958 iterations completedProgress: 959 iterations completedProgress: 960 iterations completedProgress: 961 iterations completedProgress: 962 iterations completedProgress: 963 iterations completedProgress: 964 iterations completedProgress: 965 iterations completedProgress: 966 iterations completedProgress: 967 iterations completedProgress: 968 iterations completedProgress: 969 iterations completedProgress: 970 iterations completedProgress: 971 iterations completedProgress: 972 iterations completedProgress: 973 iterations completedProgress: 974 iterations completedProgress: 975 iterations completedProgress: 976 iterations completedProgress: 977 iterations completedProgress: 978 iterations completedProgress: 979 iterations completedProgress: 980 iterations completedProgress: 981 iterations completedProgress: 982 iterations completedProgress: 983 iterations completedProgress: 984 iterations completedProgress: 985 iterations completedProgress: 986 iterations completedProgress: 987 iterations completedProgress: 988 iterations completedProgress: 989 iterations completedProgress: 990 iterations completedProgress: 991 iterations completedProgress: 992 iterations completedProgress: 993 iterations completedProgress: 994 iterations completedProgress: 995 iterations completedProgress: 996 iterations completedProgress: 997 iterations completedProgress: 998 iterations completedProgress: 999 iterations completedProgress: 1000 iterations completed</code></pre>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="what-is-stacked-ensambled.html#cb444-1" tabindex="-1"></a><span class="co"># Average the correlation matrix over the 1000 iterations</span></span>
<span id="cb444-2"><a href="what-is-stacked-ensambled.html#cb444-2" tabindex="-1"></a>avg_cor_matrix <span class="ot">&lt;-</span> cor_matrix_sum <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb444-3"><a href="what-is-stacked-ensambled.html#cb444-3" tabindex="-1"></a></span>
<span id="cb444-4"><a href="what-is-stacked-ensambled.html#cb444-4" tabindex="-1"></a><span class="co"># Print the averaged correlation matrix</span></span>
<span id="cb444-5"><a href="what-is-stacked-ensambled.html#cb444-5" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Averaged Correlation Matrix:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Averaged Correlation Matrix:&quot;</code></pre>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="what-is-stacked-ensambled.html#cb446-1" tabindex="-1"></a><span class="fu">print</span>(avg_cor_matrix)</span></code></pre></div>
<pre><code>##                  lm_pred   rf_pred base_gbm_pred tuned_gbm_pred
## lm_pred        1.0000000 0.9010177     0.8883905      0.8928445
## rf_pred        0.9010177 1.0000000     0.9759521      0.9770704
## base_gbm_pred  0.8883905 0.9759521     1.0000000      0.9693381
## tuned_gbm_pred 0.8928445 0.9770704     0.9693381      1.0000000</code></pre>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="what-is-stacked-ensambled.html#cb448-1" tabindex="-1"></a><span class="co"># Calculate mean RMSPE for the ensemble with all four models</span></span>
<span id="cb448-2"><a href="what-is-stacked-ensambled.html#cb448-2" tabindex="-1"></a>mean_rmspe_ensemble_four <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_ensemble_four)</span>
<span id="cb448-3"><a href="what-is-stacked-ensambled.html#cb448-3" tabindex="-1"></a></span>
<span id="cb448-4"><a href="what-is-stacked-ensambled.html#cb448-4" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb448-5"><a href="what-is-stacked-ensambled.html#cb448-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE of Stacked Ensemble with All Four Models:&quot;</span>, mean_rmspe_ensemble_four))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE of Stacked Ensemble with All Four Models: 0.33885977131557&quot;</code></pre>
<p>now what if i use another model that is less correlated to the other models</p>
<p>the first knn3 setup to make sure it works</p>
<p>It needs to be knnreg… knn3 does not work for regression</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="what-is-stacked-ensambled.html#cb450-1" tabindex="-1"></a><span class="co"># Load the required package</span></span>
<span id="cb450-2"><a href="what-is-stacked-ensambled.html#cb450-2" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb450-3"><a href="what-is-stacked-ensambled.html#cb450-3" tabindex="-1"></a></span>
<span id="cb450-4"><a href="what-is-stacked-ensambled.html#cb450-4" tabindex="-1"></a><span class="co"># Sample data (assuming &#39;data&#39; is your dataset and &#39;medv&#39; is the target)</span></span>
<span id="cb450-5"><a href="what-is-stacked-ensambled.html#cb450-5" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb450-6"><a href="what-is-stacked-ensambled.html#cb450-6" tabindex="-1"></a>train <span class="ot">&lt;-</span> data[ind, ]</span>
<span id="cb450-7"><a href="what-is-stacked-ensambled.html#cb450-7" tabindex="-1"></a>test <span class="ot">&lt;-</span> data[<span class="sc">-</span>ind, ]</span>
<span id="cb450-8"><a href="what-is-stacked-ensambled.html#cb450-8" tabindex="-1"></a></span>
<span id="cb450-9"><a href="what-is-stacked-ensambled.html#cb450-9" tabindex="-1"></a><span class="co"># Fit the KNN regression model</span></span>
<span id="cb450-10"><a href="what-is-stacked-ensambled.html#cb450-10" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">knnreg</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb450-11"><a href="what-is-stacked-ensambled.html#cb450-11" tabindex="-1"></a></span>
<span id="cb450-12"><a href="what-is-stacked-ensambled.html#cb450-12" tabindex="-1"></a><span class="co"># Predict on the test set</span></span>
<span id="cb450-13"><a href="what-is-stacked-ensambled.html#cb450-13" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, test)</span>
<span id="cb450-14"><a href="what-is-stacked-ensambled.html#cb450-14" tabindex="-1"></a></span>
<span id="cb450-15"><a href="what-is-stacked-ensambled.html#cb450-15" tabindex="-1"></a><span class="co"># Calculate RMSE</span></span>
<span id="cb450-16"><a href="what-is-stacked-ensambled.html#cb450-16" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predictions <span class="sc">-</span> test<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb450-17"><a href="what-is-stacked-ensambled.html#cb450-17" tabindex="-1"></a><span class="fu">print</span>(rmse)</span></code></pre></div>
<pre><code>## [1] 0.4574346</code></pre>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="what-is-stacked-ensambled.html#cb452-1" tabindex="-1"></a><span class="co"># Define the grid for k values</span></span>
<span id="cb452-2"><a href="what-is-stacked-ensambled.html#cb452-2" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb452-3"><a href="what-is-stacked-ensambled.html#cb452-3" tabindex="-1"></a></span>
<span id="cb452-4"><a href="what-is-stacked-ensambled.html#cb452-4" tabindex="-1"></a><span class="co"># Initialize a vector to store the average RMSPE for each k</span></span>
<span id="cb452-5"><a href="what-is-stacked-ensambled.html#cb452-5" tabindex="-1"></a>rmspe_k <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k_values))</span>
<span id="cb452-6"><a href="what-is-stacked-ensambled.html#cb452-6" tabindex="-1"></a></span>
<span id="cb452-7"><a href="what-is-stacked-ensambled.html#cb452-7" tabindex="-1"></a><span class="co"># Loop over each k value</span></span>
<span id="cb452-8"><a href="what-is-stacked-ensambled.html#cb452-8" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(k_values)) {</span>
<span id="cb452-9"><a href="what-is-stacked-ensambled.html#cb452-9" tabindex="-1"></a>  k <span class="ot">&lt;-</span> k_values[j]</span>
<span id="cb452-10"><a href="what-is-stacked-ensambled.html#cb452-10" tabindex="-1"></a>  </span>
<span id="cb452-11"><a href="what-is-stacked-ensambled.html#cb452-11" tabindex="-1"></a>  <span class="co"># Initialize a vector to store RMSPE for each bootstrap run</span></span>
<span id="cb452-12"><a href="what-is-stacked-ensambled.html#cb452-12" tabindex="-1"></a>  rmspe_vals <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb452-13"><a href="what-is-stacked-ensambled.html#cb452-13" tabindex="-1"></a>  </span>
<span id="cb452-14"><a href="what-is-stacked-ensambled.html#cb452-14" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb452-15"><a href="what-is-stacked-ensambled.html#cb452-15" tabindex="-1"></a>    <span class="co"># Bootstrapping</span></span>
<span id="cb452-16"><a href="what-is-stacked-ensambled.html#cb452-16" tabindex="-1"></a>    train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb452-17"><a href="what-is-stacked-ensambled.html#cb452-17" tabindex="-1"></a>    train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb452-18"><a href="what-is-stacked-ensambled.html#cb452-18" tabindex="-1"></a>    test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb452-19"><a href="what-is-stacked-ensambled.html#cb452-19" tabindex="-1"></a>    </span>
<span id="cb452-20"><a href="what-is-stacked-ensambled.html#cb452-20" tabindex="-1"></a>    <span class="co"># Train KNN model with current k using knn3</span></span>
<span id="cb452-21"><a href="what-is-stacked-ensambled.html#cb452-21" tabindex="-1"></a>    knn_mod <span class="ot">&lt;-</span> <span class="fu">knnreg</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">k =</span> k)</span>
<span id="cb452-22"><a href="what-is-stacked-ensambled.html#cb452-22" tabindex="-1"></a></span>
<span id="cb452-23"><a href="what-is-stacked-ensambled.html#cb452-23" tabindex="-1"></a>    </span>
<span id="cb452-24"><a href="what-is-stacked-ensambled.html#cb452-24" tabindex="-1"></a>    </span>
<span id="cb452-25"><a href="what-is-stacked-ensambled.html#cb452-25" tabindex="-1"></a>    <span class="co">#THIS IS HUGE</span></span>
<span id="cb452-26"><a href="what-is-stacked-ensambled.html#cb452-26" tabindex="-1"></a>    test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_mod, test_data)</span>
<span id="cb452-27"><a href="what-is-stacked-ensambled.html#cb452-27" tabindex="-1"></a></span>
<span id="cb452-28"><a href="what-is-stacked-ensambled.html#cb452-28" tabindex="-1"></a>    rmspe_vals[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb452-29"><a href="what-is-stacked-ensambled.html#cb452-29" tabindex="-1"></a>  }</span>
<span id="cb452-30"><a href="what-is-stacked-ensambled.html#cb452-30" tabindex="-1"></a>  </span>
<span id="cb452-31"><a href="what-is-stacked-ensambled.html#cb452-31" tabindex="-1"></a>  <span class="co"># Store the average RMSPE for this k</span></span>
<span id="cb452-32"><a href="what-is-stacked-ensambled.html#cb452-32" tabindex="-1"></a>  rmspe_k[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_vals)</span>
<span id="cb452-33"><a href="what-is-stacked-ensambled.html#cb452-33" tabindex="-1"></a>  </span>
<span id="cb452-34"><a href="what-is-stacked-ensambled.html#cb452-34" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, j, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(k_values), <span class="st">&quot;k =&quot;</span>, k, <span class="st">&quot;Average RMSPE:&quot;</span>, rmspe_k[j])</span>
<span id="cb452-35"><a href="what-is-stacked-ensambled.html#cb452-35" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Progress: 1 / 10 k = 1 Average RMSPE: 0.4949892Progress: 2 / 10 k = 2 Average RMSPE: 0.4302938Progress: 3 / 10 k = 3 Average RMSPE: 0.4310261Progress: 4 / 10 k = 4 Average RMSPE: 0.4354456Progress: 5 / 10 k = 5 Average RMSPE: 0.4509741Progress: 6 / 10 k = 6 Average RMSPE: 0.470581Progress: 7 / 10 k = 7 Average RMSPE: 0.4740371Progress: 8 / 10 k = 8 Average RMSPE: 0.4878077Progress: 9 / 10 k = 9 Average RMSPE: 0.496359Progress: 10 / 10 k = 10 Average RMSPE: 0.500633</code></pre>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="what-is-stacked-ensambled.html#cb454-1" tabindex="-1"></a><span class="co"># Identify the best k with the lowest average RMSPE</span></span>
<span id="cb454-2"><a href="what-is-stacked-ensambled.html#cb454-2" tabindex="-1"></a>best_k <span class="ot">&lt;-</span> k_values[<span class="fu">which.min</span>(rmspe_k)]</span>
<span id="cb454-3"><a href="what-is-stacked-ensambled.html#cb454-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Best k value is:&quot;</span>, best_k, <span class="st">&quot;with an average RMSPE of:&quot;</span>, <span class="fu">min</span>(rmspe_k)))</span></code></pre></div>
<pre><code>## [1] &quot;Best k value is: 2 with an average RMSPE of: 0.43029384999798&quot;</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="what-is-stacked-ensambled.html#cb456-1" tabindex="-1"></a><span class="co"># Initialize a vector to store RMSPE results for the best k</span></span>
<span id="cb456-2"><a href="what-is-stacked-ensambled.html#cb456-2" tabindex="-1"></a>rmspe_best_k <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb456-3"><a href="what-is-stacked-ensambled.html#cb456-3" tabindex="-1"></a></span>
<span id="cb456-4"><a href="what-is-stacked-ensambled.html#cb456-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb456-5"><a href="what-is-stacked-ensambled.html#cb456-5" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb456-6"><a href="what-is-stacked-ensambled.html#cb456-6" tabindex="-1"></a>  </span>
<span id="cb456-7"><a href="what-is-stacked-ensambled.html#cb456-7" tabindex="-1"></a>  <span class="co"># Bootstrapping</span></span>
<span id="cb456-8"><a href="what-is-stacked-ensambled.html#cb456-8" tabindex="-1"></a>  train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb456-9"><a href="what-is-stacked-ensambled.html#cb456-9" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb456-10"><a href="what-is-stacked-ensambled.html#cb456-10" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb456-11"><a href="what-is-stacked-ensambled.html#cb456-11" tabindex="-1"></a>  </span>
<span id="cb456-12"><a href="what-is-stacked-ensambled.html#cb456-12" tabindex="-1"></a>  <span class="co"># Train KNN model with the best k using knn3</span></span>
<span id="cb456-13"><a href="what-is-stacked-ensambled.html#cb456-13" tabindex="-1"></a>  knn_mod <span class="ot">&lt;-</span> <span class="fu">knnreg</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">k =</span> best_k)</span>
<span id="cb456-14"><a href="what-is-stacked-ensambled.html#cb456-14" tabindex="-1"></a>  </span>
<span id="cb456-15"><a href="what-is-stacked-ensambled.html#cb456-15" tabindex="-1"></a>  <span class="co"># Predict on the test set</span></span>
<span id="cb456-16"><a href="what-is-stacked-ensambled.html#cb456-16" tabindex="-1"></a>  test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_mod, test_data)</span>
<span id="cb456-17"><a href="what-is-stacked-ensambled.html#cb456-17" tabindex="-1"></a>  <span class="co"># Calculate RMSPE for the best k</span></span>
<span id="cb456-18"><a href="what-is-stacked-ensambled.html#cb456-18" tabindex="-1"></a>  rmspe_best_k[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb456-19"><a href="what-is-stacked-ensambled.html#cb456-19" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Progress: 1 iterations completedProgress: 2 iterations completedProgress: 3 iterations completedProgress: 4 iterations completedProgress: 5 iterations completedProgress: 6 iterations completedProgress: 7 iterations completedProgress: 8 iterations completedProgress: 9 iterations completedProgress: 10 iterations completedProgress: 11 iterations completedProgress: 12 iterations completedProgress: 13 iterations completedProgress: 14 iterations completedProgress: 15 iterations completedProgress: 16 iterations completedProgress: 17 iterations completedProgress: 18 iterations completedProgress: 19 iterations completedProgress: 20 iterations completedProgress: 21 iterations completedProgress: 22 iterations completedProgress: 23 iterations completedProgress: 24 iterations completedProgress: 25 iterations completedProgress: 26 iterations completedProgress: 27 iterations completedProgress: 28 iterations completedProgress: 29 iterations completedProgress: 30 iterations completedProgress: 31 iterations completedProgress: 32 iterations completedProgress: 33 iterations completedProgress: 34 iterations completedProgress: 35 iterations completedProgress: 36 iterations completedProgress: 37 iterations completedProgress: 38 iterations completedProgress: 39 iterations completedProgress: 40 iterations completedProgress: 41 iterations completedProgress: 42 iterations completedProgress: 43 iterations completedProgress: 44 iterations completedProgress: 45 iterations completedProgress: 46 iterations completedProgress: 47 iterations completedProgress: 48 iterations completedProgress: 49 iterations completedProgress: 50 iterations completedProgress: 51 iterations completedProgress: 52 iterations completedProgress: 53 iterations completedProgress: 54 iterations completedProgress: 55 iterations completedProgress: 56 iterations completedProgress: 57 iterations completedProgress: 58 iterations completedProgress: 59 iterations completedProgress: 60 iterations completedProgress: 61 iterations completedProgress: 62 iterations completedProgress: 63 iterations completedProgress: 64 iterations completedProgress: 65 iterations completedProgress: 66 iterations completedProgress: 67 iterations completedProgress: 68 iterations completedProgress: 69 iterations completedProgress: 70 iterations completedProgress: 71 iterations completedProgress: 72 iterations completedProgress: 73 iterations completedProgress: 74 iterations completedProgress: 75 iterations completedProgress: 76 iterations completedProgress: 77 iterations completedProgress: 78 iterations completedProgress: 79 iterations completedProgress: 80 iterations completedProgress: 81 iterations completedProgress: 82 iterations completedProgress: 83 iterations completedProgress: 84 iterations completedProgress: 85 iterations completedProgress: 86 iterations completedProgress: 87 iterations completedProgress: 88 iterations completedProgress: 89 iterations completedProgress: 90 iterations completedProgress: 91 iterations completedProgress: 92 iterations completedProgress: 93 iterations completedProgress: 94 iterations completedProgress: 95 iterations completedProgress: 96 iterations completedProgress: 97 iterations completedProgress: 98 iterations completedProgress: 99 iterations completedProgress: 100 iterations completed</code></pre>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="what-is-stacked-ensambled.html#cb458-1" tabindex="-1"></a><span class="co"># Calculate the mean RMSPE for the best k</span></span>
<span id="cb458-2"><a href="what-is-stacked-ensambled.html#cb458-2" tabindex="-1"></a>mean_rmspe_best_k <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_best_k)</span>
<span id="cb458-3"><a href="what-is-stacked-ensambled.html#cb458-3" tabindex="-1"></a></span>
<span id="cb458-4"><a href="what-is-stacked-ensambled.html#cb458-4" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb458-5"><a href="what-is-stacked-ensambled.html#cb458-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE with best k:&quot;</span>, mean_rmspe_best_k))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE with best k: 0.438212386417574&quot;</code></pre>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="what-is-stacked-ensambled.html#cb460-1" tabindex="-1"></a><span class="co"># Initialize storage for RMSPE results</span></span>
<span id="cb460-2"><a href="what-is-stacked-ensambled.html#cb460-2" tabindex="-1"></a>rmspe_ensemble_knn <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb460-3"><a href="what-is-stacked-ensambled.html#cb460-3" tabindex="-1"></a></span>
<span id="cb460-4"><a href="what-is-stacked-ensambled.html#cb460-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb460-5"><a href="what-is-stacked-ensambled.html#cb460-5" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb460-6"><a href="what-is-stacked-ensambled.html#cb460-6" tabindex="-1"></a>  </span>
<span id="cb460-7"><a href="what-is-stacked-ensambled.html#cb460-7" tabindex="-1"></a>  <span class="co"># Bootstrapping</span></span>
<span id="cb460-8"><a href="what-is-stacked-ensambled.html#cb460-8" tabindex="-1"></a>  train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb460-9"><a href="what-is-stacked-ensambled.html#cb460-9" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb460-10"><a href="what-is-stacked-ensambled.html#cb460-10" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb460-11"><a href="what-is-stacked-ensambled.html#cb460-11" tabindex="-1"></a>  </span>
<span id="cb460-12"><a href="what-is-stacked-ensambled.html#cb460-12" tabindex="-1"></a>  <span class="co"># Re-train the original models on bootstrapped training data</span></span>
<span id="cb460-13"><a href="what-is-stacked-ensambled.html#cb460-13" tabindex="-1"></a>  lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb460-14"><a href="what-is-stacked-ensambled.html#cb460-14" tabindex="-1"></a>  rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb460-15"><a href="what-is-stacked-ensambled.html#cb460-15" tabindex="-1"></a>  tuned_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb460-16"><a href="what-is-stacked-ensambled.html#cb460-16" tabindex="-1"></a>                       <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees, </span>
<span id="cb460-17"><a href="what-is-stacked-ensambled.html#cb460-17" tabindex="-1"></a>                       <span class="at">shrinkage =</span> best_params<span class="sc">$</span>shrinkage, </span>
<span id="cb460-18"><a href="what-is-stacked-ensambled.html#cb460-18" tabindex="-1"></a>                       <span class="at">interaction.depth =</span> best_params<span class="sc">$</span>interaction.depth, </span>
<span id="cb460-19"><a href="what-is-stacked-ensambled.html#cb460-19" tabindex="-1"></a>                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb460-20"><a href="what-is-stacked-ensambled.html#cb460-20" tabindex="-1"></a>  </span>
<span id="cb460-21"><a href="what-is-stacked-ensambled.html#cb460-21" tabindex="-1"></a>  <span class="co"># Train the KNN model with the best k</span></span>
<span id="cb460-22"><a href="what-is-stacked-ensambled.html#cb460-22" tabindex="-1"></a>  knn_mod <span class="ot">&lt;-</span> <span class="fu">knnreg</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">k =</span> best_k)</span>
<span id="cb460-23"><a href="what-is-stacked-ensambled.html#cb460-23" tabindex="-1"></a>  </span>
<span id="cb460-24"><a href="what-is-stacked-ensambled.html#cb460-24" tabindex="-1"></a>  <span class="co"># Generate predictions on the bootstrapped test set</span></span>
<span id="cb460-25"><a href="what-is-stacked-ensambled.html#cb460-25" tabindex="-1"></a>  lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_mod, test_data)</span>
<span id="cb460-26"><a href="what-is-stacked-ensambled.html#cb460-26" tabindex="-1"></a>  rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_mod, test_data)</span>
<span id="cb460-27"><a href="what-is-stacked-ensambled.html#cb460-27" tabindex="-1"></a>  tuned_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(tuned_gbm_mod, test_data, <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees)</span>
<span id="cb460-28"><a href="what-is-stacked-ensambled.html#cb460-28" tabindex="-1"></a>  knn_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_mod, test_data)</span>
<span id="cb460-29"><a href="what-is-stacked-ensambled.html#cb460-29" tabindex="-1"></a>  <span class="co"># Combine predictions into a data frame</span></span>
<span id="cb460-30"><a href="what-is-stacked-ensambled.html#cb460-30" tabindex="-1"></a>  preds_four <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, tuned_gbm_pred, knn_pred)</span>
<span id="cb460-31"><a href="what-is-stacked-ensambled.html#cb460-31" tabindex="-1"></a>  </span>
<span id="cb460-32"><a href="what-is-stacked-ensambled.html#cb460-32" tabindex="-1"></a>  <span class="co"># Train and evaluate the stacked ensemble with KNN replacing base GBM</span></span>
<span id="cb460-33"><a href="what-is-stacked-ensambled.html#cb460-33" tabindex="-1"></a>  meta_four <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds_four, <span class="at">medv =</span> test_data<span class="sc">$</span>medv))</span>
<span id="cb460-34"><a href="what-is-stacked-ensambled.html#cb460-34" tabindex="-1"></a>  meta_four_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_four, preds_four)</span>
<span id="cb460-35"><a href="what-is-stacked-ensambled.html#cb460-35" tabindex="-1"></a>  </span>
<span id="cb460-36"><a href="what-is-stacked-ensambled.html#cb460-36" tabindex="-1"></a>  <span class="co"># Calculate RMSPE for the ensemble with KNN replacing base GBM</span></span>
<span id="cb460-37"><a href="what-is-stacked-ensambled.html#cb460-37" tabindex="-1"></a>  rmspe_ensemble_knn[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_four_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb460-38"><a href="what-is-stacked-ensambled.html#cb460-38" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Progress: 1 iterations completedProgress: 2 iterations completedProgress: 3 iterations completedProgress: 4 iterations completedProgress: 5 iterations completedProgress: 6 iterations completedProgress: 7 iterations completedProgress: 8 iterations completedProgress: 9 iterations completedProgress: 10 iterations completedProgress: 11 iterations completedProgress: 12 iterations completedProgress: 13 iterations completedProgress: 14 iterations completedProgress: 15 iterations completedProgress: 16 iterations completedProgress: 17 iterations completedProgress: 18 iterations completedProgress: 19 iterations completedProgress: 20 iterations completedProgress: 21 iterations completedProgress: 22 iterations completedProgress: 23 iterations completedProgress: 24 iterations completedProgress: 25 iterations completedProgress: 26 iterations completedProgress: 27 iterations completedProgress: 28 iterations completedProgress: 29 iterations completedProgress: 30 iterations completedProgress: 31 iterations completedProgress: 32 iterations completedProgress: 33 iterations completedProgress: 34 iterations completedProgress: 35 iterations completedProgress: 36 iterations completedProgress: 37 iterations completedProgress: 38 iterations completedProgress: 39 iterations completedProgress: 40 iterations completedProgress: 41 iterations completedProgress: 42 iterations completedProgress: 43 iterations completedProgress: 44 iterations completedProgress: 45 iterations completedProgress: 46 iterations completedProgress: 47 iterations completedProgress: 48 iterations completedProgress: 49 iterations completedProgress: 50 iterations completedProgress: 51 iterations completedProgress: 52 iterations completedProgress: 53 iterations completedProgress: 54 iterations completedProgress: 55 iterations completedProgress: 56 iterations completedProgress: 57 iterations completedProgress: 58 iterations completedProgress: 59 iterations completedProgress: 60 iterations completedProgress: 61 iterations completedProgress: 62 iterations completedProgress: 63 iterations completedProgress: 64 iterations completedProgress: 65 iterations completedProgress: 66 iterations completedProgress: 67 iterations completedProgress: 68 iterations completedProgress: 69 iterations completedProgress: 70 iterations completedProgress: 71 iterations completedProgress: 72 iterations completedProgress: 73 iterations completedProgress: 74 iterations completedProgress: 75 iterations completedProgress: 76 iterations completedProgress: 77 iterations completedProgress: 78 iterations completedProgress: 79 iterations completedProgress: 80 iterations completedProgress: 81 iterations completedProgress: 82 iterations completedProgress: 83 iterations completedProgress: 84 iterations completedProgress: 85 iterations completedProgress: 86 iterations completedProgress: 87 iterations completedProgress: 88 iterations completedProgress: 89 iterations completedProgress: 90 iterations completedProgress: 91 iterations completedProgress: 92 iterations completedProgress: 93 iterations completedProgress: 94 iterations completedProgress: 95 iterations completedProgress: 96 iterations completedProgress: 97 iterations completedProgress: 98 iterations completedProgress: 99 iterations completedProgress: 100 iterations completedProgress: 101 iterations completedProgress: 102 iterations completedProgress: 103 iterations completedProgress: 104 iterations completedProgress: 105 iterations completedProgress: 106 iterations completedProgress: 107 iterations completedProgress: 108 iterations completedProgress: 109 iterations completedProgress: 110 iterations completedProgress: 111 iterations completedProgress: 112 iterations completedProgress: 113 iterations completedProgress: 114 iterations completedProgress: 115 iterations completedProgress: 116 iterations completedProgress: 117 iterations completedProgress: 118 iterations completedProgress: 119 iterations completedProgress: 120 iterations completedProgress: 121 iterations completedProgress: 122 iterations completedProgress: 123 iterations completedProgress: 124 iterations completedProgress: 125 iterations completedProgress: 126 iterations completedProgress: 127 iterations completedProgress: 128 iterations completedProgress: 129 iterations completedProgress: 130 iterations completedProgress: 131 iterations completedProgress: 132 iterations completedProgress: 133 iterations completedProgress: 134 iterations completedProgress: 135 iterations completedProgress: 136 iterations completedProgress: 137 iterations completedProgress: 138 iterations completedProgress: 139 iterations completedProgress: 140 iterations completedProgress: 141 iterations completedProgress: 142 iterations completedProgress: 143 iterations completedProgress: 144 iterations completedProgress: 145 iterations completedProgress: 146 iterations completedProgress: 147 iterations completedProgress: 148 iterations completedProgress: 149 iterations completedProgress: 150 iterations completedProgress: 151 iterations completedProgress: 152 iterations completedProgress: 153 iterations completedProgress: 154 iterations completedProgress: 155 iterations completedProgress: 156 iterations completedProgress: 157 iterations completedProgress: 158 iterations completedProgress: 159 iterations completedProgress: 160 iterations completedProgress: 161 iterations completedProgress: 162 iterations completedProgress: 163 iterations completedProgress: 164 iterations completedProgress: 165 iterations completedProgress: 166 iterations completedProgress: 167 iterations completedProgress: 168 iterations completedProgress: 169 iterations completedProgress: 170 iterations completedProgress: 171 iterations completedProgress: 172 iterations completedProgress: 173 iterations completedProgress: 174 iterations completedProgress: 175 iterations completedProgress: 176 iterations completedProgress: 177 iterations completedProgress: 178 iterations completedProgress: 179 iterations completedProgress: 180 iterations completedProgress: 181 iterations completedProgress: 182 iterations completedProgress: 183 iterations completedProgress: 184 iterations completedProgress: 185 iterations completedProgress: 186 iterations completedProgress: 187 iterations completedProgress: 188 iterations completedProgress: 189 iterations completedProgress: 190 iterations completedProgress: 191 iterations completedProgress: 192 iterations completedProgress: 193 iterations completedProgress: 194 iterations completedProgress: 195 iterations completedProgress: 196 iterations completedProgress: 197 iterations completedProgress: 198 iterations completedProgress: 199 iterations completedProgress: 200 iterations completedProgress: 201 iterations completedProgress: 202 iterations completedProgress: 203 iterations completedProgress: 204 iterations completedProgress: 205 iterations completedProgress: 206 iterations completedProgress: 207 iterations completedProgress: 208 iterations completedProgress: 209 iterations completedProgress: 210 iterations completedProgress: 211 iterations completedProgress: 212 iterations completedProgress: 213 iterations completedProgress: 214 iterations completedProgress: 215 iterations completedProgress: 216 iterations completedProgress: 217 iterations completedProgress: 218 iterations completedProgress: 219 iterations completedProgress: 220 iterations completedProgress: 221 iterations completedProgress: 222 iterations completedProgress: 223 iterations completedProgress: 224 iterations completedProgress: 225 iterations completedProgress: 226 iterations completedProgress: 227 iterations completedProgress: 228 iterations completedProgress: 229 iterations completedProgress: 230 iterations completedProgress: 231 iterations completedProgress: 232 iterations completedProgress: 233 iterations completedProgress: 234 iterations completedProgress: 235 iterations completedProgress: 236 iterations completedProgress: 237 iterations completedProgress: 238 iterations completedProgress: 239 iterations completedProgress: 240 iterations completedProgress: 241 iterations completedProgress: 242 iterations completedProgress: 243 iterations completedProgress: 244 iterations completedProgress: 245 iterations completedProgress: 246 iterations completedProgress: 247 iterations completedProgress: 248 iterations completedProgress: 249 iterations completedProgress: 250 iterations completedProgress: 251 iterations completedProgress: 252 iterations completedProgress: 253 iterations completedProgress: 254 iterations completedProgress: 255 iterations completedProgress: 256 iterations completedProgress: 257 iterations completedProgress: 258 iterations completedProgress: 259 iterations completedProgress: 260 iterations completedProgress: 261 iterations completedProgress: 262 iterations completedProgress: 263 iterations completedProgress: 264 iterations completedProgress: 265 iterations completedProgress: 266 iterations completedProgress: 267 iterations completedProgress: 268 iterations completedProgress: 269 iterations completedProgress: 270 iterations completedProgress: 271 iterations completedProgress: 272 iterations completedProgress: 273 iterations completedProgress: 274 iterations completedProgress: 275 iterations completedProgress: 276 iterations completedProgress: 277 iterations completedProgress: 278 iterations completedProgress: 279 iterations completedProgress: 280 iterations completedProgress: 281 iterations completedProgress: 282 iterations completedProgress: 283 iterations completedProgress: 284 iterations completedProgress: 285 iterations completedProgress: 286 iterations completedProgress: 287 iterations completedProgress: 288 iterations completedProgress: 289 iterations completedProgress: 290 iterations completedProgress: 291 iterations completedProgress: 292 iterations completedProgress: 293 iterations completedProgress: 294 iterations completedProgress: 295 iterations completedProgress: 296 iterations completedProgress: 297 iterations completedProgress: 298 iterations completedProgress: 299 iterations completedProgress: 300 iterations completedProgress: 301 iterations completedProgress: 302 iterations completedProgress: 303 iterations completedProgress: 304 iterations completedProgress: 305 iterations completedProgress: 306 iterations completedProgress: 307 iterations completedProgress: 308 iterations completedProgress: 309 iterations completedProgress: 310 iterations completedProgress: 311 iterations completedProgress: 312 iterations completedProgress: 313 iterations completedProgress: 314 iterations completedProgress: 315 iterations completedProgress: 316 iterations completedProgress: 317 iterations completedProgress: 318 iterations completedProgress: 319 iterations completedProgress: 320 iterations completedProgress: 321 iterations completedProgress: 322 iterations completedProgress: 323 iterations completedProgress: 324 iterations completedProgress: 325 iterations completedProgress: 326 iterations completedProgress: 327 iterations completedProgress: 328 iterations completedProgress: 329 iterations completedProgress: 330 iterations completedProgress: 331 iterations completedProgress: 332 iterations completedProgress: 333 iterations completedProgress: 334 iterations completedProgress: 335 iterations completedProgress: 336 iterations completedProgress: 337 iterations completedProgress: 338 iterations completedProgress: 339 iterations completedProgress: 340 iterations completedProgress: 341 iterations completedProgress: 342 iterations completedProgress: 343 iterations completedProgress: 344 iterations completedProgress: 345 iterations completedProgress: 346 iterations completedProgress: 347 iterations completedProgress: 348 iterations completedProgress: 349 iterations completedProgress: 350 iterations completedProgress: 351 iterations completedProgress: 352 iterations completedProgress: 353 iterations completedProgress: 354 iterations completedProgress: 355 iterations completedProgress: 356 iterations completedProgress: 357 iterations completedProgress: 358 iterations completedProgress: 359 iterations completedProgress: 360 iterations completedProgress: 361 iterations completedProgress: 362 iterations completedProgress: 363 iterations completedProgress: 364 iterations completedProgress: 365 iterations completedProgress: 366 iterations completedProgress: 367 iterations completedProgress: 368 iterations completedProgress: 369 iterations completedProgress: 370 iterations completedProgress: 371 iterations completedProgress: 372 iterations completedProgress: 373 iterations completedProgress: 374 iterations completedProgress: 375 iterations completedProgress: 376 iterations completedProgress: 377 iterations completedProgress: 378 iterations completedProgress: 379 iterations completedProgress: 380 iterations completedProgress: 381 iterations completedProgress: 382 iterations completedProgress: 383 iterations completedProgress: 384 iterations completedProgress: 385 iterations completedProgress: 386 iterations completedProgress: 387 iterations completedProgress: 388 iterations completedProgress: 389 iterations completedProgress: 390 iterations completedProgress: 391 iterations completedProgress: 392 iterations completedProgress: 393 iterations completedProgress: 394 iterations completedProgress: 395 iterations completedProgress: 396 iterations completedProgress: 397 iterations completedProgress: 398 iterations completedProgress: 399 iterations completedProgress: 400 iterations completedProgress: 401 iterations completedProgress: 402 iterations completedProgress: 403 iterations completedProgress: 404 iterations completedProgress: 405 iterations completedProgress: 406 iterations completedProgress: 407 iterations completedProgress: 408 iterations completedProgress: 409 iterations completedProgress: 410 iterations completedProgress: 411 iterations completedProgress: 412 iterations completedProgress: 413 iterations completedProgress: 414 iterations completedProgress: 415 iterations completedProgress: 416 iterations completedProgress: 417 iterations completedProgress: 418 iterations completedProgress: 419 iterations completedProgress: 420 iterations completedProgress: 421 iterations completedProgress: 422 iterations completedProgress: 423 iterations completedProgress: 424 iterations completedProgress: 425 iterations completedProgress: 426 iterations completedProgress: 427 iterations completedProgress: 428 iterations completedProgress: 429 iterations completedProgress: 430 iterations completedProgress: 431 iterations completedProgress: 432 iterations completedProgress: 433 iterations completedProgress: 434 iterations completedProgress: 435 iterations completedProgress: 436 iterations completedProgress: 437 iterations completedProgress: 438 iterations completedProgress: 439 iterations completedProgress: 440 iterations completedProgress: 441 iterations completedProgress: 442 iterations completedProgress: 443 iterations completedProgress: 444 iterations completedProgress: 445 iterations completedProgress: 446 iterations completedProgress: 447 iterations completedProgress: 448 iterations completedProgress: 449 iterations completedProgress: 450 iterations completedProgress: 451 iterations completedProgress: 452 iterations completedProgress: 453 iterations completedProgress: 454 iterations completedProgress: 455 iterations completedProgress: 456 iterations completedProgress: 457 iterations completedProgress: 458 iterations completedProgress: 459 iterations completedProgress: 460 iterations completedProgress: 461 iterations completedProgress: 462 iterations completedProgress: 463 iterations completedProgress: 464 iterations completedProgress: 465 iterations completedProgress: 466 iterations completedProgress: 467 iterations completedProgress: 468 iterations completedProgress: 469 iterations completedProgress: 470 iterations completedProgress: 471 iterations completedProgress: 472 iterations completedProgress: 473 iterations completedProgress: 474 iterations completedProgress: 475 iterations completedProgress: 476 iterations completedProgress: 477 iterations completedProgress: 478 iterations completedProgress: 479 iterations completedProgress: 480 iterations completedProgress: 481 iterations completedProgress: 482 iterations completedProgress: 483 iterations completedProgress: 484 iterations completedProgress: 485 iterations completedProgress: 486 iterations completedProgress: 487 iterations completedProgress: 488 iterations completedProgress: 489 iterations completedProgress: 490 iterations completedProgress: 491 iterations completedProgress: 492 iterations completedProgress: 493 iterations completedProgress: 494 iterations completedProgress: 495 iterations completedProgress: 496 iterations completedProgress: 497 iterations completedProgress: 498 iterations completedProgress: 499 iterations completedProgress: 500 iterations completedProgress: 501 iterations completedProgress: 502 iterations completedProgress: 503 iterations completedProgress: 504 iterations completedProgress: 505 iterations completedProgress: 506 iterations completedProgress: 507 iterations completedProgress: 508 iterations completedProgress: 509 iterations completedProgress: 510 iterations completedProgress: 511 iterations completedProgress: 512 iterations completedProgress: 513 iterations completedProgress: 514 iterations completedProgress: 515 iterations completedProgress: 516 iterations completedProgress: 517 iterations completedProgress: 518 iterations completedProgress: 519 iterations completedProgress: 520 iterations completedProgress: 521 iterations completedProgress: 522 iterations completedProgress: 523 iterations completedProgress: 524 iterations completedProgress: 525 iterations completedProgress: 526 iterations completedProgress: 527 iterations completedProgress: 528 iterations completedProgress: 529 iterations completedProgress: 530 iterations completedProgress: 531 iterations completedProgress: 532 iterations completedProgress: 533 iterations completedProgress: 534 iterations completedProgress: 535 iterations completedProgress: 536 iterations completedProgress: 537 iterations completedProgress: 538 iterations completedProgress: 539 iterations completedProgress: 540 iterations completedProgress: 541 iterations completedProgress: 542 iterations completedProgress: 543 iterations completedProgress: 544 iterations completedProgress: 545 iterations completedProgress: 546 iterations completedProgress: 547 iterations completedProgress: 548 iterations completedProgress: 549 iterations completedProgress: 550 iterations completedProgress: 551 iterations completedProgress: 552 iterations completedProgress: 553 iterations completedProgress: 554 iterations completedProgress: 555 iterations completedProgress: 556 iterations completedProgress: 557 iterations completedProgress: 558 iterations completedProgress: 559 iterations completedProgress: 560 iterations completedProgress: 561 iterations completedProgress: 562 iterations completedProgress: 563 iterations completedProgress: 564 iterations completedProgress: 565 iterations completedProgress: 566 iterations completedProgress: 567 iterations completedProgress: 568 iterations completedProgress: 569 iterations completedProgress: 570 iterations completedProgress: 571 iterations completedProgress: 572 iterations completedProgress: 573 iterations completedProgress: 574 iterations completedProgress: 575 iterations completedProgress: 576 iterations completedProgress: 577 iterations completedProgress: 578 iterations completedProgress: 579 iterations completedProgress: 580 iterations completedProgress: 581 iterations completedProgress: 582 iterations completedProgress: 583 iterations completedProgress: 584 iterations completedProgress: 585 iterations completedProgress: 586 iterations completedProgress: 587 iterations completedProgress: 588 iterations completedProgress: 589 iterations completedProgress: 590 iterations completedProgress: 591 iterations completedProgress: 592 iterations completedProgress: 593 iterations completedProgress: 594 iterations completedProgress: 595 iterations completedProgress: 596 iterations completedProgress: 597 iterations completedProgress: 598 iterations completedProgress: 599 iterations completedProgress: 600 iterations completedProgress: 601 iterations completedProgress: 602 iterations completedProgress: 603 iterations completedProgress: 604 iterations completedProgress: 605 iterations completedProgress: 606 iterations completedProgress: 607 iterations completedProgress: 608 iterations completedProgress: 609 iterations completedProgress: 610 iterations completedProgress: 611 iterations completedProgress: 612 iterations completedProgress: 613 iterations completedProgress: 614 iterations completedProgress: 615 iterations completedProgress: 616 iterations completedProgress: 617 iterations completedProgress: 618 iterations completedProgress: 619 iterations completedProgress: 620 iterations completedProgress: 621 iterations completedProgress: 622 iterations completedProgress: 623 iterations completedProgress: 624 iterations completedProgress: 625 iterations completedProgress: 626 iterations completedProgress: 627 iterations completedProgress: 628 iterations completedProgress: 629 iterations completedProgress: 630 iterations completedProgress: 631 iterations completedProgress: 632 iterations completedProgress: 633 iterations completedProgress: 634 iterations completedProgress: 635 iterations completedProgress: 636 iterations completedProgress: 637 iterations completedProgress: 638 iterations completedProgress: 639 iterations completedProgress: 640 iterations completedProgress: 641 iterations completedProgress: 642 iterations completedProgress: 643 iterations completedProgress: 644 iterations completedProgress: 645 iterations completedProgress: 646 iterations completedProgress: 647 iterations completedProgress: 648 iterations completedProgress: 649 iterations completedProgress: 650 iterations completedProgress: 651 iterations completedProgress: 652 iterations completedProgress: 653 iterations completedProgress: 654 iterations completedProgress: 655 iterations completedProgress: 656 iterations completedProgress: 657 iterations completedProgress: 658 iterations completedProgress: 659 iterations completedProgress: 660 iterations completedProgress: 661 iterations completedProgress: 662 iterations completedProgress: 663 iterations completedProgress: 664 iterations completedProgress: 665 iterations completedProgress: 666 iterations completedProgress: 667 iterations completedProgress: 668 iterations completedProgress: 669 iterations completedProgress: 670 iterations completedProgress: 671 iterations completedProgress: 672 iterations completedProgress: 673 iterations completedProgress: 674 iterations completedProgress: 675 iterations completedProgress: 676 iterations completedProgress: 677 iterations completedProgress: 678 iterations completedProgress: 679 iterations completedProgress: 680 iterations completedProgress: 681 iterations completedProgress: 682 iterations completedProgress: 683 iterations completedProgress: 684 iterations completedProgress: 685 iterations completedProgress: 686 iterations completedProgress: 687 iterations completedProgress: 688 iterations completedProgress: 689 iterations completedProgress: 690 iterations completedProgress: 691 iterations completedProgress: 692 iterations completedProgress: 693 iterations completedProgress: 694 iterations completedProgress: 695 iterations completedProgress: 696 iterations completedProgress: 697 iterations completedProgress: 698 iterations completedProgress: 699 iterations completedProgress: 700 iterations completedProgress: 701 iterations completedProgress: 702 iterations completedProgress: 703 iterations completedProgress: 704 iterations completedProgress: 705 iterations completedProgress: 706 iterations completedProgress: 707 iterations completedProgress: 708 iterations completedProgress: 709 iterations completedProgress: 710 iterations completedProgress: 711 iterations completedProgress: 712 iterations completedProgress: 713 iterations completedProgress: 714 iterations completedProgress: 715 iterations completedProgress: 716 iterations completedProgress: 717 iterations completedProgress: 718 iterations completedProgress: 719 iterations completedProgress: 720 iterations completedProgress: 721 iterations completedProgress: 722 iterations completedProgress: 723 iterations completedProgress: 724 iterations completedProgress: 725 iterations completedProgress: 726 iterations completedProgress: 727 iterations completedProgress: 728 iterations completedProgress: 729 iterations completedProgress: 730 iterations completedProgress: 731 iterations completedProgress: 732 iterations completedProgress: 733 iterations completedProgress: 734 iterations completedProgress: 735 iterations completedProgress: 736 iterations completedProgress: 737 iterations completedProgress: 738 iterations completedProgress: 739 iterations completedProgress: 740 iterations completedProgress: 741 iterations completedProgress: 742 iterations completedProgress: 743 iterations completedProgress: 744 iterations completedProgress: 745 iterations completedProgress: 746 iterations completedProgress: 747 iterations completedProgress: 748 iterations completedProgress: 749 iterations completedProgress: 750 iterations completedProgress: 751 iterations completedProgress: 752 iterations completedProgress: 753 iterations completedProgress: 754 iterations completedProgress: 755 iterations completedProgress: 756 iterations completedProgress: 757 iterations completedProgress: 758 iterations completedProgress: 759 iterations completedProgress: 760 iterations completedProgress: 761 iterations completedProgress: 762 iterations completedProgress: 763 iterations completedProgress: 764 iterations completedProgress: 765 iterations completedProgress: 766 iterations completedProgress: 767 iterations completedProgress: 768 iterations completedProgress: 769 iterations completedProgress: 770 iterations completedProgress: 771 iterations completedProgress: 772 iterations completedProgress: 773 iterations completedProgress: 774 iterations completedProgress: 775 iterations completedProgress: 776 iterations completedProgress: 777 iterations completedProgress: 778 iterations completedProgress: 779 iterations completedProgress: 780 iterations completedProgress: 781 iterations completedProgress: 782 iterations completedProgress: 783 iterations completedProgress: 784 iterations completedProgress: 785 iterations completedProgress: 786 iterations completedProgress: 787 iterations completedProgress: 788 iterations completedProgress: 789 iterations completedProgress: 790 iterations completedProgress: 791 iterations completedProgress: 792 iterations completedProgress: 793 iterations completedProgress: 794 iterations completedProgress: 795 iterations completedProgress: 796 iterations completedProgress: 797 iterations completedProgress: 798 iterations completedProgress: 799 iterations completedProgress: 800 iterations completedProgress: 801 iterations completedProgress: 802 iterations completedProgress: 803 iterations completedProgress: 804 iterations completedProgress: 805 iterations completedProgress: 806 iterations completedProgress: 807 iterations completedProgress: 808 iterations completedProgress: 809 iterations completedProgress: 810 iterations completedProgress: 811 iterations completedProgress: 812 iterations completedProgress: 813 iterations completedProgress: 814 iterations completedProgress: 815 iterations completedProgress: 816 iterations completedProgress: 817 iterations completedProgress: 818 iterations completedProgress: 819 iterations completedProgress: 820 iterations completedProgress: 821 iterations completedProgress: 822 iterations completedProgress: 823 iterations completedProgress: 824 iterations completedProgress: 825 iterations completedProgress: 826 iterations completedProgress: 827 iterations completedProgress: 828 iterations completedProgress: 829 iterations completedProgress: 830 iterations completedProgress: 831 iterations completedProgress: 832 iterations completedProgress: 833 iterations completedProgress: 834 iterations completedProgress: 835 iterations completedProgress: 836 iterations completedProgress: 837 iterations completedProgress: 838 iterations completedProgress: 839 iterations completedProgress: 840 iterations completedProgress: 841 iterations completedProgress: 842 iterations completedProgress: 843 iterations completedProgress: 844 iterations completedProgress: 845 iterations completedProgress: 846 iterations completedProgress: 847 iterations completedProgress: 848 iterations completedProgress: 849 iterations completedProgress: 850 iterations completedProgress: 851 iterations completedProgress: 852 iterations completedProgress: 853 iterations completedProgress: 854 iterations completedProgress: 855 iterations completedProgress: 856 iterations completedProgress: 857 iterations completedProgress: 858 iterations completedProgress: 859 iterations completedProgress: 860 iterations completedProgress: 861 iterations completedProgress: 862 iterations completedProgress: 863 iterations completedProgress: 864 iterations completedProgress: 865 iterations completedProgress: 866 iterations completedProgress: 867 iterations completedProgress: 868 iterations completedProgress: 869 iterations completedProgress: 870 iterations completedProgress: 871 iterations completedProgress: 872 iterations completedProgress: 873 iterations completedProgress: 874 iterations completedProgress: 875 iterations completedProgress: 876 iterations completedProgress: 877 iterations completedProgress: 878 iterations completedProgress: 879 iterations completedProgress: 880 iterations completedProgress: 881 iterations completedProgress: 882 iterations completedProgress: 883 iterations completedProgress: 884 iterations completedProgress: 885 iterations completedProgress: 886 iterations completedProgress: 887 iterations completedProgress: 888 iterations completedProgress: 889 iterations completedProgress: 890 iterations completedProgress: 891 iterations completedProgress: 892 iterations completedProgress: 893 iterations completedProgress: 894 iterations completedProgress: 895 iterations completedProgress: 896 iterations completedProgress: 897 iterations completedProgress: 898 iterations completedProgress: 899 iterations completedProgress: 900 iterations completedProgress: 901 iterations completedProgress: 902 iterations completedProgress: 903 iterations completedProgress: 904 iterations completedProgress: 905 iterations completedProgress: 906 iterations completedProgress: 907 iterations completedProgress: 908 iterations completedProgress: 909 iterations completedProgress: 910 iterations completedProgress: 911 iterations completedProgress: 912 iterations completedProgress: 913 iterations completedProgress: 914 iterations completedProgress: 915 iterations completedProgress: 916 iterations completedProgress: 917 iterations completedProgress: 918 iterations completedProgress: 919 iterations completedProgress: 920 iterations completedProgress: 921 iterations completedProgress: 922 iterations completedProgress: 923 iterations completedProgress: 924 iterations completedProgress: 925 iterations completedProgress: 926 iterations completedProgress: 927 iterations completedProgress: 928 iterations completedProgress: 929 iterations completedProgress: 930 iterations completedProgress: 931 iterations completedProgress: 932 iterations completedProgress: 933 iterations completedProgress: 934 iterations completedProgress: 935 iterations completedProgress: 936 iterations completedProgress: 937 iterations completedProgress: 938 iterations completedProgress: 939 iterations completedProgress: 940 iterations completedProgress: 941 iterations completedProgress: 942 iterations completedProgress: 943 iterations completedProgress: 944 iterations completedProgress: 945 iterations completedProgress: 946 iterations completedProgress: 947 iterations completedProgress: 948 iterations completedProgress: 949 iterations completedProgress: 950 iterations completedProgress: 951 iterations completedProgress: 952 iterations completedProgress: 953 iterations completedProgress: 954 iterations completedProgress: 955 iterations completedProgress: 956 iterations completedProgress: 957 iterations completedProgress: 958 iterations completedProgress: 959 iterations completedProgress: 960 iterations completedProgress: 961 iterations completedProgress: 962 iterations completedProgress: 963 iterations completedProgress: 964 iterations completedProgress: 965 iterations completedProgress: 966 iterations completedProgress: 967 iterations completedProgress: 968 iterations completedProgress: 969 iterations completedProgress: 970 iterations completedProgress: 971 iterations completedProgress: 972 iterations completedProgress: 973 iterations completedProgress: 974 iterations completedProgress: 975 iterations completedProgress: 976 iterations completedProgress: 977 iterations completedProgress: 978 iterations completedProgress: 979 iterations completedProgress: 980 iterations completedProgress: 981 iterations completedProgress: 982 iterations completedProgress: 983 iterations completedProgress: 984 iterations completedProgress: 985 iterations completedProgress: 986 iterations completedProgress: 987 iterations completedProgress: 988 iterations completedProgress: 989 iterations completedProgress: 990 iterations completedProgress: 991 iterations completedProgress: 992 iterations completedProgress: 993 iterations completedProgress: 994 iterations completedProgress: 995 iterations completedProgress: 996 iterations completedProgress: 997 iterations completedProgress: 998 iterations completedProgress: 999 iterations completedProgress: 1000 iterations completed</code></pre>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="what-is-stacked-ensambled.html#cb462-1" tabindex="-1"></a><span class="co"># Calculate mean RMSPE for the ensemble with KNN</span></span>
<span id="cb462-2"><a href="what-is-stacked-ensambled.html#cb462-2" tabindex="-1"></a>mean_rmspe_ensemble_knn <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_ensemble_knn)</span>
<span id="cb462-3"><a href="what-is-stacked-ensambled.html#cb462-3" tabindex="-1"></a></span>
<span id="cb462-4"><a href="what-is-stacked-ensambled.html#cb462-4" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb462-5"><a href="what-is-stacked-ensambled.html#cb462-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE of Stacked Ensemble with Tuned KNN Model:&quot;</span>, mean_rmspe_ensemble_knn))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE of Stacked Ensemble with Tuned KNN Model: 0.33259406977605&quot;</code></pre>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="what-is-stacked-ensambled.html#cb464-1" tabindex="-1"></a><span class="co"># Initialize storage for the sum of correlation matrices</span></span>
<span id="cb464-2"><a href="what-is-stacked-ensambled.html#cb464-2" tabindex="-1"></a>cor_matrix_sum <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>)  <span class="co"># Assuming 4 base models</span></span>
<span id="cb464-3"><a href="what-is-stacked-ensambled.html#cb464-3" tabindex="-1"></a></span>
<span id="cb464-4"><a href="what-is-stacked-ensambled.html#cb464-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb464-5"><a href="what-is-stacked-ensambled.html#cb464-5" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb464-6"><a href="what-is-stacked-ensambled.html#cb464-6" tabindex="-1"></a>  </span>
<span id="cb464-7"><a href="what-is-stacked-ensambled.html#cb464-7" tabindex="-1"></a>  <span class="co"># Bootstrapping</span></span>
<span id="cb464-8"><a href="what-is-stacked-ensambled.html#cb464-8" tabindex="-1"></a>  train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb464-9"><a href="what-is-stacked-ensambled.html#cb464-9" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb464-10"><a href="what-is-stacked-ensambled.html#cb464-10" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb464-11"><a href="what-is-stacked-ensambled.html#cb464-11" tabindex="-1"></a>  </span>
<span id="cb464-12"><a href="what-is-stacked-ensambled.html#cb464-12" tabindex="-1"></a>  <span class="co"># Re-train the original models on bootstrapped training data</span></span>
<span id="cb464-13"><a href="what-is-stacked-ensambled.html#cb464-13" tabindex="-1"></a>  lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb464-14"><a href="what-is-stacked-ensambled.html#cb464-14" tabindex="-1"></a>  rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb464-15"><a href="what-is-stacked-ensambled.html#cb464-15" tabindex="-1"></a>  tuned_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb464-16"><a href="what-is-stacked-ensambled.html#cb464-16" tabindex="-1"></a>                       <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees, </span>
<span id="cb464-17"><a href="what-is-stacked-ensambled.html#cb464-17" tabindex="-1"></a>                       <span class="at">shrinkage =</span> best_params<span class="sc">$</span>shrinkage, </span>
<span id="cb464-18"><a href="what-is-stacked-ensambled.html#cb464-18" tabindex="-1"></a>                       <span class="at">interaction.depth =</span> best_params<span class="sc">$</span>interaction.depth, </span>
<span id="cb464-19"><a href="what-is-stacked-ensambled.html#cb464-19" tabindex="-1"></a>                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb464-20"><a href="what-is-stacked-ensambled.html#cb464-20" tabindex="-1"></a>  </span>
<span id="cb464-21"><a href="what-is-stacked-ensambled.html#cb464-21" tabindex="-1"></a>  <span class="co"># Train the KNN model with the best k</span></span>
<span id="cb464-22"><a href="what-is-stacked-ensambled.html#cb464-22" tabindex="-1"></a>  knn_mod <span class="ot">&lt;-</span> <span class="fu">knnreg</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">k =</span> best_k)</span>
<span id="cb464-23"><a href="what-is-stacked-ensambled.html#cb464-23" tabindex="-1"></a>  </span>
<span id="cb464-24"><a href="what-is-stacked-ensambled.html#cb464-24" tabindex="-1"></a>  <span class="co"># Generate predictions on the bootstrapped test set</span></span>
<span id="cb464-25"><a href="what-is-stacked-ensambled.html#cb464-25" tabindex="-1"></a>  lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_mod, test_data)</span>
<span id="cb464-26"><a href="what-is-stacked-ensambled.html#cb464-26" tabindex="-1"></a>  rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_mod, test_data)</span>
<span id="cb464-27"><a href="what-is-stacked-ensambled.html#cb464-27" tabindex="-1"></a>  tuned_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(tuned_gbm_mod, test_data, <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees)</span>
<span id="cb464-28"><a href="what-is-stacked-ensambled.html#cb464-28" tabindex="-1"></a>knn_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_mod, test_data)</span>
<span id="cb464-29"><a href="what-is-stacked-ensambled.html#cb464-29" tabindex="-1"></a>  <span class="co"># Combine predictions into a data frame</span></span>
<span id="cb464-30"><a href="what-is-stacked-ensambled.html#cb464-30" tabindex="-1"></a>  preds_four <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, tuned_gbm_pred, knn_pred)</span>
<span id="cb464-31"><a href="what-is-stacked-ensambled.html#cb464-31" tabindex="-1"></a>  </span>
<span id="cb464-32"><a href="what-is-stacked-ensambled.html#cb464-32" tabindex="-1"></a>  <span class="co"># Calculate the correlation matrix for the current iteration</span></span>
<span id="cb464-33"><a href="what-is-stacked-ensambled.html#cb464-33" tabindex="-1"></a>  cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(preds_four)</span>
<span id="cb464-34"><a href="what-is-stacked-ensambled.html#cb464-34" tabindex="-1"></a>  </span>
<span id="cb464-35"><a href="what-is-stacked-ensambled.html#cb464-35" tabindex="-1"></a>  <span class="co"># Accumulate the correlation matrix</span></span>
<span id="cb464-36"><a href="what-is-stacked-ensambled.html#cb464-36" tabindex="-1"></a>  cor_matrix_sum <span class="ot">&lt;-</span> cor_matrix_sum <span class="sc">+</span> cor_matrix</span>
<span id="cb464-37"><a href="what-is-stacked-ensambled.html#cb464-37" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Progress: 1 iterations completedProgress: 2 iterations completedProgress: 3 iterations completedProgress: 4 iterations completedProgress: 5 iterations completedProgress: 6 iterations completedProgress: 7 iterations completedProgress: 8 iterations completedProgress: 9 iterations completedProgress: 10 iterations completedProgress: 11 iterations completedProgress: 12 iterations completedProgress: 13 iterations completedProgress: 14 iterations completedProgress: 15 iterations completedProgress: 16 iterations completedProgress: 17 iterations completedProgress: 18 iterations completedProgress: 19 iterations completedProgress: 20 iterations completedProgress: 21 iterations completedProgress: 22 iterations completedProgress: 23 iterations completedProgress: 24 iterations completedProgress: 25 iterations completedProgress: 26 iterations completedProgress: 27 iterations completedProgress: 28 iterations completedProgress: 29 iterations completedProgress: 30 iterations completedProgress: 31 iterations completedProgress: 32 iterations completedProgress: 33 iterations completedProgress: 34 iterations completedProgress: 35 iterations completedProgress: 36 iterations completedProgress: 37 iterations completedProgress: 38 iterations completedProgress: 39 iterations completedProgress: 40 iterations completedProgress: 41 iterations completedProgress: 42 iterations completedProgress: 43 iterations completedProgress: 44 iterations completedProgress: 45 iterations completedProgress: 46 iterations completedProgress: 47 iterations completedProgress: 48 iterations completedProgress: 49 iterations completedProgress: 50 iterations completedProgress: 51 iterations completedProgress: 52 iterations completedProgress: 53 iterations completedProgress: 54 iterations completedProgress: 55 iterations completedProgress: 56 iterations completedProgress: 57 iterations completedProgress: 58 iterations completedProgress: 59 iterations completedProgress: 60 iterations completedProgress: 61 iterations completedProgress: 62 iterations completedProgress: 63 iterations completedProgress: 64 iterations completedProgress: 65 iterations completedProgress: 66 iterations completedProgress: 67 iterations completedProgress: 68 iterations completedProgress: 69 iterations completedProgress: 70 iterations completedProgress: 71 iterations completedProgress: 72 iterations completedProgress: 73 iterations completedProgress: 74 iterations completedProgress: 75 iterations completedProgress: 76 iterations completedProgress: 77 iterations completedProgress: 78 iterations completedProgress: 79 iterations completedProgress: 80 iterations completedProgress: 81 iterations completedProgress: 82 iterations completedProgress: 83 iterations completedProgress: 84 iterations completedProgress: 85 iterations completedProgress: 86 iterations completedProgress: 87 iterations completedProgress: 88 iterations completedProgress: 89 iterations completedProgress: 90 iterations completedProgress: 91 iterations completedProgress: 92 iterations completedProgress: 93 iterations completedProgress: 94 iterations completedProgress: 95 iterations completedProgress: 96 iterations completedProgress: 97 iterations completedProgress: 98 iterations completedProgress: 99 iterations completedProgress: 100 iterations completedProgress: 101 iterations completedProgress: 102 iterations completedProgress: 103 iterations completedProgress: 104 iterations completedProgress: 105 iterations completedProgress: 106 iterations completedProgress: 107 iterations completedProgress: 108 iterations completedProgress: 109 iterations completedProgress: 110 iterations completedProgress: 111 iterations completedProgress: 112 iterations completedProgress: 113 iterations completedProgress: 114 iterations completedProgress: 115 iterations completedProgress: 116 iterations completedProgress: 117 iterations completedProgress: 118 iterations completedProgress: 119 iterations completedProgress: 120 iterations completedProgress: 121 iterations completedProgress: 122 iterations completedProgress: 123 iterations completedProgress: 124 iterations completedProgress: 125 iterations completedProgress: 126 iterations completedProgress: 127 iterations completedProgress: 128 iterations completedProgress: 129 iterations completedProgress: 130 iterations completedProgress: 131 iterations completedProgress: 132 iterations completedProgress: 133 iterations completedProgress: 134 iterations completedProgress: 135 iterations completedProgress: 136 iterations completedProgress: 137 iterations completedProgress: 138 iterations completedProgress: 139 iterations completedProgress: 140 iterations completedProgress: 141 iterations completedProgress: 142 iterations completedProgress: 143 iterations completedProgress: 144 iterations completedProgress: 145 iterations completedProgress: 146 iterations completedProgress: 147 iterations completedProgress: 148 iterations completedProgress: 149 iterations completedProgress: 150 iterations completedProgress: 151 iterations completedProgress: 152 iterations completedProgress: 153 iterations completedProgress: 154 iterations completedProgress: 155 iterations completedProgress: 156 iterations completedProgress: 157 iterations completedProgress: 158 iterations completedProgress: 159 iterations completedProgress: 160 iterations completedProgress: 161 iterations completedProgress: 162 iterations completedProgress: 163 iterations completedProgress: 164 iterations completedProgress: 165 iterations completedProgress: 166 iterations completedProgress: 167 iterations completedProgress: 168 iterations completedProgress: 169 iterations completedProgress: 170 iterations completedProgress: 171 iterations completedProgress: 172 iterations completedProgress: 173 iterations completedProgress: 174 iterations completedProgress: 175 iterations completedProgress: 176 iterations completedProgress: 177 iterations completedProgress: 178 iterations completedProgress: 179 iterations completedProgress: 180 iterations completedProgress: 181 iterations completedProgress: 182 iterations completedProgress: 183 iterations completedProgress: 184 iterations completedProgress: 185 iterations completedProgress: 186 iterations completedProgress: 187 iterations completedProgress: 188 iterations completedProgress: 189 iterations completedProgress: 190 iterations completedProgress: 191 iterations completedProgress: 192 iterations completedProgress: 193 iterations completedProgress: 194 iterations completedProgress: 195 iterations completedProgress: 196 iterations completedProgress: 197 iterations completedProgress: 198 iterations completedProgress: 199 iterations completedProgress: 200 iterations completedProgress: 201 iterations completedProgress: 202 iterations completedProgress: 203 iterations completedProgress: 204 iterations completedProgress: 205 iterations completedProgress: 206 iterations completedProgress: 207 iterations completedProgress: 208 iterations completedProgress: 209 iterations completedProgress: 210 iterations completedProgress: 211 iterations completedProgress: 212 iterations completedProgress: 213 iterations completedProgress: 214 iterations completedProgress: 215 iterations completedProgress: 216 iterations completedProgress: 217 iterations completedProgress: 218 iterations completedProgress: 219 iterations completedProgress: 220 iterations completedProgress: 221 iterations completedProgress: 222 iterations completedProgress: 223 iterations completedProgress: 224 iterations completedProgress: 225 iterations completedProgress: 226 iterations completedProgress: 227 iterations completedProgress: 228 iterations completedProgress: 229 iterations completedProgress: 230 iterations completedProgress: 231 iterations completedProgress: 232 iterations completedProgress: 233 iterations completedProgress: 234 iterations completedProgress: 235 iterations completedProgress: 236 iterations completedProgress: 237 iterations completedProgress: 238 iterations completedProgress: 239 iterations completedProgress: 240 iterations completedProgress: 241 iterations completedProgress: 242 iterations completedProgress: 243 iterations completedProgress: 244 iterations completedProgress: 245 iterations completedProgress: 246 iterations completedProgress: 247 iterations completedProgress: 248 iterations completedProgress: 249 iterations completedProgress: 250 iterations completedProgress: 251 iterations completedProgress: 252 iterations completedProgress: 253 iterations completedProgress: 254 iterations completedProgress: 255 iterations completedProgress: 256 iterations completedProgress: 257 iterations completedProgress: 258 iterations completedProgress: 259 iterations completedProgress: 260 iterations completedProgress: 261 iterations completedProgress: 262 iterations completedProgress: 263 iterations completedProgress: 264 iterations completedProgress: 265 iterations completedProgress: 266 iterations completedProgress: 267 iterations completedProgress: 268 iterations completedProgress: 269 iterations completedProgress: 270 iterations completedProgress: 271 iterations completedProgress: 272 iterations completedProgress: 273 iterations completedProgress: 274 iterations completedProgress: 275 iterations completedProgress: 276 iterations completedProgress: 277 iterations completedProgress: 278 iterations completedProgress: 279 iterations completedProgress: 280 iterations completedProgress: 281 iterations completedProgress: 282 iterations completedProgress: 283 iterations completedProgress: 284 iterations completedProgress: 285 iterations completedProgress: 286 iterations completedProgress: 287 iterations completedProgress: 288 iterations completedProgress: 289 iterations completedProgress: 290 iterations completedProgress: 291 iterations completedProgress: 292 iterations completedProgress: 293 iterations completedProgress: 294 iterations completedProgress: 295 iterations completedProgress: 296 iterations completedProgress: 297 iterations completedProgress: 298 iterations completedProgress: 299 iterations completedProgress: 300 iterations completedProgress: 301 iterations completedProgress: 302 iterations completedProgress: 303 iterations completedProgress: 304 iterations completedProgress: 305 iterations completedProgress: 306 iterations completedProgress: 307 iterations completedProgress: 308 iterations completedProgress: 309 iterations completedProgress: 310 iterations completedProgress: 311 iterations completedProgress: 312 iterations completedProgress: 313 iterations completedProgress: 314 iterations completedProgress: 315 iterations completedProgress: 316 iterations completedProgress: 317 iterations completedProgress: 318 iterations completedProgress: 319 iterations completedProgress: 320 iterations completedProgress: 321 iterations completedProgress: 322 iterations completedProgress: 323 iterations completedProgress: 324 iterations completedProgress: 325 iterations completedProgress: 326 iterations completedProgress: 327 iterations completedProgress: 328 iterations completedProgress: 329 iterations completedProgress: 330 iterations completedProgress: 331 iterations completedProgress: 332 iterations completedProgress: 333 iterations completedProgress: 334 iterations completedProgress: 335 iterations completedProgress: 336 iterations completedProgress: 337 iterations completedProgress: 338 iterations completedProgress: 339 iterations completedProgress: 340 iterations completedProgress: 341 iterations completedProgress: 342 iterations completedProgress: 343 iterations completedProgress: 344 iterations completedProgress: 345 iterations completedProgress: 346 iterations completedProgress: 347 iterations completedProgress: 348 iterations completedProgress: 349 iterations completedProgress: 350 iterations completedProgress: 351 iterations completedProgress: 352 iterations completedProgress: 353 iterations completedProgress: 354 iterations completedProgress: 355 iterations completedProgress: 356 iterations completedProgress: 357 iterations completedProgress: 358 iterations completedProgress: 359 iterations completedProgress: 360 iterations completedProgress: 361 iterations completedProgress: 362 iterations completedProgress: 363 iterations completedProgress: 364 iterations completedProgress: 365 iterations completedProgress: 366 iterations completedProgress: 367 iterations completedProgress: 368 iterations completedProgress: 369 iterations completedProgress: 370 iterations completedProgress: 371 iterations completedProgress: 372 iterations completedProgress: 373 iterations completedProgress: 374 iterations completedProgress: 375 iterations completedProgress: 376 iterations completedProgress: 377 iterations completedProgress: 378 iterations completedProgress: 379 iterations completedProgress: 380 iterations completedProgress: 381 iterations completedProgress: 382 iterations completedProgress: 383 iterations completedProgress: 384 iterations completedProgress: 385 iterations completedProgress: 386 iterations completedProgress: 387 iterations completedProgress: 388 iterations completedProgress: 389 iterations completedProgress: 390 iterations completedProgress: 391 iterations completedProgress: 392 iterations completedProgress: 393 iterations completedProgress: 394 iterations completedProgress: 395 iterations completedProgress: 396 iterations completedProgress: 397 iterations completedProgress: 398 iterations completedProgress: 399 iterations completedProgress: 400 iterations completedProgress: 401 iterations completedProgress: 402 iterations completedProgress: 403 iterations completedProgress: 404 iterations completedProgress: 405 iterations completedProgress: 406 iterations completedProgress: 407 iterations completedProgress: 408 iterations completedProgress: 409 iterations completedProgress: 410 iterations completedProgress: 411 iterations completedProgress: 412 iterations completedProgress: 413 iterations completedProgress: 414 iterations completedProgress: 415 iterations completedProgress: 416 iterations completedProgress: 417 iterations completedProgress: 418 iterations completedProgress: 419 iterations completedProgress: 420 iterations completedProgress: 421 iterations completedProgress: 422 iterations completedProgress: 423 iterations completedProgress: 424 iterations completedProgress: 425 iterations completedProgress: 426 iterations completedProgress: 427 iterations completedProgress: 428 iterations completedProgress: 429 iterations completedProgress: 430 iterations completedProgress: 431 iterations completedProgress: 432 iterations completedProgress: 433 iterations completedProgress: 434 iterations completedProgress: 435 iterations completedProgress: 436 iterations completedProgress: 437 iterations completedProgress: 438 iterations completedProgress: 439 iterations completedProgress: 440 iterations completedProgress: 441 iterations completedProgress: 442 iterations completedProgress: 443 iterations completedProgress: 444 iterations completedProgress: 445 iterations completedProgress: 446 iterations completedProgress: 447 iterations completedProgress: 448 iterations completedProgress: 449 iterations completedProgress: 450 iterations completedProgress: 451 iterations completedProgress: 452 iterations completedProgress: 453 iterations completedProgress: 454 iterations completedProgress: 455 iterations completedProgress: 456 iterations completedProgress: 457 iterations completedProgress: 458 iterations completedProgress: 459 iterations completedProgress: 460 iterations completedProgress: 461 iterations completedProgress: 462 iterations completedProgress: 463 iterations completedProgress: 464 iterations completedProgress: 465 iterations completedProgress: 466 iterations completedProgress: 467 iterations completedProgress: 468 iterations completedProgress: 469 iterations completedProgress: 470 iterations completedProgress: 471 iterations completedProgress: 472 iterations completedProgress: 473 iterations completedProgress: 474 iterations completedProgress: 475 iterations completedProgress: 476 iterations completedProgress: 477 iterations completedProgress: 478 iterations completedProgress: 479 iterations completedProgress: 480 iterations completedProgress: 481 iterations completedProgress: 482 iterations completedProgress: 483 iterations completedProgress: 484 iterations completedProgress: 485 iterations completedProgress: 486 iterations completedProgress: 487 iterations completedProgress: 488 iterations completedProgress: 489 iterations completedProgress: 490 iterations completedProgress: 491 iterations completedProgress: 492 iterations completedProgress: 493 iterations completedProgress: 494 iterations completedProgress: 495 iterations completedProgress: 496 iterations completedProgress: 497 iterations completedProgress: 498 iterations completedProgress: 499 iterations completedProgress: 500 iterations completedProgress: 501 iterations completedProgress: 502 iterations completedProgress: 503 iterations completedProgress: 504 iterations completedProgress: 505 iterations completedProgress: 506 iterations completedProgress: 507 iterations completedProgress: 508 iterations completedProgress: 509 iterations completedProgress: 510 iterations completedProgress: 511 iterations completedProgress: 512 iterations completedProgress: 513 iterations completedProgress: 514 iterations completedProgress: 515 iterations completedProgress: 516 iterations completedProgress: 517 iterations completedProgress: 518 iterations completedProgress: 519 iterations completedProgress: 520 iterations completedProgress: 521 iterations completedProgress: 522 iterations completedProgress: 523 iterations completedProgress: 524 iterations completedProgress: 525 iterations completedProgress: 526 iterations completedProgress: 527 iterations completedProgress: 528 iterations completedProgress: 529 iterations completedProgress: 530 iterations completedProgress: 531 iterations completedProgress: 532 iterations completedProgress: 533 iterations completedProgress: 534 iterations completedProgress: 535 iterations completedProgress: 536 iterations completedProgress: 537 iterations completedProgress: 538 iterations completedProgress: 539 iterations completedProgress: 540 iterations completedProgress: 541 iterations completedProgress: 542 iterations completedProgress: 543 iterations completedProgress: 544 iterations completedProgress: 545 iterations completedProgress: 546 iterations completedProgress: 547 iterations completedProgress: 548 iterations completedProgress: 549 iterations completedProgress: 550 iterations completedProgress: 551 iterations completedProgress: 552 iterations completedProgress: 553 iterations completedProgress: 554 iterations completedProgress: 555 iterations completedProgress: 556 iterations completedProgress: 557 iterations completedProgress: 558 iterations completedProgress: 559 iterations completedProgress: 560 iterations completedProgress: 561 iterations completedProgress: 562 iterations completedProgress: 563 iterations completedProgress: 564 iterations completedProgress: 565 iterations completedProgress: 566 iterations completedProgress: 567 iterations completedProgress: 568 iterations completedProgress: 569 iterations completedProgress: 570 iterations completedProgress: 571 iterations completedProgress: 572 iterations completedProgress: 573 iterations completedProgress: 574 iterations completedProgress: 575 iterations completedProgress: 576 iterations completedProgress: 577 iterations completedProgress: 578 iterations completedProgress: 579 iterations completedProgress: 580 iterations completedProgress: 581 iterations completedProgress: 582 iterations completedProgress: 583 iterations completedProgress: 584 iterations completedProgress: 585 iterations completedProgress: 586 iterations completedProgress: 587 iterations completedProgress: 588 iterations completedProgress: 589 iterations completedProgress: 590 iterations completedProgress: 591 iterations completedProgress: 592 iterations completedProgress: 593 iterations completedProgress: 594 iterations completedProgress: 595 iterations completedProgress: 596 iterations completedProgress: 597 iterations completedProgress: 598 iterations completedProgress: 599 iterations completedProgress: 600 iterations completedProgress: 601 iterations completedProgress: 602 iterations completedProgress: 603 iterations completedProgress: 604 iterations completedProgress: 605 iterations completedProgress: 606 iterations completedProgress: 607 iterations completedProgress: 608 iterations completedProgress: 609 iterations completedProgress: 610 iterations completedProgress: 611 iterations completedProgress: 612 iterations completedProgress: 613 iterations completedProgress: 614 iterations completedProgress: 615 iterations completedProgress: 616 iterations completedProgress: 617 iterations completedProgress: 618 iterations completedProgress: 619 iterations completedProgress: 620 iterations completedProgress: 621 iterations completedProgress: 622 iterations completedProgress: 623 iterations completedProgress: 624 iterations completedProgress: 625 iterations completedProgress: 626 iterations completedProgress: 627 iterations completedProgress: 628 iterations completedProgress: 629 iterations completedProgress: 630 iterations completedProgress: 631 iterations completedProgress: 632 iterations completedProgress: 633 iterations completedProgress: 634 iterations completedProgress: 635 iterations completedProgress: 636 iterations completedProgress: 637 iterations completedProgress: 638 iterations completedProgress: 639 iterations completedProgress: 640 iterations completedProgress: 641 iterations completedProgress: 642 iterations completedProgress: 643 iterations completedProgress: 644 iterations completedProgress: 645 iterations completedProgress: 646 iterations completedProgress: 647 iterations completedProgress: 648 iterations completedProgress: 649 iterations completedProgress: 650 iterations completedProgress: 651 iterations completedProgress: 652 iterations completedProgress: 653 iterations completedProgress: 654 iterations completedProgress: 655 iterations completedProgress: 656 iterations completedProgress: 657 iterations completedProgress: 658 iterations completedProgress: 659 iterations completedProgress: 660 iterations completedProgress: 661 iterations completedProgress: 662 iterations completedProgress: 663 iterations completedProgress: 664 iterations completedProgress: 665 iterations completedProgress: 666 iterations completedProgress: 667 iterations completedProgress: 668 iterations completedProgress: 669 iterations completedProgress: 670 iterations completedProgress: 671 iterations completedProgress: 672 iterations completedProgress: 673 iterations completedProgress: 674 iterations completedProgress: 675 iterations completedProgress: 676 iterations completedProgress: 677 iterations completedProgress: 678 iterations completedProgress: 679 iterations completedProgress: 680 iterations completedProgress: 681 iterations completedProgress: 682 iterations completedProgress: 683 iterations completedProgress: 684 iterations completedProgress: 685 iterations completedProgress: 686 iterations completedProgress: 687 iterations completedProgress: 688 iterations completedProgress: 689 iterations completedProgress: 690 iterations completedProgress: 691 iterations completedProgress: 692 iterations completedProgress: 693 iterations completedProgress: 694 iterations completedProgress: 695 iterations completedProgress: 696 iterations completedProgress: 697 iterations completedProgress: 698 iterations completedProgress: 699 iterations completedProgress: 700 iterations completedProgress: 701 iterations completedProgress: 702 iterations completedProgress: 703 iterations completedProgress: 704 iterations completedProgress: 705 iterations completedProgress: 706 iterations completedProgress: 707 iterations completedProgress: 708 iterations completedProgress: 709 iterations completedProgress: 710 iterations completedProgress: 711 iterations completedProgress: 712 iterations completedProgress: 713 iterations completedProgress: 714 iterations completedProgress: 715 iterations completedProgress: 716 iterations completedProgress: 717 iterations completedProgress: 718 iterations completedProgress: 719 iterations completedProgress: 720 iterations completedProgress: 721 iterations completedProgress: 722 iterations completedProgress: 723 iterations completedProgress: 724 iterations completedProgress: 725 iterations completedProgress: 726 iterations completedProgress: 727 iterations completedProgress: 728 iterations completedProgress: 729 iterations completedProgress: 730 iterations completedProgress: 731 iterations completedProgress: 732 iterations completedProgress: 733 iterations completedProgress: 734 iterations completedProgress: 735 iterations completedProgress: 736 iterations completedProgress: 737 iterations completedProgress: 738 iterations completedProgress: 739 iterations completedProgress: 740 iterations completedProgress: 741 iterations completedProgress: 742 iterations completedProgress: 743 iterations completedProgress: 744 iterations completedProgress: 745 iterations completedProgress: 746 iterations completedProgress: 747 iterations completedProgress: 748 iterations completedProgress: 749 iterations completedProgress: 750 iterations completedProgress: 751 iterations completedProgress: 752 iterations completedProgress: 753 iterations completedProgress: 754 iterations completedProgress: 755 iterations completedProgress: 756 iterations completedProgress: 757 iterations completedProgress: 758 iterations completedProgress: 759 iterations completedProgress: 760 iterations completedProgress: 761 iterations completedProgress: 762 iterations completedProgress: 763 iterations completedProgress: 764 iterations completedProgress: 765 iterations completedProgress: 766 iterations completedProgress: 767 iterations completedProgress: 768 iterations completedProgress: 769 iterations completedProgress: 770 iterations completedProgress: 771 iterations completedProgress: 772 iterations completedProgress: 773 iterations completedProgress: 774 iterations completedProgress: 775 iterations completedProgress: 776 iterations completedProgress: 777 iterations completedProgress: 778 iterations completedProgress: 779 iterations completedProgress: 780 iterations completedProgress: 781 iterations completedProgress: 782 iterations completedProgress: 783 iterations completedProgress: 784 iterations completedProgress: 785 iterations completedProgress: 786 iterations completedProgress: 787 iterations completedProgress: 788 iterations completedProgress: 789 iterations completedProgress: 790 iterations completedProgress: 791 iterations completedProgress: 792 iterations completedProgress: 793 iterations completedProgress: 794 iterations completedProgress: 795 iterations completedProgress: 796 iterations completedProgress: 797 iterations completedProgress: 798 iterations completedProgress: 799 iterations completedProgress: 800 iterations completedProgress: 801 iterations completedProgress: 802 iterations completedProgress: 803 iterations completedProgress: 804 iterations completedProgress: 805 iterations completedProgress: 806 iterations completedProgress: 807 iterations completedProgress: 808 iterations completedProgress: 809 iterations completedProgress: 810 iterations completedProgress: 811 iterations completedProgress: 812 iterations completedProgress: 813 iterations completedProgress: 814 iterations completedProgress: 815 iterations completedProgress: 816 iterations completedProgress: 817 iterations completedProgress: 818 iterations completedProgress: 819 iterations completedProgress: 820 iterations completedProgress: 821 iterations completedProgress: 822 iterations completedProgress: 823 iterations completedProgress: 824 iterations completedProgress: 825 iterations completedProgress: 826 iterations completedProgress: 827 iterations completedProgress: 828 iterations completedProgress: 829 iterations completedProgress: 830 iterations completedProgress: 831 iterations completedProgress: 832 iterations completedProgress: 833 iterations completedProgress: 834 iterations completedProgress: 835 iterations completedProgress: 836 iterations completedProgress: 837 iterations completedProgress: 838 iterations completedProgress: 839 iterations completedProgress: 840 iterations completedProgress: 841 iterations completedProgress: 842 iterations completedProgress: 843 iterations completedProgress: 844 iterations completedProgress: 845 iterations completedProgress: 846 iterations completedProgress: 847 iterations completedProgress: 848 iterations completedProgress: 849 iterations completedProgress: 850 iterations completedProgress: 851 iterations completedProgress: 852 iterations completedProgress: 853 iterations completedProgress: 854 iterations completedProgress: 855 iterations completedProgress: 856 iterations completedProgress: 857 iterations completedProgress: 858 iterations completedProgress: 859 iterations completedProgress: 860 iterations completedProgress: 861 iterations completedProgress: 862 iterations completedProgress: 863 iterations completedProgress: 864 iterations completedProgress: 865 iterations completedProgress: 866 iterations completedProgress: 867 iterations completedProgress: 868 iterations completedProgress: 869 iterations completedProgress: 870 iterations completedProgress: 871 iterations completedProgress: 872 iterations completedProgress: 873 iterations completedProgress: 874 iterations completedProgress: 875 iterations completedProgress: 876 iterations completedProgress: 877 iterations completedProgress: 878 iterations completedProgress: 879 iterations completedProgress: 880 iterations completedProgress: 881 iterations completedProgress: 882 iterations completedProgress: 883 iterations completedProgress: 884 iterations completedProgress: 885 iterations completedProgress: 886 iterations completedProgress: 887 iterations completedProgress: 888 iterations completedProgress: 889 iterations completedProgress: 890 iterations completedProgress: 891 iterations completedProgress: 892 iterations completedProgress: 893 iterations completedProgress: 894 iterations completedProgress: 895 iterations completedProgress: 896 iterations completedProgress: 897 iterations completedProgress: 898 iterations completedProgress: 899 iterations completedProgress: 900 iterations completedProgress: 901 iterations completedProgress: 902 iterations completedProgress: 903 iterations completedProgress: 904 iterations completedProgress: 905 iterations completedProgress: 906 iterations completedProgress: 907 iterations completedProgress: 908 iterations completedProgress: 909 iterations completedProgress: 910 iterations completedProgress: 911 iterations completedProgress: 912 iterations completedProgress: 913 iterations completedProgress: 914 iterations completedProgress: 915 iterations completedProgress: 916 iterations completedProgress: 917 iterations completedProgress: 918 iterations completedProgress: 919 iterations completedProgress: 920 iterations completedProgress: 921 iterations completedProgress: 922 iterations completedProgress: 923 iterations completedProgress: 924 iterations completedProgress: 925 iterations completedProgress: 926 iterations completedProgress: 927 iterations completedProgress: 928 iterations completedProgress: 929 iterations completedProgress: 930 iterations completedProgress: 931 iterations completedProgress: 932 iterations completedProgress: 933 iterations completedProgress: 934 iterations completedProgress: 935 iterations completedProgress: 936 iterations completedProgress: 937 iterations completedProgress: 938 iterations completedProgress: 939 iterations completedProgress: 940 iterations completedProgress: 941 iterations completedProgress: 942 iterations completedProgress: 943 iterations completedProgress: 944 iterations completedProgress: 945 iterations completedProgress: 946 iterations completedProgress: 947 iterations completedProgress: 948 iterations completedProgress: 949 iterations completedProgress: 950 iterations completedProgress: 951 iterations completedProgress: 952 iterations completedProgress: 953 iterations completedProgress: 954 iterations completedProgress: 955 iterations completedProgress: 956 iterations completedProgress: 957 iterations completedProgress: 958 iterations completedProgress: 959 iterations completedProgress: 960 iterations completedProgress: 961 iterations completedProgress: 962 iterations completedProgress: 963 iterations completedProgress: 964 iterations completedProgress: 965 iterations completedProgress: 966 iterations completedProgress: 967 iterations completedProgress: 968 iterations completedProgress: 969 iterations completedProgress: 970 iterations completedProgress: 971 iterations completedProgress: 972 iterations completedProgress: 973 iterations completedProgress: 974 iterations completedProgress: 975 iterations completedProgress: 976 iterations completedProgress: 977 iterations completedProgress: 978 iterations completedProgress: 979 iterations completedProgress: 980 iterations completedProgress: 981 iterations completedProgress: 982 iterations completedProgress: 983 iterations completedProgress: 984 iterations completedProgress: 985 iterations completedProgress: 986 iterations completedProgress: 987 iterations completedProgress: 988 iterations completedProgress: 989 iterations completedProgress: 990 iterations completedProgress: 991 iterations completedProgress: 992 iterations completedProgress: 993 iterations completedProgress: 994 iterations completedProgress: 995 iterations completedProgress: 996 iterations completedProgress: 997 iterations completedProgress: 998 iterations completedProgress: 999 iterations completedProgress: 1000 iterations completed</code></pre>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="what-is-stacked-ensambled.html#cb466-1" tabindex="-1"></a><span class="co"># Average the correlation matrix over the 1000 iterations</span></span>
<span id="cb466-2"><a href="what-is-stacked-ensambled.html#cb466-2" tabindex="-1"></a>avg_cor_matrix <span class="ot">&lt;-</span> cor_matrix_sum <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb466-3"><a href="what-is-stacked-ensambled.html#cb466-3" tabindex="-1"></a></span>
<span id="cb466-4"><a href="what-is-stacked-ensambled.html#cb466-4" tabindex="-1"></a><span class="co"># Print the averaged correlation matrix</span></span>
<span id="cb466-5"><a href="what-is-stacked-ensambled.html#cb466-5" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Averaged Correlation Matrix:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Averaged Correlation Matrix:&quot;</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="what-is-stacked-ensambled.html#cb468-1" tabindex="-1"></a><span class="fu">print</span>(avg_cor_matrix)</span></code></pre></div>
<pre><code>##                  lm_pred   rf_pred tuned_gbm_pred  knn_pred
## lm_pred        1.0000000 0.9009099      0.8921886 0.8645067
## rf_pred        0.9009099 1.0000000      0.9771105 0.9339113
## tuned_gbm_pred 0.8921886 0.9771105      1.0000000 0.9153983
## knn_pred       0.8645067 0.9339113      0.9153983 1.0000000</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="hcc_survey_analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intro-econ-stats.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/13_What_Is_Stacked_Ensambled.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
