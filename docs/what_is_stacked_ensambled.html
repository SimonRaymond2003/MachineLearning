<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 14 13_What_Is_Stacked_Ensambled | Machine Learning Applications</title>
  <meta name="description" content="Introduction" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 14 13_What_Is_Stacked_Ensambled | Machine Learning Applications" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Introduction" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 14 13_What_Is_Stacked_Ensambled | Machine Learning Applications" />
  
  <meta name="twitter:description" content="Introduction" />
  

<meta name="author" content="Simon P. Raymond" />


<meta name="date" content="2024-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="hcc_survey_analysis.html"/>
<link rel="next" href="intro_econ_stats.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MachineLearning</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About Myself</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#purpose"><i class="fa fa-check"></i><b>1.1</b> Purpose</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#notes-for-public"><i class="fa fa-check"></i><b>1.2</b> Notes for public</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#work-in-progress"><i class="fa fa-check"></i><b>1.3</b> Work in progress</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>2</b> Algorithms</a>
<ul>
<li class="chapter" data-level="2.1" data-path="algorithms.html"><a href="algorithms.html#data"><i class="fa fa-check"></i><b>2.1</b> Data</a></li>
<li class="chapter" data-level="2.2" data-path="algorithms.html"><a href="algorithms.html#parametric"><i class="fa fa-check"></i><b>2.2</b> Parametric</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="algorithms.html"><a href="algorithms.html#lm"><i class="fa fa-check"></i><b>2.2.1</b> LM</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="algorithms.html"><a href="algorithms.html#trees"><i class="fa fa-check"></i><b>2.3</b> Trees</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="algorithms.html"><a href="algorithms.html#cart"><i class="fa fa-check"></i><b>2.3.1</b> CART</a></li>
<li class="chapter" data-level="2.3.2" data-path="algorithms.html"><a href="algorithms.html#bagging"><i class="fa fa-check"></i><b>2.3.2</b> Bagging</a></li>
<li class="chapter" data-level="2.3.3" data-path="algorithms.html"><a href="algorithms.html#rf"><i class="fa fa-check"></i><b>2.3.3</b> RF</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="algorithms.html"><a href="algorithms.html#boosting"><i class="fa fa-check"></i><b>2.4</b> Boosting</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="algorithms.html"><a href="algorithms.html#adaboost"><i class="fa fa-check"></i><b>2.4.1</b> Adaboost</a></li>
<li class="chapter" data-level="2.4.2" data-path="algorithms.html"><a href="algorithms.html#gbm-boost"><i class="fa fa-check"></i><b>2.4.2</b> GBM boost</a></li>
<li class="chapter" data-level="2.4.3" data-path="algorithms.html"><a href="algorithms.html#xgboost"><i class="fa fa-check"></i><b>2.4.3</b> XGBoost</a></li>
<li class="chapter" data-level="2.4.4" data-path="algorithms.html"><a href="algorithms.html#light-gbm-boost"><i class="fa fa-check"></i><b>2.4.4</b> Light GBM boost</a></li>
<li class="chapter" data-level="2.4.5" data-path="algorithms.html"><a href="algorithms.html#catboost"><i class="fa fa-check"></i><b>2.4.5</b> Catboost</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="algorithms.html"><a href="algorithms.html#other-non-parametric"><i class="fa fa-check"></i><b>2.5</b> Other Non-parametric</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="algorithms.html"><a href="algorithms.html#knn"><i class="fa fa-check"></i><b>2.5.1</b> KNN</a></li>
<li class="chapter" data-level="2.5.2" data-path="algorithms.html"><a href="algorithms.html#nueralnet"><i class="fa fa-check"></i><b>2.5.2</b> Nueralnet</a></li>
<li class="chapter" data-level="2.5.3" data-path="algorithms.html"><a href="algorithms.html#svm"><i class="fa fa-check"></i><b>2.5.3</b> SVM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="binary-application.html"><a href="binary-application.html"><i class="fa fa-check"></i><b>3</b> Binary Application</a>
<ul>
<li class="chapter" data-level="3.1" data-path="binary-application.html"><a href="binary-application.html#data-1"><i class="fa fa-check"></i><b>3.1</b> Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="binary-application.html"><a href="binary-application.html#data-prep"><i class="fa fa-check"></i><b>3.1.1</b> Data Prep</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="binary-application.html"><a href="binary-application.html#model-selection"><i class="fa fa-check"></i><b>3.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="binary-application.html"><a href="binary-application.html#functions"><i class="fa fa-check"></i><b>3.2.1</b> Functions</a></li>
<li class="chapter" data-level="3.2.2" data-path="binary-application.html"><a href="binary-application.html#xgb"><i class="fa fa-check"></i><b>3.2.2</b> XGB</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="binary-application.html"><a href="binary-application.html#comparisions"><i class="fa fa-check"></i><b>3.3</b> Comparisions</a></li>
<li class="chapter" data-level="3.4" data-path="binary-application.html"><a href="binary-application.html#statistic-selection"><i class="fa fa-check"></i><b>3.4</b> Statistic selection</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="binary-application.html"><a href="binary-application.html#section"><i class="fa fa-check"></i><b>3.4.1</b> 0.5</a></li>
<li class="chapter" data-level="3.4.2" data-path="binary-application.html"><a href="binary-application.html#youdens-j-statistic"><i class="fa fa-check"></i><b>3.4.2</b> Youden’s J Statistic</a></li>
<li class="chapter" data-level="3.4.3" data-path="binary-application.html"><a href="binary-application.html#fscore"><i class="fa fa-check"></i><b>3.4.3</b> Fscore</a></li>
<li class="chapter" data-level="3.4.4" data-path="binary-application.html"><a href="binary-application.html#roc-curve"><i class="fa fa-check"></i><b>3.4.4</b> ROC curve</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regressional-application.html"><a href="regressional-application.html"><i class="fa fa-check"></i><b>4</b> Regressional Application</a>
<ul>
<li class="chapter" data-level="4.1" data-path="regressional-application.html"><a href="regressional-application.html#data-2"><i class="fa fa-check"></i><b>4.1</b> Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="regressional-application.html"><a href="regressional-application.html#data-prep-1"><i class="fa fa-check"></i><b>4.1.1</b> Data Prep</a></li>
<li class="chapter" data-level="4.1.2" data-path="regressional-application.html"><a href="regressional-application.html#data-explorations"><i class="fa fa-check"></i><b>4.1.2</b> Data Explorations</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="regressional-application.html"><a href="regressional-application.html#model-selection-1"><i class="fa fa-check"></i><b>4.2</b> Model Selection</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="regressional-application.html"><a href="regressional-application.html#rf-1"><i class="fa fa-check"></i><b>4.2.1</b> RF</a></li>
<li class="chapter" data-level="4.2.2" data-path="regressional-application.html"><a href="regressional-application.html#lm-1"><i class="fa fa-check"></i><b>4.2.2</b> LM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="imbalanced-application.html"><a href="imbalanced-application.html"><i class="fa fa-check"></i><b>5</b> Imbalanced Application</a>
<ul>
<li class="chapter" data-level="5.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#data-3"><i class="fa fa-check"></i><b>5.1</b> Data</a></li>
<li class="chapter" data-level="5.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#approaches"><i class="fa fa-check"></i><b>5.2</b> Approaches</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="imbalanced-application.html"><a href="imbalanced-application.html#no-changes"><i class="fa fa-check"></i><b>5.2.1</b> No changes</a></li>
<li class="chapter" data-level="5.2.2" data-path="imbalanced-application.html"><a href="imbalanced-application.html#undersample"><i class="fa fa-check"></i><b>5.2.2</b> Undersample</a></li>
<li class="chapter" data-level="5.2.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#oversampling"><i class="fa fa-check"></i><b>5.2.3</b> Oversampling</a></li>
<li class="chapter" data-level="5.2.4" data-path="imbalanced-application.html"><a href="imbalanced-application.html#smoteing"><i class="fa fa-check"></i><b>5.2.4</b> Smoteing</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="imbalanced-application.html"><a href="imbalanced-application.html#statistic-selection-1"><i class="fa fa-check"></i><b>5.3</b> Statistic selection</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="speeds.html"><a href="speeds.html"><i class="fa fa-check"></i><b>6</b> Speeds</a>
<ul>
<li class="chapter" data-level="6.1" data-path="speeds.html"><a href="speeds.html#functions-to-run-the-tests"><i class="fa fa-check"></i><b>6.1</b> Functions to run the tests</a></li>
<li class="chapter" data-level="6.2" data-path="speeds.html"><a href="speeds.html#data-4"><i class="fa fa-check"></i><b>6.2</b> Data</a></li>
<li class="chapter" data-level="6.3" data-path="speeds.html"><a href="speeds.html#rows"><i class="fa fa-check"></i><b>6.3</b> 10,000 rows</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix"><i class="fa fa-check"></i><b>6.3.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.3.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix"><i class="fa fa-check"></i><b>6.3.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="speeds.html"><a href="speeds.html#rows-1"><i class="fa fa-check"></i><b>6.4</b> 500,000 rows</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="speeds.html"><a href="speeds.html#with-a-normal-matrix-1"><i class="fa fa-check"></i><b>6.4.1</b> With a normal Matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="speeds.html"><a href="speeds.html#with-a-sparse-matrix-1"><i class="fa fa-check"></i><b>6.4.2</b> With a sparse matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="speeds.html"><a href="speeds.html#presentations"><i class="fa fa-check"></i><b>6.5</b> Presentations</a></li>
<li class="chapter" data-level="6.6" data-path="speeds.html"><a href="speeds.html#analysis"><i class="fa fa-check"></i><b>6.6</b> Analysis</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="speeds.html"><a href="speeds.html#graphs"><i class="fa fa-check"></i><b>6.6.1</b> Graphs</a></li>
<li class="chapter" data-level="6.6.2" data-path="speeds.html"><a href="speeds.html#takaways"><i class="fa fa-check"></i><b>6.6.2</b> Takaways</a></li>
<li class="chapter" data-level="6.6.3" data-path="speeds.html"><a href="speeds.html#things-to-change"><i class="fa fa-check"></i><b>6.6.3</b> Things to change</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html"><i class="fa fa-check"></i><b>7</b> Multi Variable Classification</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#data-5"><i class="fa fa-check"></i><b>7.1</b> Data</a></li>
<li class="chapter" data-level="7.2" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#aucs"><i class="fa fa-check"></i><b>7.2</b> AUCs</a></li>
<li class="chapter" data-level="7.3" data-path="multi-variable-classification.html"><a href="multi-variable-classification.html#confusion-table"><i class="fa fa-check"></i><b>7.3</b> Confusion Table</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="h20.html"><a href="h20.html"><i class="fa fa-check"></i><b>8</b> h20</a>
<ul>
<li class="chapter" data-level="8.1" data-path="h20.html"><a href="h20.html#set-up"><i class="fa fa-check"></i><b>8.1</b> Set-Up</a></li>
<li class="chapter" data-level="8.2" data-path="h20.html"><a href="h20.html#eda"><i class="fa fa-check"></i><b>8.2</b> EDA</a></li>
<li class="chapter" data-level="8.3" data-path="h20.html"><a href="h20.html#models-h20"><i class="fa fa-check"></i><b>8.3</b> Models h20</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="h20.html"><a href="h20.html#random-forest"><i class="fa fa-check"></i><b>8.3.1</b> Random Forest</a></li>
<li class="chapter" data-level="8.3.2" data-path="h20.html"><a href="h20.html#gradient-boosting-machine"><i class="fa fa-check"></i><b>8.3.2</b> Gradient Boosting Machine</a></li>
<li class="chapter" data-level="8.3.3" data-path="h20.html"><a href="h20.html#automl"><i class="fa fa-check"></i><b>8.3.3</b> AutoML</a></li>
<li class="chapter" data-level="8.3.4" data-path="h20.html"><a href="h20.html#xgboost-1"><i class="fa fa-check"></i><b>8.3.4</b> XGBoost</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="econometrics.html"><a href="econometrics.html"><i class="fa fa-check"></i><b>9</b> 08_Econometrics</a>
<ul>
<li class="chapter" data-level="9.1" data-path="econometrics.html"><a href="econometrics.html#a.-california-test-scores"><i class="fa fa-check"></i><b>9.1</b> A. California Test Scores</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="econometrics.html"><a href="econometrics.html#introduction"><i class="fa fa-check"></i><b>9.1.1</b> Introduction</a></li>
<li class="chapter" data-level="9.1.2" data-path="econometrics.html"><a href="econometrics.html#theory"><i class="fa fa-check"></i><b>9.1.2</b> Theory</a></li>
<li class="chapter" data-level="9.1.3" data-path="econometrics.html"><a href="econometrics.html#building-the-models"><i class="fa fa-check"></i><b>9.1.3</b> Building The models</a></li>
<li class="chapter" data-level="9.1.4" data-path="econometrics.html"><a href="econometrics.html#proofs"><i class="fa fa-check"></i><b>9.1.4</b> Proofs</a></li>
<li class="chapter" data-level="9.1.5" data-path="econometrics.html"><a href="econometrics.html#tests"><i class="fa fa-check"></i><b>9.1.5</b> Tests</a></li>
<li class="chapter" data-level="9.1.6" data-path="econometrics.html"><a href="econometrics.html#significances-and-tests"><i class="fa fa-check"></i><b>9.1.6</b> Significances and Tests</a></li>
<li class="chapter" data-level="9.1.7" data-path="econometrics.html"><a href="econometrics.html#conclusion"><i class="fa fa-check"></i><b>9.1.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="econometrics.html"><a href="econometrics.html#auto-correlation"><i class="fa fa-check"></i><b>9.2</b> Auto Correlation</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="parrallel-processing.html"><a href="parrallel-processing.html"><i class="fa fa-check"></i><b>10</b> Parrallel Processing</a>
<ul>
<li class="chapter" data-level="10.1" data-path="parrallel-processing.html"><a href="parrallel-processing.html#parallel-with-parlapply"><i class="fa fa-check"></i><b>10.1</b> 1. parallel with parLapply</a></li>
<li class="chapter" data-level="10.2" data-path="parrallel-processing.html"><a href="parrallel-processing.html#foreach-with-doparallel"><i class="fa fa-check"></i><b>10.2</b> 2. foreach with doParallel</a></li>
<li class="chapter" data-level="10.3" data-path="parrallel-processing.html"><a href="parrallel-processing.html#future-with-future.apply"><i class="fa fa-check"></i><b>10.3</b> 3. future with future.apply</a></li>
<li class="chapter" data-level="10.4" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-with-furrr"><i class="fa fa-check"></i><b>10.4</b> 4. purrr with furrr</a></li>
<li class="chapter" data-level="10.5" data-path="parrallel-processing.html"><a href="parrallel-processing.html#purrr-synchronously"><i class="fa fa-check"></i><b>10.5</b> 5. purrr Synchronously</a></li>
<li class="chapter" data-level="10.6" data-path="parrallel-processing.html"><a href="parrallel-processing.html#comparisions-1"><i class="fa fa-check"></i><b>10.6</b> comparisions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="randomforestinsight.html"><a href="randomforestinsight.html"><i class="fa fa-check"></i><b>11</b> 10_RandomForestInsight</a></li>
<li class="chapter" data-level="12" data-path="sequential-data-embedding.html"><a href="sequential-data-embedding.html"><i class="fa fa-check"></i><b>12</b> Sequential Data Embedding</a></li>
<li class="chapter" data-level="13" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html"><i class="fa fa-check"></i><b>13</b> HCC_Survey_Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#our-data-and-purpose"><i class="fa fa-check"></i><b>13.1</b> Our data and Purpose</a></li>
<li class="chapter" data-level="13.2" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>13.2</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="13.3" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#modeling-random-forest"><i class="fa fa-check"></i><b>13.3</b> Modeling Random Forest</a></li>
<li class="chapter" data-level="13.4" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#global-importance"><i class="fa fa-check"></i><b>13.4</b> Global Importance</a></li>
<li class="chapter" data-level="13.5" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#local-importance"><i class="fa fa-check"></i><b>13.5</b> Local Importance</a></li>
<li class="chapter" data-level="13.6" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#partial-dependence-plots"><i class="fa fa-check"></i><b>13.6</b> Partial Dependence Plots</a></li>
<li class="chapter" data-level="13.7" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#random-forest-explainer"><i class="fa fa-check"></i><b>13.7</b> Random Forest Explainer</a></li>
<li class="chapter" data-level="13.8" data-path="hcc_survey_analysis.html"><a href="hcc_survey_analysis.html#final-notes"><i class="fa fa-check"></i><b>13.8</b> Final Notes</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="what_is_stacked_ensambled.html"><a href="what_is_stacked_ensambled.html"><i class="fa fa-check"></i><b>14</b> 13_What_Is_Stacked_Ensambled</a></li>
<li class="chapter" data-level="15" data-path="intro_econ_stats.html"><a href="intro_econ_stats.html"><i class="fa fa-check"></i><b>15</b> 14_Intro_Econ_Stats</a></li>
<li class="chapter" data-level="16" data-path="nfl.html"><a href="nfl.html"><i class="fa fa-check"></i><b>16</b> NFL</a>
<ul>
<li class="chapter" data-level="16.1" data-path="nfl.html"><a href="nfl.html#wbs"><i class="fa fa-check"></i><b>16.1</b> WBs</a></li>
<li class="chapter" data-level="16.2" data-path="nfl.html"><a href="nfl.html#rbs"><i class="fa fa-check"></i><b>16.2</b> RBs</a></li>
<li class="chapter" data-level="16.3" data-path="nfl.html"><a href="nfl.html#qbs"><i class="fa fa-check"></i><b>16.3</b> QBs</a></li>
<li class="chapter" data-level="16.4" data-path="nfl.html"><a href="nfl.html#plots-and-analysis"><i class="fa fa-check"></i><b>16.4</b> Plots and Analysis</a></li>
<li class="chapter" data-level="16.5" data-path="nfl.html"><a href="nfl.html#lists-to-do"><i class="fa fa-check"></i><b>16.5</b> Lists to do</a></li>
<li class="chapter" data-level="16.6" data-path="nfl.html"><a href="nfl.html#team-mates"><i class="fa fa-check"></i><b>16.6</b> team mates</a></li>
<li class="chapter" data-level="16.7" data-path="nfl.html"><a href="nfl.html#testing"><i class="fa fa-check"></i><b>16.7</b> Testing</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning Applications</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="what_is_stacked_ensambled" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">Chapter 14</span> 13_What_Is_Stacked_Ensambled<a href="what_is_stacked_ensambled.html#what_is_stacked_ensambled" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>WE USE RMSE NOT RMSPE… it can be prediction but chat gpt thinks its percentage and is a idiot</p>
<p>Stacked ensemble learning, or stacking, involves training multiple different types of models (e.g., decision trees, logistic regression, neural networks) and then combining their predictions using a “meta-model” or “meta-learner.” The meta-model learns to make the final prediction by considering the outputs of the individual models as input features. This approach often leads to better performance than any single model or bagging method like random forest.</p>
<p>Homogeneity vs. Heterogeneity:</p>
<p>Bagging typically uses homogeneous models (e.g., multiple CART trees), while stacked ensembles use heterogeneous models (e.g., GBM, random forest, neural networks).</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="what_is_stacked_ensambled.html#cb407-1" tabindex="-1"></a><span class="co"># Load the required libraries</span></span>
<span id="cb407-2"><a href="what_is_stacked_ensambled.html#cb407-2" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb407-3"><a href="what_is_stacked_ensambled.html#cb407-3" tabindex="-1"></a><span class="fu">library</span>(gbm)</span>
<span id="cb407-4"><a href="what_is_stacked_ensambled.html#cb407-4" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb407-5"><a href="what_is_stacked_ensambled.html#cb407-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb407-6"><a href="what_is_stacked_ensambled.html#cb407-6" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb407-7"><a href="what_is_stacked_ensambled.html#cb407-7" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code></pre></div>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="what_is_stacked_ensambled.html#cb408-1" tabindex="-1"></a><span class="co"># Get the number of cores minus 1</span></span>
<span id="cb408-2"><a href="what_is_stacked_ensambled.html#cb408-2" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">detectCores</span>() <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb408-3"><a href="what_is_stacked_ensambled.html#cb408-3" tabindex="-1"></a><span class="co"># Load the Boston dataset</span></span>
<span id="cb408-4"><a href="what_is_stacked_ensambled.html#cb408-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> Boston</span></code></pre></div>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="what_is_stacked_ensambled.html#cb409-1" tabindex="-1"></a><span class="co"># Convert the &#39;chas&#39; column to a factor</span></span>
<span id="cb409-2"><a href="what_is_stacked_ensambled.html#cb409-2" tabindex="-1"></a>data<span class="sc">$</span>chas <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>chas)</span>
<span id="cb409-3"><a href="what_is_stacked_ensambled.html#cb409-3" tabindex="-1"></a></span>
<span id="cb409-4"><a href="what_is_stacked_ensambled.html#cb409-4" tabindex="-1"></a><span class="co"># Scale all numeric columns in the data</span></span>
<span id="cb409-5"><a href="what_is_stacked_ensambled.html#cb409-5" tabindex="-1"></a>numeric_columns <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data, is.numeric)</span>
<span id="cb409-6"><a href="what_is_stacked_ensambled.html#cb409-6" tabindex="-1"></a>data[numeric_columns] <span class="ot">&lt;-</span> <span class="fu">scale</span>(data[numeric_columns])</span>
<span id="cb409-7"><a href="what_is_stacked_ensambled.html#cb409-7" tabindex="-1"></a></span>
<span id="cb409-8"><a href="what_is_stacked_ensambled.html#cb409-8" tabindex="-1"></a><span class="co"># Verify that the column names are correct</span></span>
<span id="cb409-9"><a href="what_is_stacked_ensambled.html#cb409-9" tabindex="-1"></a><span class="fu">colnames</span>(data) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;scale</span><span class="sc">\\</span><span class="st">((.+)</span><span class="sc">\\</span><span class="st">)&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>, <span class="fu">colnames</span>(data))</span>
<span id="cb409-10"><a href="what_is_stacked_ensambled.html#cb409-10" tabindex="-1"></a></span>
<span id="cb409-11"><a href="what_is_stacked_ensambled.html#cb409-11" tabindex="-1"></a><span class="co"># Now, the &#39;medv&#39; column should still be named &#39;medv&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="what_is_stacked_ensambled.html#cb410-1" tabindex="-1"></a><span class="co"># Train linear regression model</span></span>
<span id="cb410-2"><a href="what_is_stacked_ensambled.html#cb410-2" tabindex="-1"></a>lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> data)</span>
<span id="cb410-3"><a href="what_is_stacked_ensambled.html#cb410-3" tabindex="-1"></a></span>
<span id="cb410-4"><a href="what_is_stacked_ensambled.html#cb410-4" tabindex="-1"></a><span class="co"># Train random forest model</span></span>
<span id="cb410-5"><a href="what_is_stacked_ensambled.html#cb410-5" tabindex="-1"></a>rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> data)</span>
<span id="cb410-6"><a href="what_is_stacked_ensambled.html#cb410-6" tabindex="-1"></a></span>
<span id="cb410-7"><a href="what_is_stacked_ensambled.html#cb410-7" tabindex="-1"></a><span class="co"># Train gradient boosting model</span></span>
<span id="cb410-8"><a href="what_is_stacked_ensambled.html#cb410-8" tabindex="-1"></a>gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">n.trees =</span> <span class="dv">100</span>, <span class="at">interaction.depth =</span> <span class="dv">1</span>)</span>
<span id="cb410-9"><a href="what_is_stacked_ensambled.html#cb410-9" tabindex="-1"></a></span>
<span id="cb410-10"><a href="what_is_stacked_ensambled.html#cb410-10" tabindex="-1"></a><span class="co"># Generate predictions</span></span>
<span id="cb410-11"><a href="what_is_stacked_ensambled.html#cb410-11" tabindex="-1"></a>lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_mod, data)</span>
<span id="cb410-12"><a href="what_is_stacked_ensambled.html#cb410-12" tabindex="-1"></a>rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_mod, data)</span>
<span id="cb410-13"><a href="what_is_stacked_ensambled.html#cb410-13" tabindex="-1"></a>gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(gbm_mod, data, <span class="at">n.trees =</span> <span class="dv">100</span>)</span>
<span id="cb410-14"><a href="what_is_stacked_ensambled.html#cb410-14" tabindex="-1"></a></span>
<span id="cb410-15"><a href="what_is_stacked_ensambled.html#cb410-15" tabindex="-1"></a><span class="co"># Combine predictions into a data frame</span></span>
<span id="cb410-16"><a href="what_is_stacked_ensambled.html#cb410-16" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, gbm_pred)</span>
<span id="cb410-17"><a href="what_is_stacked_ensambled.html#cb410-17" tabindex="-1"></a></span>
<span id="cb410-18"><a href="what_is_stacked_ensambled.html#cb410-18" tabindex="-1"></a><span class="co"># Train linear regression as meta-model</span></span>
<span id="cb410-19"><a href="what_is_stacked_ensambled.html#cb410-19" tabindex="-1"></a>meta_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds, <span class="at">medv =</span> data<span class="sc">$</span>medv))</span>
<span id="cb410-20"><a href="what_is_stacked_ensambled.html#cb410-20" tabindex="-1"></a></span>
<span id="cb410-21"><a href="what_is_stacked_ensambled.html#cb410-21" tabindex="-1"></a><span class="co"># Predict using meta-model</span></span>
<span id="cb410-22"><a href="what_is_stacked_ensambled.html#cb410-22" tabindex="-1"></a>meta_lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_lm, preds)</span>
<span id="cb410-23"><a href="what_is_stacked_ensambled.html#cb410-23" tabindex="-1"></a></span>
<span id="cb410-24"><a href="what_is_stacked_ensambled.html#cb410-24" tabindex="-1"></a><span class="co"># Calculate RMSPE (now as RMSE since the percentage part is removed)</span></span>
<span id="cb410-25"><a href="what_is_stacked_ensambled.html#cb410-25" tabindex="-1"></a>rmspe_lm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_lm_pred <span class="sc">-</span> data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb410-26"><a href="what_is_stacked_ensambled.html#cb410-26" tabindex="-1"></a></span>
<span id="cb410-27"><a href="what_is_stacked_ensambled.html#cb410-27" tabindex="-1"></a><span class="co"># Train random forest as meta-model</span></span>
<span id="cb410-28"><a href="what_is_stacked_ensambled.html#cb410-28" tabindex="-1"></a>meta_rf <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds, <span class="at">medv =</span> data<span class="sc">$</span>medv))</span>
<span id="cb410-29"><a href="what_is_stacked_ensambled.html#cb410-29" tabindex="-1"></a></span>
<span id="cb410-30"><a href="what_is_stacked_ensambled.html#cb410-30" tabindex="-1"></a><span class="co"># Predict using meta-model</span></span>
<span id="cb410-31"><a href="what_is_stacked_ensambled.html#cb410-31" tabindex="-1"></a>meta_rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_rf, preds)</span>
<span id="cb410-32"><a href="what_is_stacked_ensambled.html#cb410-32" tabindex="-1"></a></span>
<span id="cb410-33"><a href="what_is_stacked_ensambled.html#cb410-33" tabindex="-1"></a><span class="co"># Calculate RMSPE (now as RMSE since the percentage part is removed)</span></span>
<span id="cb410-34"><a href="what_is_stacked_ensambled.html#cb410-34" tabindex="-1"></a>rmspe_rf <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_rf_pred <span class="sc">-</span> data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb410-35"><a href="what_is_stacked_ensambled.html#cb410-35" tabindex="-1"></a></span>
<span id="cb410-36"><a href="what_is_stacked_ensambled.html#cb410-36" tabindex="-1"></a><span class="co"># Train gradient boosting as meta-model</span></span>
<span id="cb410-37"><a href="what_is_stacked_ensambled.html#cb410-37" tabindex="-1"></a>meta_gbm <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds, <span class="at">medv =</span> data<span class="sc">$</span>medv), <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">n.trees =</span> <span class="dv">100</span>, <span class="at">interaction.depth =</span> <span class="dv">1</span>)</span>
<span id="cb410-38"><a href="what_is_stacked_ensambled.html#cb410-38" tabindex="-1"></a></span>
<span id="cb410-39"><a href="what_is_stacked_ensambled.html#cb410-39" tabindex="-1"></a><span class="co"># Predict using meta-model</span></span>
<span id="cb410-40"><a href="what_is_stacked_ensambled.html#cb410-40" tabindex="-1"></a>meta_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_gbm, preds, <span class="at">n.trees =</span> <span class="dv">100</span>)</span>
<span id="cb410-41"><a href="what_is_stacked_ensambled.html#cb410-41" tabindex="-1"></a></span>
<span id="cb410-42"><a href="what_is_stacked_ensambled.html#cb410-42" tabindex="-1"></a><span class="co"># Calculate RMSPE (now as RMSE since the percentage part is removed)</span></span>
<span id="cb410-43"><a href="what_is_stacked_ensambled.html#cb410-43" tabindex="-1"></a>rmspe_gbm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_gbm_pred <span class="sc">-</span> data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb410-44"><a href="what_is_stacked_ensambled.html#cb410-44" tabindex="-1"></a></span>
<span id="cb410-45"><a href="what_is_stacked_ensambled.html#cb410-45" tabindex="-1"></a><span class="co"># Calculate RMSPE for base models (now as RMSE since the percentage part is removed)</span></span>
<span id="cb410-46"><a href="what_is_stacked_ensambled.html#cb410-46" tabindex="-1"></a>rmspe_base_lm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((lm_pred <span class="sc">-</span> data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb410-47"><a href="what_is_stacked_ensambled.html#cb410-47" tabindex="-1"></a>rmspe_base_rf <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((rf_pred <span class="sc">-</span> data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb410-48"><a href="what_is_stacked_ensambled.html#cb410-48" tabindex="-1"></a>rmspe_base_gbm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((gbm_pred <span class="sc">-</span> data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb410-49"><a href="what_is_stacked_ensambled.html#cb410-49" tabindex="-1"></a></span>
<span id="cb410-50"><a href="what_is_stacked_ensambled.html#cb410-50" tabindex="-1"></a><span class="co"># Find the best base model&#39;s RMSPE</span></span>
<span id="cb410-51"><a href="what_is_stacked_ensambled.html#cb410-51" tabindex="-1"></a>best_base_rmspe <span class="ot">&lt;-</span> <span class="fu">min</span>(rmspe_base_lm, rmspe_base_rf, rmspe_base_gbm)</span>
<span id="cb410-52"><a href="what_is_stacked_ensambled.html#cb410-52" tabindex="-1"></a>worst_base_rmspe <span class="ot">&lt;-</span> <span class="fu">max</span>(rmspe_base_lm, rmspe_base_rf, rmspe_base_gbm)</span>
<span id="cb410-53"><a href="what_is_stacked_ensambled.html#cb410-53" tabindex="-1"></a><span class="co"># Print the RMSPEs</span></span>
<span id="cb410-54"><a href="what_is_stacked_ensambled.html#cb410-54" tabindex="-1"></a><span class="fu">print</span>(rmspe_lm)</span></code></pre></div>
<pre><code>## [1] 0.1014164</code></pre>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="what_is_stacked_ensambled.html#cb412-1" tabindex="-1"></a><span class="fu">print</span>(rmspe_rf)</span></code></pre></div>
<pre><code>## [1] 0.08832115</code></pre>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="what_is_stacked_ensambled.html#cb414-1" tabindex="-1"></a><span class="fu">print</span>(rmspe_gbm)</span></code></pre></div>
<pre><code>## [1] 0.1279383</code></pre>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="what_is_stacked_ensambled.html#cb416-1" tabindex="-1"></a><span class="fu">print</span>(best_base_rmspe)</span></code></pre></div>
<pre><code>## [1] 0.1526848</code></pre>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="what_is_stacked_ensambled.html#cb418-1" tabindex="-1"></a><span class="fu">print</span>(worst_base_rmspe)</span></code></pre></div>
<pre><code>## [1] 0.5087679</code></pre>
<p>Now we see that the stacked ensemble models have lower RMSPE compared to the individual base models.</p>
<p>However the GBM model wasnt tuned at all. what is the effect of tuning the GBM model?</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="what_is_stacked_ensambled.html#cb420-1" tabindex="-1"></a><span class="co"># Hyperparameter tuning grid</span></span>
<span id="cb420-2"><a href="what_is_stacked_ensambled.html#cb420-2" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb420-3"><a href="what_is_stacked_ensambled.html#cb420-3" tabindex="-1"></a>  <span class="at">n.trees =</span> <span class="fu">seq</span>(<span class="dv">50</span>, <span class="dv">200</span>, <span class="at">by =</span> <span class="dv">50</span>),</span>
<span id="cb420-4"><a href="what_is_stacked_ensambled.html#cb420-4" tabindex="-1"></a>  <span class="at">shrinkage =</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="at">by =</span> <span class="fl">0.04</span>),</span>
<span id="cb420-5"><a href="what_is_stacked_ensambled.html#cb420-5" tabindex="-1"></a>  <span class="at">interaction.depth =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb420-6"><a href="what_is_stacked_ensambled.html#cb420-6" tabindex="-1"></a>)</span>
<span id="cb420-7"><a href="what_is_stacked_ensambled.html#cb420-7" tabindex="-1"></a></span>
<span id="cb420-8"><a href="what_is_stacked_ensambled.html#cb420-8" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n.trees =</span> <span class="fu">integer</span>(), <span class="at">shrinkage =</span> <span class="fu">numeric</span>(), <span class="at">interaction.depth =</span> <span class="fu">integer</span>(), <span class="at">cv.error =</span> <span class="fu">numeric</span>())</span>
<span id="cb420-9"><a href="what_is_stacked_ensambled.html#cb420-9" tabindex="-1"></a></span>
<span id="cb420-10"><a href="what_is_stacked_ensambled.html#cb420-10" tabindex="-1"></a><span class="co"># Loop over the grid</span></span>
<span id="cb420-11"><a href="what_is_stacked_ensambled.html#cb420-11" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(grid)) {</span>
<span id="cb420-12"><a href="what_is_stacked_ensambled.html#cb420-12" tabindex="-1"></a>  </span>
<span id="cb420-13"><a href="what_is_stacked_ensambled.html#cb420-13" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;/&quot;</span>, <span class="fu">nrow</span>(grid), <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb420-14"><a href="what_is_stacked_ensambled.html#cb420-14" tabindex="-1"></a>  </span>
<span id="cb420-15"><a href="what_is_stacked_ensambled.html#cb420-15" tabindex="-1"></a>  gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., </span>
<span id="cb420-16"><a href="what_is_stacked_ensambled.html#cb420-16" tabindex="-1"></a>                 <span class="at">data =</span> data, </span>
<span id="cb420-17"><a href="what_is_stacked_ensambled.html#cb420-17" tabindex="-1"></a>                 <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb420-18"><a href="what_is_stacked_ensambled.html#cb420-18" tabindex="-1"></a>                 <span class="at">n.trees =</span> grid<span class="sc">$</span>n.trees[i], </span>
<span id="cb420-19"><a href="what_is_stacked_ensambled.html#cb420-19" tabindex="-1"></a>                 <span class="at">shrinkage =</span> grid<span class="sc">$</span>shrinkage[i], </span>
<span id="cb420-20"><a href="what_is_stacked_ensambled.html#cb420-20" tabindex="-1"></a>                 <span class="at">interaction.depth =</span> grid<span class="sc">$</span>interaction.depth[i], </span>
<span id="cb420-21"><a href="what_is_stacked_ensambled.html#cb420-21" tabindex="-1"></a>                 <span class="at">cv.folds =</span> <span class="dv">3</span>, </span>
<span id="cb420-22"><a href="what_is_stacked_ensambled.html#cb420-22" tabindex="-1"></a>                 <span class="at">n.cores =</span> nc, </span>
<span id="cb420-23"><a href="what_is_stacked_ensambled.html#cb420-23" tabindex="-1"></a>                 <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb420-24"><a href="what_is_stacked_ensambled.html#cb420-24" tabindex="-1"></a>  </span>
<span id="cb420-25"><a href="what_is_stacked_ensambled.html#cb420-25" tabindex="-1"></a>  <span class="co"># Get the cross-validation error</span></span>
<span id="cb420-26"><a href="what_is_stacked_ensambled.html#cb420-26" tabindex="-1"></a>  cv_error <span class="ot">&lt;-</span> <span class="fu">min</span>(gbm_mod<span class="sc">$</span>cv.error)</span>
<span id="cb420-27"><a href="what_is_stacked_ensambled.html#cb420-27" tabindex="-1"></a>  </span>
<span id="cb420-28"><a href="what_is_stacked_ensambled.html#cb420-28" tabindex="-1"></a>  <span class="co"># Store the results</span></span>
<span id="cb420-29"><a href="what_is_stacked_ensambled.html#cb420-29" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(<span class="at">n.trees =</span> grid<span class="sc">$</span>n.trees[i], <span class="at">shrinkage =</span> grid<span class="sc">$</span>shrinkage[i], <span class="at">interaction.depth =</span> grid<span class="sc">$</span>interaction.depth[i], <span class="at">cv.error =</span> cv_error))</span>
<span id="cb420-30"><a href="what_is_stacked_ensambled.html#cb420-30" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
Progress: 1 / 24 iterations completed
Progress: 2 / 24 iterations completed
Progress: 3 / 24 iterations completed
Progress: 4 / 24 iterations completed
Progress: 5 / 24 iterations completed
Progress: 6 / 24 iterations completed
Progress: 7 / 24 iterations completed
Progress: 8 / 24 iterations completed
Progress: 9 / 24 iterations completed
Progress: 10 / 24 iterations completed
Progress: 11 / 24 iterations completed
Progress: 12 / 24 iterations completed
Progress: 13 / 24 iterations completed
Progress: 14 / 24 iterations completed
Progress: 15 / 24 iterations completed
Progress: 16 / 24 iterations completed
Progress: 17 / 24 iterations completed
Progress: 18 / 24 iterations completed
Progress: 19 / 24 iterations completed
Progress: 20 / 24 iterations completed
Progress: 21 / 24 iterations completed
Progress: 22 / 24 iterations completed
Progress: 23 / 24 iterations completed
Progress: 24 / 24 iterations completed</code></pre>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="what_is_stacked_ensambled.html#cb422-1" tabindex="-1"></a><span class="co"># Find the best hyperparameters - base R version</span></span>
<span id="cb422-2"><a href="what_is_stacked_ensambled.html#cb422-2" tabindex="-1"></a>best_params <span class="ot">&lt;-</span> results[<span class="fu">order</span>(results<span class="sc">$</span>cv.error), ][<span class="dv">1</span>, ]</span>
<span id="cb422-3"><a href="what_is_stacked_ensambled.html#cb422-3" tabindex="-1"></a><span class="fu">print</span>(best_params)</span></code></pre></div>
<pre><code>##    n.trees shrinkage interaction.depth cv.error
## 24     200      0.13                 3  0.12826</code></pre>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="what_is_stacked_ensambled.html#cb424-1" tabindex="-1"></a>rmspe_t2 <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb424-2"><a href="what_is_stacked_ensambled.html#cb424-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb424-3"><a href="what_is_stacked_ensambled.html#cb424-3" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb424-4"><a href="what_is_stacked_ensambled.html#cb424-4" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb424-5"><a href="what_is_stacked_ensambled.html#cb424-5" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb424-6"><a href="what_is_stacked_ensambled.html#cb424-6" tabindex="-1"></a></span>
<span id="cb424-7"><a href="what_is_stacked_ensambled.html#cb424-7" tabindex="-1"></a><span class="co"># Train the GBM model with the best hyperparameters</span></span>
<span id="cb424-8"><a href="what_is_stacked_ensambled.html#cb424-8" tabindex="-1"></a>best_gbm <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., </span>
<span id="cb424-9"><a href="what_is_stacked_ensambled.html#cb424-9" tabindex="-1"></a>                <span class="at">data =</span> train_data, </span>
<span id="cb424-10"><a href="what_is_stacked_ensambled.html#cb424-10" tabindex="-1"></a>                <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>,</span>
<span id="cb424-11"><a href="what_is_stacked_ensambled.html#cb424-11" tabindex="-1"></a>                <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb424-12"><a href="what_is_stacked_ensambled.html#cb424-12" tabindex="-1"></a></span>
<span id="cb424-13"><a href="what_is_stacked_ensambled.html#cb424-13" tabindex="-1"></a><span class="co"># Predict on the test set</span></span>
<span id="cb424-14"><a href="what_is_stacked_ensambled.html#cb424-14" tabindex="-1"></a>test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_gbm, test_data, <span class="at">n.trees =</span> <span class="dv">100</span>)</span>
<span id="cb424-15"><a href="what_is_stacked_ensambled.html#cb424-15" tabindex="-1"></a></span>
<span id="cb424-16"><a href="what_is_stacked_ensambled.html#cb424-16" tabindex="-1"></a><span class="co"># Calculate RMSPE on the test set (now as RMSE since the percentage part is removed)</span></span>
<span id="cb424-17"><a href="what_is_stacked_ensambled.html#cb424-17" tabindex="-1"></a>rmspe_t2[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb424-18"><a href="what_is_stacked_ensambled.html#cb424-18" tabindex="-1"></a></span>
<span id="cb424-19"><a href="what_is_stacked_ensambled.html#cb424-19" tabindex="-1"></a>}</span>
<span id="cb424-20"><a href="what_is_stacked_ensambled.html#cb424-20" tabindex="-1"></a></span>
<span id="cb424-21"><a href="what_is_stacked_ensambled.html#cb424-21" tabindex="-1"></a><span class="fu">mean</span>(rmspe_t2)</span></code></pre></div>
<pre><code>## [1] 0.4297122</code></pre>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="what_is_stacked_ensambled.html#cb426-1" tabindex="-1"></a>rmspe_test <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb426-2"><a href="what_is_stacked_ensambled.html#cb426-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb426-3"><a href="what_is_stacked_ensambled.html#cb426-3" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb426-4"><a href="what_is_stacked_ensambled.html#cb426-4" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb426-5"><a href="what_is_stacked_ensambled.html#cb426-5" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb426-6"><a href="what_is_stacked_ensambled.html#cb426-6" tabindex="-1"></a></span>
<span id="cb426-7"><a href="what_is_stacked_ensambled.html#cb426-7" tabindex="-1"></a><span class="co"># Train the GBM model with the best hyperparameters</span></span>
<span id="cb426-8"><a href="what_is_stacked_ensambled.html#cb426-8" tabindex="-1"></a>best_gbm <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., </span>
<span id="cb426-9"><a href="what_is_stacked_ensambled.html#cb426-9" tabindex="-1"></a>                <span class="at">data =</span> train_data, </span>
<span id="cb426-10"><a href="what_is_stacked_ensambled.html#cb426-10" tabindex="-1"></a>                <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb426-11"><a href="what_is_stacked_ensambled.html#cb426-11" tabindex="-1"></a>                <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees, </span>
<span id="cb426-12"><a href="what_is_stacked_ensambled.html#cb426-12" tabindex="-1"></a>                <span class="at">shrinkage =</span> best_params<span class="sc">$</span>shrinkage, </span>
<span id="cb426-13"><a href="what_is_stacked_ensambled.html#cb426-13" tabindex="-1"></a>                <span class="at">interaction.depth =</span> best_params<span class="sc">$</span>interaction.depth)</span>
<span id="cb426-14"><a href="what_is_stacked_ensambled.html#cb426-14" tabindex="-1"></a></span>
<span id="cb426-15"><a href="what_is_stacked_ensambled.html#cb426-15" tabindex="-1"></a><span class="co"># Predict on the test set</span></span>
<span id="cb426-16"><a href="what_is_stacked_ensambled.html#cb426-16" tabindex="-1"></a>test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_gbm, test_data, <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees)</span>
<span id="cb426-17"><a href="what_is_stacked_ensambled.html#cb426-17" tabindex="-1"></a></span>
<span id="cb426-18"><a href="what_is_stacked_ensambled.html#cb426-18" tabindex="-1"></a><span class="co"># Calculate RMSPE on the test set (now as RMSE since the percentage part is removed)</span></span>
<span id="cb426-19"><a href="what_is_stacked_ensambled.html#cb426-19" tabindex="-1"></a>rmspe_test[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb426-20"><a href="what_is_stacked_ensambled.html#cb426-20" tabindex="-1"></a></span>
<span id="cb426-21"><a href="what_is_stacked_ensambled.html#cb426-21" tabindex="-1"></a>}</span>
<span id="cb426-22"><a href="what_is_stacked_ensambled.html#cb426-22" tabindex="-1"></a></span>
<span id="cb426-23"><a href="what_is_stacked_ensambled.html#cb426-23" tabindex="-1"></a><span class="fu">mean</span>(rmspe_test)</span></code></pre></div>
<pre><code>## [1] 0.3751048</code></pre>
<p>Now we see that we have a slightly tuned gbm model. SO will this better tuned base model effect the stacked ensemble model?</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="what_is_stacked_ensambled.html#cb428-1" tabindex="-1"></a><span class="co"># Store RMSPE results for the two stacked ensembles</span></span>
<span id="cb428-2"><a href="what_is_stacked_ensambled.html#cb428-2" tabindex="-1"></a>rmspe_ensemble_original <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb428-3"><a href="what_is_stacked_ensambled.html#cb428-3" tabindex="-1"></a>rmspe_ensemble_tuned <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb428-4"><a href="what_is_stacked_ensambled.html#cb428-4" tabindex="-1"></a></span>
<span id="cb428-5"><a href="what_is_stacked_ensambled.html#cb428-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb428-6"><a href="what_is_stacked_ensambled.html#cb428-6" tabindex="-1"></a>   <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb428-7"><a href="what_is_stacked_ensambled.html#cb428-7" tabindex="-1"></a></span>
<span id="cb428-8"><a href="what_is_stacked_ensambled.html#cb428-8" tabindex="-1"></a>  <span class="co"># Bootstrapping</span></span>
<span id="cb428-9"><a href="what_is_stacked_ensambled.html#cb428-9" tabindex="-1"></a>  train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb428-10"><a href="what_is_stacked_ensambled.html#cb428-10" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb428-11"><a href="what_is_stacked_ensambled.html#cb428-11" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb428-12"><a href="what_is_stacked_ensambled.html#cb428-12" tabindex="-1"></a>  </span>
<span id="cb428-13"><a href="what_is_stacked_ensambled.html#cb428-13" tabindex="-1"></a>  <span class="co"># Original Base Models</span></span>
<span id="cb428-14"><a href="what_is_stacked_ensambled.html#cb428-14" tabindex="-1"></a>  lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb428-15"><a href="what_is_stacked_ensambled.html#cb428-15" tabindex="-1"></a>  rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb428-16"><a href="what_is_stacked_ensambled.html#cb428-16" tabindex="-1"></a>  gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">n.trees =</span> <span class="dv">100</span>, <span class="at">interaction.depth =</span> <span class="dv">1</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb428-17"><a href="what_is_stacked_ensambled.html#cb428-17" tabindex="-1"></a>  </span>
<span id="cb428-18"><a href="what_is_stacked_ensambled.html#cb428-18" tabindex="-1"></a>  <span class="co"># Generate predictions</span></span>
<span id="cb428-19"><a href="what_is_stacked_ensambled.html#cb428-19" tabindex="-1"></a>  lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_mod, test_data)</span>
<span id="cb428-20"><a href="what_is_stacked_ensambled.html#cb428-20" tabindex="-1"></a>  rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_mod, test_data)</span>
<span id="cb428-21"><a href="what_is_stacked_ensambled.html#cb428-21" tabindex="-1"></a>  gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(gbm_mod, test_data, <span class="at">n.trees =</span> <span class="dv">100</span>)</span>
<span id="cb428-22"><a href="what_is_stacked_ensambled.html#cb428-22" tabindex="-1"></a>  </span>
<span id="cb428-23"><a href="what_is_stacked_ensambled.html#cb428-23" tabindex="-1"></a>  <span class="co"># Combine predictions into a data frame</span></span>
<span id="cb428-24"><a href="what_is_stacked_ensambled.html#cb428-24" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, gbm_pred)</span>
<span id="cb428-25"><a href="what_is_stacked_ensambled.html#cb428-25" tabindex="-1"></a>  </span>
<span id="cb428-26"><a href="what_is_stacked_ensambled.html#cb428-26" tabindex="-1"></a>  <span class="co"># Train and evaluate original stacked ensemble</span></span>
<span id="cb428-27"><a href="what_is_stacked_ensambled.html#cb428-27" tabindex="-1"></a>  meta_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds, <span class="at">medv =</span> test_data<span class="sc">$</span>medv))</span>
<span id="cb428-28"><a href="what_is_stacked_ensambled.html#cb428-28" tabindex="-1"></a>  meta_lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_lm, preds)</span>
<span id="cb428-29"><a href="what_is_stacked_ensambled.html#cb428-29" tabindex="-1"></a>  rmspe_ensemble_original[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_lm_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb428-30"><a href="what_is_stacked_ensambled.html#cb428-30" tabindex="-1"></a>  </span>
<span id="cb428-31"><a href="what_is_stacked_ensambled.html#cb428-31" tabindex="-1"></a>  <span class="co"># Train and evaluate stacked ensemble with tuned GBM model</span></span>
<span id="cb428-32"><a href="what_is_stacked_ensambled.html#cb428-32" tabindex="-1"></a>  tuned_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb428-33"><a href="what_is_stacked_ensambled.html#cb428-33" tabindex="-1"></a>                       <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees, </span>
<span id="cb428-34"><a href="what_is_stacked_ensambled.html#cb428-34" tabindex="-1"></a>                       <span class="at">shrinkage =</span> best_params<span class="sc">$</span>shrinkage, </span>
<span id="cb428-35"><a href="what_is_stacked_ensambled.html#cb428-35" tabindex="-1"></a>                       <span class="at">interaction.depth =</span> best_params<span class="sc">$</span>interaction.depth, </span>
<span id="cb428-36"><a href="what_is_stacked_ensambled.html#cb428-36" tabindex="-1"></a>                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb428-37"><a href="what_is_stacked_ensambled.html#cb428-37" tabindex="-1"></a>  </span>
<span id="cb428-38"><a href="what_is_stacked_ensambled.html#cb428-38" tabindex="-1"></a>  gbm_pred_tuned <span class="ot">&lt;-</span> <span class="fu">predict</span>(tuned_gbm_mod, test_data, <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees)</span>
<span id="cb428-39"><a href="what_is_stacked_ensambled.html#cb428-39" tabindex="-1"></a>  </span>
<span id="cb428-40"><a href="what_is_stacked_ensambled.html#cb428-40" tabindex="-1"></a>  <span class="co"># Combine predictions with tuned GBM</span></span>
<span id="cb428-41"><a href="what_is_stacked_ensambled.html#cb428-41" tabindex="-1"></a>  preds_tuned <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, gbm_pred_tuned)</span>
<span id="cb428-42"><a href="what_is_stacked_ensambled.html#cb428-42" tabindex="-1"></a>  </span>
<span id="cb428-43"><a href="what_is_stacked_ensambled.html#cb428-43" tabindex="-1"></a>  meta_lm_tuned <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds_tuned, <span class="at">medv =</span> test_data<span class="sc">$</span>medv))</span>
<span id="cb428-44"><a href="what_is_stacked_ensambled.html#cb428-44" tabindex="-1"></a>  meta_lm_pred_tuned <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_lm_tuned, preds_tuned)</span>
<span id="cb428-45"><a href="what_is_stacked_ensambled.html#cb428-45" tabindex="-1"></a>  rmspe_ensemble_tuned[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_lm_pred_tuned <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb428-46"><a href="what_is_stacked_ensambled.html#cb428-46" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
Progress: 1 iterations completed
Progress: 2 iterations completed
Progress: 3 iterations completed
Progress: 4 iterations completed
Progress: 5 iterations completed
Progress: 6 iterations completed
Progress: 7 iterations completed
Progress: 8 iterations completed
Progress: 9 iterations completed
Progress: 10 iterations completed
Progress: 11 iterations completed
Progress: 12 iterations completed
Progress: 13 iterations completed
Progress: 14 iterations completed
Progress: 15 iterations completed
Progress: 16 iterations completed
Progress: 17 iterations completed
Progress: 18 iterations completed
Progress: 19 iterations completed
Progress: 20 iterations completed
Progress: 21 iterations completed
Progress: 22 iterations completed
Progress: 23 iterations completed
Progress: 24 iterations completed
Progress: 25 iterations completed
Progress: 26 iterations completed
Progress: 27 iterations completed
Progress: 28 iterations completed
Progress: 29 iterations completed
Progress: 30 iterations completed
Progress: 31 iterations completed
Progress: 32 iterations completed
Progress: 33 iterations completed
Progress: 34 iterations completed
Progress: 35 iterations completed
Progress: 36 iterations completed
Progress: 37 iterations completed
Progress: 38 iterations completed
Progress: 39 iterations completed
Progress: 40 iterations completed
Progress: 41 iterations completed
Progress: 42 iterations completed
Progress: 43 iterations completed
Progress: 44 iterations completed
Progress: 45 iterations completed
Progress: 46 iterations completed
Progress: 47 iterations completed
Progress: 48 iterations completed
Progress: 49 iterations completed
Progress: 50 iterations completed
Progress: 51 iterations completed
Progress: 52 iterations completed
Progress: 53 iterations completed
Progress: 54 iterations completed
Progress: 55 iterations completed
Progress: 56 iterations completed
Progress: 57 iterations completed
Progress: 58 iterations completed
Progress: 59 iterations completed
Progress: 60 iterations completed
Progress: 61 iterations completed
Progress: 62 iterations completed
Progress: 63 iterations completed
Progress: 64 iterations completed
Progress: 65 iterations completed
Progress: 66 iterations completed
Progress: 67 iterations completed
Progress: 68 iterations completed
Progress: 69 iterations completed
Progress: 70 iterations completed
Progress: 71 iterations completed
Progress: 72 iterations completed
Progress: 73 iterations completed
Progress: 74 iterations completed
Progress: 75 iterations completed
Progress: 76 iterations completed
Progress: 77 iterations completed
Progress: 78 iterations completed
Progress: 79 iterations completed
Progress: 80 iterations completed
Progress: 81 iterations completed
Progress: 82 iterations completed
Progress: 83 iterations completed
Progress: 84 iterations completed
Progress: 85 iterations completed
Progress: 86 iterations completed
Progress: 87 iterations completed
Progress: 88 iterations completed
Progress: 89 iterations completed
Progress: 90 iterations completed
Progress: 91 iterations completed
Progress: 92 iterations completed
Progress: 93 iterations completed
Progress: 94 iterations completed
Progress: 95 iterations completed
Progress: 96 iterations completed
Progress: 97 iterations completed
Progress: 98 iterations completed
Progress: 99 iterations completed
Progress: 100 iterations completed
Progress: 101 iterations completed
Progress: 102 iterations completed
Progress: 103 iterations completed
Progress: 104 iterations completed
Progress: 105 iterations completed
Progress: 106 iterations completed
Progress: 107 iterations completed
Progress: 108 iterations completed
Progress: 109 iterations completed
Progress: 110 iterations completed
Progress: 111 iterations completed
Progress: 112 iterations completed
Progress: 113 iterations completed
Progress: 114 iterations completed
Progress: 115 iterations completed
Progress: 116 iterations completed
Progress: 117 iterations completed
Progress: 118 iterations completed
Progress: 119 iterations completed
Progress: 120 iterations completed
Progress: 121 iterations completed
Progress: 122 iterations completed
Progress: 123 iterations completed
Progress: 124 iterations completed
Progress: 125 iterations completed
Progress: 126 iterations completed
Progress: 127 iterations completed
Progress: 128 iterations completed
Progress: 129 iterations completed
Progress: 130 iterations completed
Progress: 131 iterations completed
Progress: 132 iterations completed
Progress: 133 iterations completed
Progress: 134 iterations completed
Progress: 135 iterations completed
Progress: 136 iterations completed
Progress: 137 iterations completed
Progress: 138 iterations completed
Progress: 139 iterations completed
Progress: 140 iterations completed
Progress: 141 iterations completed
Progress: 142 iterations completed
Progress: 143 iterations completed
Progress: 144 iterations completed
Progress: 145 iterations completed
Progress: 146 iterations completed
Progress: 147 iterations completed
Progress: 148 iterations completed
Progress: 149 iterations completed
Progress: 150 iterations completed
Progress: 151 iterations completed
Progress: 152 iterations completed
Progress: 153 iterations completed
Progress: 154 iterations completed
Progress: 155 iterations completed
Progress: 156 iterations completed
Progress: 157 iterations completed
Progress: 158 iterations completed
Progress: 159 iterations completed
Progress: 160 iterations completed
Progress: 161 iterations completed
Progress: 162 iterations completed
Progress: 163 iterations completed
Progress: 164 iterations completed
Progress: 165 iterations completed
Progress: 166 iterations completed
Progress: 167 iterations completed
Progress: 168 iterations completed
Progress: 169 iterations completed
Progress: 170 iterations completed
Progress: 171 iterations completed
Progress: 172 iterations completed
Progress: 173 iterations completed
Progress: 174 iterations completed
Progress: 175 iterations completed
Progress: 176 iterations completed
Progress: 177 iterations completed
Progress: 178 iterations completed
Progress: 179 iterations completed
Progress: 180 iterations completed
Progress: 181 iterations completed
Progress: 182 iterations completed
Progress: 183 iterations completed
Progress: 184 iterations completed
Progress: 185 iterations completed
Progress: 186 iterations completed
Progress: 187 iterations completed
Progress: 188 iterations completed
Progress: 189 iterations completed
Progress: 190 iterations completed
Progress: 191 iterations completed
Progress: 192 iterations completed
Progress: 193 iterations completed
Progress: 194 iterations completed
Progress: 195 iterations completed
Progress: 196 iterations completed
Progress: 197 iterations completed
Progress: 198 iterations completed
Progress: 199 iterations completed
Progress: 200 iterations completed
Progress: 201 iterations completed
Progress: 202 iterations completed
Progress: 203 iterations completed
Progress: 204 iterations completed
Progress: 205 iterations completed
Progress: 206 iterations completed
Progress: 207 iterations completed
Progress: 208 iterations completed
Progress: 209 iterations completed
Progress: 210 iterations completed
Progress: 211 iterations completed
Progress: 212 iterations completed
Progress: 213 iterations completed
Progress: 214 iterations completed
Progress: 215 iterations completed
Progress: 216 iterations completed
Progress: 217 iterations completed
Progress: 218 iterations completed
Progress: 219 iterations completed
Progress: 220 iterations completed
Progress: 221 iterations completed
Progress: 222 iterations completed
Progress: 223 iterations completed
Progress: 224 iterations completed
Progress: 225 iterations completed
Progress: 226 iterations completed
Progress: 227 iterations completed
Progress: 228 iterations completed
Progress: 229 iterations completed
Progress: 230 iterations completed
Progress: 231 iterations completed
Progress: 232 iterations completed
Progress: 233 iterations completed
Progress: 234 iterations completed
Progress: 235 iterations completed
Progress: 236 iterations completed
Progress: 237 iterations completed
Progress: 238 iterations completed
Progress: 239 iterations completed
Progress: 240 iterations completed
Progress: 241 iterations completed
Progress: 242 iterations completed
Progress: 243 iterations completed
Progress: 244 iterations completed
Progress: 245 iterations completed
Progress: 246 iterations completed
Progress: 247 iterations completed
Progress: 248 iterations completed
Progress: 249 iterations completed
Progress: 250 iterations completed
Progress: 251 iterations completed
Progress: 252 iterations completed
Progress: 253 iterations completed
Progress: 254 iterations completed
Progress: 255 iterations completed
Progress: 256 iterations completed
Progress: 257 iterations completed
Progress: 258 iterations completed
Progress: 259 iterations completed
Progress: 260 iterations completed
Progress: 261 iterations completed
Progress: 262 iterations completed
Progress: 263 iterations completed
Progress: 264 iterations completed
Progress: 265 iterations completed
Progress: 266 iterations completed
Progress: 267 iterations completed
Progress: 268 iterations completed
Progress: 269 iterations completed
Progress: 270 iterations completed
Progress: 271 iterations completed
Progress: 272 iterations completed
Progress: 273 iterations completed
Progress: 274 iterations completed
Progress: 275 iterations completed
Progress: 276 iterations completed
Progress: 277 iterations completed
Progress: 278 iterations completed
Progress: 279 iterations completed
Progress: 280 iterations completed
Progress: 281 iterations completed
Progress: 282 iterations completed
Progress: 283 iterations completed
Progress: 284 iterations completed
Progress: 285 iterations completed
Progress: 286 iterations completed
Progress: 287 iterations completed
Progress: 288 iterations completed
Progress: 289 iterations completed
Progress: 290 iterations completed
Progress: 291 iterations completed
Progress: 292 iterations completed
Progress: 293 iterations completed
Progress: 294 iterations completed
Progress: 295 iterations completed
Progress: 296 iterations completed
Progress: 297 iterations completed
Progress: 298 iterations completed
Progress: 299 iterations completed
Progress: 300 iterations completed
Progress: 301 iterations completed
Progress: 302 iterations completed
Progress: 303 iterations completed
Progress: 304 iterations completed
Progress: 305 iterations completed
Progress: 306 iterations completed
Progress: 307 iterations completed
Progress: 308 iterations completed
Progress: 309 iterations completed
Progress: 310 iterations completed
Progress: 311 iterations completed
Progress: 312 iterations completed
Progress: 313 iterations completed
Progress: 314 iterations completed
Progress: 315 iterations completed
Progress: 316 iterations completed
Progress: 317 iterations completed
Progress: 318 iterations completed
Progress: 319 iterations completed
Progress: 320 iterations completed
Progress: 321 iterations completed
Progress: 322 iterations completed
Progress: 323 iterations completed
Progress: 324 iterations completed
Progress: 325 iterations completed
Progress: 326 iterations completed
Progress: 327 iterations completed
Progress: 328 iterations completed
Progress: 329 iterations completed
Progress: 330 iterations completed
Progress: 331 iterations completed
Progress: 332 iterations completed
Progress: 333 iterations completed
Progress: 334 iterations completed
Progress: 335 iterations completed
Progress: 336 iterations completed
Progress: 337 iterations completed
Progress: 338 iterations completed
Progress: 339 iterations completed
Progress: 340 iterations completed
Progress: 341 iterations completed
Progress: 342 iterations completed
Progress: 343 iterations completed
Progress: 344 iterations completed
Progress: 345 iterations completed
Progress: 346 iterations completed
Progress: 347 iterations completed
Progress: 348 iterations completed
Progress: 349 iterations completed
Progress: 350 iterations completed
Progress: 351 iterations completed
Progress: 352 iterations completed
Progress: 353 iterations completed
Progress: 354 iterations completed
Progress: 355 iterations completed
Progress: 356 iterations completed
Progress: 357 iterations completed
Progress: 358 iterations completed
Progress: 359 iterations completed
Progress: 360 iterations completed
Progress: 361 iterations completed
Progress: 362 iterations completed
Progress: 363 iterations completed
Progress: 364 iterations completed
Progress: 365 iterations completed
Progress: 366 iterations completed
Progress: 367 iterations completed
Progress: 368 iterations completed
Progress: 369 iterations completed
Progress: 370 iterations completed
Progress: 371 iterations completed
Progress: 372 iterations completed
Progress: 373 iterations completed
Progress: 374 iterations completed
Progress: 375 iterations completed
Progress: 376 iterations completed
Progress: 377 iterations completed
Progress: 378 iterations completed
Progress: 379 iterations completed
Progress: 380 iterations completed
Progress: 381 iterations completed
Progress: 382 iterations completed
Progress: 383 iterations completed
Progress: 384 iterations completed
Progress: 385 iterations completed
Progress: 386 iterations completed
Progress: 387 iterations completed
Progress: 388 iterations completed
Progress: 389 iterations completed
Progress: 390 iterations completed
Progress: 391 iterations completed
Progress: 392 iterations completed
Progress: 393 iterations completed
Progress: 394 iterations completed
Progress: 395 iterations completed
Progress: 396 iterations completed
Progress: 397 iterations completed
Progress: 398 iterations completed
Progress: 399 iterations completed
Progress: 400 iterations completed
Progress: 401 iterations completed
Progress: 402 iterations completed
Progress: 403 iterations completed
Progress: 404 iterations completed
Progress: 405 iterations completed
Progress: 406 iterations completed
Progress: 407 iterations completed
Progress: 408 iterations completed
Progress: 409 iterations completed
Progress: 410 iterations completed
Progress: 411 iterations completed
Progress: 412 iterations completed
Progress: 413 iterations completed
Progress: 414 iterations completed
Progress: 415 iterations completed
Progress: 416 iterations completed
Progress: 417 iterations completed
Progress: 418 iterations completed
Progress: 419 iterations completed
Progress: 420 iterations completed
Progress: 421 iterations completed
Progress: 422 iterations completed
Progress: 423 iterations completed
Progress: 424 iterations completed
Progress: 425 iterations completed
Progress: 426 iterations completed
Progress: 427 iterations completed
Progress: 428 iterations completed
Progress: 429 iterations completed
Progress: 430 iterations completed
Progress: 431 iterations completed
Progress: 432 iterations completed
Progress: 433 iterations completed
Progress: 434 iterations completed
Progress: 435 iterations completed
Progress: 436 iterations completed
Progress: 437 iterations completed
Progress: 438 iterations completed
Progress: 439 iterations completed
Progress: 440 iterations completed
Progress: 441 iterations completed
Progress: 442 iterations completed
Progress: 443 iterations completed
Progress: 444 iterations completed
Progress: 445 iterations completed
Progress: 446 iterations completed
Progress: 447 iterations completed
Progress: 448 iterations completed
Progress: 449 iterations completed
Progress: 450 iterations completed
Progress: 451 iterations completed
Progress: 452 iterations completed
Progress: 453 iterations completed
Progress: 454 iterations completed
Progress: 455 iterations completed
Progress: 456 iterations completed
Progress: 457 iterations completed
Progress: 458 iterations completed
Progress: 459 iterations completed
Progress: 460 iterations completed
Progress: 461 iterations completed
Progress: 462 iterations completed
Progress: 463 iterations completed
Progress: 464 iterations completed
Progress: 465 iterations completed
Progress: 466 iterations completed
Progress: 467 iterations completed
Progress: 468 iterations completed
Progress: 469 iterations completed
Progress: 470 iterations completed
Progress: 471 iterations completed
Progress: 472 iterations completed
Progress: 473 iterations completed
Progress: 474 iterations completed
Progress: 475 iterations completed
Progress: 476 iterations completed
Progress: 477 iterations completed
Progress: 478 iterations completed
Progress: 479 iterations completed
Progress: 480 iterations completed
Progress: 481 iterations completed
Progress: 482 iterations completed
Progress: 483 iterations completed
Progress: 484 iterations completed
Progress: 485 iterations completed
Progress: 486 iterations completed
Progress: 487 iterations completed
Progress: 488 iterations completed
Progress: 489 iterations completed
Progress: 490 iterations completed
Progress: 491 iterations completed
Progress: 492 iterations completed
Progress: 493 iterations completed
Progress: 494 iterations completed
Progress: 495 iterations completed
Progress: 496 iterations completed
Progress: 497 iterations completed
Progress: 498 iterations completed
Progress: 499 iterations completed
Progress: 500 iterations completed
Progress: 501 iterations completed
Progress: 502 iterations completed
Progress: 503 iterations completed
Progress: 504 iterations completed
Progress: 505 iterations completed
Progress: 506 iterations completed
Progress: 507 iterations completed
Progress: 508 iterations completed
Progress: 509 iterations completed
Progress: 510 iterations completed
Progress: 511 iterations completed
Progress: 512 iterations completed
Progress: 513 iterations completed
Progress: 514 iterations completed
Progress: 515 iterations completed
Progress: 516 iterations completed
Progress: 517 iterations completed
Progress: 518 iterations completed
Progress: 519 iterations completed
Progress: 520 iterations completed
Progress: 521 iterations completed
Progress: 522 iterations completed
Progress: 523 iterations completed
Progress: 524 iterations completed
Progress: 525 iterations completed
Progress: 526 iterations completed
Progress: 527 iterations completed
Progress: 528 iterations completed
Progress: 529 iterations completed
Progress: 530 iterations completed
Progress: 531 iterations completed
Progress: 532 iterations completed
Progress: 533 iterations completed
Progress: 534 iterations completed
Progress: 535 iterations completed
Progress: 536 iterations completed
Progress: 537 iterations completed
Progress: 538 iterations completed
Progress: 539 iterations completed
Progress: 540 iterations completed
Progress: 541 iterations completed
Progress: 542 iterations completed
Progress: 543 iterations completed
Progress: 544 iterations completed
Progress: 545 iterations completed
Progress: 546 iterations completed
Progress: 547 iterations completed
Progress: 548 iterations completed
Progress: 549 iterations completed
Progress: 550 iterations completed
Progress: 551 iterations completed
Progress: 552 iterations completed
Progress: 553 iterations completed
Progress: 554 iterations completed
Progress: 555 iterations completed
Progress: 556 iterations completed
Progress: 557 iterations completed
Progress: 558 iterations completed
Progress: 559 iterations completed
Progress: 560 iterations completed
Progress: 561 iterations completed
Progress: 562 iterations completed
Progress: 563 iterations completed
Progress: 564 iterations completed
Progress: 565 iterations completed
Progress: 566 iterations completed
Progress: 567 iterations completed
Progress: 568 iterations completed
Progress: 569 iterations completed
Progress: 570 iterations completed
Progress: 571 iterations completed
Progress: 572 iterations completed
Progress: 573 iterations completed
Progress: 574 iterations completed
Progress: 575 iterations completed
Progress: 576 iterations completed
Progress: 577 iterations completed
Progress: 578 iterations completed
Progress: 579 iterations completed
Progress: 580 iterations completed
Progress: 581 iterations completed
Progress: 582 iterations completed
Progress: 583 iterations completed
Progress: 584 iterations completed
Progress: 585 iterations completed
Progress: 586 iterations completed
Progress: 587 iterations completed
Progress: 588 iterations completed
Progress: 589 iterations completed
Progress: 590 iterations completed
Progress: 591 iterations completed
Progress: 592 iterations completed
Progress: 593 iterations completed
Progress: 594 iterations completed
Progress: 595 iterations completed
Progress: 596 iterations completed
Progress: 597 iterations completed
Progress: 598 iterations completed
Progress: 599 iterations completed
Progress: 600 iterations completed
Progress: 601 iterations completed
Progress: 602 iterations completed
Progress: 603 iterations completed
Progress: 604 iterations completed
Progress: 605 iterations completed
Progress: 606 iterations completed
Progress: 607 iterations completed
Progress: 608 iterations completed
Progress: 609 iterations completed
Progress: 610 iterations completed
Progress: 611 iterations completed
Progress: 612 iterations completed
Progress: 613 iterations completed
Progress: 614 iterations completed
Progress: 615 iterations completed
Progress: 616 iterations completed
Progress: 617 iterations completed
Progress: 618 iterations completed
Progress: 619 iterations completed
Progress: 620 iterations completed
Progress: 621 iterations completed
Progress: 622 iterations completed
Progress: 623 iterations completed
Progress: 624 iterations completed
Progress: 625 iterations completed
Progress: 626 iterations completed
Progress: 627 iterations completed
Progress: 628 iterations completed
Progress: 629 iterations completed
Progress: 630 iterations completed
Progress: 631 iterations completed
Progress: 632 iterations completed
Progress: 633 iterations completed
Progress: 634 iterations completed
Progress: 635 iterations completed
Progress: 636 iterations completed
Progress: 637 iterations completed
Progress: 638 iterations completed
Progress: 639 iterations completed
Progress: 640 iterations completed
Progress: 641 iterations completed
Progress: 642 iterations completed
Progress: 643 iterations completed
Progress: 644 iterations completed
Progress: 645 iterations completed
Progress: 646 iterations completed
Progress: 647 iterations completed
Progress: 648 iterations completed
Progress: 649 iterations completed
Progress: 650 iterations completed
Progress: 651 iterations completed
Progress: 652 iterations completed
Progress: 653 iterations completed
Progress: 654 iterations completed
Progress: 655 iterations completed
Progress: 656 iterations completed
Progress: 657 iterations completed
Progress: 658 iterations completed
Progress: 659 iterations completed
Progress: 660 iterations completed
Progress: 661 iterations completed
Progress: 662 iterations completed
Progress: 663 iterations completed
Progress: 664 iterations completed
Progress: 665 iterations completed
Progress: 666 iterations completed
Progress: 667 iterations completed
Progress: 668 iterations completed
Progress: 669 iterations completed
Progress: 670 iterations completed
Progress: 671 iterations completed
Progress: 672 iterations completed
Progress: 673 iterations completed
Progress: 674 iterations completed
Progress: 675 iterations completed
Progress: 676 iterations completed
Progress: 677 iterations completed
Progress: 678 iterations completed
Progress: 679 iterations completed
Progress: 680 iterations completed
Progress: 681 iterations completed
Progress: 682 iterations completed
Progress: 683 iterations completed
Progress: 684 iterations completed
Progress: 685 iterations completed
Progress: 686 iterations completed
Progress: 687 iterations completed
Progress: 688 iterations completed
Progress: 689 iterations completed
Progress: 690 iterations completed
Progress: 691 iterations completed
Progress: 692 iterations completed
Progress: 693 iterations completed
Progress: 694 iterations completed
Progress: 695 iterations completed
Progress: 696 iterations completed
Progress: 697 iterations completed
Progress: 698 iterations completed
Progress: 699 iterations completed
Progress: 700 iterations completed
Progress: 701 iterations completed
Progress: 702 iterations completed
Progress: 703 iterations completed
Progress: 704 iterations completed
Progress: 705 iterations completed
Progress: 706 iterations completed
Progress: 707 iterations completed
Progress: 708 iterations completed
Progress: 709 iterations completed
Progress: 710 iterations completed
Progress: 711 iterations completed
Progress: 712 iterations completed
Progress: 713 iterations completed
Progress: 714 iterations completed
Progress: 715 iterations completed
Progress: 716 iterations completed
Progress: 717 iterations completed
Progress: 718 iterations completed
Progress: 719 iterations completed
Progress: 720 iterations completed
Progress: 721 iterations completed
Progress: 722 iterations completed
Progress: 723 iterations completed
Progress: 724 iterations completed
Progress: 725 iterations completed
Progress: 726 iterations completed
Progress: 727 iterations completed
Progress: 728 iterations completed
Progress: 729 iterations completed
Progress: 730 iterations completed
Progress: 731 iterations completed
Progress: 732 iterations completed
Progress: 733 iterations completed
Progress: 734 iterations completed
Progress: 735 iterations completed
Progress: 736 iterations completed
Progress: 737 iterations completed
Progress: 738 iterations completed
Progress: 739 iterations completed
Progress: 740 iterations completed
Progress: 741 iterations completed
Progress: 742 iterations completed
Progress: 743 iterations completed
Progress: 744 iterations completed
Progress: 745 iterations completed
Progress: 746 iterations completed
Progress: 747 iterations completed
Progress: 748 iterations completed
Progress: 749 iterations completed
Progress: 750 iterations completed
Progress: 751 iterations completed
Progress: 752 iterations completed
Progress: 753 iterations completed
Progress: 754 iterations completed
Progress: 755 iterations completed
Progress: 756 iterations completed
Progress: 757 iterations completed
Progress: 758 iterations completed
Progress: 759 iterations completed
Progress: 760 iterations completed
Progress: 761 iterations completed
Progress: 762 iterations completed
Progress: 763 iterations completed
Progress: 764 iterations completed
Progress: 765 iterations completed
Progress: 766 iterations completed
Progress: 767 iterations completed
Progress: 768 iterations completed
Progress: 769 iterations completed
Progress: 770 iterations completed
Progress: 771 iterations completed
Progress: 772 iterations completed
Progress: 773 iterations completed
Progress: 774 iterations completed
Progress: 775 iterations completed
Progress: 776 iterations completed
Progress: 777 iterations completed
Progress: 778 iterations completed
Progress: 779 iterations completed
Progress: 780 iterations completed
Progress: 781 iterations completed
Progress: 782 iterations completed
Progress: 783 iterations completed
Progress: 784 iterations completed
Progress: 785 iterations completed
Progress: 786 iterations completed
Progress: 787 iterations completed
Progress: 788 iterations completed
Progress: 789 iterations completed
Progress: 790 iterations completed
Progress: 791 iterations completed
Progress: 792 iterations completed
Progress: 793 iterations completed
Progress: 794 iterations completed
Progress: 795 iterations completed
Progress: 796 iterations completed
Progress: 797 iterations completed
Progress: 798 iterations completed
Progress: 799 iterations completed
Progress: 800 iterations completed
Progress: 801 iterations completed
Progress: 802 iterations completed
Progress: 803 iterations completed
Progress: 804 iterations completed
Progress: 805 iterations completed
Progress: 806 iterations completed
Progress: 807 iterations completed
Progress: 808 iterations completed
Progress: 809 iterations completed
Progress: 810 iterations completed
Progress: 811 iterations completed
Progress: 812 iterations completed
Progress: 813 iterations completed
Progress: 814 iterations completed
Progress: 815 iterations completed
Progress: 816 iterations completed
Progress: 817 iterations completed
Progress: 818 iterations completed
Progress: 819 iterations completed
Progress: 820 iterations completed
Progress: 821 iterations completed
Progress: 822 iterations completed
Progress: 823 iterations completed
Progress: 824 iterations completed
Progress: 825 iterations completed
Progress: 826 iterations completed
Progress: 827 iterations completed
Progress: 828 iterations completed
Progress: 829 iterations completed
Progress: 830 iterations completed
Progress: 831 iterations completed
Progress: 832 iterations completed
Progress: 833 iterations completed
Progress: 834 iterations completed
Progress: 835 iterations completed
Progress: 836 iterations completed
Progress: 837 iterations completed
Progress: 838 iterations completed
Progress: 839 iterations completed
Progress: 840 iterations completed
Progress: 841 iterations completed
Progress: 842 iterations completed
Progress: 843 iterations completed
Progress: 844 iterations completed
Progress: 845 iterations completed
Progress: 846 iterations completed
Progress: 847 iterations completed
Progress: 848 iterations completed
Progress: 849 iterations completed
Progress: 850 iterations completed
Progress: 851 iterations completed
Progress: 852 iterations completed
Progress: 853 iterations completed
Progress: 854 iterations completed
Progress: 855 iterations completed
Progress: 856 iterations completed
Progress: 857 iterations completed
Progress: 858 iterations completed
Progress: 859 iterations completed
Progress: 860 iterations completed
Progress: 861 iterations completed
Progress: 862 iterations completed
Progress: 863 iterations completed
Progress: 864 iterations completed
Progress: 865 iterations completed
Progress: 866 iterations completed
Progress: 867 iterations completed
Progress: 868 iterations completed
Progress: 869 iterations completed
Progress: 870 iterations completed
Progress: 871 iterations completed
Progress: 872 iterations completed
Progress: 873 iterations completed
Progress: 874 iterations completed
Progress: 875 iterations completed
Progress: 876 iterations completed
Progress: 877 iterations completed
Progress: 878 iterations completed
Progress: 879 iterations completed
Progress: 880 iterations completed
Progress: 881 iterations completed
Progress: 882 iterations completed
Progress: 883 iterations completed
Progress: 884 iterations completed
Progress: 885 iterations completed
Progress: 886 iterations completed
Progress: 887 iterations completed
Progress: 888 iterations completed
Progress: 889 iterations completed
Progress: 890 iterations completed
Progress: 891 iterations completed
Progress: 892 iterations completed
Progress: 893 iterations completed
Progress: 894 iterations completed
Progress: 895 iterations completed
Progress: 896 iterations completed
Progress: 897 iterations completed
Progress: 898 iterations completed
Progress: 899 iterations completed
Progress: 900 iterations completed
Progress: 901 iterations completed
Progress: 902 iterations completed
Progress: 903 iterations completed
Progress: 904 iterations completed
Progress: 905 iterations completed
Progress: 906 iterations completed
Progress: 907 iterations completed
Progress: 908 iterations completed
Progress: 909 iterations completed
Progress: 910 iterations completed
Progress: 911 iterations completed
Progress: 912 iterations completed
Progress: 913 iterations completed
Progress: 914 iterations completed
Progress: 915 iterations completed
Progress: 916 iterations completed
Progress: 917 iterations completed
Progress: 918 iterations completed
Progress: 919 iterations completed
Progress: 920 iterations completed
Progress: 921 iterations completed
Progress: 922 iterations completed
Progress: 923 iterations completed
Progress: 924 iterations completed
Progress: 925 iterations completed
Progress: 926 iterations completed
Progress: 927 iterations completed
Progress: 928 iterations completed
Progress: 929 iterations completed
Progress: 930 iterations completed
Progress: 931 iterations completed
Progress: 932 iterations completed
Progress: 933 iterations completed
Progress: 934 iterations completed
Progress: 935 iterations completed
Progress: 936 iterations completed
Progress: 937 iterations completed
Progress: 938 iterations completed
Progress: 939 iterations completed
Progress: 940 iterations completed
Progress: 941 iterations completed
Progress: 942 iterations completed
Progress: 943 iterations completed
Progress: 944 iterations completed
Progress: 945 iterations completed
Progress: 946 iterations completed
Progress: 947 iterations completed
Progress: 948 iterations completed
Progress: 949 iterations completed
Progress: 950 iterations completed
Progress: 951 iterations completed
Progress: 952 iterations completed
Progress: 953 iterations completed
Progress: 954 iterations completed
Progress: 955 iterations completed
Progress: 956 iterations completed
Progress: 957 iterations completed
Progress: 958 iterations completed
Progress: 959 iterations completed
Progress: 960 iterations completed
Progress: 961 iterations completed
Progress: 962 iterations completed
Progress: 963 iterations completed
Progress: 964 iterations completed
Progress: 965 iterations completed
Progress: 966 iterations completed
Progress: 967 iterations completed
Progress: 968 iterations completed
Progress: 969 iterations completed
Progress: 970 iterations completed
Progress: 971 iterations completed
Progress: 972 iterations completed
Progress: 973 iterations completed
Progress: 974 iterations completed
Progress: 975 iterations completed
Progress: 976 iterations completed
Progress: 977 iterations completed
Progress: 978 iterations completed
Progress: 979 iterations completed
Progress: 980 iterations completed
Progress: 981 iterations completed
Progress: 982 iterations completed
Progress: 983 iterations completed
Progress: 984 iterations completed
Progress: 985 iterations completed
Progress: 986 iterations completed
Progress: 987 iterations completed
Progress: 988 iterations completed
Progress: 989 iterations completed
Progress: 990 iterations completed
Progress: 991 iterations completed
Progress: 992 iterations completed
Progress: 993 iterations completed
Progress: 994 iterations completed
Progress: 995 iterations completed
Progress: 996 iterations completed
Progress: 997 iterations completed
Progress: 998 iterations completed
Progress: 999 iterations completed
Progress: 1000 iterations completed</code></pre>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="what_is_stacked_ensambled.html#cb430-1" tabindex="-1"></a><span class="co"># Calculate mean RMSPE for both ensembles</span></span>
<span id="cb430-2"><a href="what_is_stacked_ensambled.html#cb430-2" tabindex="-1"></a>mean_rmspe_ensemble_original <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_ensemble_original)</span>
<span id="cb430-3"><a href="what_is_stacked_ensambled.html#cb430-3" tabindex="-1"></a>mean_rmspe_ensemble_tuned <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_ensemble_tuned)</span>
<span id="cb430-4"><a href="what_is_stacked_ensambled.html#cb430-4" tabindex="-1"></a></span>
<span id="cb430-5"><a href="what_is_stacked_ensambled.html#cb430-5" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb430-6"><a href="what_is_stacked_ensambled.html#cb430-6" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE of Original Stacked Ensemble:&quot;</span>, mean_rmspe_ensemble_original))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE of Original Stacked Ensemble: 0.353459843644142&quot;</code></pre>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="what_is_stacked_ensambled.html#cb432-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE of Tuned Stacked Ensemble:&quot;</span>, mean_rmspe_ensemble_tuned))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE of Tuned Stacked Ensemble: 0.346391469391828&quot;</code></pre>
<p>We can see a difference in the average RMSPE</p>
<p>now we will ask the question does adding a model that is simply worse and similar to the other models help the ensemble model?</p>
<p>we will now stacked ensambled all 4 base models that we have</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="what_is_stacked_ensambled.html#cb434-1" tabindex="-1"></a><span class="co"># Store RMSPE results for the stacked ensemble with all four models</span></span>
<span id="cb434-2"><a href="what_is_stacked_ensambled.html#cb434-2" tabindex="-1"></a>rmspe_ensemble_four <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb434-3"><a href="what_is_stacked_ensambled.html#cb434-3" tabindex="-1"></a></span>
<span id="cb434-4"><a href="what_is_stacked_ensambled.html#cb434-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb434-5"><a href="what_is_stacked_ensambled.html#cb434-5" tabindex="-1"></a>     <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb434-6"><a href="what_is_stacked_ensambled.html#cb434-6" tabindex="-1"></a></span>
<span id="cb434-7"><a href="what_is_stacked_ensambled.html#cb434-7" tabindex="-1"></a>  </span>
<span id="cb434-8"><a href="what_is_stacked_ensambled.html#cb434-8" tabindex="-1"></a>  <span class="co"># Bootstrapping</span></span>
<span id="cb434-9"><a href="what_is_stacked_ensambled.html#cb434-9" tabindex="-1"></a>  train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb434-10"><a href="what_is_stacked_ensambled.html#cb434-10" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb434-11"><a href="what_is_stacked_ensambled.html#cb434-11" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb434-12"><a href="what_is_stacked_ensambled.html#cb434-12" tabindex="-1"></a>  </span>
<span id="cb434-13"><a href="what_is_stacked_ensambled.html#cb434-13" tabindex="-1"></a>  <span class="co"># Re-train the original models on bootstrapped training data</span></span>
<span id="cb434-14"><a href="what_is_stacked_ensambled.html#cb434-14" tabindex="-1"></a>  lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb434-15"><a href="what_is_stacked_ensambled.html#cb434-15" tabindex="-1"></a>  rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb434-16"><a href="what_is_stacked_ensambled.html#cb434-16" tabindex="-1"></a>  </span>
<span id="cb434-17"><a href="what_is_stacked_ensambled.html#cb434-17" tabindex="-1"></a>  <span class="co"># Train both GBM models on the bootstrapped training data</span></span>
<span id="cb434-18"><a href="what_is_stacked_ensambled.html#cb434-18" tabindex="-1"></a>  base_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">n.trees =</span> <span class="dv">100</span>, <span class="at">interaction.depth =</span> <span class="dv">1</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb434-19"><a href="what_is_stacked_ensambled.html#cb434-19" tabindex="-1"></a>  tuned_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb434-20"><a href="what_is_stacked_ensambled.html#cb434-20" tabindex="-1"></a>                       <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees, </span>
<span id="cb434-21"><a href="what_is_stacked_ensambled.html#cb434-21" tabindex="-1"></a>                       <span class="at">shrinkage =</span> best_params<span class="sc">$</span>shrinkage, </span>
<span id="cb434-22"><a href="what_is_stacked_ensambled.html#cb434-22" tabindex="-1"></a>                       <span class="at">interaction.depth =</span> best_params<span class="sc">$</span>interaction.depth, </span>
<span id="cb434-23"><a href="what_is_stacked_ensambled.html#cb434-23" tabindex="-1"></a>                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb434-24"><a href="what_is_stacked_ensambled.html#cb434-24" tabindex="-1"></a>  </span>
<span id="cb434-25"><a href="what_is_stacked_ensambled.html#cb434-25" tabindex="-1"></a>  <span class="co"># Generate predictions on the bootstrapped test set</span></span>
<span id="cb434-26"><a href="what_is_stacked_ensambled.html#cb434-26" tabindex="-1"></a>  lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_mod, test_data)</span>
<span id="cb434-27"><a href="what_is_stacked_ensambled.html#cb434-27" tabindex="-1"></a>  rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_mod, test_data)</span>
<span id="cb434-28"><a href="what_is_stacked_ensambled.html#cb434-28" tabindex="-1"></a>  base_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(base_gbm_mod, test_data, <span class="at">n.trees =</span> <span class="dv">100</span>)</span>
<span id="cb434-29"><a href="what_is_stacked_ensambled.html#cb434-29" tabindex="-1"></a>  tuned_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(tuned_gbm_mod, test_data, <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees)</span>
<span id="cb434-30"><a href="what_is_stacked_ensambled.html#cb434-30" tabindex="-1"></a>  </span>
<span id="cb434-31"><a href="what_is_stacked_ensambled.html#cb434-31" tabindex="-1"></a>  <span class="co"># Combine predictions into a data frame</span></span>
<span id="cb434-32"><a href="what_is_stacked_ensambled.html#cb434-32" tabindex="-1"></a>  preds_four <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, base_gbm_pred, tuned_gbm_pred)</span>
<span id="cb434-33"><a href="what_is_stacked_ensambled.html#cb434-33" tabindex="-1"></a>  </span>
<span id="cb434-34"><a href="what_is_stacked_ensambled.html#cb434-34" tabindex="-1"></a>  <span class="co"># Train and evaluate the stacked ensemble with all four models</span></span>
<span id="cb434-35"><a href="what_is_stacked_ensambled.html#cb434-35" tabindex="-1"></a>  meta_four <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds_four, <span class="at">medv =</span> test_data<span class="sc">$</span>medv))</span>
<span id="cb434-36"><a href="what_is_stacked_ensambled.html#cb434-36" tabindex="-1"></a>  meta_four_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_four, preds_four)</span>
<span id="cb434-37"><a href="what_is_stacked_ensambled.html#cb434-37" tabindex="-1"></a>  </span>
<span id="cb434-38"><a href="what_is_stacked_ensambled.html#cb434-38" tabindex="-1"></a>  <span class="co"># Calculate RMSPE for the ensemble with all four models</span></span>
<span id="cb434-39"><a href="what_is_stacked_ensambled.html#cb434-39" tabindex="-1"></a>  rmspe_ensemble_four[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_four_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb434-40"><a href="what_is_stacked_ensambled.html#cb434-40" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
Progress: 1 iterations completed
Progress: 2 iterations completed
Progress: 3 iterations completed
Progress: 4 iterations completed
Progress: 5 iterations completed
Progress: 6 iterations completed
Progress: 7 iterations completed
Progress: 8 iterations completed
Progress: 9 iterations completed
Progress: 10 iterations completed
Progress: 11 iterations completed
Progress: 12 iterations completed
Progress: 13 iterations completed
Progress: 14 iterations completed
Progress: 15 iterations completed
Progress: 16 iterations completed
Progress: 17 iterations completed
Progress: 18 iterations completed
Progress: 19 iterations completed
Progress: 20 iterations completed
Progress: 21 iterations completed
Progress: 22 iterations completed
Progress: 23 iterations completed
Progress: 24 iterations completed
Progress: 25 iterations completed
Progress: 26 iterations completed
Progress: 27 iterations completed
Progress: 28 iterations completed
Progress: 29 iterations completed
Progress: 30 iterations completed
Progress: 31 iterations completed
Progress: 32 iterations completed
Progress: 33 iterations completed
Progress: 34 iterations completed
Progress: 35 iterations completed
Progress: 36 iterations completed
Progress: 37 iterations completed
Progress: 38 iterations completed
Progress: 39 iterations completed
Progress: 40 iterations completed
Progress: 41 iterations completed
Progress: 42 iterations completed
Progress: 43 iterations completed
Progress: 44 iterations completed
Progress: 45 iterations completed
Progress: 46 iterations completed
Progress: 47 iterations completed
Progress: 48 iterations completed
Progress: 49 iterations completed
Progress: 50 iterations completed
Progress: 51 iterations completed
Progress: 52 iterations completed
Progress: 53 iterations completed
Progress: 54 iterations completed
Progress: 55 iterations completed
Progress: 56 iterations completed
Progress: 57 iterations completed
Progress: 58 iterations completed
Progress: 59 iterations completed
Progress: 60 iterations completed
Progress: 61 iterations completed
Progress: 62 iterations completed
Progress: 63 iterations completed
Progress: 64 iterations completed
Progress: 65 iterations completed
Progress: 66 iterations completed
Progress: 67 iterations completed
Progress: 68 iterations completed
Progress: 69 iterations completed
Progress: 70 iterations completed
Progress: 71 iterations completed
Progress: 72 iterations completed
Progress: 73 iterations completed
Progress: 74 iterations completed
Progress: 75 iterations completed
Progress: 76 iterations completed
Progress: 77 iterations completed
Progress: 78 iterations completed
Progress: 79 iterations completed
Progress: 80 iterations completed
Progress: 81 iterations completed
Progress: 82 iterations completed
Progress: 83 iterations completed
Progress: 84 iterations completed
Progress: 85 iterations completed
Progress: 86 iterations completed
Progress: 87 iterations completed
Progress: 88 iterations completed
Progress: 89 iterations completed
Progress: 90 iterations completed
Progress: 91 iterations completed
Progress: 92 iterations completed
Progress: 93 iterations completed
Progress: 94 iterations completed
Progress: 95 iterations completed
Progress: 96 iterations completed
Progress: 97 iterations completed
Progress: 98 iterations completed
Progress: 99 iterations completed
Progress: 100 iterations completed
Progress: 101 iterations completed
Progress: 102 iterations completed
Progress: 103 iterations completed
Progress: 104 iterations completed
Progress: 105 iterations completed
Progress: 106 iterations completed
Progress: 107 iterations completed
Progress: 108 iterations completed
Progress: 109 iterations completed
Progress: 110 iterations completed
Progress: 111 iterations completed
Progress: 112 iterations completed
Progress: 113 iterations completed
Progress: 114 iterations completed
Progress: 115 iterations completed
Progress: 116 iterations completed
Progress: 117 iterations completed
Progress: 118 iterations completed
Progress: 119 iterations completed
Progress: 120 iterations completed
Progress: 121 iterations completed
Progress: 122 iterations completed
Progress: 123 iterations completed
Progress: 124 iterations completed
Progress: 125 iterations completed
Progress: 126 iterations completed
Progress: 127 iterations completed
Progress: 128 iterations completed
Progress: 129 iterations completed
Progress: 130 iterations completed
Progress: 131 iterations completed
Progress: 132 iterations completed
Progress: 133 iterations completed
Progress: 134 iterations completed
Progress: 135 iterations completed
Progress: 136 iterations completed
Progress: 137 iterations completed
Progress: 138 iterations completed
Progress: 139 iterations completed
Progress: 140 iterations completed
Progress: 141 iterations completed
Progress: 142 iterations completed
Progress: 143 iterations completed
Progress: 144 iterations completed
Progress: 145 iterations completed
Progress: 146 iterations completed
Progress: 147 iterations completed
Progress: 148 iterations completed
Progress: 149 iterations completed
Progress: 150 iterations completed
Progress: 151 iterations completed
Progress: 152 iterations completed
Progress: 153 iterations completed
Progress: 154 iterations completed
Progress: 155 iterations completed
Progress: 156 iterations completed
Progress: 157 iterations completed
Progress: 158 iterations completed
Progress: 159 iterations completed
Progress: 160 iterations completed
Progress: 161 iterations completed
Progress: 162 iterations completed
Progress: 163 iterations completed
Progress: 164 iterations completed
Progress: 165 iterations completed
Progress: 166 iterations completed
Progress: 167 iterations completed
Progress: 168 iterations completed
Progress: 169 iterations completed
Progress: 170 iterations completed
Progress: 171 iterations completed
Progress: 172 iterations completed
Progress: 173 iterations completed
Progress: 174 iterations completed
Progress: 175 iterations completed
Progress: 176 iterations completed
Progress: 177 iterations completed
Progress: 178 iterations completed
Progress: 179 iterations completed
Progress: 180 iterations completed
Progress: 181 iterations completed
Progress: 182 iterations completed
Progress: 183 iterations completed
Progress: 184 iterations completed
Progress: 185 iterations completed
Progress: 186 iterations completed
Progress: 187 iterations completed
Progress: 188 iterations completed
Progress: 189 iterations completed
Progress: 190 iterations completed
Progress: 191 iterations completed
Progress: 192 iterations completed
Progress: 193 iterations completed
Progress: 194 iterations completed
Progress: 195 iterations completed
Progress: 196 iterations completed
Progress: 197 iterations completed
Progress: 198 iterations completed
Progress: 199 iterations completed
Progress: 200 iterations completed
Progress: 201 iterations completed
Progress: 202 iterations completed
Progress: 203 iterations completed
Progress: 204 iterations completed
Progress: 205 iterations completed
Progress: 206 iterations completed
Progress: 207 iterations completed
Progress: 208 iterations completed
Progress: 209 iterations completed
Progress: 210 iterations completed
Progress: 211 iterations completed
Progress: 212 iterations completed
Progress: 213 iterations completed
Progress: 214 iterations completed
Progress: 215 iterations completed
Progress: 216 iterations completed
Progress: 217 iterations completed
Progress: 218 iterations completed
Progress: 219 iterations completed
Progress: 220 iterations completed
Progress: 221 iterations completed
Progress: 222 iterations completed
Progress: 223 iterations completed
Progress: 224 iterations completed
Progress: 225 iterations completed
Progress: 226 iterations completed
Progress: 227 iterations completed
Progress: 228 iterations completed
Progress: 229 iterations completed
Progress: 230 iterations completed
Progress: 231 iterations completed
Progress: 232 iterations completed
Progress: 233 iterations completed
Progress: 234 iterations completed
Progress: 235 iterations completed
Progress: 236 iterations completed
Progress: 237 iterations completed
Progress: 238 iterations completed
Progress: 239 iterations completed
Progress: 240 iterations completed
Progress: 241 iterations completed
Progress: 242 iterations completed
Progress: 243 iterations completed
Progress: 244 iterations completed
Progress: 245 iterations completed
Progress: 246 iterations completed
Progress: 247 iterations completed
Progress: 248 iterations completed
Progress: 249 iterations completed
Progress: 250 iterations completed
Progress: 251 iterations completed
Progress: 252 iterations completed
Progress: 253 iterations completed
Progress: 254 iterations completed
Progress: 255 iterations completed
Progress: 256 iterations completed
Progress: 257 iterations completed
Progress: 258 iterations completed
Progress: 259 iterations completed
Progress: 260 iterations completed
Progress: 261 iterations completed
Progress: 262 iterations completed
Progress: 263 iterations completed
Progress: 264 iterations completed
Progress: 265 iterations completed
Progress: 266 iterations completed
Progress: 267 iterations completed
Progress: 268 iterations completed
Progress: 269 iterations completed
Progress: 270 iterations completed
Progress: 271 iterations completed
Progress: 272 iterations completed
Progress: 273 iterations completed
Progress: 274 iterations completed
Progress: 275 iterations completed
Progress: 276 iterations completed
Progress: 277 iterations completed
Progress: 278 iterations completed
Progress: 279 iterations completed
Progress: 280 iterations completed
Progress: 281 iterations completed
Progress: 282 iterations completed
Progress: 283 iterations completed
Progress: 284 iterations completed
Progress: 285 iterations completed
Progress: 286 iterations completed
Progress: 287 iterations completed
Progress: 288 iterations completed
Progress: 289 iterations completed
Progress: 290 iterations completed
Progress: 291 iterations completed
Progress: 292 iterations completed
Progress: 293 iterations completed
Progress: 294 iterations completed
Progress: 295 iterations completed
Progress: 296 iterations completed
Progress: 297 iterations completed
Progress: 298 iterations completed
Progress: 299 iterations completed
Progress: 300 iterations completed
Progress: 301 iterations completed
Progress: 302 iterations completed
Progress: 303 iterations completed
Progress: 304 iterations completed
Progress: 305 iterations completed
Progress: 306 iterations completed
Progress: 307 iterations completed
Progress: 308 iterations completed
Progress: 309 iterations completed
Progress: 310 iterations completed
Progress: 311 iterations completed
Progress: 312 iterations completed
Progress: 313 iterations completed
Progress: 314 iterations completed
Progress: 315 iterations completed
Progress: 316 iterations completed
Progress: 317 iterations completed
Progress: 318 iterations completed
Progress: 319 iterations completed
Progress: 320 iterations completed
Progress: 321 iterations completed
Progress: 322 iterations completed
Progress: 323 iterations completed
Progress: 324 iterations completed
Progress: 325 iterations completed
Progress: 326 iterations completed
Progress: 327 iterations completed
Progress: 328 iterations completed
Progress: 329 iterations completed
Progress: 330 iterations completed
Progress: 331 iterations completed
Progress: 332 iterations completed
Progress: 333 iterations completed
Progress: 334 iterations completed
Progress: 335 iterations completed
Progress: 336 iterations completed
Progress: 337 iterations completed
Progress: 338 iterations completed
Progress: 339 iterations completed
Progress: 340 iterations completed
Progress: 341 iterations completed
Progress: 342 iterations completed
Progress: 343 iterations completed
Progress: 344 iterations completed
Progress: 345 iterations completed
Progress: 346 iterations completed
Progress: 347 iterations completed
Progress: 348 iterations completed
Progress: 349 iterations completed
Progress: 350 iterations completed
Progress: 351 iterations completed
Progress: 352 iterations completed
Progress: 353 iterations completed
Progress: 354 iterations completed
Progress: 355 iterations completed
Progress: 356 iterations completed
Progress: 357 iterations completed
Progress: 358 iterations completed
Progress: 359 iterations completed
Progress: 360 iterations completed
Progress: 361 iterations completed
Progress: 362 iterations completed
Progress: 363 iterations completed
Progress: 364 iterations completed
Progress: 365 iterations completed
Progress: 366 iterations completed
Progress: 367 iterations completed
Progress: 368 iterations completed
Progress: 369 iterations completed
Progress: 370 iterations completed
Progress: 371 iterations completed
Progress: 372 iterations completed
Progress: 373 iterations completed
Progress: 374 iterations completed
Progress: 375 iterations completed
Progress: 376 iterations completed
Progress: 377 iterations completed
Progress: 378 iterations completed
Progress: 379 iterations completed
Progress: 380 iterations completed
Progress: 381 iterations completed
Progress: 382 iterations completed
Progress: 383 iterations completed
Progress: 384 iterations completed
Progress: 385 iterations completed
Progress: 386 iterations completed
Progress: 387 iterations completed
Progress: 388 iterations completed
Progress: 389 iterations completed
Progress: 390 iterations completed
Progress: 391 iterations completed
Progress: 392 iterations completed
Progress: 393 iterations completed
Progress: 394 iterations completed
Progress: 395 iterations completed
Progress: 396 iterations completed
Progress: 397 iterations completed
Progress: 398 iterations completed
Progress: 399 iterations completed
Progress: 400 iterations completed
Progress: 401 iterations completed
Progress: 402 iterations completed
Progress: 403 iterations completed
Progress: 404 iterations completed
Progress: 405 iterations completed
Progress: 406 iterations completed
Progress: 407 iterations completed
Progress: 408 iterations completed
Progress: 409 iterations completed
Progress: 410 iterations completed
Progress: 411 iterations completed
Progress: 412 iterations completed
Progress: 413 iterations completed
Progress: 414 iterations completed
Progress: 415 iterations completed
Progress: 416 iterations completed
Progress: 417 iterations completed
Progress: 418 iterations completed
Progress: 419 iterations completed
Progress: 420 iterations completed
Progress: 421 iterations completed
Progress: 422 iterations completed
Progress: 423 iterations completed
Progress: 424 iterations completed
Progress: 425 iterations completed
Progress: 426 iterations completed
Progress: 427 iterations completed
Progress: 428 iterations completed
Progress: 429 iterations completed
Progress: 430 iterations completed
Progress: 431 iterations completed
Progress: 432 iterations completed
Progress: 433 iterations completed
Progress: 434 iterations completed
Progress: 435 iterations completed
Progress: 436 iterations completed
Progress: 437 iterations completed
Progress: 438 iterations completed
Progress: 439 iterations completed
Progress: 440 iterations completed
Progress: 441 iterations completed
Progress: 442 iterations completed
Progress: 443 iterations completed
Progress: 444 iterations completed
Progress: 445 iterations completed
Progress: 446 iterations completed
Progress: 447 iterations completed
Progress: 448 iterations completed
Progress: 449 iterations completed
Progress: 450 iterations completed
Progress: 451 iterations completed
Progress: 452 iterations completed
Progress: 453 iterations completed
Progress: 454 iterations completed
Progress: 455 iterations completed
Progress: 456 iterations completed
Progress: 457 iterations completed
Progress: 458 iterations completed
Progress: 459 iterations completed
Progress: 460 iterations completed
Progress: 461 iterations completed
Progress: 462 iterations completed
Progress: 463 iterations completed
Progress: 464 iterations completed
Progress: 465 iterations completed
Progress: 466 iterations completed
Progress: 467 iterations completed
Progress: 468 iterations completed
Progress: 469 iterations completed
Progress: 470 iterations completed
Progress: 471 iterations completed
Progress: 472 iterations completed
Progress: 473 iterations completed
Progress: 474 iterations completed
Progress: 475 iterations completed
Progress: 476 iterations completed
Progress: 477 iterations completed
Progress: 478 iterations completed
Progress: 479 iterations completed
Progress: 480 iterations completed
Progress: 481 iterations completed
Progress: 482 iterations completed
Progress: 483 iterations completed
Progress: 484 iterations completed
Progress: 485 iterations completed
Progress: 486 iterations completed
Progress: 487 iterations completed
Progress: 488 iterations completed
Progress: 489 iterations completed
Progress: 490 iterations completed
Progress: 491 iterations completed
Progress: 492 iterations completed
Progress: 493 iterations completed
Progress: 494 iterations completed
Progress: 495 iterations completed
Progress: 496 iterations completed
Progress: 497 iterations completed
Progress: 498 iterations completed
Progress: 499 iterations completed
Progress: 500 iterations completed
Progress: 501 iterations completed
Progress: 502 iterations completed
Progress: 503 iterations completed
Progress: 504 iterations completed
Progress: 505 iterations completed
Progress: 506 iterations completed
Progress: 507 iterations completed
Progress: 508 iterations completed
Progress: 509 iterations completed
Progress: 510 iterations completed
Progress: 511 iterations completed
Progress: 512 iterations completed
Progress: 513 iterations completed
Progress: 514 iterations completed
Progress: 515 iterations completed
Progress: 516 iterations completed
Progress: 517 iterations completed
Progress: 518 iterations completed
Progress: 519 iterations completed
Progress: 520 iterations completed
Progress: 521 iterations completed
Progress: 522 iterations completed
Progress: 523 iterations completed
Progress: 524 iterations completed
Progress: 525 iterations completed
Progress: 526 iterations completed
Progress: 527 iterations completed
Progress: 528 iterations completed
Progress: 529 iterations completed
Progress: 530 iterations completed
Progress: 531 iterations completed
Progress: 532 iterations completed
Progress: 533 iterations completed
Progress: 534 iterations completed
Progress: 535 iterations completed
Progress: 536 iterations completed
Progress: 537 iterations completed
Progress: 538 iterations completed
Progress: 539 iterations completed
Progress: 540 iterations completed
Progress: 541 iterations completed
Progress: 542 iterations completed
Progress: 543 iterations completed
Progress: 544 iterations completed
Progress: 545 iterations completed
Progress: 546 iterations completed
Progress: 547 iterations completed
Progress: 548 iterations completed
Progress: 549 iterations completed
Progress: 550 iterations completed
Progress: 551 iterations completed
Progress: 552 iterations completed
Progress: 553 iterations completed
Progress: 554 iterations completed
Progress: 555 iterations completed
Progress: 556 iterations completed
Progress: 557 iterations completed
Progress: 558 iterations completed
Progress: 559 iterations completed
Progress: 560 iterations completed
Progress: 561 iterations completed
Progress: 562 iterations completed
Progress: 563 iterations completed
Progress: 564 iterations completed
Progress: 565 iterations completed
Progress: 566 iterations completed
Progress: 567 iterations completed
Progress: 568 iterations completed
Progress: 569 iterations completed
Progress: 570 iterations completed
Progress: 571 iterations completed
Progress: 572 iterations completed
Progress: 573 iterations completed
Progress: 574 iterations completed
Progress: 575 iterations completed
Progress: 576 iterations completed
Progress: 577 iterations completed
Progress: 578 iterations completed
Progress: 579 iterations completed
Progress: 580 iterations completed
Progress: 581 iterations completed
Progress: 582 iterations completed
Progress: 583 iterations completed
Progress: 584 iterations completed
Progress: 585 iterations completed
Progress: 586 iterations completed
Progress: 587 iterations completed
Progress: 588 iterations completed
Progress: 589 iterations completed
Progress: 590 iterations completed
Progress: 591 iterations completed
Progress: 592 iterations completed
Progress: 593 iterations completed
Progress: 594 iterations completed
Progress: 595 iterations completed
Progress: 596 iterations completed
Progress: 597 iterations completed
Progress: 598 iterations completed
Progress: 599 iterations completed
Progress: 600 iterations completed
Progress: 601 iterations completed
Progress: 602 iterations completed
Progress: 603 iterations completed
Progress: 604 iterations completed
Progress: 605 iterations completed
Progress: 606 iterations completed
Progress: 607 iterations completed
Progress: 608 iterations completed
Progress: 609 iterations completed
Progress: 610 iterations completed
Progress: 611 iterations completed
Progress: 612 iterations completed
Progress: 613 iterations completed
Progress: 614 iterations completed
Progress: 615 iterations completed
Progress: 616 iterations completed
Progress: 617 iterations completed
Progress: 618 iterations completed
Progress: 619 iterations completed
Progress: 620 iterations completed
Progress: 621 iterations completed
Progress: 622 iterations completed
Progress: 623 iterations completed
Progress: 624 iterations completed
Progress: 625 iterations completed
Progress: 626 iterations completed
Progress: 627 iterations completed
Progress: 628 iterations completed
Progress: 629 iterations completed
Progress: 630 iterations completed
Progress: 631 iterations completed
Progress: 632 iterations completed
Progress: 633 iterations completed
Progress: 634 iterations completed
Progress: 635 iterations completed
Progress: 636 iterations completed
Progress: 637 iterations completed
Progress: 638 iterations completed
Progress: 639 iterations completed
Progress: 640 iterations completed
Progress: 641 iterations completed
Progress: 642 iterations completed
Progress: 643 iterations completed
Progress: 644 iterations completed
Progress: 645 iterations completed
Progress: 646 iterations completed
Progress: 647 iterations completed
Progress: 648 iterations completed
Progress: 649 iterations completed
Progress: 650 iterations completed
Progress: 651 iterations completed
Progress: 652 iterations completed
Progress: 653 iterations completed
Progress: 654 iterations completed
Progress: 655 iterations completed
Progress: 656 iterations completed
Progress: 657 iterations completed
Progress: 658 iterations completed
Progress: 659 iterations completed
Progress: 660 iterations completed
Progress: 661 iterations completed
Progress: 662 iterations completed
Progress: 663 iterations completed
Progress: 664 iterations completed
Progress: 665 iterations completed
Progress: 666 iterations completed
Progress: 667 iterations completed
Progress: 668 iterations completed
Progress: 669 iterations completed
Progress: 670 iterations completed
Progress: 671 iterations completed
Progress: 672 iterations completed
Progress: 673 iterations completed
Progress: 674 iterations completed
Progress: 675 iterations completed
Progress: 676 iterations completed
Progress: 677 iterations completed
Progress: 678 iterations completed
Progress: 679 iterations completed
Progress: 680 iterations completed
Progress: 681 iterations completed
Progress: 682 iterations completed
Progress: 683 iterations completed
Progress: 684 iterations completed
Progress: 685 iterations completed
Progress: 686 iterations completed
Progress: 687 iterations completed
Progress: 688 iterations completed
Progress: 689 iterations completed
Progress: 690 iterations completed
Progress: 691 iterations completed
Progress: 692 iterations completed
Progress: 693 iterations completed
Progress: 694 iterations completed
Progress: 695 iterations completed
Progress: 696 iterations completed
Progress: 697 iterations completed
Progress: 698 iterations completed
Progress: 699 iterations completed
Progress: 700 iterations completed
Progress: 701 iterations completed
Progress: 702 iterations completed
Progress: 703 iterations completed
Progress: 704 iterations completed
Progress: 705 iterations completed
Progress: 706 iterations completed
Progress: 707 iterations completed
Progress: 708 iterations completed
Progress: 709 iterations completed
Progress: 710 iterations completed
Progress: 711 iterations completed
Progress: 712 iterations completed
Progress: 713 iterations completed
Progress: 714 iterations completed
Progress: 715 iterations completed
Progress: 716 iterations completed
Progress: 717 iterations completed
Progress: 718 iterations completed
Progress: 719 iterations completed
Progress: 720 iterations completed
Progress: 721 iterations completed
Progress: 722 iterations completed
Progress: 723 iterations completed
Progress: 724 iterations completed
Progress: 725 iterations completed
Progress: 726 iterations completed
Progress: 727 iterations completed
Progress: 728 iterations completed
Progress: 729 iterations completed
Progress: 730 iterations completed
Progress: 731 iterations completed
Progress: 732 iterations completed
Progress: 733 iterations completed
Progress: 734 iterations completed
Progress: 735 iterations completed
Progress: 736 iterations completed
Progress: 737 iterations completed
Progress: 738 iterations completed
Progress: 739 iterations completed
Progress: 740 iterations completed
Progress: 741 iterations completed
Progress: 742 iterations completed
Progress: 743 iterations completed
Progress: 744 iterations completed
Progress: 745 iterations completed
Progress: 746 iterations completed
Progress: 747 iterations completed
Progress: 748 iterations completed
Progress: 749 iterations completed
Progress: 750 iterations completed
Progress: 751 iterations completed
Progress: 752 iterations completed
Progress: 753 iterations completed
Progress: 754 iterations completed
Progress: 755 iterations completed
Progress: 756 iterations completed
Progress: 757 iterations completed
Progress: 758 iterations completed
Progress: 759 iterations completed
Progress: 760 iterations completed
Progress: 761 iterations completed
Progress: 762 iterations completed
Progress: 763 iterations completed
Progress: 764 iterations completed
Progress: 765 iterations completed
Progress: 766 iterations completed
Progress: 767 iterations completed
Progress: 768 iterations completed
Progress: 769 iterations completed
Progress: 770 iterations completed
Progress: 771 iterations completed
Progress: 772 iterations completed
Progress: 773 iterations completed
Progress: 774 iterations completed
Progress: 775 iterations completed
Progress: 776 iterations completed
Progress: 777 iterations completed
Progress: 778 iterations completed
Progress: 779 iterations completed
Progress: 780 iterations completed
Progress: 781 iterations completed
Progress: 782 iterations completed
Progress: 783 iterations completed
Progress: 784 iterations completed
Progress: 785 iterations completed
Progress: 786 iterations completed
Progress: 787 iterations completed
Progress: 788 iterations completed
Progress: 789 iterations completed
Progress: 790 iterations completed
Progress: 791 iterations completed
Progress: 792 iterations completed
Progress: 793 iterations completed
Progress: 794 iterations completed
Progress: 795 iterations completed
Progress: 796 iterations completed
Progress: 797 iterations completed
Progress: 798 iterations completed
Progress: 799 iterations completed
Progress: 800 iterations completed
Progress: 801 iterations completed
Progress: 802 iterations completed
Progress: 803 iterations completed
Progress: 804 iterations completed
Progress: 805 iterations completed
Progress: 806 iterations completed
Progress: 807 iterations completed
Progress: 808 iterations completed
Progress: 809 iterations completed
Progress: 810 iterations completed
Progress: 811 iterations completed
Progress: 812 iterations completed
Progress: 813 iterations completed
Progress: 814 iterations completed
Progress: 815 iterations completed
Progress: 816 iterations completed
Progress: 817 iterations completed
Progress: 818 iterations completed
Progress: 819 iterations completed
Progress: 820 iterations completed
Progress: 821 iterations completed
Progress: 822 iterations completed
Progress: 823 iterations completed
Progress: 824 iterations completed
Progress: 825 iterations completed
Progress: 826 iterations completed
Progress: 827 iterations completed
Progress: 828 iterations completed
Progress: 829 iterations completed
Progress: 830 iterations completed
Progress: 831 iterations completed
Progress: 832 iterations completed
Progress: 833 iterations completed
Progress: 834 iterations completed
Progress: 835 iterations completed
Progress: 836 iterations completed
Progress: 837 iterations completed
Progress: 838 iterations completed
Progress: 839 iterations completed
Progress: 840 iterations completed
Progress: 841 iterations completed
Progress: 842 iterations completed
Progress: 843 iterations completed
Progress: 844 iterations completed
Progress: 845 iterations completed
Progress: 846 iterations completed
Progress: 847 iterations completed
Progress: 848 iterations completed
Progress: 849 iterations completed
Progress: 850 iterations completed
Progress: 851 iterations completed
Progress: 852 iterations completed
Progress: 853 iterations completed
Progress: 854 iterations completed
Progress: 855 iterations completed
Progress: 856 iterations completed
Progress: 857 iterations completed
Progress: 858 iterations completed
Progress: 859 iterations completed
Progress: 860 iterations completed
Progress: 861 iterations completed
Progress: 862 iterations completed
Progress: 863 iterations completed
Progress: 864 iterations completed
Progress: 865 iterations completed
Progress: 866 iterations completed
Progress: 867 iterations completed
Progress: 868 iterations completed
Progress: 869 iterations completed
Progress: 870 iterations completed
Progress: 871 iterations completed
Progress: 872 iterations completed
Progress: 873 iterations completed
Progress: 874 iterations completed
Progress: 875 iterations completed
Progress: 876 iterations completed
Progress: 877 iterations completed
Progress: 878 iterations completed
Progress: 879 iterations completed
Progress: 880 iterations completed
Progress: 881 iterations completed
Progress: 882 iterations completed
Progress: 883 iterations completed
Progress: 884 iterations completed
Progress: 885 iterations completed
Progress: 886 iterations completed
Progress: 887 iterations completed
Progress: 888 iterations completed
Progress: 889 iterations completed
Progress: 890 iterations completed
Progress: 891 iterations completed
Progress: 892 iterations completed
Progress: 893 iterations completed
Progress: 894 iterations completed
Progress: 895 iterations completed
Progress: 896 iterations completed
Progress: 897 iterations completed
Progress: 898 iterations completed
Progress: 899 iterations completed
Progress: 900 iterations completed
Progress: 901 iterations completed
Progress: 902 iterations completed
Progress: 903 iterations completed
Progress: 904 iterations completed
Progress: 905 iterations completed
Progress: 906 iterations completed
Progress: 907 iterations completed
Progress: 908 iterations completed
Progress: 909 iterations completed
Progress: 910 iterations completed
Progress: 911 iterations completed
Progress: 912 iterations completed
Progress: 913 iterations completed
Progress: 914 iterations completed
Progress: 915 iterations completed
Progress: 916 iterations completed
Progress: 917 iterations completed
Progress: 918 iterations completed
Progress: 919 iterations completed
Progress: 920 iterations completed
Progress: 921 iterations completed
Progress: 922 iterations completed
Progress: 923 iterations completed
Progress: 924 iterations completed
Progress: 925 iterations completed
Progress: 926 iterations completed
Progress: 927 iterations completed
Progress: 928 iterations completed
Progress: 929 iterations completed
Progress: 930 iterations completed
Progress: 931 iterations completed
Progress: 932 iterations completed
Progress: 933 iterations completed
Progress: 934 iterations completed
Progress: 935 iterations completed
Progress: 936 iterations completed
Progress: 937 iterations completed
Progress: 938 iterations completed
Progress: 939 iterations completed
Progress: 940 iterations completed
Progress: 941 iterations completed
Progress: 942 iterations completed
Progress: 943 iterations completed
Progress: 944 iterations completed
Progress: 945 iterations completed
Progress: 946 iterations completed
Progress: 947 iterations completed
Progress: 948 iterations completed
Progress: 949 iterations completed
Progress: 950 iterations completed
Progress: 951 iterations completed
Progress: 952 iterations completed
Progress: 953 iterations completed
Progress: 954 iterations completed
Progress: 955 iterations completed
Progress: 956 iterations completed
Progress: 957 iterations completed
Progress: 958 iterations completed
Progress: 959 iterations completed
Progress: 960 iterations completed
Progress: 961 iterations completed
Progress: 962 iterations completed
Progress: 963 iterations completed
Progress: 964 iterations completed
Progress: 965 iterations completed
Progress: 966 iterations completed
Progress: 967 iterations completed
Progress: 968 iterations completed
Progress: 969 iterations completed
Progress: 970 iterations completed
Progress: 971 iterations completed
Progress: 972 iterations completed
Progress: 973 iterations completed
Progress: 974 iterations completed
Progress: 975 iterations completed
Progress: 976 iterations completed
Progress: 977 iterations completed
Progress: 978 iterations completed
Progress: 979 iterations completed
Progress: 980 iterations completed
Progress: 981 iterations completed
Progress: 982 iterations completed
Progress: 983 iterations completed
Progress: 984 iterations completed
Progress: 985 iterations completed
Progress: 986 iterations completed
Progress: 987 iterations completed
Progress: 988 iterations completed
Progress: 989 iterations completed
Progress: 990 iterations completed
Progress: 991 iterations completed
Progress: 992 iterations completed
Progress: 993 iterations completed
Progress: 994 iterations completed
Progress: 995 iterations completed
Progress: 996 iterations completed
Progress: 997 iterations completed
Progress: 998 iterations completed
Progress: 999 iterations completed
Progress: 1000 iterations completed</code></pre>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="what_is_stacked_ensambled.html#cb436-1" tabindex="-1"></a><span class="co"># Calculate mean RMSPE for the ensemble with all four models</span></span>
<span id="cb436-2"><a href="what_is_stacked_ensambled.html#cb436-2" tabindex="-1"></a>mean_rmspe_ensemble_four <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_ensemble_four)</span>
<span id="cb436-3"><a href="what_is_stacked_ensambled.html#cb436-3" tabindex="-1"></a></span>
<span id="cb436-4"><a href="what_is_stacked_ensambled.html#cb436-4" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb436-5"><a href="what_is_stacked_ensambled.html#cb436-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE of Stacked Ensemble with All Four Models:&quot;</span>, mean_rmspe_ensemble_four))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE of Stacked Ensemble with All Four Models: 0.336746256053834&quot;</code></pre>
<p>So we do see a better rmspe probably due to having more base models. so lets look at the covariance matrix of the base models to see if they are correlated</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="what_is_stacked_ensambled.html#cb438-1" tabindex="-1"></a><span class="co"># Initialize the matrix to accumulate correlations</span></span>
<span id="cb438-2"><a href="what_is_stacked_ensambled.html#cb438-2" tabindex="-1"></a>cor_matrix_sum <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb438-3"><a href="what_is_stacked_ensambled.html#cb438-3" tabindex="-1"></a></span>
<span id="cb438-4"><a href="what_is_stacked_ensambled.html#cb438-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb438-5"><a href="what_is_stacked_ensambled.html#cb438-5" tabindex="-1"></a>     <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb438-6"><a href="what_is_stacked_ensambled.html#cb438-6" tabindex="-1"></a>  </span>
<span id="cb438-7"><a href="what_is_stacked_ensambled.html#cb438-7" tabindex="-1"></a>  <span class="co"># Bootstrapping</span></span>
<span id="cb438-8"><a href="what_is_stacked_ensambled.html#cb438-8" tabindex="-1"></a>  train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb438-9"><a href="what_is_stacked_ensambled.html#cb438-9" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb438-10"><a href="what_is_stacked_ensambled.html#cb438-10" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb438-11"><a href="what_is_stacked_ensambled.html#cb438-11" tabindex="-1"></a>  </span>
<span id="cb438-12"><a href="what_is_stacked_ensambled.html#cb438-12" tabindex="-1"></a>  <span class="co"># Re-train the original models on bootstrapped training data</span></span>
<span id="cb438-13"><a href="what_is_stacked_ensambled.html#cb438-13" tabindex="-1"></a>  lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb438-14"><a href="what_is_stacked_ensambled.html#cb438-14" tabindex="-1"></a>  rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb438-15"><a href="what_is_stacked_ensambled.html#cb438-15" tabindex="-1"></a>  </span>
<span id="cb438-16"><a href="what_is_stacked_ensambled.html#cb438-16" tabindex="-1"></a>  <span class="co"># Train both GBM models on the bootstrapped training data</span></span>
<span id="cb438-17"><a href="what_is_stacked_ensambled.html#cb438-17" tabindex="-1"></a>  base_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="at">n.trees =</span> <span class="dv">100</span>, <span class="at">interaction.depth =</span> <span class="dv">1</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb438-18"><a href="what_is_stacked_ensambled.html#cb438-18" tabindex="-1"></a>  tuned_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb438-19"><a href="what_is_stacked_ensambled.html#cb438-19" tabindex="-1"></a>                       <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees, </span>
<span id="cb438-20"><a href="what_is_stacked_ensambled.html#cb438-20" tabindex="-1"></a>                       <span class="at">shrinkage =</span> best_params<span class="sc">$</span>shrinkage, </span>
<span id="cb438-21"><a href="what_is_stacked_ensambled.html#cb438-21" tabindex="-1"></a>                       <span class="at">interaction.depth =</span> best_params<span class="sc">$</span>interaction.depth, </span>
<span id="cb438-22"><a href="what_is_stacked_ensambled.html#cb438-22" tabindex="-1"></a>                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb438-23"><a href="what_is_stacked_ensambled.html#cb438-23" tabindex="-1"></a>  </span>
<span id="cb438-24"><a href="what_is_stacked_ensambled.html#cb438-24" tabindex="-1"></a>  <span class="co"># Generate predictions on the bootstrapped test set</span></span>
<span id="cb438-25"><a href="what_is_stacked_ensambled.html#cb438-25" tabindex="-1"></a>  lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_mod, test_data)</span>
<span id="cb438-26"><a href="what_is_stacked_ensambled.html#cb438-26" tabindex="-1"></a>  rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_mod, test_data)</span>
<span id="cb438-27"><a href="what_is_stacked_ensambled.html#cb438-27" tabindex="-1"></a>  base_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(base_gbm_mod, test_data, <span class="at">n.trees =</span> <span class="dv">100</span>)</span>
<span id="cb438-28"><a href="what_is_stacked_ensambled.html#cb438-28" tabindex="-1"></a>  tuned_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(tuned_gbm_mod, test_data, <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees)</span>
<span id="cb438-29"><a href="what_is_stacked_ensambled.html#cb438-29" tabindex="-1"></a>  </span>
<span id="cb438-30"><a href="what_is_stacked_ensambled.html#cb438-30" tabindex="-1"></a>  <span class="co"># Combine predictions into a data frame</span></span>
<span id="cb438-31"><a href="what_is_stacked_ensambled.html#cb438-31" tabindex="-1"></a>  preds_four <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, base_gbm_pred, tuned_gbm_pred)</span>
<span id="cb438-32"><a href="what_is_stacked_ensambled.html#cb438-32" tabindex="-1"></a>  </span>
<span id="cb438-33"><a href="what_is_stacked_ensambled.html#cb438-33" tabindex="-1"></a>  <span class="co"># Calculate the correlation matrix for the current iteration</span></span>
<span id="cb438-34"><a href="what_is_stacked_ensambled.html#cb438-34" tabindex="-1"></a>  cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(preds_four)</span>
<span id="cb438-35"><a href="what_is_stacked_ensambled.html#cb438-35" tabindex="-1"></a>  </span>
<span id="cb438-36"><a href="what_is_stacked_ensambled.html#cb438-36" tabindex="-1"></a>  <span class="co"># Accumulate the correlation matrices</span></span>
<span id="cb438-37"><a href="what_is_stacked_ensambled.html#cb438-37" tabindex="-1"></a>  cor_matrix_sum <span class="ot">&lt;-</span> cor_matrix_sum <span class="sc">+</span> cor_matrix</span>
<span id="cb438-38"><a href="what_is_stacked_ensambled.html#cb438-38" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
Progress: 1 iterations completed
Progress: 2 iterations completed
Progress: 3 iterations completed
Progress: 4 iterations completed
Progress: 5 iterations completed
Progress: 6 iterations completed
Progress: 7 iterations completed
Progress: 8 iterations completed
Progress: 9 iterations completed
Progress: 10 iterations completed
Progress: 11 iterations completed
Progress: 12 iterations completed
Progress: 13 iterations completed
Progress: 14 iterations completed
Progress: 15 iterations completed
Progress: 16 iterations completed
Progress: 17 iterations completed
Progress: 18 iterations completed
Progress: 19 iterations completed
Progress: 20 iterations completed
Progress: 21 iterations completed
Progress: 22 iterations completed
Progress: 23 iterations completed
Progress: 24 iterations completed
Progress: 25 iterations completed
Progress: 26 iterations completed
Progress: 27 iterations completed
Progress: 28 iterations completed
Progress: 29 iterations completed
Progress: 30 iterations completed
Progress: 31 iterations completed
Progress: 32 iterations completed
Progress: 33 iterations completed
Progress: 34 iterations completed
Progress: 35 iterations completed
Progress: 36 iterations completed
Progress: 37 iterations completed
Progress: 38 iterations completed
Progress: 39 iterations completed
Progress: 40 iterations completed
Progress: 41 iterations completed
Progress: 42 iterations completed
Progress: 43 iterations completed
Progress: 44 iterations completed
Progress: 45 iterations completed
Progress: 46 iterations completed
Progress: 47 iterations completed
Progress: 48 iterations completed
Progress: 49 iterations completed
Progress: 50 iterations completed
Progress: 51 iterations completed
Progress: 52 iterations completed
Progress: 53 iterations completed
Progress: 54 iterations completed
Progress: 55 iterations completed
Progress: 56 iterations completed
Progress: 57 iterations completed
Progress: 58 iterations completed
Progress: 59 iterations completed
Progress: 60 iterations completed
Progress: 61 iterations completed
Progress: 62 iterations completed
Progress: 63 iterations completed
Progress: 64 iterations completed
Progress: 65 iterations completed
Progress: 66 iterations completed
Progress: 67 iterations completed
Progress: 68 iterations completed
Progress: 69 iterations completed
Progress: 70 iterations completed
Progress: 71 iterations completed
Progress: 72 iterations completed
Progress: 73 iterations completed
Progress: 74 iterations completed
Progress: 75 iterations completed
Progress: 76 iterations completed
Progress: 77 iterations completed
Progress: 78 iterations completed
Progress: 79 iterations completed
Progress: 80 iterations completed
Progress: 81 iterations completed
Progress: 82 iterations completed
Progress: 83 iterations completed
Progress: 84 iterations completed
Progress: 85 iterations completed
Progress: 86 iterations completed
Progress: 87 iterations completed
Progress: 88 iterations completed
Progress: 89 iterations completed
Progress: 90 iterations completed
Progress: 91 iterations completed
Progress: 92 iterations completed
Progress: 93 iterations completed
Progress: 94 iterations completed
Progress: 95 iterations completed
Progress: 96 iterations completed
Progress: 97 iterations completed
Progress: 98 iterations completed
Progress: 99 iterations completed
Progress: 100 iterations completed
Progress: 101 iterations completed
Progress: 102 iterations completed
Progress: 103 iterations completed
Progress: 104 iterations completed
Progress: 105 iterations completed
Progress: 106 iterations completed
Progress: 107 iterations completed
Progress: 108 iterations completed
Progress: 109 iterations completed
Progress: 110 iterations completed
Progress: 111 iterations completed
Progress: 112 iterations completed
Progress: 113 iterations completed
Progress: 114 iterations completed
Progress: 115 iterations completed
Progress: 116 iterations completed
Progress: 117 iterations completed
Progress: 118 iterations completed
Progress: 119 iterations completed
Progress: 120 iterations completed
Progress: 121 iterations completed
Progress: 122 iterations completed
Progress: 123 iterations completed
Progress: 124 iterations completed
Progress: 125 iterations completed
Progress: 126 iterations completed
Progress: 127 iterations completed
Progress: 128 iterations completed
Progress: 129 iterations completed
Progress: 130 iterations completed
Progress: 131 iterations completed
Progress: 132 iterations completed
Progress: 133 iterations completed
Progress: 134 iterations completed
Progress: 135 iterations completed
Progress: 136 iterations completed
Progress: 137 iterations completed
Progress: 138 iterations completed
Progress: 139 iterations completed
Progress: 140 iterations completed
Progress: 141 iterations completed
Progress: 142 iterations completed
Progress: 143 iterations completed
Progress: 144 iterations completed
Progress: 145 iterations completed
Progress: 146 iterations completed
Progress: 147 iterations completed
Progress: 148 iterations completed
Progress: 149 iterations completed
Progress: 150 iterations completed
Progress: 151 iterations completed
Progress: 152 iterations completed
Progress: 153 iterations completed
Progress: 154 iterations completed
Progress: 155 iterations completed
Progress: 156 iterations completed
Progress: 157 iterations completed
Progress: 158 iterations completed
Progress: 159 iterations completed
Progress: 160 iterations completed
Progress: 161 iterations completed
Progress: 162 iterations completed
Progress: 163 iterations completed
Progress: 164 iterations completed
Progress: 165 iterations completed
Progress: 166 iterations completed
Progress: 167 iterations completed
Progress: 168 iterations completed
Progress: 169 iterations completed
Progress: 170 iterations completed
Progress: 171 iterations completed
Progress: 172 iterations completed
Progress: 173 iterations completed
Progress: 174 iterations completed
Progress: 175 iterations completed
Progress: 176 iterations completed
Progress: 177 iterations completed
Progress: 178 iterations completed
Progress: 179 iterations completed
Progress: 180 iterations completed
Progress: 181 iterations completed
Progress: 182 iterations completed
Progress: 183 iterations completed
Progress: 184 iterations completed
Progress: 185 iterations completed
Progress: 186 iterations completed
Progress: 187 iterations completed
Progress: 188 iterations completed
Progress: 189 iterations completed
Progress: 190 iterations completed
Progress: 191 iterations completed
Progress: 192 iterations completed
Progress: 193 iterations completed
Progress: 194 iterations completed
Progress: 195 iterations completed
Progress: 196 iterations completed
Progress: 197 iterations completed
Progress: 198 iterations completed
Progress: 199 iterations completed
Progress: 200 iterations completed
Progress: 201 iterations completed
Progress: 202 iterations completed
Progress: 203 iterations completed
Progress: 204 iterations completed
Progress: 205 iterations completed
Progress: 206 iterations completed
Progress: 207 iterations completed
Progress: 208 iterations completed
Progress: 209 iterations completed
Progress: 210 iterations completed
Progress: 211 iterations completed
Progress: 212 iterations completed
Progress: 213 iterations completed
Progress: 214 iterations completed
Progress: 215 iterations completed
Progress: 216 iterations completed
Progress: 217 iterations completed
Progress: 218 iterations completed
Progress: 219 iterations completed
Progress: 220 iterations completed
Progress: 221 iterations completed
Progress: 222 iterations completed
Progress: 223 iterations completed
Progress: 224 iterations completed
Progress: 225 iterations completed
Progress: 226 iterations completed
Progress: 227 iterations completed
Progress: 228 iterations completed
Progress: 229 iterations completed
Progress: 230 iterations completed
Progress: 231 iterations completed
Progress: 232 iterations completed
Progress: 233 iterations completed
Progress: 234 iterations completed
Progress: 235 iterations completed
Progress: 236 iterations completed
Progress: 237 iterations completed
Progress: 238 iterations completed
Progress: 239 iterations completed
Progress: 240 iterations completed
Progress: 241 iterations completed
Progress: 242 iterations completed
Progress: 243 iterations completed
Progress: 244 iterations completed
Progress: 245 iterations completed
Progress: 246 iterations completed
Progress: 247 iterations completed
Progress: 248 iterations completed
Progress: 249 iterations completed
Progress: 250 iterations completed
Progress: 251 iterations completed
Progress: 252 iterations completed
Progress: 253 iterations completed
Progress: 254 iterations completed
Progress: 255 iterations completed
Progress: 256 iterations completed
Progress: 257 iterations completed
Progress: 258 iterations completed
Progress: 259 iterations completed
Progress: 260 iterations completed
Progress: 261 iterations completed
Progress: 262 iterations completed
Progress: 263 iterations completed
Progress: 264 iterations completed
Progress: 265 iterations completed
Progress: 266 iterations completed
Progress: 267 iterations completed
Progress: 268 iterations completed
Progress: 269 iterations completed
Progress: 270 iterations completed
Progress: 271 iterations completed
Progress: 272 iterations completed
Progress: 273 iterations completed
Progress: 274 iterations completed
Progress: 275 iterations completed
Progress: 276 iterations completed
Progress: 277 iterations completed
Progress: 278 iterations completed
Progress: 279 iterations completed
Progress: 280 iterations completed
Progress: 281 iterations completed
Progress: 282 iterations completed
Progress: 283 iterations completed
Progress: 284 iterations completed
Progress: 285 iterations completed
Progress: 286 iterations completed
Progress: 287 iterations completed
Progress: 288 iterations completed
Progress: 289 iterations completed
Progress: 290 iterations completed
Progress: 291 iterations completed
Progress: 292 iterations completed
Progress: 293 iterations completed
Progress: 294 iterations completed
Progress: 295 iterations completed
Progress: 296 iterations completed
Progress: 297 iterations completed
Progress: 298 iterations completed
Progress: 299 iterations completed
Progress: 300 iterations completed
Progress: 301 iterations completed
Progress: 302 iterations completed
Progress: 303 iterations completed
Progress: 304 iterations completed
Progress: 305 iterations completed
Progress: 306 iterations completed
Progress: 307 iterations completed
Progress: 308 iterations completed
Progress: 309 iterations completed
Progress: 310 iterations completed
Progress: 311 iterations completed
Progress: 312 iterations completed
Progress: 313 iterations completed
Progress: 314 iterations completed
Progress: 315 iterations completed
Progress: 316 iterations completed
Progress: 317 iterations completed
Progress: 318 iterations completed
Progress: 319 iterations completed
Progress: 320 iterations completed
Progress: 321 iterations completed
Progress: 322 iterations completed
Progress: 323 iterations completed
Progress: 324 iterations completed
Progress: 325 iterations completed
Progress: 326 iterations completed
Progress: 327 iterations completed
Progress: 328 iterations completed
Progress: 329 iterations completed
Progress: 330 iterations completed
Progress: 331 iterations completed
Progress: 332 iterations completed
Progress: 333 iterations completed
Progress: 334 iterations completed
Progress: 335 iterations completed
Progress: 336 iterations completed
Progress: 337 iterations completed
Progress: 338 iterations completed
Progress: 339 iterations completed
Progress: 340 iterations completed
Progress: 341 iterations completed
Progress: 342 iterations completed
Progress: 343 iterations completed
Progress: 344 iterations completed
Progress: 345 iterations completed
Progress: 346 iterations completed
Progress: 347 iterations completed
Progress: 348 iterations completed
Progress: 349 iterations completed
Progress: 350 iterations completed
Progress: 351 iterations completed
Progress: 352 iterations completed
Progress: 353 iterations completed
Progress: 354 iterations completed
Progress: 355 iterations completed
Progress: 356 iterations completed
Progress: 357 iterations completed
Progress: 358 iterations completed
Progress: 359 iterations completed
Progress: 360 iterations completed
Progress: 361 iterations completed
Progress: 362 iterations completed
Progress: 363 iterations completed
Progress: 364 iterations completed
Progress: 365 iterations completed
Progress: 366 iterations completed
Progress: 367 iterations completed
Progress: 368 iterations completed
Progress: 369 iterations completed
Progress: 370 iterations completed
Progress: 371 iterations completed
Progress: 372 iterations completed
Progress: 373 iterations completed
Progress: 374 iterations completed
Progress: 375 iterations completed
Progress: 376 iterations completed
Progress: 377 iterations completed
Progress: 378 iterations completed
Progress: 379 iterations completed
Progress: 380 iterations completed
Progress: 381 iterations completed
Progress: 382 iterations completed
Progress: 383 iterations completed
Progress: 384 iterations completed
Progress: 385 iterations completed
Progress: 386 iterations completed
Progress: 387 iterations completed
Progress: 388 iterations completed
Progress: 389 iterations completed
Progress: 390 iterations completed
Progress: 391 iterations completed
Progress: 392 iterations completed
Progress: 393 iterations completed
Progress: 394 iterations completed
Progress: 395 iterations completed
Progress: 396 iterations completed
Progress: 397 iterations completed
Progress: 398 iterations completed
Progress: 399 iterations completed
Progress: 400 iterations completed
Progress: 401 iterations completed
Progress: 402 iterations completed
Progress: 403 iterations completed
Progress: 404 iterations completed
Progress: 405 iterations completed
Progress: 406 iterations completed
Progress: 407 iterations completed
Progress: 408 iterations completed
Progress: 409 iterations completed
Progress: 410 iterations completed
Progress: 411 iterations completed
Progress: 412 iterations completed
Progress: 413 iterations completed
Progress: 414 iterations completed
Progress: 415 iterations completed
Progress: 416 iterations completed
Progress: 417 iterations completed
Progress: 418 iterations completed
Progress: 419 iterations completed
Progress: 420 iterations completed
Progress: 421 iterations completed
Progress: 422 iterations completed
Progress: 423 iterations completed
Progress: 424 iterations completed
Progress: 425 iterations completed
Progress: 426 iterations completed
Progress: 427 iterations completed
Progress: 428 iterations completed
Progress: 429 iterations completed
Progress: 430 iterations completed
Progress: 431 iterations completed
Progress: 432 iterations completed
Progress: 433 iterations completed
Progress: 434 iterations completed
Progress: 435 iterations completed
Progress: 436 iterations completed
Progress: 437 iterations completed
Progress: 438 iterations completed
Progress: 439 iterations completed
Progress: 440 iterations completed
Progress: 441 iterations completed
Progress: 442 iterations completed
Progress: 443 iterations completed
Progress: 444 iterations completed
Progress: 445 iterations completed
Progress: 446 iterations completed
Progress: 447 iterations completed
Progress: 448 iterations completed
Progress: 449 iterations completed
Progress: 450 iterations completed
Progress: 451 iterations completed
Progress: 452 iterations completed
Progress: 453 iterations completed
Progress: 454 iterations completed
Progress: 455 iterations completed
Progress: 456 iterations completed
Progress: 457 iterations completed
Progress: 458 iterations completed
Progress: 459 iterations completed
Progress: 460 iterations completed
Progress: 461 iterations completed
Progress: 462 iterations completed
Progress: 463 iterations completed
Progress: 464 iterations completed
Progress: 465 iterations completed
Progress: 466 iterations completed
Progress: 467 iterations completed
Progress: 468 iterations completed
Progress: 469 iterations completed
Progress: 470 iterations completed
Progress: 471 iterations completed
Progress: 472 iterations completed
Progress: 473 iterations completed
Progress: 474 iterations completed
Progress: 475 iterations completed
Progress: 476 iterations completed
Progress: 477 iterations completed
Progress: 478 iterations completed
Progress: 479 iterations completed
Progress: 480 iterations completed
Progress: 481 iterations completed
Progress: 482 iterations completed
Progress: 483 iterations completed
Progress: 484 iterations completed
Progress: 485 iterations completed
Progress: 486 iterations completed
Progress: 487 iterations completed
Progress: 488 iterations completed
Progress: 489 iterations completed
Progress: 490 iterations completed
Progress: 491 iterations completed
Progress: 492 iterations completed
Progress: 493 iterations completed
Progress: 494 iterations completed
Progress: 495 iterations completed
Progress: 496 iterations completed
Progress: 497 iterations completed
Progress: 498 iterations completed
Progress: 499 iterations completed
Progress: 500 iterations completed
Progress: 501 iterations completed
Progress: 502 iterations completed
Progress: 503 iterations completed
Progress: 504 iterations completed
Progress: 505 iterations completed
Progress: 506 iterations completed
Progress: 507 iterations completed
Progress: 508 iterations completed
Progress: 509 iterations completed
Progress: 510 iterations completed
Progress: 511 iterations completed
Progress: 512 iterations completed
Progress: 513 iterations completed
Progress: 514 iterations completed
Progress: 515 iterations completed
Progress: 516 iterations completed
Progress: 517 iterations completed
Progress: 518 iterations completed
Progress: 519 iterations completed
Progress: 520 iterations completed
Progress: 521 iterations completed
Progress: 522 iterations completed
Progress: 523 iterations completed
Progress: 524 iterations completed
Progress: 525 iterations completed
Progress: 526 iterations completed
Progress: 527 iterations completed
Progress: 528 iterations completed
Progress: 529 iterations completed
Progress: 530 iterations completed
Progress: 531 iterations completed
Progress: 532 iterations completed
Progress: 533 iterations completed
Progress: 534 iterations completed
Progress: 535 iterations completed
Progress: 536 iterations completed
Progress: 537 iterations completed
Progress: 538 iterations completed
Progress: 539 iterations completed
Progress: 540 iterations completed
Progress: 541 iterations completed
Progress: 542 iterations completed
Progress: 543 iterations completed
Progress: 544 iterations completed
Progress: 545 iterations completed
Progress: 546 iterations completed
Progress: 547 iterations completed
Progress: 548 iterations completed
Progress: 549 iterations completed
Progress: 550 iterations completed
Progress: 551 iterations completed
Progress: 552 iterations completed
Progress: 553 iterations completed
Progress: 554 iterations completed
Progress: 555 iterations completed
Progress: 556 iterations completed
Progress: 557 iterations completed
Progress: 558 iterations completed
Progress: 559 iterations completed
Progress: 560 iterations completed
Progress: 561 iterations completed
Progress: 562 iterations completed
Progress: 563 iterations completed
Progress: 564 iterations completed
Progress: 565 iterations completed
Progress: 566 iterations completed
Progress: 567 iterations completed
Progress: 568 iterations completed
Progress: 569 iterations completed
Progress: 570 iterations completed
Progress: 571 iterations completed
Progress: 572 iterations completed
Progress: 573 iterations completed
Progress: 574 iterations completed
Progress: 575 iterations completed
Progress: 576 iterations completed
Progress: 577 iterations completed
Progress: 578 iterations completed
Progress: 579 iterations completed
Progress: 580 iterations completed
Progress: 581 iterations completed
Progress: 582 iterations completed
Progress: 583 iterations completed
Progress: 584 iterations completed
Progress: 585 iterations completed
Progress: 586 iterations completed
Progress: 587 iterations completed
Progress: 588 iterations completed
Progress: 589 iterations completed
Progress: 590 iterations completed
Progress: 591 iterations completed
Progress: 592 iterations completed
Progress: 593 iterations completed
Progress: 594 iterations completed
Progress: 595 iterations completed
Progress: 596 iterations completed
Progress: 597 iterations completed
Progress: 598 iterations completed
Progress: 599 iterations completed
Progress: 600 iterations completed
Progress: 601 iterations completed
Progress: 602 iterations completed
Progress: 603 iterations completed
Progress: 604 iterations completed
Progress: 605 iterations completed
Progress: 606 iterations completed
Progress: 607 iterations completed
Progress: 608 iterations completed
Progress: 609 iterations completed
Progress: 610 iterations completed
Progress: 611 iterations completed
Progress: 612 iterations completed
Progress: 613 iterations completed
Progress: 614 iterations completed
Progress: 615 iterations completed
Progress: 616 iterations completed
Progress: 617 iterations completed
Progress: 618 iterations completed
Progress: 619 iterations completed
Progress: 620 iterations completed
Progress: 621 iterations completed
Progress: 622 iterations completed
Progress: 623 iterations completed
Progress: 624 iterations completed
Progress: 625 iterations completed
Progress: 626 iterations completed
Progress: 627 iterations completed
Progress: 628 iterations completed
Progress: 629 iterations completed
Progress: 630 iterations completed
Progress: 631 iterations completed
Progress: 632 iterations completed
Progress: 633 iterations completed
Progress: 634 iterations completed
Progress: 635 iterations completed
Progress: 636 iterations completed
Progress: 637 iterations completed
Progress: 638 iterations completed
Progress: 639 iterations completed
Progress: 640 iterations completed
Progress: 641 iterations completed
Progress: 642 iterations completed
Progress: 643 iterations completed
Progress: 644 iterations completed
Progress: 645 iterations completed
Progress: 646 iterations completed
Progress: 647 iterations completed
Progress: 648 iterations completed
Progress: 649 iterations completed
Progress: 650 iterations completed
Progress: 651 iterations completed
Progress: 652 iterations completed
Progress: 653 iterations completed
Progress: 654 iterations completed
Progress: 655 iterations completed
Progress: 656 iterations completed
Progress: 657 iterations completed
Progress: 658 iterations completed
Progress: 659 iterations completed
Progress: 660 iterations completed
Progress: 661 iterations completed
Progress: 662 iterations completed
Progress: 663 iterations completed
Progress: 664 iterations completed
Progress: 665 iterations completed
Progress: 666 iterations completed
Progress: 667 iterations completed
Progress: 668 iterations completed
Progress: 669 iterations completed
Progress: 670 iterations completed
Progress: 671 iterations completed
Progress: 672 iterations completed
Progress: 673 iterations completed
Progress: 674 iterations completed
Progress: 675 iterations completed
Progress: 676 iterations completed
Progress: 677 iterations completed
Progress: 678 iterations completed
Progress: 679 iterations completed
Progress: 680 iterations completed
Progress: 681 iterations completed
Progress: 682 iterations completed
Progress: 683 iterations completed
Progress: 684 iterations completed
Progress: 685 iterations completed
Progress: 686 iterations completed
Progress: 687 iterations completed
Progress: 688 iterations completed
Progress: 689 iterations completed
Progress: 690 iterations completed
Progress: 691 iterations completed
Progress: 692 iterations completed
Progress: 693 iterations completed
Progress: 694 iterations completed
Progress: 695 iterations completed
Progress: 696 iterations completed
Progress: 697 iterations completed
Progress: 698 iterations completed
Progress: 699 iterations completed
Progress: 700 iterations completed
Progress: 701 iterations completed
Progress: 702 iterations completed
Progress: 703 iterations completed
Progress: 704 iterations completed
Progress: 705 iterations completed
Progress: 706 iterations completed
Progress: 707 iterations completed
Progress: 708 iterations completed
Progress: 709 iterations completed
Progress: 710 iterations completed
Progress: 711 iterations completed
Progress: 712 iterations completed
Progress: 713 iterations completed
Progress: 714 iterations completed
Progress: 715 iterations completed
Progress: 716 iterations completed
Progress: 717 iterations completed
Progress: 718 iterations completed
Progress: 719 iterations completed
Progress: 720 iterations completed
Progress: 721 iterations completed
Progress: 722 iterations completed
Progress: 723 iterations completed
Progress: 724 iterations completed
Progress: 725 iterations completed
Progress: 726 iterations completed
Progress: 727 iterations completed
Progress: 728 iterations completed
Progress: 729 iterations completed
Progress: 730 iterations completed
Progress: 731 iterations completed
Progress: 732 iterations completed
Progress: 733 iterations completed
Progress: 734 iterations completed
Progress: 735 iterations completed
Progress: 736 iterations completed
Progress: 737 iterations completed
Progress: 738 iterations completed
Progress: 739 iterations completed
Progress: 740 iterations completed
Progress: 741 iterations completed
Progress: 742 iterations completed
Progress: 743 iterations completed
Progress: 744 iterations completed
Progress: 745 iterations completed
Progress: 746 iterations completed
Progress: 747 iterations completed
Progress: 748 iterations completed
Progress: 749 iterations completed
Progress: 750 iterations completed
Progress: 751 iterations completed
Progress: 752 iterations completed
Progress: 753 iterations completed
Progress: 754 iterations completed
Progress: 755 iterations completed
Progress: 756 iterations completed
Progress: 757 iterations completed
Progress: 758 iterations completed
Progress: 759 iterations completed
Progress: 760 iterations completed
Progress: 761 iterations completed
Progress: 762 iterations completed
Progress: 763 iterations completed
Progress: 764 iterations completed
Progress: 765 iterations completed
Progress: 766 iterations completed
Progress: 767 iterations completed
Progress: 768 iterations completed
Progress: 769 iterations completed
Progress: 770 iterations completed
Progress: 771 iterations completed
Progress: 772 iterations completed
Progress: 773 iterations completed
Progress: 774 iterations completed
Progress: 775 iterations completed
Progress: 776 iterations completed
Progress: 777 iterations completed
Progress: 778 iterations completed
Progress: 779 iterations completed
Progress: 780 iterations completed
Progress: 781 iterations completed
Progress: 782 iterations completed
Progress: 783 iterations completed
Progress: 784 iterations completed
Progress: 785 iterations completed
Progress: 786 iterations completed
Progress: 787 iterations completed
Progress: 788 iterations completed
Progress: 789 iterations completed
Progress: 790 iterations completed
Progress: 791 iterations completed
Progress: 792 iterations completed
Progress: 793 iterations completed
Progress: 794 iterations completed
Progress: 795 iterations completed
Progress: 796 iterations completed
Progress: 797 iterations completed
Progress: 798 iterations completed
Progress: 799 iterations completed
Progress: 800 iterations completed
Progress: 801 iterations completed
Progress: 802 iterations completed
Progress: 803 iterations completed
Progress: 804 iterations completed
Progress: 805 iterations completed
Progress: 806 iterations completed
Progress: 807 iterations completed
Progress: 808 iterations completed
Progress: 809 iterations completed
Progress: 810 iterations completed
Progress: 811 iterations completed
Progress: 812 iterations completed
Progress: 813 iterations completed
Progress: 814 iterations completed
Progress: 815 iterations completed
Progress: 816 iterations completed
Progress: 817 iterations completed
Progress: 818 iterations completed
Progress: 819 iterations completed
Progress: 820 iterations completed
Progress: 821 iterations completed
Progress: 822 iterations completed
Progress: 823 iterations completed
Progress: 824 iterations completed
Progress: 825 iterations completed
Progress: 826 iterations completed
Progress: 827 iterations completed
Progress: 828 iterations completed
Progress: 829 iterations completed
Progress: 830 iterations completed
Progress: 831 iterations completed
Progress: 832 iterations completed
Progress: 833 iterations completed
Progress: 834 iterations completed
Progress: 835 iterations completed
Progress: 836 iterations completed
Progress: 837 iterations completed
Progress: 838 iterations completed
Progress: 839 iterations completed
Progress: 840 iterations completed
Progress: 841 iterations completed
Progress: 842 iterations completed
Progress: 843 iterations completed
Progress: 844 iterations completed
Progress: 845 iterations completed
Progress: 846 iterations completed
Progress: 847 iterations completed
Progress: 848 iterations completed
Progress: 849 iterations completed
Progress: 850 iterations completed
Progress: 851 iterations completed
Progress: 852 iterations completed
Progress: 853 iterations completed
Progress: 854 iterations completed
Progress: 855 iterations completed
Progress: 856 iterations completed
Progress: 857 iterations completed
Progress: 858 iterations completed
Progress: 859 iterations completed
Progress: 860 iterations completed
Progress: 861 iterations completed
Progress: 862 iterations completed
Progress: 863 iterations completed
Progress: 864 iterations completed
Progress: 865 iterations completed
Progress: 866 iterations completed
Progress: 867 iterations completed
Progress: 868 iterations completed
Progress: 869 iterations completed
Progress: 870 iterations completed
Progress: 871 iterations completed
Progress: 872 iterations completed
Progress: 873 iterations completed
Progress: 874 iterations completed
Progress: 875 iterations completed
Progress: 876 iterations completed
Progress: 877 iterations completed
Progress: 878 iterations completed
Progress: 879 iterations completed
Progress: 880 iterations completed
Progress: 881 iterations completed
Progress: 882 iterations completed
Progress: 883 iterations completed
Progress: 884 iterations completed
Progress: 885 iterations completed
Progress: 886 iterations completed
Progress: 887 iterations completed
Progress: 888 iterations completed
Progress: 889 iterations completed
Progress: 890 iterations completed
Progress: 891 iterations completed
Progress: 892 iterations completed
Progress: 893 iterations completed
Progress: 894 iterations completed
Progress: 895 iterations completed
Progress: 896 iterations completed
Progress: 897 iterations completed
Progress: 898 iterations completed
Progress: 899 iterations completed
Progress: 900 iterations completed
Progress: 901 iterations completed
Progress: 902 iterations completed
Progress: 903 iterations completed
Progress: 904 iterations completed
Progress: 905 iterations completed
Progress: 906 iterations completed
Progress: 907 iterations completed
Progress: 908 iterations completed
Progress: 909 iterations completed
Progress: 910 iterations completed
Progress: 911 iterations completed
Progress: 912 iterations completed
Progress: 913 iterations completed
Progress: 914 iterations completed
Progress: 915 iterations completed
Progress: 916 iterations completed
Progress: 917 iterations completed
Progress: 918 iterations completed
Progress: 919 iterations completed
Progress: 920 iterations completed
Progress: 921 iterations completed
Progress: 922 iterations completed
Progress: 923 iterations completed
Progress: 924 iterations completed
Progress: 925 iterations completed
Progress: 926 iterations completed
Progress: 927 iterations completed
Progress: 928 iterations completed
Progress: 929 iterations completed
Progress: 930 iterations completed
Progress: 931 iterations completed
Progress: 932 iterations completed
Progress: 933 iterations completed
Progress: 934 iterations completed
Progress: 935 iterations completed
Progress: 936 iterations completed
Progress: 937 iterations completed
Progress: 938 iterations completed
Progress: 939 iterations completed
Progress: 940 iterations completed
Progress: 941 iterations completed
Progress: 942 iterations completed
Progress: 943 iterations completed
Progress: 944 iterations completed
Progress: 945 iterations completed
Progress: 946 iterations completed
Progress: 947 iterations completed
Progress: 948 iterations completed
Progress: 949 iterations completed
Progress: 950 iterations completed
Progress: 951 iterations completed
Progress: 952 iterations completed
Progress: 953 iterations completed
Progress: 954 iterations completed
Progress: 955 iterations completed
Progress: 956 iterations completed
Progress: 957 iterations completed
Progress: 958 iterations completed
Progress: 959 iterations completed
Progress: 960 iterations completed
Progress: 961 iterations completed
Progress: 962 iterations completed
Progress: 963 iterations completed
Progress: 964 iterations completed
Progress: 965 iterations completed
Progress: 966 iterations completed
Progress: 967 iterations completed
Progress: 968 iterations completed
Progress: 969 iterations completed
Progress: 970 iterations completed
Progress: 971 iterations completed
Progress: 972 iterations completed
Progress: 973 iterations completed
Progress: 974 iterations completed
Progress: 975 iterations completed
Progress: 976 iterations completed
Progress: 977 iterations completed
Progress: 978 iterations completed
Progress: 979 iterations completed
Progress: 980 iterations completed
Progress: 981 iterations completed
Progress: 982 iterations completed
Progress: 983 iterations completed
Progress: 984 iterations completed
Progress: 985 iterations completed
Progress: 986 iterations completed
Progress: 987 iterations completed
Progress: 988 iterations completed
Progress: 989 iterations completed
Progress: 990 iterations completed
Progress: 991 iterations completed
Progress: 992 iterations completed
Progress: 993 iterations completed
Progress: 994 iterations completed
Progress: 995 iterations completed
Progress: 996 iterations completed
Progress: 997 iterations completed
Progress: 998 iterations completed
Progress: 999 iterations completed
Progress: 1000 iterations completed</code></pre>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="what_is_stacked_ensambled.html#cb440-1" tabindex="-1"></a><span class="co"># Average the correlation matrix over the 1000 iterations</span></span>
<span id="cb440-2"><a href="what_is_stacked_ensambled.html#cb440-2" tabindex="-1"></a>avg_cor_matrix <span class="ot">&lt;-</span> cor_matrix_sum <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb440-3"><a href="what_is_stacked_ensambled.html#cb440-3" tabindex="-1"></a></span>
<span id="cb440-4"><a href="what_is_stacked_ensambled.html#cb440-4" tabindex="-1"></a><span class="co"># Print the averaged correlation matrix</span></span>
<span id="cb440-5"><a href="what_is_stacked_ensambled.html#cb440-5" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Averaged Correlation Matrix:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Averaged Correlation Matrix:&quot;</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="what_is_stacked_ensambled.html#cb442-1" tabindex="-1"></a><span class="fu">print</span>(avg_cor_matrix)</span></code></pre></div>
<pre><code>##                  lm_pred   rf_pred base_gbm_pred tuned_gbm_pred
## lm_pred        1.0000000 0.9006896     0.8882324      0.8921471
## rf_pred        0.9006896 1.0000000     0.9761753      0.9768151
## base_gbm_pred  0.8882324 0.9761753     1.0000000      0.9690552
## tuned_gbm_pred 0.8921471 0.9768151     0.9690552      1.0000000</code></pre>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="what_is_stacked_ensambled.html#cb444-1" tabindex="-1"></a><span class="co"># Calculate mean RMSPE for the ensemble with all four models</span></span>
<span id="cb444-2"><a href="what_is_stacked_ensambled.html#cb444-2" tabindex="-1"></a>mean_rmspe_ensemble_four <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_ensemble_four)</span>
<span id="cb444-3"><a href="what_is_stacked_ensambled.html#cb444-3" tabindex="-1"></a></span>
<span id="cb444-4"><a href="what_is_stacked_ensambled.html#cb444-4" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb444-5"><a href="what_is_stacked_ensambled.html#cb444-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE of Stacked Ensemble with All Four Models:&quot;</span>, mean_rmspe_ensemble_four))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE of Stacked Ensemble with All Four Models: 0.336746256053834&quot;</code></pre>
<p>now what if i use another model that is less correlated to the other models</p>
<p>the first knn3 setup to make sure it works</p>
<p>It needs to be knnreg… knn3 does not work for regression</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="what_is_stacked_ensambled.html#cb446-1" tabindex="-1"></a><span class="co"># Load the required package</span></span>
<span id="cb446-2"><a href="what_is_stacked_ensambled.html#cb446-2" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb446-3"><a href="what_is_stacked_ensambled.html#cb446-3" tabindex="-1"></a></span>
<span id="cb446-4"><a href="what_is_stacked_ensambled.html#cb446-4" tabindex="-1"></a><span class="co"># Sample data (assuming &#39;data&#39; is your dataset and &#39;medv&#39; is the target)</span></span>
<span id="cb446-5"><a href="what_is_stacked_ensambled.html#cb446-5" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb446-6"><a href="what_is_stacked_ensambled.html#cb446-6" tabindex="-1"></a>train <span class="ot">&lt;-</span> data[ind, ]</span>
<span id="cb446-7"><a href="what_is_stacked_ensambled.html#cb446-7" tabindex="-1"></a>test <span class="ot">&lt;-</span> data[<span class="sc">-</span>ind, ]</span>
<span id="cb446-8"><a href="what_is_stacked_ensambled.html#cb446-8" tabindex="-1"></a></span>
<span id="cb446-9"><a href="what_is_stacked_ensambled.html#cb446-9" tabindex="-1"></a><span class="co"># Fit the KNN regression model</span></span>
<span id="cb446-10"><a href="what_is_stacked_ensambled.html#cb446-10" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">knnreg</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train, <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb446-11"><a href="what_is_stacked_ensambled.html#cb446-11" tabindex="-1"></a></span>
<span id="cb446-12"><a href="what_is_stacked_ensambled.html#cb446-12" tabindex="-1"></a><span class="co"># Predict on the test set</span></span>
<span id="cb446-13"><a href="what_is_stacked_ensambled.html#cb446-13" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, test)</span>
<span id="cb446-14"><a href="what_is_stacked_ensambled.html#cb446-14" tabindex="-1"></a></span>
<span id="cb446-15"><a href="what_is_stacked_ensambled.html#cb446-15" tabindex="-1"></a><span class="co"># Calculate RMSE</span></span>
<span id="cb446-16"><a href="what_is_stacked_ensambled.html#cb446-16" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((predictions <span class="sc">-</span> test<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb446-17"><a href="what_is_stacked_ensambled.html#cb446-17" tabindex="-1"></a><span class="fu">print</span>(rmse)</span></code></pre></div>
<pre><code>## [1] 0.4388689</code></pre>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="what_is_stacked_ensambled.html#cb448-1" tabindex="-1"></a><span class="co"># Define the grid for k values</span></span>
<span id="cb448-2"><a href="what_is_stacked_ensambled.html#cb448-2" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb448-3"><a href="what_is_stacked_ensambled.html#cb448-3" tabindex="-1"></a></span>
<span id="cb448-4"><a href="what_is_stacked_ensambled.html#cb448-4" tabindex="-1"></a><span class="co"># Initialize a vector to store the average RMSPE for each k</span></span>
<span id="cb448-5"><a href="what_is_stacked_ensambled.html#cb448-5" tabindex="-1"></a>rmspe_k <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k_values))</span>
<span id="cb448-6"><a href="what_is_stacked_ensambled.html#cb448-6" tabindex="-1"></a></span>
<span id="cb448-7"><a href="what_is_stacked_ensambled.html#cb448-7" tabindex="-1"></a><span class="co"># Loop over each k value</span></span>
<span id="cb448-8"><a href="what_is_stacked_ensambled.html#cb448-8" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(k_values)) {</span>
<span id="cb448-9"><a href="what_is_stacked_ensambled.html#cb448-9" tabindex="-1"></a>  k <span class="ot">&lt;-</span> k_values[j]</span>
<span id="cb448-10"><a href="what_is_stacked_ensambled.html#cb448-10" tabindex="-1"></a>  </span>
<span id="cb448-11"><a href="what_is_stacked_ensambled.html#cb448-11" tabindex="-1"></a>  <span class="co"># Initialize a vector to store RMSPE for each bootstrap run</span></span>
<span id="cb448-12"><a href="what_is_stacked_ensambled.html#cb448-12" tabindex="-1"></a>  rmspe_vals <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb448-13"><a href="what_is_stacked_ensambled.html#cb448-13" tabindex="-1"></a>  </span>
<span id="cb448-14"><a href="what_is_stacked_ensambled.html#cb448-14" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb448-15"><a href="what_is_stacked_ensambled.html#cb448-15" tabindex="-1"></a>    <span class="co"># Bootstrapping</span></span>
<span id="cb448-16"><a href="what_is_stacked_ensambled.html#cb448-16" tabindex="-1"></a>    train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb448-17"><a href="what_is_stacked_ensambled.html#cb448-17" tabindex="-1"></a>    train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb448-18"><a href="what_is_stacked_ensambled.html#cb448-18" tabindex="-1"></a>    test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb448-19"><a href="what_is_stacked_ensambled.html#cb448-19" tabindex="-1"></a>    </span>
<span id="cb448-20"><a href="what_is_stacked_ensambled.html#cb448-20" tabindex="-1"></a>    <span class="co"># Train KNN model with current k using knn3</span></span>
<span id="cb448-21"><a href="what_is_stacked_ensambled.html#cb448-21" tabindex="-1"></a>    knn_mod <span class="ot">&lt;-</span> <span class="fu">knnreg</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">k =</span> k)</span>
<span id="cb448-22"><a href="what_is_stacked_ensambled.html#cb448-22" tabindex="-1"></a></span>
<span id="cb448-23"><a href="what_is_stacked_ensambled.html#cb448-23" tabindex="-1"></a>    </span>
<span id="cb448-24"><a href="what_is_stacked_ensambled.html#cb448-24" tabindex="-1"></a>    </span>
<span id="cb448-25"><a href="what_is_stacked_ensambled.html#cb448-25" tabindex="-1"></a>    <span class="co">#THIS IS HUGE</span></span>
<span id="cb448-26"><a href="what_is_stacked_ensambled.html#cb448-26" tabindex="-1"></a>    test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_mod, test_data)</span>
<span id="cb448-27"><a href="what_is_stacked_ensambled.html#cb448-27" tabindex="-1"></a></span>
<span id="cb448-28"><a href="what_is_stacked_ensambled.html#cb448-28" tabindex="-1"></a>    rmspe_vals[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb448-29"><a href="what_is_stacked_ensambled.html#cb448-29" tabindex="-1"></a>  }</span>
<span id="cb448-30"><a href="what_is_stacked_ensambled.html#cb448-30" tabindex="-1"></a>  </span>
<span id="cb448-31"><a href="what_is_stacked_ensambled.html#cb448-31" tabindex="-1"></a>  <span class="co"># Store the average RMSPE for this k</span></span>
<span id="cb448-32"><a href="what_is_stacked_ensambled.html#cb448-32" tabindex="-1"></a>  rmspe_k[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_vals)</span>
<span id="cb448-33"><a href="what_is_stacked_ensambled.html#cb448-33" tabindex="-1"></a>  </span>
<span id="cb448-34"><a href="what_is_stacked_ensambled.html#cb448-34" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, j, <span class="st">&quot;/&quot;</span>, <span class="fu">length</span>(k_values), <span class="st">&quot;k =&quot;</span>, k, <span class="st">&quot;Average RMSPE:&quot;</span>, rmspe_k[j])</span>
<span id="cb448-35"><a href="what_is_stacked_ensambled.html#cb448-35" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
Progress: 1 / 10 k = 1 Average RMSPE: 0.4806884
Progress: 2 / 10 k = 2 Average RMSPE: 0.4280265
Progress: 3 / 10 k = 3 Average RMSPE: 0.4298077
Progress: 4 / 10 k = 4 Average RMSPE: 0.4325119
Progress: 5 / 10 k = 5 Average RMSPE: 0.4472152
Progress: 6 / 10 k = 6 Average RMSPE: 0.4632297
Progress: 7 / 10 k = 7 Average RMSPE: 0.4772773
Progress: 8 / 10 k = 8 Average RMSPE: 0.4799322
Progress: 9 / 10 k = 9 Average RMSPE: 0.4907186
Progress: 10 / 10 k = 10 Average RMSPE: 0.5038339</code></pre>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="what_is_stacked_ensambled.html#cb450-1" tabindex="-1"></a><span class="co"># Identify the best k with the lowest average RMSPE</span></span>
<span id="cb450-2"><a href="what_is_stacked_ensambled.html#cb450-2" tabindex="-1"></a>best_k <span class="ot">&lt;-</span> k_values[<span class="fu">which.min</span>(rmspe_k)]</span>
<span id="cb450-3"><a href="what_is_stacked_ensambled.html#cb450-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Best k value is:&quot;</span>, best_k, <span class="st">&quot;with an average RMSPE of:&quot;</span>, <span class="fu">min</span>(rmspe_k)))</span></code></pre></div>
<pre><code>## [1] &quot;Best k value is: 2 with an average RMSPE of: 0.428026512526112&quot;</code></pre>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="what_is_stacked_ensambled.html#cb452-1" tabindex="-1"></a><span class="co"># Initialize a vector to store RMSPE results for the best k</span></span>
<span id="cb452-2"><a href="what_is_stacked_ensambled.html#cb452-2" tabindex="-1"></a>rmspe_best_k <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb452-3"><a href="what_is_stacked_ensambled.html#cb452-3" tabindex="-1"></a></span>
<span id="cb452-4"><a href="what_is_stacked_ensambled.html#cb452-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb452-5"><a href="what_is_stacked_ensambled.html#cb452-5" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb452-6"><a href="what_is_stacked_ensambled.html#cb452-6" tabindex="-1"></a>  </span>
<span id="cb452-7"><a href="what_is_stacked_ensambled.html#cb452-7" tabindex="-1"></a>  <span class="co"># Bootstrapping</span></span>
<span id="cb452-8"><a href="what_is_stacked_ensambled.html#cb452-8" tabindex="-1"></a>  train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb452-9"><a href="what_is_stacked_ensambled.html#cb452-9" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb452-10"><a href="what_is_stacked_ensambled.html#cb452-10" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb452-11"><a href="what_is_stacked_ensambled.html#cb452-11" tabindex="-1"></a>  </span>
<span id="cb452-12"><a href="what_is_stacked_ensambled.html#cb452-12" tabindex="-1"></a>  <span class="co"># Train KNN model with the best k using knn3</span></span>
<span id="cb452-13"><a href="what_is_stacked_ensambled.html#cb452-13" tabindex="-1"></a>  knn_mod <span class="ot">&lt;-</span> <span class="fu">knnreg</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">k =</span> best_k)</span>
<span id="cb452-14"><a href="what_is_stacked_ensambled.html#cb452-14" tabindex="-1"></a>  </span>
<span id="cb452-15"><a href="what_is_stacked_ensambled.html#cb452-15" tabindex="-1"></a>  <span class="co"># Predict on the test set</span></span>
<span id="cb452-16"><a href="what_is_stacked_ensambled.html#cb452-16" tabindex="-1"></a>  test_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_mod, test_data)</span>
<span id="cb452-17"><a href="what_is_stacked_ensambled.html#cb452-17" tabindex="-1"></a>  <span class="co"># Calculate RMSPE for the best k</span></span>
<span id="cb452-18"><a href="what_is_stacked_ensambled.html#cb452-18" tabindex="-1"></a>  rmspe_best_k[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((test_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb452-19"><a href="what_is_stacked_ensambled.html#cb452-19" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
Progress: 1 iterations completed
Progress: 2 iterations completed
Progress: 3 iterations completed
Progress: 4 iterations completed
Progress: 5 iterations completed
Progress: 6 iterations completed
Progress: 7 iterations completed
Progress: 8 iterations completed
Progress: 9 iterations completed
Progress: 10 iterations completed
Progress: 11 iterations completed
Progress: 12 iterations completed
Progress: 13 iterations completed
Progress: 14 iterations completed
Progress: 15 iterations completed
Progress: 16 iterations completed
Progress: 17 iterations completed
Progress: 18 iterations completed
Progress: 19 iterations completed
Progress: 20 iterations completed
Progress: 21 iterations completed
Progress: 22 iterations completed
Progress: 23 iterations completed
Progress: 24 iterations completed
Progress: 25 iterations completed
Progress: 26 iterations completed
Progress: 27 iterations completed
Progress: 28 iterations completed
Progress: 29 iterations completed
Progress: 30 iterations completed
Progress: 31 iterations completed
Progress: 32 iterations completed
Progress: 33 iterations completed
Progress: 34 iterations completed
Progress: 35 iterations completed
Progress: 36 iterations completed
Progress: 37 iterations completed
Progress: 38 iterations completed
Progress: 39 iterations completed
Progress: 40 iterations completed
Progress: 41 iterations completed
Progress: 42 iterations completed
Progress: 43 iterations completed
Progress: 44 iterations completed
Progress: 45 iterations completed
Progress: 46 iterations completed
Progress: 47 iterations completed
Progress: 48 iterations completed
Progress: 49 iterations completed
Progress: 50 iterations completed
Progress: 51 iterations completed
Progress: 52 iterations completed
Progress: 53 iterations completed
Progress: 54 iterations completed
Progress: 55 iterations completed
Progress: 56 iterations completed
Progress: 57 iterations completed
Progress: 58 iterations completed
Progress: 59 iterations completed
Progress: 60 iterations completed
Progress: 61 iterations completed
Progress: 62 iterations completed
Progress: 63 iterations completed
Progress: 64 iterations completed
Progress: 65 iterations completed
Progress: 66 iterations completed
Progress: 67 iterations completed
Progress: 68 iterations completed
Progress: 69 iterations completed
Progress: 70 iterations completed
Progress: 71 iterations completed
Progress: 72 iterations completed
Progress: 73 iterations completed
Progress: 74 iterations completed
Progress: 75 iterations completed
Progress: 76 iterations completed
Progress: 77 iterations completed
Progress: 78 iterations completed
Progress: 79 iterations completed
Progress: 80 iterations completed
Progress: 81 iterations completed
Progress: 82 iterations completed
Progress: 83 iterations completed
Progress: 84 iterations completed
Progress: 85 iterations completed
Progress: 86 iterations completed
Progress: 87 iterations completed
Progress: 88 iterations completed
Progress: 89 iterations completed
Progress: 90 iterations completed
Progress: 91 iterations completed
Progress: 92 iterations completed
Progress: 93 iterations completed
Progress: 94 iterations completed
Progress: 95 iterations completed
Progress: 96 iterations completed
Progress: 97 iterations completed
Progress: 98 iterations completed
Progress: 99 iterations completed
Progress: 100 iterations completed</code></pre>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="what_is_stacked_ensambled.html#cb454-1" tabindex="-1"></a><span class="co"># Calculate the mean RMSPE for the best k</span></span>
<span id="cb454-2"><a href="what_is_stacked_ensambled.html#cb454-2" tabindex="-1"></a>mean_rmspe_best_k <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_best_k)</span>
<span id="cb454-3"><a href="what_is_stacked_ensambled.html#cb454-3" tabindex="-1"></a></span>
<span id="cb454-4"><a href="what_is_stacked_ensambled.html#cb454-4" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb454-5"><a href="what_is_stacked_ensambled.html#cb454-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE with best k:&quot;</span>, mean_rmspe_best_k))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE with best k: 0.430163863732055&quot;</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="what_is_stacked_ensambled.html#cb456-1" tabindex="-1"></a><span class="co"># Initialize storage for RMSPE results</span></span>
<span id="cb456-2"><a href="what_is_stacked_ensambled.html#cb456-2" tabindex="-1"></a>rmspe_ensemble_knn <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb456-3"><a href="what_is_stacked_ensambled.html#cb456-3" tabindex="-1"></a></span>
<span id="cb456-4"><a href="what_is_stacked_ensambled.html#cb456-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb456-5"><a href="what_is_stacked_ensambled.html#cb456-5" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb456-6"><a href="what_is_stacked_ensambled.html#cb456-6" tabindex="-1"></a>  </span>
<span id="cb456-7"><a href="what_is_stacked_ensambled.html#cb456-7" tabindex="-1"></a>  <span class="co"># Bootstrapping</span></span>
<span id="cb456-8"><a href="what_is_stacked_ensambled.html#cb456-8" tabindex="-1"></a>  train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb456-9"><a href="what_is_stacked_ensambled.html#cb456-9" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb456-10"><a href="what_is_stacked_ensambled.html#cb456-10" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb456-11"><a href="what_is_stacked_ensambled.html#cb456-11" tabindex="-1"></a>  </span>
<span id="cb456-12"><a href="what_is_stacked_ensambled.html#cb456-12" tabindex="-1"></a>  <span class="co"># Re-train the original models on bootstrapped training data</span></span>
<span id="cb456-13"><a href="what_is_stacked_ensambled.html#cb456-13" tabindex="-1"></a>  lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb456-14"><a href="what_is_stacked_ensambled.html#cb456-14" tabindex="-1"></a>  rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb456-15"><a href="what_is_stacked_ensambled.html#cb456-15" tabindex="-1"></a>  tuned_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb456-16"><a href="what_is_stacked_ensambled.html#cb456-16" tabindex="-1"></a>                       <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees, </span>
<span id="cb456-17"><a href="what_is_stacked_ensambled.html#cb456-17" tabindex="-1"></a>                       <span class="at">shrinkage =</span> best_params<span class="sc">$</span>shrinkage, </span>
<span id="cb456-18"><a href="what_is_stacked_ensambled.html#cb456-18" tabindex="-1"></a>                       <span class="at">interaction.depth =</span> best_params<span class="sc">$</span>interaction.depth, </span>
<span id="cb456-19"><a href="what_is_stacked_ensambled.html#cb456-19" tabindex="-1"></a>                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb456-20"><a href="what_is_stacked_ensambled.html#cb456-20" tabindex="-1"></a>  </span>
<span id="cb456-21"><a href="what_is_stacked_ensambled.html#cb456-21" tabindex="-1"></a>  <span class="co"># Train the KNN model with the best k</span></span>
<span id="cb456-22"><a href="what_is_stacked_ensambled.html#cb456-22" tabindex="-1"></a>  knn_mod <span class="ot">&lt;-</span> <span class="fu">knnreg</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">k =</span> best_k)</span>
<span id="cb456-23"><a href="what_is_stacked_ensambled.html#cb456-23" tabindex="-1"></a>  </span>
<span id="cb456-24"><a href="what_is_stacked_ensambled.html#cb456-24" tabindex="-1"></a>  <span class="co"># Generate predictions on the bootstrapped test set</span></span>
<span id="cb456-25"><a href="what_is_stacked_ensambled.html#cb456-25" tabindex="-1"></a>  lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_mod, test_data)</span>
<span id="cb456-26"><a href="what_is_stacked_ensambled.html#cb456-26" tabindex="-1"></a>  rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_mod, test_data)</span>
<span id="cb456-27"><a href="what_is_stacked_ensambled.html#cb456-27" tabindex="-1"></a>  tuned_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(tuned_gbm_mod, test_data, <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees)</span>
<span id="cb456-28"><a href="what_is_stacked_ensambled.html#cb456-28" tabindex="-1"></a>  knn_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_mod, test_data)</span>
<span id="cb456-29"><a href="what_is_stacked_ensambled.html#cb456-29" tabindex="-1"></a>  <span class="co"># Combine predictions into a data frame</span></span>
<span id="cb456-30"><a href="what_is_stacked_ensambled.html#cb456-30" tabindex="-1"></a>  preds_four <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, tuned_gbm_pred, knn_pred)</span>
<span id="cb456-31"><a href="what_is_stacked_ensambled.html#cb456-31" tabindex="-1"></a>  </span>
<span id="cb456-32"><a href="what_is_stacked_ensambled.html#cb456-32" tabindex="-1"></a>  <span class="co"># Train and evaluate the stacked ensemble with KNN replacing base GBM</span></span>
<span id="cb456-33"><a href="what_is_stacked_ensambled.html#cb456-33" tabindex="-1"></a>  meta_four <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">cbind</span>(preds_four, <span class="at">medv =</span> test_data<span class="sc">$</span>medv))</span>
<span id="cb456-34"><a href="what_is_stacked_ensambled.html#cb456-34" tabindex="-1"></a>  meta_four_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(meta_four, preds_four)</span>
<span id="cb456-35"><a href="what_is_stacked_ensambled.html#cb456-35" tabindex="-1"></a>  </span>
<span id="cb456-36"><a href="what_is_stacked_ensambled.html#cb456-36" tabindex="-1"></a>  <span class="co"># Calculate RMSPE for the ensemble with KNN replacing base GBM</span></span>
<span id="cb456-37"><a href="what_is_stacked_ensambled.html#cb456-37" tabindex="-1"></a>  rmspe_ensemble_knn[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((meta_four_pred <span class="sc">-</span> test_data<span class="sc">$</span>medv)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb456-38"><a href="what_is_stacked_ensambled.html#cb456-38" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
Progress: 1 iterations completed
Progress: 2 iterations completed
Progress: 3 iterations completed
Progress: 4 iterations completed
Progress: 5 iterations completed
Progress: 6 iterations completed
Progress: 7 iterations completed
Progress: 8 iterations completed
Progress: 9 iterations completed
Progress: 10 iterations completed
Progress: 11 iterations completed
Progress: 12 iterations completed
Progress: 13 iterations completed
Progress: 14 iterations completed
Progress: 15 iterations completed
Progress: 16 iterations completed
Progress: 17 iterations completed
Progress: 18 iterations completed
Progress: 19 iterations completed
Progress: 20 iterations completed
Progress: 21 iterations completed
Progress: 22 iterations completed
Progress: 23 iterations completed
Progress: 24 iterations completed
Progress: 25 iterations completed
Progress: 26 iterations completed
Progress: 27 iterations completed
Progress: 28 iterations completed
Progress: 29 iterations completed
Progress: 30 iterations completed
Progress: 31 iterations completed
Progress: 32 iterations completed
Progress: 33 iterations completed
Progress: 34 iterations completed
Progress: 35 iterations completed
Progress: 36 iterations completed
Progress: 37 iterations completed
Progress: 38 iterations completed
Progress: 39 iterations completed
Progress: 40 iterations completed
Progress: 41 iterations completed
Progress: 42 iterations completed
Progress: 43 iterations completed
Progress: 44 iterations completed
Progress: 45 iterations completed
Progress: 46 iterations completed
Progress: 47 iterations completed
Progress: 48 iterations completed
Progress: 49 iterations completed
Progress: 50 iterations completed
Progress: 51 iterations completed
Progress: 52 iterations completed
Progress: 53 iterations completed
Progress: 54 iterations completed
Progress: 55 iterations completed
Progress: 56 iterations completed
Progress: 57 iterations completed
Progress: 58 iterations completed
Progress: 59 iterations completed
Progress: 60 iterations completed
Progress: 61 iterations completed
Progress: 62 iterations completed
Progress: 63 iterations completed
Progress: 64 iterations completed
Progress: 65 iterations completed
Progress: 66 iterations completed
Progress: 67 iterations completed
Progress: 68 iterations completed
Progress: 69 iterations completed
Progress: 70 iterations completed
Progress: 71 iterations completed
Progress: 72 iterations completed
Progress: 73 iterations completed
Progress: 74 iterations completed
Progress: 75 iterations completed
Progress: 76 iterations completed
Progress: 77 iterations completed
Progress: 78 iterations completed
Progress: 79 iterations completed
Progress: 80 iterations completed
Progress: 81 iterations completed
Progress: 82 iterations completed
Progress: 83 iterations completed
Progress: 84 iterations completed
Progress: 85 iterations completed
Progress: 86 iterations completed
Progress: 87 iterations completed
Progress: 88 iterations completed
Progress: 89 iterations completed
Progress: 90 iterations completed
Progress: 91 iterations completed
Progress: 92 iterations completed
Progress: 93 iterations completed
Progress: 94 iterations completed
Progress: 95 iterations completed
Progress: 96 iterations completed
Progress: 97 iterations completed
Progress: 98 iterations completed
Progress: 99 iterations completed
Progress: 100 iterations completed
Progress: 101 iterations completed
Progress: 102 iterations completed
Progress: 103 iterations completed
Progress: 104 iterations completed
Progress: 105 iterations completed
Progress: 106 iterations completed
Progress: 107 iterations completed
Progress: 108 iterations completed
Progress: 109 iterations completed
Progress: 110 iterations completed
Progress: 111 iterations completed
Progress: 112 iterations completed
Progress: 113 iterations completed
Progress: 114 iterations completed
Progress: 115 iterations completed
Progress: 116 iterations completed
Progress: 117 iterations completed
Progress: 118 iterations completed
Progress: 119 iterations completed
Progress: 120 iterations completed
Progress: 121 iterations completed
Progress: 122 iterations completed
Progress: 123 iterations completed
Progress: 124 iterations completed
Progress: 125 iterations completed
Progress: 126 iterations completed
Progress: 127 iterations completed
Progress: 128 iterations completed
Progress: 129 iterations completed
Progress: 130 iterations completed
Progress: 131 iterations completed
Progress: 132 iterations completed
Progress: 133 iterations completed
Progress: 134 iterations completed
Progress: 135 iterations completed
Progress: 136 iterations completed
Progress: 137 iterations completed
Progress: 138 iterations completed
Progress: 139 iterations completed
Progress: 140 iterations completed
Progress: 141 iterations completed
Progress: 142 iterations completed
Progress: 143 iterations completed
Progress: 144 iterations completed
Progress: 145 iterations completed
Progress: 146 iterations completed
Progress: 147 iterations completed
Progress: 148 iterations completed
Progress: 149 iterations completed
Progress: 150 iterations completed
Progress: 151 iterations completed
Progress: 152 iterations completed
Progress: 153 iterations completed
Progress: 154 iterations completed
Progress: 155 iterations completed
Progress: 156 iterations completed
Progress: 157 iterations completed
Progress: 158 iterations completed
Progress: 159 iterations completed
Progress: 160 iterations completed
Progress: 161 iterations completed
Progress: 162 iterations completed
Progress: 163 iterations completed
Progress: 164 iterations completed
Progress: 165 iterations completed
Progress: 166 iterations completed
Progress: 167 iterations completed
Progress: 168 iterations completed
Progress: 169 iterations completed
Progress: 170 iterations completed
Progress: 171 iterations completed
Progress: 172 iterations completed
Progress: 173 iterations completed
Progress: 174 iterations completed
Progress: 175 iterations completed
Progress: 176 iterations completed
Progress: 177 iterations completed
Progress: 178 iterations completed
Progress: 179 iterations completed
Progress: 180 iterations completed
Progress: 181 iterations completed
Progress: 182 iterations completed
Progress: 183 iterations completed
Progress: 184 iterations completed
Progress: 185 iterations completed
Progress: 186 iterations completed
Progress: 187 iterations completed
Progress: 188 iterations completed
Progress: 189 iterations completed
Progress: 190 iterations completed
Progress: 191 iterations completed
Progress: 192 iterations completed
Progress: 193 iterations completed
Progress: 194 iterations completed
Progress: 195 iterations completed
Progress: 196 iterations completed
Progress: 197 iterations completed
Progress: 198 iterations completed
Progress: 199 iterations completed
Progress: 200 iterations completed
Progress: 201 iterations completed
Progress: 202 iterations completed
Progress: 203 iterations completed
Progress: 204 iterations completed
Progress: 205 iterations completed
Progress: 206 iterations completed
Progress: 207 iterations completed
Progress: 208 iterations completed
Progress: 209 iterations completed
Progress: 210 iterations completed
Progress: 211 iterations completed
Progress: 212 iterations completed
Progress: 213 iterations completed
Progress: 214 iterations completed
Progress: 215 iterations completed
Progress: 216 iterations completed
Progress: 217 iterations completed
Progress: 218 iterations completed
Progress: 219 iterations completed
Progress: 220 iterations completed
Progress: 221 iterations completed
Progress: 222 iterations completed
Progress: 223 iterations completed
Progress: 224 iterations completed
Progress: 225 iterations completed
Progress: 226 iterations completed
Progress: 227 iterations completed
Progress: 228 iterations completed
Progress: 229 iterations completed
Progress: 230 iterations completed
Progress: 231 iterations completed
Progress: 232 iterations completed
Progress: 233 iterations completed
Progress: 234 iterations completed
Progress: 235 iterations completed
Progress: 236 iterations completed
Progress: 237 iterations completed
Progress: 238 iterations completed
Progress: 239 iterations completed
Progress: 240 iterations completed
Progress: 241 iterations completed
Progress: 242 iterations completed
Progress: 243 iterations completed
Progress: 244 iterations completed
Progress: 245 iterations completed
Progress: 246 iterations completed
Progress: 247 iterations completed
Progress: 248 iterations completed
Progress: 249 iterations completed
Progress: 250 iterations completed
Progress: 251 iterations completed
Progress: 252 iterations completed
Progress: 253 iterations completed
Progress: 254 iterations completed
Progress: 255 iterations completed
Progress: 256 iterations completed
Progress: 257 iterations completed
Progress: 258 iterations completed
Progress: 259 iterations completed
Progress: 260 iterations completed
Progress: 261 iterations completed
Progress: 262 iterations completed
Progress: 263 iterations completed
Progress: 264 iterations completed
Progress: 265 iterations completed
Progress: 266 iterations completed
Progress: 267 iterations completed
Progress: 268 iterations completed
Progress: 269 iterations completed
Progress: 270 iterations completed
Progress: 271 iterations completed
Progress: 272 iterations completed
Progress: 273 iterations completed
Progress: 274 iterations completed
Progress: 275 iterations completed
Progress: 276 iterations completed
Progress: 277 iterations completed
Progress: 278 iterations completed
Progress: 279 iterations completed
Progress: 280 iterations completed
Progress: 281 iterations completed
Progress: 282 iterations completed
Progress: 283 iterations completed
Progress: 284 iterations completed
Progress: 285 iterations completed
Progress: 286 iterations completed
Progress: 287 iterations completed
Progress: 288 iterations completed
Progress: 289 iterations completed
Progress: 290 iterations completed
Progress: 291 iterations completed
Progress: 292 iterations completed
Progress: 293 iterations completed
Progress: 294 iterations completed
Progress: 295 iterations completed
Progress: 296 iterations completed
Progress: 297 iterations completed
Progress: 298 iterations completed
Progress: 299 iterations completed
Progress: 300 iterations completed
Progress: 301 iterations completed
Progress: 302 iterations completed
Progress: 303 iterations completed
Progress: 304 iterations completed
Progress: 305 iterations completed
Progress: 306 iterations completed
Progress: 307 iterations completed
Progress: 308 iterations completed
Progress: 309 iterations completed
Progress: 310 iterations completed
Progress: 311 iterations completed
Progress: 312 iterations completed
Progress: 313 iterations completed
Progress: 314 iterations completed
Progress: 315 iterations completed
Progress: 316 iterations completed
Progress: 317 iterations completed
Progress: 318 iterations completed
Progress: 319 iterations completed
Progress: 320 iterations completed
Progress: 321 iterations completed
Progress: 322 iterations completed
Progress: 323 iterations completed
Progress: 324 iterations completed
Progress: 325 iterations completed
Progress: 326 iterations completed
Progress: 327 iterations completed
Progress: 328 iterations completed
Progress: 329 iterations completed
Progress: 330 iterations completed
Progress: 331 iterations completed
Progress: 332 iterations completed
Progress: 333 iterations completed
Progress: 334 iterations completed
Progress: 335 iterations completed
Progress: 336 iterations completed
Progress: 337 iterations completed
Progress: 338 iterations completed
Progress: 339 iterations completed
Progress: 340 iterations completed
Progress: 341 iterations completed
Progress: 342 iterations completed
Progress: 343 iterations completed
Progress: 344 iterations completed
Progress: 345 iterations completed
Progress: 346 iterations completed
Progress: 347 iterations completed
Progress: 348 iterations completed
Progress: 349 iterations completed
Progress: 350 iterations completed
Progress: 351 iterations completed
Progress: 352 iterations completed
Progress: 353 iterations completed
Progress: 354 iterations completed
Progress: 355 iterations completed
Progress: 356 iterations completed
Progress: 357 iterations completed
Progress: 358 iterations completed
Progress: 359 iterations completed
Progress: 360 iterations completed
Progress: 361 iterations completed
Progress: 362 iterations completed
Progress: 363 iterations completed
Progress: 364 iterations completed
Progress: 365 iterations completed
Progress: 366 iterations completed
Progress: 367 iterations completed
Progress: 368 iterations completed
Progress: 369 iterations completed
Progress: 370 iterations completed
Progress: 371 iterations completed
Progress: 372 iterations completed
Progress: 373 iterations completed
Progress: 374 iterations completed
Progress: 375 iterations completed
Progress: 376 iterations completed
Progress: 377 iterations completed
Progress: 378 iterations completed
Progress: 379 iterations completed
Progress: 380 iterations completed
Progress: 381 iterations completed
Progress: 382 iterations completed
Progress: 383 iterations completed
Progress: 384 iterations completed
Progress: 385 iterations completed
Progress: 386 iterations completed
Progress: 387 iterations completed
Progress: 388 iterations completed
Progress: 389 iterations completed
Progress: 390 iterations completed
Progress: 391 iterations completed
Progress: 392 iterations completed
Progress: 393 iterations completed
Progress: 394 iterations completed
Progress: 395 iterations completed
Progress: 396 iterations completed
Progress: 397 iterations completed
Progress: 398 iterations completed
Progress: 399 iterations completed
Progress: 400 iterations completed
Progress: 401 iterations completed
Progress: 402 iterations completed
Progress: 403 iterations completed
Progress: 404 iterations completed
Progress: 405 iterations completed
Progress: 406 iterations completed
Progress: 407 iterations completed
Progress: 408 iterations completed
Progress: 409 iterations completed
Progress: 410 iterations completed
Progress: 411 iterations completed
Progress: 412 iterations completed
Progress: 413 iterations completed
Progress: 414 iterations completed
Progress: 415 iterations completed
Progress: 416 iterations completed
Progress: 417 iterations completed
Progress: 418 iterations completed
Progress: 419 iterations completed
Progress: 420 iterations completed
Progress: 421 iterations completed
Progress: 422 iterations completed
Progress: 423 iterations completed
Progress: 424 iterations completed
Progress: 425 iterations completed
Progress: 426 iterations completed
Progress: 427 iterations completed
Progress: 428 iterations completed
Progress: 429 iterations completed
Progress: 430 iterations completed
Progress: 431 iterations completed
Progress: 432 iterations completed
Progress: 433 iterations completed
Progress: 434 iterations completed
Progress: 435 iterations completed
Progress: 436 iterations completed
Progress: 437 iterations completed
Progress: 438 iterations completed
Progress: 439 iterations completed
Progress: 440 iterations completed
Progress: 441 iterations completed
Progress: 442 iterations completed
Progress: 443 iterations completed
Progress: 444 iterations completed
Progress: 445 iterations completed
Progress: 446 iterations completed
Progress: 447 iterations completed
Progress: 448 iterations completed
Progress: 449 iterations completed
Progress: 450 iterations completed
Progress: 451 iterations completed
Progress: 452 iterations completed
Progress: 453 iterations completed
Progress: 454 iterations completed
Progress: 455 iterations completed
Progress: 456 iterations completed
Progress: 457 iterations completed
Progress: 458 iterations completed
Progress: 459 iterations completed
Progress: 460 iterations completed
Progress: 461 iterations completed
Progress: 462 iterations completed
Progress: 463 iterations completed
Progress: 464 iterations completed
Progress: 465 iterations completed
Progress: 466 iterations completed
Progress: 467 iterations completed
Progress: 468 iterations completed
Progress: 469 iterations completed
Progress: 470 iterations completed
Progress: 471 iterations completed
Progress: 472 iterations completed
Progress: 473 iterations completed
Progress: 474 iterations completed
Progress: 475 iterations completed
Progress: 476 iterations completed
Progress: 477 iterations completed
Progress: 478 iterations completed
Progress: 479 iterations completed
Progress: 480 iterations completed
Progress: 481 iterations completed
Progress: 482 iterations completed
Progress: 483 iterations completed
Progress: 484 iterations completed
Progress: 485 iterations completed
Progress: 486 iterations completed
Progress: 487 iterations completed
Progress: 488 iterations completed
Progress: 489 iterations completed
Progress: 490 iterations completed
Progress: 491 iterations completed
Progress: 492 iterations completed
Progress: 493 iterations completed
Progress: 494 iterations completed
Progress: 495 iterations completed
Progress: 496 iterations completed
Progress: 497 iterations completed
Progress: 498 iterations completed
Progress: 499 iterations completed
Progress: 500 iterations completed
Progress: 501 iterations completed
Progress: 502 iterations completed
Progress: 503 iterations completed
Progress: 504 iterations completed
Progress: 505 iterations completed
Progress: 506 iterations completed
Progress: 507 iterations completed
Progress: 508 iterations completed
Progress: 509 iterations completed
Progress: 510 iterations completed
Progress: 511 iterations completed
Progress: 512 iterations completed
Progress: 513 iterations completed
Progress: 514 iterations completed
Progress: 515 iterations completed
Progress: 516 iterations completed
Progress: 517 iterations completed
Progress: 518 iterations completed
Progress: 519 iterations completed
Progress: 520 iterations completed
Progress: 521 iterations completed
Progress: 522 iterations completed
Progress: 523 iterations completed
Progress: 524 iterations completed
Progress: 525 iterations completed
Progress: 526 iterations completed
Progress: 527 iterations completed
Progress: 528 iterations completed
Progress: 529 iterations completed
Progress: 530 iterations completed
Progress: 531 iterations completed
Progress: 532 iterations completed
Progress: 533 iterations completed
Progress: 534 iterations completed
Progress: 535 iterations completed
Progress: 536 iterations completed
Progress: 537 iterations completed
Progress: 538 iterations completed
Progress: 539 iterations completed
Progress: 540 iterations completed
Progress: 541 iterations completed
Progress: 542 iterations completed
Progress: 543 iterations completed
Progress: 544 iterations completed
Progress: 545 iterations completed
Progress: 546 iterations completed
Progress: 547 iterations completed
Progress: 548 iterations completed
Progress: 549 iterations completed
Progress: 550 iterations completed
Progress: 551 iterations completed
Progress: 552 iterations completed
Progress: 553 iterations completed
Progress: 554 iterations completed
Progress: 555 iterations completed
Progress: 556 iterations completed
Progress: 557 iterations completed
Progress: 558 iterations completed
Progress: 559 iterations completed
Progress: 560 iterations completed
Progress: 561 iterations completed
Progress: 562 iterations completed
Progress: 563 iterations completed
Progress: 564 iterations completed
Progress: 565 iterations completed
Progress: 566 iterations completed
Progress: 567 iterations completed
Progress: 568 iterations completed
Progress: 569 iterations completed
Progress: 570 iterations completed
Progress: 571 iterations completed
Progress: 572 iterations completed
Progress: 573 iterations completed
Progress: 574 iterations completed
Progress: 575 iterations completed
Progress: 576 iterations completed
Progress: 577 iterations completed
Progress: 578 iterations completed
Progress: 579 iterations completed
Progress: 580 iterations completed
Progress: 581 iterations completed
Progress: 582 iterations completed
Progress: 583 iterations completed
Progress: 584 iterations completed
Progress: 585 iterations completed
Progress: 586 iterations completed
Progress: 587 iterations completed
Progress: 588 iterations completed
Progress: 589 iterations completed
Progress: 590 iterations completed
Progress: 591 iterations completed
Progress: 592 iterations completed
Progress: 593 iterations completed
Progress: 594 iterations completed
Progress: 595 iterations completed
Progress: 596 iterations completed
Progress: 597 iterations completed
Progress: 598 iterations completed
Progress: 599 iterations completed
Progress: 600 iterations completed
Progress: 601 iterations completed
Progress: 602 iterations completed
Progress: 603 iterations completed
Progress: 604 iterations completed
Progress: 605 iterations completed
Progress: 606 iterations completed
Progress: 607 iterations completed
Progress: 608 iterations completed
Progress: 609 iterations completed
Progress: 610 iterations completed
Progress: 611 iterations completed
Progress: 612 iterations completed
Progress: 613 iterations completed
Progress: 614 iterations completed
Progress: 615 iterations completed
Progress: 616 iterations completed
Progress: 617 iterations completed
Progress: 618 iterations completed
Progress: 619 iterations completed
Progress: 620 iterations completed
Progress: 621 iterations completed
Progress: 622 iterations completed
Progress: 623 iterations completed
Progress: 624 iterations completed
Progress: 625 iterations completed
Progress: 626 iterations completed
Progress: 627 iterations completed
Progress: 628 iterations completed
Progress: 629 iterations completed
Progress: 630 iterations completed
Progress: 631 iterations completed
Progress: 632 iterations completed
Progress: 633 iterations completed
Progress: 634 iterations completed
Progress: 635 iterations completed
Progress: 636 iterations completed
Progress: 637 iterations completed
Progress: 638 iterations completed
Progress: 639 iterations completed
Progress: 640 iterations completed
Progress: 641 iterations completed
Progress: 642 iterations completed
Progress: 643 iterations completed
Progress: 644 iterations completed
Progress: 645 iterations completed
Progress: 646 iterations completed
Progress: 647 iterations completed
Progress: 648 iterations completed
Progress: 649 iterations completed
Progress: 650 iterations completed
Progress: 651 iterations completed
Progress: 652 iterations completed
Progress: 653 iterations completed
Progress: 654 iterations completed
Progress: 655 iterations completed
Progress: 656 iterations completed
Progress: 657 iterations completed
Progress: 658 iterations completed
Progress: 659 iterations completed
Progress: 660 iterations completed
Progress: 661 iterations completed
Progress: 662 iterations completed
Progress: 663 iterations completed
Progress: 664 iterations completed
Progress: 665 iterations completed
Progress: 666 iterations completed
Progress: 667 iterations completed
Progress: 668 iterations completed
Progress: 669 iterations completed
Progress: 670 iterations completed
Progress: 671 iterations completed
Progress: 672 iterations completed
Progress: 673 iterations completed
Progress: 674 iterations completed
Progress: 675 iterations completed
Progress: 676 iterations completed
Progress: 677 iterations completed
Progress: 678 iterations completed
Progress: 679 iterations completed
Progress: 680 iterations completed
Progress: 681 iterations completed
Progress: 682 iterations completed
Progress: 683 iterations completed
Progress: 684 iterations completed
Progress: 685 iterations completed
Progress: 686 iterations completed
Progress: 687 iterations completed
Progress: 688 iterations completed
Progress: 689 iterations completed
Progress: 690 iterations completed
Progress: 691 iterations completed
Progress: 692 iterations completed
Progress: 693 iterations completed
Progress: 694 iterations completed
Progress: 695 iterations completed
Progress: 696 iterations completed
Progress: 697 iterations completed
Progress: 698 iterations completed
Progress: 699 iterations completed
Progress: 700 iterations completed
Progress: 701 iterations completed
Progress: 702 iterations completed
Progress: 703 iterations completed
Progress: 704 iterations completed
Progress: 705 iterations completed
Progress: 706 iterations completed
Progress: 707 iterations completed
Progress: 708 iterations completed
Progress: 709 iterations completed
Progress: 710 iterations completed
Progress: 711 iterations completed
Progress: 712 iterations completed
Progress: 713 iterations completed
Progress: 714 iterations completed
Progress: 715 iterations completed
Progress: 716 iterations completed
Progress: 717 iterations completed
Progress: 718 iterations completed
Progress: 719 iterations completed
Progress: 720 iterations completed
Progress: 721 iterations completed
Progress: 722 iterations completed
Progress: 723 iterations completed
Progress: 724 iterations completed
Progress: 725 iterations completed
Progress: 726 iterations completed
Progress: 727 iterations completed
Progress: 728 iterations completed
Progress: 729 iterations completed
Progress: 730 iterations completed
Progress: 731 iterations completed
Progress: 732 iterations completed
Progress: 733 iterations completed
Progress: 734 iterations completed
Progress: 735 iterations completed
Progress: 736 iterations completed
Progress: 737 iterations completed
Progress: 738 iterations completed
Progress: 739 iterations completed
Progress: 740 iterations completed
Progress: 741 iterations completed
Progress: 742 iterations completed
Progress: 743 iterations completed
Progress: 744 iterations completed
Progress: 745 iterations completed
Progress: 746 iterations completed
Progress: 747 iterations completed
Progress: 748 iterations completed
Progress: 749 iterations completed
Progress: 750 iterations completed
Progress: 751 iterations completed
Progress: 752 iterations completed
Progress: 753 iterations completed
Progress: 754 iterations completed
Progress: 755 iterations completed
Progress: 756 iterations completed
Progress: 757 iterations completed
Progress: 758 iterations completed
Progress: 759 iterations completed
Progress: 760 iterations completed
Progress: 761 iterations completed
Progress: 762 iterations completed
Progress: 763 iterations completed
Progress: 764 iterations completed
Progress: 765 iterations completed
Progress: 766 iterations completed
Progress: 767 iterations completed
Progress: 768 iterations completed
Progress: 769 iterations completed
Progress: 770 iterations completed
Progress: 771 iterations completed
Progress: 772 iterations completed
Progress: 773 iterations completed
Progress: 774 iterations completed
Progress: 775 iterations completed
Progress: 776 iterations completed
Progress: 777 iterations completed
Progress: 778 iterations completed
Progress: 779 iterations completed
Progress: 780 iterations completed
Progress: 781 iterations completed
Progress: 782 iterations completed
Progress: 783 iterations completed
Progress: 784 iterations completed
Progress: 785 iterations completed
Progress: 786 iterations completed
Progress: 787 iterations completed
Progress: 788 iterations completed
Progress: 789 iterations completed
Progress: 790 iterations completed
Progress: 791 iterations completed
Progress: 792 iterations completed
Progress: 793 iterations completed
Progress: 794 iterations completed
Progress: 795 iterations completed
Progress: 796 iterations completed
Progress: 797 iterations completed
Progress: 798 iterations completed
Progress: 799 iterations completed
Progress: 800 iterations completed
Progress: 801 iterations completed
Progress: 802 iterations completed
Progress: 803 iterations completed
Progress: 804 iterations completed
Progress: 805 iterations completed
Progress: 806 iterations completed
Progress: 807 iterations completed
Progress: 808 iterations completed
Progress: 809 iterations completed
Progress: 810 iterations completed
Progress: 811 iterations completed
Progress: 812 iterations completed
Progress: 813 iterations completed
Progress: 814 iterations completed
Progress: 815 iterations completed
Progress: 816 iterations completed
Progress: 817 iterations completed
Progress: 818 iterations completed
Progress: 819 iterations completed
Progress: 820 iterations completed
Progress: 821 iterations completed
Progress: 822 iterations completed
Progress: 823 iterations completed
Progress: 824 iterations completed
Progress: 825 iterations completed
Progress: 826 iterations completed
Progress: 827 iterations completed
Progress: 828 iterations completed
Progress: 829 iterations completed
Progress: 830 iterations completed
Progress: 831 iterations completed
Progress: 832 iterations completed
Progress: 833 iterations completed
Progress: 834 iterations completed
Progress: 835 iterations completed
Progress: 836 iterations completed
Progress: 837 iterations completed
Progress: 838 iterations completed
Progress: 839 iterations completed
Progress: 840 iterations completed
Progress: 841 iterations completed
Progress: 842 iterations completed
Progress: 843 iterations completed
Progress: 844 iterations completed
Progress: 845 iterations completed
Progress: 846 iterations completed
Progress: 847 iterations completed
Progress: 848 iterations completed
Progress: 849 iterations completed
Progress: 850 iterations completed
Progress: 851 iterations completed
Progress: 852 iterations completed
Progress: 853 iterations completed
Progress: 854 iterations completed
Progress: 855 iterations completed
Progress: 856 iterations completed
Progress: 857 iterations completed
Progress: 858 iterations completed
Progress: 859 iterations completed
Progress: 860 iterations completed
Progress: 861 iterations completed
Progress: 862 iterations completed
Progress: 863 iterations completed
Progress: 864 iterations completed
Progress: 865 iterations completed
Progress: 866 iterations completed
Progress: 867 iterations completed
Progress: 868 iterations completed
Progress: 869 iterations completed
Progress: 870 iterations completed
Progress: 871 iterations completed
Progress: 872 iterations completed
Progress: 873 iterations completed
Progress: 874 iterations completed
Progress: 875 iterations completed
Progress: 876 iterations completed
Progress: 877 iterations completed
Progress: 878 iterations completed
Progress: 879 iterations completed
Progress: 880 iterations completed
Progress: 881 iterations completed
Progress: 882 iterations completed
Progress: 883 iterations completed
Progress: 884 iterations completed
Progress: 885 iterations completed
Progress: 886 iterations completed
Progress: 887 iterations completed
Progress: 888 iterations completed
Progress: 889 iterations completed
Progress: 890 iterations completed
Progress: 891 iterations completed
Progress: 892 iterations completed
Progress: 893 iterations completed
Progress: 894 iterations completed
Progress: 895 iterations completed
Progress: 896 iterations completed
Progress: 897 iterations completed
Progress: 898 iterations completed
Progress: 899 iterations completed
Progress: 900 iterations completed
Progress: 901 iterations completed
Progress: 902 iterations completed
Progress: 903 iterations completed
Progress: 904 iterations completed
Progress: 905 iterations completed
Progress: 906 iterations completed
Progress: 907 iterations completed
Progress: 908 iterations completed
Progress: 909 iterations completed
Progress: 910 iterations completed
Progress: 911 iterations completed
Progress: 912 iterations completed
Progress: 913 iterations completed
Progress: 914 iterations completed
Progress: 915 iterations completed
Progress: 916 iterations completed
Progress: 917 iterations completed
Progress: 918 iterations completed
Progress: 919 iterations completed
Progress: 920 iterations completed
Progress: 921 iterations completed
Progress: 922 iterations completed
Progress: 923 iterations completed
Progress: 924 iterations completed
Progress: 925 iterations completed
Progress: 926 iterations completed
Progress: 927 iterations completed
Progress: 928 iterations completed
Progress: 929 iterations completed
Progress: 930 iterations completed
Progress: 931 iterations completed
Progress: 932 iterations completed
Progress: 933 iterations completed
Progress: 934 iterations completed
Progress: 935 iterations completed
Progress: 936 iterations completed
Progress: 937 iterations completed
Progress: 938 iterations completed
Progress: 939 iterations completed
Progress: 940 iterations completed
Progress: 941 iterations completed
Progress: 942 iterations completed
Progress: 943 iterations completed
Progress: 944 iterations completed
Progress: 945 iterations completed
Progress: 946 iterations completed
Progress: 947 iterations completed
Progress: 948 iterations completed
Progress: 949 iterations completed
Progress: 950 iterations completed
Progress: 951 iterations completed
Progress: 952 iterations completed
Progress: 953 iterations completed
Progress: 954 iterations completed
Progress: 955 iterations completed
Progress: 956 iterations completed
Progress: 957 iterations completed
Progress: 958 iterations completed
Progress: 959 iterations completed
Progress: 960 iterations completed
Progress: 961 iterations completed
Progress: 962 iterations completed
Progress: 963 iterations completed
Progress: 964 iterations completed
Progress: 965 iterations completed
Progress: 966 iterations completed
Progress: 967 iterations completed
Progress: 968 iterations completed
Progress: 969 iterations completed
Progress: 970 iterations completed
Progress: 971 iterations completed
Progress: 972 iterations completed
Progress: 973 iterations completed
Progress: 974 iterations completed
Progress: 975 iterations completed
Progress: 976 iterations completed
Progress: 977 iterations completed
Progress: 978 iterations completed
Progress: 979 iterations completed
Progress: 980 iterations completed
Progress: 981 iterations completed
Progress: 982 iterations completed
Progress: 983 iterations completed
Progress: 984 iterations completed
Progress: 985 iterations completed
Progress: 986 iterations completed
Progress: 987 iterations completed
Progress: 988 iterations completed
Progress: 989 iterations completed
Progress: 990 iterations completed
Progress: 991 iterations completed
Progress: 992 iterations completed
Progress: 993 iterations completed
Progress: 994 iterations completed
Progress: 995 iterations completed
Progress: 996 iterations completed
Progress: 997 iterations completed
Progress: 998 iterations completed
Progress: 999 iterations completed
Progress: 1000 iterations completed</code></pre>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="what_is_stacked_ensambled.html#cb458-1" tabindex="-1"></a><span class="co"># Calculate mean RMSPE for the ensemble with KNN</span></span>
<span id="cb458-2"><a href="what_is_stacked_ensambled.html#cb458-2" tabindex="-1"></a>mean_rmspe_ensemble_knn <span class="ot">&lt;-</span> <span class="fu">mean</span>(rmspe_ensemble_knn)</span>
<span id="cb458-3"><a href="what_is_stacked_ensambled.html#cb458-3" tabindex="-1"></a></span>
<span id="cb458-4"><a href="what_is_stacked_ensambled.html#cb458-4" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb458-5"><a href="what_is_stacked_ensambled.html#cb458-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Mean RMSPE of Stacked Ensemble with Tuned KNN Model:&quot;</span>, mean_rmspe_ensemble_knn))</span></code></pre></div>
<pre><code>## [1] &quot;Mean RMSPE of Stacked Ensemble with Tuned KNN Model: 0.33117728762542&quot;</code></pre>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="what_is_stacked_ensambled.html#cb460-1" tabindex="-1"></a><span class="co"># Initialize storage for the sum of correlation matrices</span></span>
<span id="cb460-2"><a href="what_is_stacked_ensambled.html#cb460-2" tabindex="-1"></a>cor_matrix_sum <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">4</span>)  <span class="co"># Assuming 4 base models</span></span>
<span id="cb460-3"><a href="what_is_stacked_ensambled.html#cb460-3" tabindex="-1"></a></span>
<span id="cb460-4"><a href="what_is_stacked_ensambled.html#cb460-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb460-5"><a href="what_is_stacked_ensambled.html#cb460-5" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\r</span><span class="st">Progress:&quot;</span>, i, <span class="st">&quot;iterations completed&quot;</span>)</span>
<span id="cb460-6"><a href="what_is_stacked_ensambled.html#cb460-6" tabindex="-1"></a>  </span>
<span id="cb460-7"><a href="what_is_stacked_ensambled.html#cb460-7" tabindex="-1"></a>  <span class="co"># Bootstrapping</span></span>
<span id="cb460-8"><a href="what_is_stacked_ensambled.html#cb460-8" tabindex="-1"></a>  train_index <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb460-9"><a href="what_is_stacked_ensambled.html#cb460-9" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> data[train_index, ]</span>
<span id="cb460-10"><a href="what_is_stacked_ensambled.html#cb460-10" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> data[<span class="sc">-</span>train_index, ]</span>
<span id="cb460-11"><a href="what_is_stacked_ensambled.html#cb460-11" tabindex="-1"></a>  </span>
<span id="cb460-12"><a href="what_is_stacked_ensambled.html#cb460-12" tabindex="-1"></a>  <span class="co"># Re-train the original models on bootstrapped training data</span></span>
<span id="cb460-13"><a href="what_is_stacked_ensambled.html#cb460-13" tabindex="-1"></a>  lm_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb460-14"><a href="what_is_stacked_ensambled.html#cb460-14" tabindex="-1"></a>  rf_mod <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb460-15"><a href="what_is_stacked_ensambled.html#cb460-15" tabindex="-1"></a>  tuned_gbm_mod <span class="ot">&lt;-</span> <span class="fu">gbm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb460-16"><a href="what_is_stacked_ensambled.html#cb460-16" tabindex="-1"></a>                       <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees, </span>
<span id="cb460-17"><a href="what_is_stacked_ensambled.html#cb460-17" tabindex="-1"></a>                       <span class="at">shrinkage =</span> best_params<span class="sc">$</span>shrinkage, </span>
<span id="cb460-18"><a href="what_is_stacked_ensambled.html#cb460-18" tabindex="-1"></a>                       <span class="at">interaction.depth =</span> best_params<span class="sc">$</span>interaction.depth, </span>
<span id="cb460-19"><a href="what_is_stacked_ensambled.html#cb460-19" tabindex="-1"></a>                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb460-20"><a href="what_is_stacked_ensambled.html#cb460-20" tabindex="-1"></a>  </span>
<span id="cb460-21"><a href="what_is_stacked_ensambled.html#cb460-21" tabindex="-1"></a>  <span class="co"># Train the KNN model with the best k</span></span>
<span id="cb460-22"><a href="what_is_stacked_ensambled.html#cb460-22" tabindex="-1"></a>  knn_mod <span class="ot">&lt;-</span> <span class="fu">knnreg</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">k =</span> best_k)</span>
<span id="cb460-23"><a href="what_is_stacked_ensambled.html#cb460-23" tabindex="-1"></a>  </span>
<span id="cb460-24"><a href="what_is_stacked_ensambled.html#cb460-24" tabindex="-1"></a>  <span class="co"># Generate predictions on the bootstrapped test set</span></span>
<span id="cb460-25"><a href="what_is_stacked_ensambled.html#cb460-25" tabindex="-1"></a>  lm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_mod, test_data)</span>
<span id="cb460-26"><a href="what_is_stacked_ensambled.html#cb460-26" tabindex="-1"></a>  rf_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_mod, test_data)</span>
<span id="cb460-27"><a href="what_is_stacked_ensambled.html#cb460-27" tabindex="-1"></a>  tuned_gbm_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(tuned_gbm_mod, test_data, <span class="at">n.trees =</span> best_params<span class="sc">$</span>n.trees)</span>
<span id="cb460-28"><a href="what_is_stacked_ensambled.html#cb460-28" tabindex="-1"></a>knn_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_mod, test_data)</span>
<span id="cb460-29"><a href="what_is_stacked_ensambled.html#cb460-29" tabindex="-1"></a>  <span class="co"># Combine predictions into a data frame</span></span>
<span id="cb460-30"><a href="what_is_stacked_ensambled.html#cb460-30" tabindex="-1"></a>  preds_four <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lm_pred, rf_pred, tuned_gbm_pred, knn_pred)</span>
<span id="cb460-31"><a href="what_is_stacked_ensambled.html#cb460-31" tabindex="-1"></a>  </span>
<span id="cb460-32"><a href="what_is_stacked_ensambled.html#cb460-32" tabindex="-1"></a>  <span class="co"># Calculate the correlation matrix for the current iteration</span></span>
<span id="cb460-33"><a href="what_is_stacked_ensambled.html#cb460-33" tabindex="-1"></a>  cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(preds_four)</span>
<span id="cb460-34"><a href="what_is_stacked_ensambled.html#cb460-34" tabindex="-1"></a>  </span>
<span id="cb460-35"><a href="what_is_stacked_ensambled.html#cb460-35" tabindex="-1"></a>  <span class="co"># Accumulate the correlation matrix</span></span>
<span id="cb460-36"><a href="what_is_stacked_ensambled.html#cb460-36" tabindex="-1"></a>  cor_matrix_sum <span class="ot">&lt;-</span> cor_matrix_sum <span class="sc">+</span> cor_matrix</span>
<span id="cb460-37"><a href="what_is_stacked_ensambled.html#cb460-37" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
Progress: 1 iterations completed
Progress: 2 iterations completed
Progress: 3 iterations completed
Progress: 4 iterations completed
Progress: 5 iterations completed
Progress: 6 iterations completed
Progress: 7 iterations completed
Progress: 8 iterations completed
Progress: 9 iterations completed
Progress: 10 iterations completed
Progress: 11 iterations completed
Progress: 12 iterations completed
Progress: 13 iterations completed
Progress: 14 iterations completed
Progress: 15 iterations completed
Progress: 16 iterations completed
Progress: 17 iterations completed
Progress: 18 iterations completed
Progress: 19 iterations completed
Progress: 20 iterations completed
Progress: 21 iterations completed
Progress: 22 iterations completed
Progress: 23 iterations completed
Progress: 24 iterations completed
Progress: 25 iterations completed
Progress: 26 iterations completed
Progress: 27 iterations completed
Progress: 28 iterations completed
Progress: 29 iterations completed
Progress: 30 iterations completed
Progress: 31 iterations completed
Progress: 32 iterations completed
Progress: 33 iterations completed
Progress: 34 iterations completed
Progress: 35 iterations completed
Progress: 36 iterations completed
Progress: 37 iterations completed
Progress: 38 iterations completed
Progress: 39 iterations completed
Progress: 40 iterations completed
Progress: 41 iterations completed
Progress: 42 iterations completed
Progress: 43 iterations completed
Progress: 44 iterations completed
Progress: 45 iterations completed
Progress: 46 iterations completed
Progress: 47 iterations completed
Progress: 48 iterations completed
Progress: 49 iterations completed
Progress: 50 iterations completed
Progress: 51 iterations completed
Progress: 52 iterations completed
Progress: 53 iterations completed
Progress: 54 iterations completed
Progress: 55 iterations completed
Progress: 56 iterations completed
Progress: 57 iterations completed
Progress: 58 iterations completed
Progress: 59 iterations completed
Progress: 60 iterations completed
Progress: 61 iterations completed
Progress: 62 iterations completed
Progress: 63 iterations completed
Progress: 64 iterations completed
Progress: 65 iterations completed
Progress: 66 iterations completed
Progress: 67 iterations completed
Progress: 68 iterations completed
Progress: 69 iterations completed
Progress: 70 iterations completed
Progress: 71 iterations completed
Progress: 72 iterations completed
Progress: 73 iterations completed
Progress: 74 iterations completed
Progress: 75 iterations completed
Progress: 76 iterations completed
Progress: 77 iterations completed
Progress: 78 iterations completed
Progress: 79 iterations completed
Progress: 80 iterations completed
Progress: 81 iterations completed
Progress: 82 iterations completed
Progress: 83 iterations completed
Progress: 84 iterations completed
Progress: 85 iterations completed
Progress: 86 iterations completed
Progress: 87 iterations completed
Progress: 88 iterations completed
Progress: 89 iterations completed
Progress: 90 iterations completed
Progress: 91 iterations completed
Progress: 92 iterations completed
Progress: 93 iterations completed
Progress: 94 iterations completed
Progress: 95 iterations completed
Progress: 96 iterations completed
Progress: 97 iterations completed
Progress: 98 iterations completed
Progress: 99 iterations completed
Progress: 100 iterations completed
Progress: 101 iterations completed
Progress: 102 iterations completed
Progress: 103 iterations completed
Progress: 104 iterations completed
Progress: 105 iterations completed
Progress: 106 iterations completed
Progress: 107 iterations completed
Progress: 108 iterations completed
Progress: 109 iterations completed
Progress: 110 iterations completed
Progress: 111 iterations completed
Progress: 112 iterations completed
Progress: 113 iterations completed
Progress: 114 iterations completed
Progress: 115 iterations completed
Progress: 116 iterations completed
Progress: 117 iterations completed
Progress: 118 iterations completed
Progress: 119 iterations completed
Progress: 120 iterations completed
Progress: 121 iterations completed
Progress: 122 iterations completed
Progress: 123 iterations completed
Progress: 124 iterations completed
Progress: 125 iterations completed
Progress: 126 iterations completed
Progress: 127 iterations completed
Progress: 128 iterations completed
Progress: 129 iterations completed
Progress: 130 iterations completed
Progress: 131 iterations completed
Progress: 132 iterations completed
Progress: 133 iterations completed
Progress: 134 iterations completed
Progress: 135 iterations completed
Progress: 136 iterations completed
Progress: 137 iterations completed
Progress: 138 iterations completed
Progress: 139 iterations completed
Progress: 140 iterations completed
Progress: 141 iterations completed
Progress: 142 iterations completed
Progress: 143 iterations completed
Progress: 144 iterations completed
Progress: 145 iterations completed
Progress: 146 iterations completed
Progress: 147 iterations completed
Progress: 148 iterations completed
Progress: 149 iterations completed
Progress: 150 iterations completed
Progress: 151 iterations completed
Progress: 152 iterations completed
Progress: 153 iterations completed
Progress: 154 iterations completed
Progress: 155 iterations completed
Progress: 156 iterations completed
Progress: 157 iterations completed
Progress: 158 iterations completed
Progress: 159 iterations completed
Progress: 160 iterations completed
Progress: 161 iterations completed
Progress: 162 iterations completed
Progress: 163 iterations completed
Progress: 164 iterations completed
Progress: 165 iterations completed
Progress: 166 iterations completed
Progress: 167 iterations completed
Progress: 168 iterations completed
Progress: 169 iterations completed
Progress: 170 iterations completed
Progress: 171 iterations completed
Progress: 172 iterations completed
Progress: 173 iterations completed
Progress: 174 iterations completed
Progress: 175 iterations completed
Progress: 176 iterations completed
Progress: 177 iterations completed
Progress: 178 iterations completed
Progress: 179 iterations completed
Progress: 180 iterations completed
Progress: 181 iterations completed
Progress: 182 iterations completed
Progress: 183 iterations completed
Progress: 184 iterations completed
Progress: 185 iterations completed
Progress: 186 iterations completed
Progress: 187 iterations completed
Progress: 188 iterations completed
Progress: 189 iterations completed
Progress: 190 iterations completed
Progress: 191 iterations completed
Progress: 192 iterations completed
Progress: 193 iterations completed
Progress: 194 iterations completed
Progress: 195 iterations completed
Progress: 196 iterations completed
Progress: 197 iterations completed
Progress: 198 iterations completed
Progress: 199 iterations completed
Progress: 200 iterations completed
Progress: 201 iterations completed
Progress: 202 iterations completed
Progress: 203 iterations completed
Progress: 204 iterations completed
Progress: 205 iterations completed
Progress: 206 iterations completed
Progress: 207 iterations completed
Progress: 208 iterations completed
Progress: 209 iterations completed
Progress: 210 iterations completed
Progress: 211 iterations completed
Progress: 212 iterations completed
Progress: 213 iterations completed
Progress: 214 iterations completed
Progress: 215 iterations completed
Progress: 216 iterations completed
Progress: 217 iterations completed
Progress: 218 iterations completed
Progress: 219 iterations completed
Progress: 220 iterations completed
Progress: 221 iterations completed
Progress: 222 iterations completed
Progress: 223 iterations completed
Progress: 224 iterations completed
Progress: 225 iterations completed
Progress: 226 iterations completed
Progress: 227 iterations completed
Progress: 228 iterations completed
Progress: 229 iterations completed
Progress: 230 iterations completed
Progress: 231 iterations completed
Progress: 232 iterations completed
Progress: 233 iterations completed
Progress: 234 iterations completed
Progress: 235 iterations completed
Progress: 236 iterations completed
Progress: 237 iterations completed
Progress: 238 iterations completed
Progress: 239 iterations completed
Progress: 240 iterations completed
Progress: 241 iterations completed
Progress: 242 iterations completed
Progress: 243 iterations completed
Progress: 244 iterations completed
Progress: 245 iterations completed
Progress: 246 iterations completed
Progress: 247 iterations completed
Progress: 248 iterations completed
Progress: 249 iterations completed
Progress: 250 iterations completed
Progress: 251 iterations completed
Progress: 252 iterations completed
Progress: 253 iterations completed
Progress: 254 iterations completed
Progress: 255 iterations completed
Progress: 256 iterations completed
Progress: 257 iterations completed
Progress: 258 iterations completed
Progress: 259 iterations completed
Progress: 260 iterations completed
Progress: 261 iterations completed
Progress: 262 iterations completed
Progress: 263 iterations completed
Progress: 264 iterations completed
Progress: 265 iterations completed
Progress: 266 iterations completed
Progress: 267 iterations completed
Progress: 268 iterations completed
Progress: 269 iterations completed
Progress: 270 iterations completed
Progress: 271 iterations completed
Progress: 272 iterations completed
Progress: 273 iterations completed
Progress: 274 iterations completed
Progress: 275 iterations completed
Progress: 276 iterations completed
Progress: 277 iterations completed
Progress: 278 iterations completed
Progress: 279 iterations completed
Progress: 280 iterations completed
Progress: 281 iterations completed
Progress: 282 iterations completed
Progress: 283 iterations completed
Progress: 284 iterations completed
Progress: 285 iterations completed
Progress: 286 iterations completed
Progress: 287 iterations completed
Progress: 288 iterations completed
Progress: 289 iterations completed
Progress: 290 iterations completed
Progress: 291 iterations completed
Progress: 292 iterations completed
Progress: 293 iterations completed
Progress: 294 iterations completed
Progress: 295 iterations completed
Progress: 296 iterations completed
Progress: 297 iterations completed
Progress: 298 iterations completed
Progress: 299 iterations completed
Progress: 300 iterations completed
Progress: 301 iterations completed
Progress: 302 iterations completed
Progress: 303 iterations completed
Progress: 304 iterations completed
Progress: 305 iterations completed
Progress: 306 iterations completed
Progress: 307 iterations completed
Progress: 308 iterations completed
Progress: 309 iterations completed
Progress: 310 iterations completed
Progress: 311 iterations completed
Progress: 312 iterations completed
Progress: 313 iterations completed
Progress: 314 iterations completed
Progress: 315 iterations completed
Progress: 316 iterations completed
Progress: 317 iterations completed
Progress: 318 iterations completed
Progress: 319 iterations completed
Progress: 320 iterations completed
Progress: 321 iterations completed
Progress: 322 iterations completed
Progress: 323 iterations completed
Progress: 324 iterations completed
Progress: 325 iterations completed
Progress: 326 iterations completed
Progress: 327 iterations completed
Progress: 328 iterations completed
Progress: 329 iterations completed
Progress: 330 iterations completed
Progress: 331 iterations completed
Progress: 332 iterations completed
Progress: 333 iterations completed
Progress: 334 iterations completed
Progress: 335 iterations completed
Progress: 336 iterations completed
Progress: 337 iterations completed
Progress: 338 iterations completed
Progress: 339 iterations completed
Progress: 340 iterations completed
Progress: 341 iterations completed
Progress: 342 iterations completed
Progress: 343 iterations completed
Progress: 344 iterations completed
Progress: 345 iterations completed
Progress: 346 iterations completed
Progress: 347 iterations completed
Progress: 348 iterations completed
Progress: 349 iterations completed
Progress: 350 iterations completed
Progress: 351 iterations completed
Progress: 352 iterations completed
Progress: 353 iterations completed
Progress: 354 iterations completed
Progress: 355 iterations completed
Progress: 356 iterations completed
Progress: 357 iterations completed
Progress: 358 iterations completed
Progress: 359 iterations completed
Progress: 360 iterations completed
Progress: 361 iterations completed
Progress: 362 iterations completed
Progress: 363 iterations completed
Progress: 364 iterations completed
Progress: 365 iterations completed
Progress: 366 iterations completed
Progress: 367 iterations completed
Progress: 368 iterations completed
Progress: 369 iterations completed
Progress: 370 iterations completed
Progress: 371 iterations completed
Progress: 372 iterations completed
Progress: 373 iterations completed
Progress: 374 iterations completed
Progress: 375 iterations completed
Progress: 376 iterations completed
Progress: 377 iterations completed
Progress: 378 iterations completed
Progress: 379 iterations completed
Progress: 380 iterations completed
Progress: 381 iterations completed
Progress: 382 iterations completed
Progress: 383 iterations completed
Progress: 384 iterations completed
Progress: 385 iterations completed
Progress: 386 iterations completed
Progress: 387 iterations completed
Progress: 388 iterations completed
Progress: 389 iterations completed
Progress: 390 iterations completed
Progress: 391 iterations completed
Progress: 392 iterations completed
Progress: 393 iterations completed
Progress: 394 iterations completed
Progress: 395 iterations completed
Progress: 396 iterations completed
Progress: 397 iterations completed
Progress: 398 iterations completed
Progress: 399 iterations completed
Progress: 400 iterations completed
Progress: 401 iterations completed
Progress: 402 iterations completed
Progress: 403 iterations completed
Progress: 404 iterations completed
Progress: 405 iterations completed
Progress: 406 iterations completed
Progress: 407 iterations completed
Progress: 408 iterations completed
Progress: 409 iterations completed
Progress: 410 iterations completed
Progress: 411 iterations completed
Progress: 412 iterations completed
Progress: 413 iterations completed
Progress: 414 iterations completed
Progress: 415 iterations completed
Progress: 416 iterations completed
Progress: 417 iterations completed
Progress: 418 iterations completed
Progress: 419 iterations completed
Progress: 420 iterations completed
Progress: 421 iterations completed
Progress: 422 iterations completed
Progress: 423 iterations completed
Progress: 424 iterations completed
Progress: 425 iterations completed
Progress: 426 iterations completed
Progress: 427 iterations completed
Progress: 428 iterations completed
Progress: 429 iterations completed
Progress: 430 iterations completed
Progress: 431 iterations completed
Progress: 432 iterations completed
Progress: 433 iterations completed
Progress: 434 iterations completed
Progress: 435 iterations completed
Progress: 436 iterations completed
Progress: 437 iterations completed
Progress: 438 iterations completed
Progress: 439 iterations completed
Progress: 440 iterations completed
Progress: 441 iterations completed
Progress: 442 iterations completed
Progress: 443 iterations completed
Progress: 444 iterations completed
Progress: 445 iterations completed
Progress: 446 iterations completed
Progress: 447 iterations completed
Progress: 448 iterations completed
Progress: 449 iterations completed
Progress: 450 iterations completed
Progress: 451 iterations completed
Progress: 452 iterations completed
Progress: 453 iterations completed
Progress: 454 iterations completed
Progress: 455 iterations completed
Progress: 456 iterations completed
Progress: 457 iterations completed
Progress: 458 iterations completed
Progress: 459 iterations completed
Progress: 460 iterations completed
Progress: 461 iterations completed
Progress: 462 iterations completed
Progress: 463 iterations completed
Progress: 464 iterations completed
Progress: 465 iterations completed
Progress: 466 iterations completed
Progress: 467 iterations completed
Progress: 468 iterations completed
Progress: 469 iterations completed
Progress: 470 iterations completed
Progress: 471 iterations completed
Progress: 472 iterations completed
Progress: 473 iterations completed
Progress: 474 iterations completed
Progress: 475 iterations completed
Progress: 476 iterations completed
Progress: 477 iterations completed
Progress: 478 iterations completed
Progress: 479 iterations completed
Progress: 480 iterations completed
Progress: 481 iterations completed
Progress: 482 iterations completed
Progress: 483 iterations completed
Progress: 484 iterations completed
Progress: 485 iterations completed
Progress: 486 iterations completed
Progress: 487 iterations completed
Progress: 488 iterations completed
Progress: 489 iterations completed
Progress: 490 iterations completed
Progress: 491 iterations completed
Progress: 492 iterations completed
Progress: 493 iterations completed
Progress: 494 iterations completed
Progress: 495 iterations completed
Progress: 496 iterations completed
Progress: 497 iterations completed
Progress: 498 iterations completed
Progress: 499 iterations completed
Progress: 500 iterations completed
Progress: 501 iterations completed
Progress: 502 iterations completed
Progress: 503 iterations completed
Progress: 504 iterations completed
Progress: 505 iterations completed
Progress: 506 iterations completed
Progress: 507 iterations completed
Progress: 508 iterations completed
Progress: 509 iterations completed
Progress: 510 iterations completed
Progress: 511 iterations completed
Progress: 512 iterations completed
Progress: 513 iterations completed
Progress: 514 iterations completed
Progress: 515 iterations completed
Progress: 516 iterations completed
Progress: 517 iterations completed
Progress: 518 iterations completed
Progress: 519 iterations completed
Progress: 520 iterations completed
Progress: 521 iterations completed
Progress: 522 iterations completed
Progress: 523 iterations completed
Progress: 524 iterations completed
Progress: 525 iterations completed
Progress: 526 iterations completed
Progress: 527 iterations completed
Progress: 528 iterations completed
Progress: 529 iterations completed
Progress: 530 iterations completed
Progress: 531 iterations completed
Progress: 532 iterations completed
Progress: 533 iterations completed
Progress: 534 iterations completed
Progress: 535 iterations completed
Progress: 536 iterations completed
Progress: 537 iterations completed
Progress: 538 iterations completed
Progress: 539 iterations completed
Progress: 540 iterations completed
Progress: 541 iterations completed
Progress: 542 iterations completed
Progress: 543 iterations completed
Progress: 544 iterations completed
Progress: 545 iterations completed
Progress: 546 iterations completed
Progress: 547 iterations completed
Progress: 548 iterations completed
Progress: 549 iterations completed
Progress: 550 iterations completed
Progress: 551 iterations completed
Progress: 552 iterations completed
Progress: 553 iterations completed
Progress: 554 iterations completed
Progress: 555 iterations completed
Progress: 556 iterations completed
Progress: 557 iterations completed
Progress: 558 iterations completed
Progress: 559 iterations completed
Progress: 560 iterations completed
Progress: 561 iterations completed
Progress: 562 iterations completed
Progress: 563 iterations completed
Progress: 564 iterations completed
Progress: 565 iterations completed
Progress: 566 iterations completed
Progress: 567 iterations completed
Progress: 568 iterations completed
Progress: 569 iterations completed
Progress: 570 iterations completed
Progress: 571 iterations completed
Progress: 572 iterations completed
Progress: 573 iterations completed
Progress: 574 iterations completed
Progress: 575 iterations completed
Progress: 576 iterations completed
Progress: 577 iterations completed
Progress: 578 iterations completed
Progress: 579 iterations completed
Progress: 580 iterations completed
Progress: 581 iterations completed
Progress: 582 iterations completed
Progress: 583 iterations completed
Progress: 584 iterations completed
Progress: 585 iterations completed
Progress: 586 iterations completed
Progress: 587 iterations completed
Progress: 588 iterations completed
Progress: 589 iterations completed
Progress: 590 iterations completed
Progress: 591 iterations completed
Progress: 592 iterations completed
Progress: 593 iterations completed
Progress: 594 iterations completed
Progress: 595 iterations completed
Progress: 596 iterations completed
Progress: 597 iterations completed
Progress: 598 iterations completed
Progress: 599 iterations completed
Progress: 600 iterations completed
Progress: 601 iterations completed
Progress: 602 iterations completed
Progress: 603 iterations completed
Progress: 604 iterations completed
Progress: 605 iterations completed
Progress: 606 iterations completed
Progress: 607 iterations completed
Progress: 608 iterations completed
Progress: 609 iterations completed
Progress: 610 iterations completed
Progress: 611 iterations completed
Progress: 612 iterations completed
Progress: 613 iterations completed
Progress: 614 iterations completed
Progress: 615 iterations completed
Progress: 616 iterations completed
Progress: 617 iterations completed
Progress: 618 iterations completed
Progress: 619 iterations completed
Progress: 620 iterations completed
Progress: 621 iterations completed
Progress: 622 iterations completed
Progress: 623 iterations completed
Progress: 624 iterations completed
Progress: 625 iterations completed
Progress: 626 iterations completed
Progress: 627 iterations completed
Progress: 628 iterations completed
Progress: 629 iterations completed
Progress: 630 iterations completed
Progress: 631 iterations completed
Progress: 632 iterations completed
Progress: 633 iterations completed
Progress: 634 iterations completed
Progress: 635 iterations completed
Progress: 636 iterations completed
Progress: 637 iterations completed
Progress: 638 iterations completed
Progress: 639 iterations completed
Progress: 640 iterations completed
Progress: 641 iterations completed
Progress: 642 iterations completed
Progress: 643 iterations completed
Progress: 644 iterations completed
Progress: 645 iterations completed
Progress: 646 iterations completed
Progress: 647 iterations completed
Progress: 648 iterations completed
Progress: 649 iterations completed
Progress: 650 iterations completed
Progress: 651 iterations completed
Progress: 652 iterations completed
Progress: 653 iterations completed
Progress: 654 iterations completed
Progress: 655 iterations completed
Progress: 656 iterations completed
Progress: 657 iterations completed
Progress: 658 iterations completed
Progress: 659 iterations completed
Progress: 660 iterations completed
Progress: 661 iterations completed
Progress: 662 iterations completed
Progress: 663 iterations completed
Progress: 664 iterations completed
Progress: 665 iterations completed
Progress: 666 iterations completed
Progress: 667 iterations completed
Progress: 668 iterations completed
Progress: 669 iterations completed
Progress: 670 iterations completed
Progress: 671 iterations completed
Progress: 672 iterations completed
Progress: 673 iterations completed
Progress: 674 iterations completed
Progress: 675 iterations completed
Progress: 676 iterations completed
Progress: 677 iterations completed
Progress: 678 iterations completed
Progress: 679 iterations completed
Progress: 680 iterations completed
Progress: 681 iterations completed
Progress: 682 iterations completed
Progress: 683 iterations completed
Progress: 684 iterations completed
Progress: 685 iterations completed
Progress: 686 iterations completed
Progress: 687 iterations completed
Progress: 688 iterations completed
Progress: 689 iterations completed
Progress: 690 iterations completed
Progress: 691 iterations completed
Progress: 692 iterations completed
Progress: 693 iterations completed
Progress: 694 iterations completed
Progress: 695 iterations completed
Progress: 696 iterations completed
Progress: 697 iterations completed
Progress: 698 iterations completed
Progress: 699 iterations completed
Progress: 700 iterations completed
Progress: 701 iterations completed
Progress: 702 iterations completed
Progress: 703 iterations completed
Progress: 704 iterations completed
Progress: 705 iterations completed
Progress: 706 iterations completed
Progress: 707 iterations completed
Progress: 708 iterations completed
Progress: 709 iterations completed
Progress: 710 iterations completed
Progress: 711 iterations completed
Progress: 712 iterations completed
Progress: 713 iterations completed
Progress: 714 iterations completed
Progress: 715 iterations completed
Progress: 716 iterations completed
Progress: 717 iterations completed
Progress: 718 iterations completed
Progress: 719 iterations completed
Progress: 720 iterations completed
Progress: 721 iterations completed
Progress: 722 iterations completed
Progress: 723 iterations completed
Progress: 724 iterations completed
Progress: 725 iterations completed
Progress: 726 iterations completed
Progress: 727 iterations completed
Progress: 728 iterations completed
Progress: 729 iterations completed
Progress: 730 iterations completed
Progress: 731 iterations completed
Progress: 732 iterations completed
Progress: 733 iterations completed
Progress: 734 iterations completed
Progress: 735 iterations completed
Progress: 736 iterations completed
Progress: 737 iterations completed
Progress: 738 iterations completed
Progress: 739 iterations completed
Progress: 740 iterations completed
Progress: 741 iterations completed
Progress: 742 iterations completed
Progress: 743 iterations completed
Progress: 744 iterations completed
Progress: 745 iterations completed
Progress: 746 iterations completed
Progress: 747 iterations completed
Progress: 748 iterations completed
Progress: 749 iterations completed
Progress: 750 iterations completed
Progress: 751 iterations completed
Progress: 752 iterations completed
Progress: 753 iterations completed
Progress: 754 iterations completed
Progress: 755 iterations completed
Progress: 756 iterations completed
Progress: 757 iterations completed
Progress: 758 iterations completed
Progress: 759 iterations completed
Progress: 760 iterations completed
Progress: 761 iterations completed
Progress: 762 iterations completed
Progress: 763 iterations completed
Progress: 764 iterations completed
Progress: 765 iterations completed
Progress: 766 iterations completed
Progress: 767 iterations completed
Progress: 768 iterations completed
Progress: 769 iterations completed
Progress: 770 iterations completed
Progress: 771 iterations completed
Progress: 772 iterations completed
Progress: 773 iterations completed
Progress: 774 iterations completed
Progress: 775 iterations completed
Progress: 776 iterations completed
Progress: 777 iterations completed
Progress: 778 iterations completed
Progress: 779 iterations completed
Progress: 780 iterations completed
Progress: 781 iterations completed
Progress: 782 iterations completed
Progress: 783 iterations completed
Progress: 784 iterations completed
Progress: 785 iterations completed
Progress: 786 iterations completed
Progress: 787 iterations completed
Progress: 788 iterations completed
Progress: 789 iterations completed
Progress: 790 iterations completed
Progress: 791 iterations completed
Progress: 792 iterations completed
Progress: 793 iterations completed
Progress: 794 iterations completed
Progress: 795 iterations completed
Progress: 796 iterations completed
Progress: 797 iterations completed
Progress: 798 iterations completed
Progress: 799 iterations completed
Progress: 800 iterations completed
Progress: 801 iterations completed
Progress: 802 iterations completed
Progress: 803 iterations completed
Progress: 804 iterations completed
Progress: 805 iterations completed
Progress: 806 iterations completed
Progress: 807 iterations completed
Progress: 808 iterations completed
Progress: 809 iterations completed
Progress: 810 iterations completed
Progress: 811 iterations completed
Progress: 812 iterations completed
Progress: 813 iterations completed
Progress: 814 iterations completed
Progress: 815 iterations completed
Progress: 816 iterations completed
Progress: 817 iterations completed
Progress: 818 iterations completed
Progress: 819 iterations completed
Progress: 820 iterations completed
Progress: 821 iterations completed
Progress: 822 iterations completed
Progress: 823 iterations completed
Progress: 824 iterations completed
Progress: 825 iterations completed
Progress: 826 iterations completed
Progress: 827 iterations completed
Progress: 828 iterations completed
Progress: 829 iterations completed
Progress: 830 iterations completed
Progress: 831 iterations completed
Progress: 832 iterations completed
Progress: 833 iterations completed
Progress: 834 iterations completed
Progress: 835 iterations completed
Progress: 836 iterations completed
Progress: 837 iterations completed
Progress: 838 iterations completed
Progress: 839 iterations completed
Progress: 840 iterations completed
Progress: 841 iterations completed
Progress: 842 iterations completed
Progress: 843 iterations completed
Progress: 844 iterations completed
Progress: 845 iterations completed
Progress: 846 iterations completed
Progress: 847 iterations completed
Progress: 848 iterations completed
Progress: 849 iterations completed
Progress: 850 iterations completed
Progress: 851 iterations completed
Progress: 852 iterations completed
Progress: 853 iterations completed
Progress: 854 iterations completed
Progress: 855 iterations completed
Progress: 856 iterations completed
Progress: 857 iterations completed
Progress: 858 iterations completed
Progress: 859 iterations completed
Progress: 860 iterations completed
Progress: 861 iterations completed
Progress: 862 iterations completed
Progress: 863 iterations completed
Progress: 864 iterations completed
Progress: 865 iterations completed
Progress: 866 iterations completed
Progress: 867 iterations completed
Progress: 868 iterations completed
Progress: 869 iterations completed
Progress: 870 iterations completed
Progress: 871 iterations completed
Progress: 872 iterations completed
Progress: 873 iterations completed
Progress: 874 iterations completed
Progress: 875 iterations completed
Progress: 876 iterations completed
Progress: 877 iterations completed
Progress: 878 iterations completed
Progress: 879 iterations completed
Progress: 880 iterations completed
Progress: 881 iterations completed
Progress: 882 iterations completed
Progress: 883 iterations completed
Progress: 884 iterations completed
Progress: 885 iterations completed
Progress: 886 iterations completed
Progress: 887 iterations completed
Progress: 888 iterations completed
Progress: 889 iterations completed
Progress: 890 iterations completed
Progress: 891 iterations completed
Progress: 892 iterations completed
Progress: 893 iterations completed
Progress: 894 iterations completed
Progress: 895 iterations completed
Progress: 896 iterations completed
Progress: 897 iterations completed
Progress: 898 iterations completed
Progress: 899 iterations completed
Progress: 900 iterations completed
Progress: 901 iterations completed
Progress: 902 iterations completed
Progress: 903 iterations completed
Progress: 904 iterations completed
Progress: 905 iterations completed
Progress: 906 iterations completed
Progress: 907 iterations completed
Progress: 908 iterations completed
Progress: 909 iterations completed
Progress: 910 iterations completed
Progress: 911 iterations completed
Progress: 912 iterations completed
Progress: 913 iterations completed
Progress: 914 iterations completed
Progress: 915 iterations completed
Progress: 916 iterations completed
Progress: 917 iterations completed
Progress: 918 iterations completed
Progress: 919 iterations completed
Progress: 920 iterations completed
Progress: 921 iterations completed
Progress: 922 iterations completed
Progress: 923 iterations completed
Progress: 924 iterations completed
Progress: 925 iterations completed
Progress: 926 iterations completed
Progress: 927 iterations completed
Progress: 928 iterations completed
Progress: 929 iterations completed
Progress: 930 iterations completed
Progress: 931 iterations completed
Progress: 932 iterations completed
Progress: 933 iterations completed
Progress: 934 iterations completed
Progress: 935 iterations completed
Progress: 936 iterations completed
Progress: 937 iterations completed
Progress: 938 iterations completed
Progress: 939 iterations completed
Progress: 940 iterations completed
Progress: 941 iterations completed
Progress: 942 iterations completed
Progress: 943 iterations completed
Progress: 944 iterations completed
Progress: 945 iterations completed
Progress: 946 iterations completed
Progress: 947 iterations completed
Progress: 948 iterations completed
Progress: 949 iterations completed
Progress: 950 iterations completed
Progress: 951 iterations completed
Progress: 952 iterations completed
Progress: 953 iterations completed
Progress: 954 iterations completed
Progress: 955 iterations completed
Progress: 956 iterations completed
Progress: 957 iterations completed
Progress: 958 iterations completed
Progress: 959 iterations completed
Progress: 960 iterations completed
Progress: 961 iterations completed
Progress: 962 iterations completed
Progress: 963 iterations completed
Progress: 964 iterations completed
Progress: 965 iterations completed
Progress: 966 iterations completed
Progress: 967 iterations completed
Progress: 968 iterations completed
Progress: 969 iterations completed
Progress: 970 iterations completed
Progress: 971 iterations completed
Progress: 972 iterations completed
Progress: 973 iterations completed
Progress: 974 iterations completed
Progress: 975 iterations completed
Progress: 976 iterations completed
Progress: 977 iterations completed
Progress: 978 iterations completed
Progress: 979 iterations completed
Progress: 980 iterations completed
Progress: 981 iterations completed
Progress: 982 iterations completed
Progress: 983 iterations completed
Progress: 984 iterations completed
Progress: 985 iterations completed
Progress: 986 iterations completed
Progress: 987 iterations completed
Progress: 988 iterations completed
Progress: 989 iterations completed
Progress: 990 iterations completed
Progress: 991 iterations completed
Progress: 992 iterations completed
Progress: 993 iterations completed
Progress: 994 iterations completed
Progress: 995 iterations completed
Progress: 996 iterations completed
Progress: 997 iterations completed
Progress: 998 iterations completed
Progress: 999 iterations completed
Progress: 1000 iterations completed</code></pre>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="what_is_stacked_ensambled.html#cb462-1" tabindex="-1"></a><span class="co"># Average the correlation matrix over the 1000 iterations</span></span>
<span id="cb462-2"><a href="what_is_stacked_ensambled.html#cb462-2" tabindex="-1"></a>avg_cor_matrix <span class="ot">&lt;-</span> cor_matrix_sum <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb462-3"><a href="what_is_stacked_ensambled.html#cb462-3" tabindex="-1"></a></span>
<span id="cb462-4"><a href="what_is_stacked_ensambled.html#cb462-4" tabindex="-1"></a><span class="co"># Print the averaged correlation matrix</span></span>
<span id="cb462-5"><a href="what_is_stacked_ensambled.html#cb462-5" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Averaged Correlation Matrix:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Averaged Correlation Matrix:&quot;</code></pre>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="what_is_stacked_ensambled.html#cb464-1" tabindex="-1"></a><span class="fu">print</span>(avg_cor_matrix)</span></code></pre></div>
<pre><code>##                  lm_pred   rf_pred tuned_gbm_pred  knn_pred
## lm_pred        1.0000000 0.9014258      0.8926652 0.8656307
## rf_pred        0.9014258 1.0000000      0.9769452 0.9341390
## tuned_gbm_pred 0.8926652 0.9769452      1.0000000 0.9154042
## knn_pred       0.8656307 0.9341390      0.9154042 1.0000000</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="hcc_survey_analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intro_econ_stats.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/13_What_Is_Stacked_Ensambled.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
